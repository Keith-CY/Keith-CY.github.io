<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>note of sw-precache | EzCook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="A node module to generate service worker code that will precaches specific resource so they work offline. Serving your local static resources cache-first means that you can get all the crucial scaffol">
<meta name="keywords" content="precache">
<meta property="og:type" content="article">
<meta property="og:title" content="note of sw-precache">
<meta property="og:url" content="http://yoursite.com/2017/09/04/note-of-sw-precache/index.html">
<meta property="og:site_name" content="EzCook">
<meta property="og:description" content="A node module to generate service worker code that will precaches specific resource so they work offline. Serving your local static resources cache-first means that you can get all the crucial scaffol">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2017-09-04T05:49:43.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="note of sw-precache">
<meta name="twitter:description" content="A node module to generate service worker code that will precaches specific resource so they work offline. Serving your local static resources cache-first means that you can get all the crucial scaffol">
  
    <link rel="alternate" href="/atom.xml" title="EzCook" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>

  
    
      <body class="dark">
    
  
      <div id="container" class="container">
        <article id="post-note-of-sw-precache" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      note of sw-precache
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p>A node module to generate service worker code that will precaches specific resource so they work offline.</p>
<p>Serving your local static resources cache-first means that you can get all the crucial scaffolding for your web app – your app shell – on the screen  without having to wait for any network responses.</p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add --dev sw-precache</div></pre></td></tr></table></figure>
<h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><ol>
<li><p>Make sure your site is served using HTTPS.</p>
</li>
<li><p>incorporate <code>sw-precache</code> into your <code>node</code>-based build script.</p>
</li>
<li><p>Register the service worker JavaScript.</p>
</li>
</ol>
<h3 id="Considerations"><a href="#Considerations" class="headerlink" title="Considerations"></a>Considerations</h3><ul>
<li><p>Service worker caching should be considered a prograssive enhancement. If you follow the model of conditionally registering a service worker only if it’s supported(determined by <code>if(&#39;serviceWorker&#39; in navigator)</code>), you’ll get offline support on browsers with service workers and on browsers that don’t support service workers, the offline-specific code will never be called.</p>
</li>
<li><p>All resources that are precached will be fetched by a service worker runing in a separate thread as soon as the service worker is installed. You should be judicious in what you list in the <code>dynamicUrlsToDependencies</code> and <code>staticFileGlobs</code> options, since listing files that are non-essential(large-images that are not shown on every page, for instance) will result in browsers downloading more data than is strictly necessary.</p>
</li>
<li><p>Precaching doesn’t make sense for all types of resource. Other caching strategies can be used in conjunction with <code>sw-precache</code> to provide the best experience for your users. If you do implement additional caching logic, put the code in a separate file and include it using the <code>importScripts()</code> method.</p>
</li>
<li><p><code>sw-precache</code> uses a <strong>cache-first</strong> strategy, which results in a copy of any cached content being returned without consulting the network.</p>
</li>
</ul>
<h3 id="Use-with-webpack"><a href="#Use-with-webpack" class="headerlink" title="Use with webpack"></a>Use with webpack</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add --dev sw-precache-webpack-plugin</div></pre></td></tr></table></figure>
<h4 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h4><p>A simple configuration example that will work well in most production environments.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</div><div class="line"><span class="keyword">const</span> SWPrecachePlugin = <span class="built_in">require</span>(<span class="string">'sw-precache-webpack-plugin'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> PUBLIC_PATH = <span class="string">'https://www.my-project-name.com/'</span></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exporst = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">main</span>: path.resolve(__dirname, <span class="string">'src/index'</span>)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: path.resolve(__dirname, <span class="string">'src/bundles/'</span>),</div><div class="line">    <span class="attr">filename</span>: <span class="string">'[name]-[hash].js'</span>,</div><div class="line">    <span class="attr">publicPath</span>: PUBLIC_PATH,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> SWPrecachePlugin(&#123;</div><div class="line">      <span class="attr">cacheId</span>: <span class="string">'my-project-name'</span>,</div><div class="line">      <span class="attr">dontCacheBustUrlsMatching</span>: <span class="regexp">/\.\w&#123;8&#125;\./</span>,</div><div class="line">      <span class="attr">filename</span>: <span class="string">'service-worker.js'</span>,</div><div class="line">      <span class="attr">minify</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">navigateFallback</span>: PUBLIC_PATH + <span class="string">'index.html'</span>,</div><div class="line">      <span class="attr">staticFileGlobsIgnorePatterns</span>: [</div><div class="line">        <span class="regexp">/\.map$/</span>,</div><div class="line">        /asset-manifest\.json$/,</div><div class="line">      ]</div><div class="line">    &#125;)</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This will generate a new service worker at <code>src/bundles/service-worker.js</code>, then you would register it in your application:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</div><div class="line">    navigator.serviceWorker.register(<span class="string">'./service-worker.js'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)()</div></pre></td></tr></table></figure>
<h4 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h4><ul>
<li><p>filename: string - service worker filename, default is <code>service-worker.js</code></p>
</li>
<li><p>filepath: string - service worker path and name, default is to use <code>webpack.output.path</code> + <code>options.filename</code>. This will override <code>filename</code>.</p>
</li>
<li><p>staticFileGlobsIngorePatters: [Regexp] - Define an optional array of regex patterns to filter out of staticFileGlobs.</p>
</li>
<li><p>mergeStaticsConfig: [boolean] - Merge provided staticFileGlobs and stripPrefixMulti with webpack’s config, rather than having those take precedence, default is false.</p>
</li>
<li><p>minify: [boolean] - Set to true to minify and uglify the generated service-worker, default is false.</p>
</li>
<li><p>cacheId: [string] - Not required but you should include this, it will give your service worker cache a unique name, default to <code>sw-precache-webpack-plugin</code>.</p>
</li>
<li><p>importScripts: [Array<string|object>]</string|object></p>
<ul>
<li><p>when importScripts array item is a string, converts to object format: <code>{ filename: &#39;&lt;publicPath&gt;/my-scripts.js&#39;}</code></p>
</li>
<li><p>when importScripts array item is an Object</p>
<ul>
<li><p>look for <code>chunkName</code> property</p>
</li>
<li><p>look for <code>filename</code> property</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>replacePrefix: [String] - should only be used in conjunction with <code>stripPrefix</code></p>
</li>
<li><p>staticFileGlobs: [Array<string>] - Omit this to allow the plugin to cache all your bundles’ emitted assets. If <code>mergeStaticsConfig=true</code>: this value will be merged with your bundles’ emitted assets, otherwise this value is just passed to <code>sw-precache</code> and emitted assets won’t be included.</string></p>
</li>
<li><p>stripPrefix: [String] - Same as stripPrefixMulti[stripPrefix] = ‘’</p>
</li>
<li><p>stripPrefixMulti: [Object<string,string>] - Omit this to use your webpack config’s <code>output.path</code> + <code>/</code>: <code>output.publicPath</code>.</string,string></p>
</li>
</ul>
<blockquote>
<p>Note taht all configuration options are optional. <code>SWPrecacheWebpackPlugin</code> will by default use all your assets emitted by webpack’s compiler for the <code>staticFileGlobs</code> parameter and your webpack config’s <code>{[output.path + &#39;/&#39;]: output.publicPath}</code> as the stripPrefixMulti parameter. This behavior is probably what you want, all your webpack assets will be cached by your generated service worker. Just don’t pass any arguments when you initialize this plugin, and let this plugin handle generating your <code>sw-precache</code> configuration.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">  <span class="keyword">new</span> SWPrecacheWebpackPlugin(),</div><div class="line">]</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2017/09/04/note-of-sw-precache/" class="article-date">
  <time datetime="2017-09-04T02:55:34.000Z" itemprop="datePublished">2017-09-04</time>
</a>

        </li>
        
        
          <li>
            <span class="label">Tag:</span>
            
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/precache/">precache</a></li></ul>


          </li>
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2017/09/04/AsyncRoute-with-React-Router-v4/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          AsyncRoute with React-Router-v4
        
      </div>
    </a>
  
  
    <a href="/2017/09/03/service-worker-with-webpack/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">service-worker with webpack</div>
    </a>
  
</nav>


  
</article>




      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>Write for Archive</p>


      </div>
    </footer>

      

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







    </div>
  </body>
</html>
