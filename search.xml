<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[Tutorial Part 5 of Dapp]]></title>
      <url>/2017/07/14/Tutorial-Part-5-of-Dapp/</url>
      <content type="html"></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Tutorial Part 4 of Dapp]]></title>
      <url>/2017/07/14/Tutorial-Part-4-of-Parity/</url>
      <content type="html"><![CDATA[<h1 id="Calling-Contracts"><a href="#Calling-Contracts" class="headerlink" title="Calling Contracts"></a>Calling Contracts</h1><p>Contract API basically comes in three pieces.</p>
<ul>
<li><p>Firstly, there’s state-changing transaction like tranferring tokens to a counter-party.</p>
</li>
<li><p>Secondly, there’s event reception and reporting that happen when such a state change occurs.</p>
</li>
<li><p>Finally, there is inspection of the contract state through calling <code>constant</code> function.</p>
</li>
</ul>
<h2 id="Our-first-contract"><a href="#Our-first-contract" class="headerlink" title="Our first contract"></a>Our first contract</h2><p>The first contract we will deal with is the global(name) registry. If you are not yet familiar, this is a registry that exists on all sensible blockchain which records fields of information for any desired name.</p>
<p>The registry records onwership information so that names can be registered and their information changed at a later date.</p>
<p>The registry contract has a fairly simple API for inspecting. We only need to worry about two functions:</p>
<ul>
<li><p><code>getOwner(bytes32) -&gt; address</code>, given the Keccak hash of name, this returns the address of its owner, if it has been reserved.</p>
</li>
<li><p><code>getData(bytes32, bytes32) -&gt; bytes32</code>, given the Keccak hash of a name and a second field key, this returns the associated data.</p>
</li>
</ul>
<p>There are subordinate functions to the latter such as <code>getAddress</code> and <code>getUint</code> which coerce the data into some other type. It is important to note that amongst the standardised field keys are:</p>
<ul>
<li><p><code>A</code> the <code>address</code> primarily associated with the name; if you’re wanting to send funds to the name, this is where to send them(assuming it’s not null)</p>
</li>
<li><p><code>CONTENT</code> the <code>bytes32</code> which equals the Keccak hash of any content associated with this name. e.g. If the name represents a dapp, then this would be the hash of the dapp’s content.</p>
</li>
<li><p><code>IMG</code> the <code>bytes32</code> which equals the Keccak hash of an associated image; this might be a person’s avatar or the dapp icon, depending on what is being named.</p>
</li>
</ul>
<p>Let’s begin by displaying the address associated with the name <code>gavofyork</code>. To do this we will need to create a special <code>Bond</code>-API contract object. The function to do this is <code>bonds.makeContract</code>; It takes the address and the ABI of the contract and returns an object with <code>Bond</code> – returning functions for each of the contract’s functions.</p>
<p>The address is easy enough to find; this can be determined via the <code>parity.api.parity.registry</code> call. The ABI spec is rather long and can be derived from the contract code available at the ethcode/contracts repository. Since there is only a single canonical registry, Parity, conveniently constructs this for you and provides it at the <code>bonds.registry</code> object.</p>
<p>To figure out the primary associated address of the <code>gavofyork</code> name, we can use the <code>getAddress</code> call, together with the <code>parity.api.util.sha3</code> call to take the Keccak hash of our name. The full expression would be:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bonds.registry.getAddress(parity.api.util.sha3(<span class="string">'gavofyork'</span>))</div></pre></td></tr></table></figure>
<p>Typing <code>parity.api.util.sha3(...)</code> every time you want to look up a name in the registry gets tedious fast. Happily, Parity provides a number of derivative helper functions as part of the <code>bonds&#39;registry</code> object: <code>lookupDate</code>, <code>lookupAddress</code>, <code>lookupUint</code> and <code>lookupOwner</code>. They are all just like the <code>get-</code> prefixed brethren, but do the hashing for you. Our expression therefore can become:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bonds.registry.lookupAddress(<span class="string">'gavofyork'</span>, <span class="string">'A'</span>)</div></pre></td></tr></table></figure>
<p>Let’s get this in to our dapp, Change the <code>render()</code>ed HTML to:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  gavofyorks address is:</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Rspan</span>&gt;</span>&#123;bonds.registry.lookupAddress('gavofyork', 'A')&#125;<span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
<h2 id="Dynamic-lookups"><a href="#Dynamic-lookups" class="headerlink" title="Dynamic lookups"></a>Dynamic lookups</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span> () &#123;</div><div class="line">    <span class="keyword">super</span>()</div><div class="line">    <span class="keyword">this</span>.bond = <span class="keyword">new</span> Bond()</div><div class="line">  &#125;</div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        Address of <span class="tag">&lt;<span class="name">InputBond</span> <span class="attr">bond</span>=<span class="string">&#123;this.bond&#125;</span> <span class="attr">placeholder</span>=<span class="string">"Lookup a name"</span> /&gt;</span> is:<span class="tag">&lt;<span class="name">br</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Rspan</span>&gt;</span>&#123;bonds.registry.lookupAddress(this.bond, 'A')&#125;<span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></div><div class="line">        Its balance is</div><div class="line">        <span class="tag">&lt;<span class="name">Rspan</span>&gt;</span></div><div class="line">          &#123;bonds.balance(bonds.registry.lookupAddress(this.bond, 'A')).map(formatBalance)&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Derivative-contracts"><a href="#Derivative-contracts" class="headerlink" title="Derivative contracts"></a>Derivative contracts</h2><p>Typically the registry is used to lookup the address of a second contract that you would actucally like to use.</p>
<p>Let’s suppose that second contract is the GithubHint contract; if you’re not already familiar, the GithubHint contract allows you to suggest which URLs might serve content for a particular hash.It’s a semi-centralized, hacky alternative to content-addressable-delivery systems like BitTorrent/Kademlia, Swarm and IPFS. We use it widely in Parity as a means of content dissemination.</p>
<p>Since is a ‘standard’ contract in Parity, the ABI for it is available in <code>oo7-parity</code> as <code>GitHubHintABI</code>. The address changes per chain, but can be discovered via the registry under the name ‘githubhint’. The expression would therefore be <code>bonds.registry.lookupAddress(&#39;githubhint&#39;, &#39;A&#39;)</code>.</p>
<p>Though we mustn’t forget to import <code>GitHubHint</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; GitHubHintABI &#125; form <span class="string">'oo7-parity'</span></div></pre></td></tr></table></figure>
<p>The GithubHint contract has only a single inspection method: <code>entries</code>. This takes a <code>bytes32</code> and returns three items(via an array). There are three kinds of entry: Github repository entries, whereby the first and second items form the addresss of a particular commit of a particular repository; general URLs, where the first item is a URL and the second is the null hash; and empty entries where both items are null. The third item is always the owner (if any) of the entry and the only account capable of changing the hint information.</p>
<p>In this small demo, we’ll assume that we are looking up only URLs and so are only interested in the first item. We therefore want an expression like:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GitHubHint.entries(hash)[<span class="number">0</span>]</div></pre></td></tr></table></figure>
<p>Where <code>hash</code> is some content hash and <code>GitHubHint</code> is the contract object.</p>
<p>Putting this all together we can change our dapp to:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span> () &#123;</div><div class="line">    <span class="keyword">super</span>()</div><div class="line">    <span class="keyword">this</span>.bond = <span class="keyword">new</span> Bond()</div><div class="line">    <span class="keyword">this</span>.GitHubHint = bonds.makeContract(bonds.registry.lookupAddress(<span class="string">'githubhint'</span>, <span class="string">'A'</span>), GitHubHintABI)</div><div class="line">  &#125;</div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">        URL for content <span class="tag">&lt;<span class="name">HashBond</span> <span class="attr">bond</span>=<span class="string">&#123;this.bond&#125;</span> <span class="attr">floatingLabelText</span>=<span class="string">"Content-Hash"</span> /&gt;</span> is:</div><div class="line">        <span class="tag">&lt;<span class="name">Rspan</span>&gt;</span>&#123;this.GithubHint.entries(this.bond)[0]&#125;<span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Note that we are using <code>HashBond</code> from <code>oo7-react</code> rather than <code>InputBond</code>. This just ensures that we enter only valid 32-byte hashes. Ensure that the import line is changed to:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; InputBond, HashBond &#125; <span class="keyword">from</span> <span class="string">'parity-reactive-ui'</span></div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Tutorial Part 3 of Dapp]]></title>
      <url>/2017/07/13/Tutorial-Part-3-of-Dapp/</url>
      <content type="html"><![CDATA[<h1 id="Parity-Bonds"><a href="#Parity-Bonds" class="headerlink" title="Parity Bonds"></a>Parity Bonds</h1><p>It’s time to get down and dirty with the blockchain.</p>
<p>For this we will introduce the <code>oo7-parity</code> package, which provides a high-level reactive <code>Bond</code> API.</p>
<p>To set this up, all we need do is import <code>bonds</code> from the <code>oo7-parity</code> module, so ensure you have this at the top of your file:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; bonds &#125; <span class="keyword">from</span> <span class="string">'oo7-parity'</span></div></pre></td></tr></table></figure>
<h2 id="Watch-the-block"><a href="#Watch-the-block" class="headerlink" title="Watch the block"></a>Watch the block</h2><p>For our first task, we will introduce the simplest of all bonds: <code>bonds.height</code>. This evaluates to <code>the number of the latest block</code>, expressed as a simple number.</p>
<p>In <code>app.jsx</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">Rspan</span>&gt;</span>&#123;bonds.height&#125;<span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It’s not especially pretty so you can add some style on it.</p>
<p>We also provide the <code>formatBlockNumber</code> function:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> formatBlockNumber = <span class="function">(<span class="params">n</span>) =&gt;</span> <span class="string">'#'</span> + (<span class="string">''</span> + n).replace(<span class="regexp">/(\d)(?=(\d&#123;3&#125;)+$)/g</span>, <span class="string">'$1,'</span>)</div></pre></td></tr></table></figure>
<p>You can use it through</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; bonds, formatBlockNumber &#125; <span class="keyword">from</span> <span class="string">'oo7-parity'</span></div></pre></td></tr></table></figure>
<h2 id="Blocks"><a href="#Blocks" class="headerlink" title="Blocks"></a>Blocks</h2><p>The block number is great and all, but perhaps we’re more intereseted in the latest block itself. Parity can help us there with the <code>bonds.blocks</code> object. This is a lazy-evaluated ‘array’ of bonds which can subscribe to. To give yourself an idea of its capabilities, let’s try it out in the console. First we will expose the <code>bonds</code> object to the environment by adding this at the end of our obejct’s constructor:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.bonds = bonds</div></pre></td></tr></table></figure>
<p>Having reloaded, quickly open the Chrome JS console, alter the environment to 127.0.0.1 and evaluate the block at number 69 with <code>bonds.blocks[69].log()</code></p>
<p>Note that since it’s all asynchronous, we must use the <code>.log()</code> trick to feed the result into the console (it’s exactly equivalent to <code>.map(console.log)</code>) The result is, of course, the block object representing the 69th mined block on this chain.</p>
<p>Naturally, <code>bonds.blocks</code> is able to accept any number, even a bond, as its subscript. Let’s make our dapp always give us the timestamp of the latest block.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  Latest block timestamp is:</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Rspan</span>&gt;</span>&#123;bonds.blocks[bonds.blocks.height].map(b =&gt; b.timestamp).map(_ =&gt; _.toString())&#125;<span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
<p>That map is a bit cumbersome, the <code>bond</code> API knows about subscripting, which means the <code>.timestamp</code> can be moved out of the <code>map</code></p>
<p>Furthermore, <code>bonds.blocks[bonds.height]</code> is a fairly common expression. So much so that it has a shorter alias: <code>bonds.head</code>, so in fact the simplest means of expressing this becomes:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; bonds.head.timestamp.map(<span class="function"><span class="params">_</span> =&gt;</span> _.toString())&#125;</div></pre></td></tr></table></figure>
<h2 id="Composing-expressions"><a href="#Composing-expressions" class="headerlink" title="Composing expressions"></a>Composing expressions</h2><p>These expressios are sometimes very useful, but often you want to do some blockchain based computation on this information.</p>
<p>Parity puts various means at your disposal to help you here:</p>
<ul>
<li><p><code>bonds.balance(address)</code>: evaluates to the current balanece of account at <code>address</code></p>
</li>
<li><p><code>bonds.transactionCount(address)</code>: evaluates to the current transaction count (‘nonce’) of account at <code>address</code></p>
</li>
<li><p><code>bonds.code(address)</code>: evaluates to the current ‘contract’ code of account at <code>address</code></p>
</li>
<li><p><code>bonds.storageAt(address, location)</code>: evaluates to the value in storage <code>location</code> of account at <code>address</code></p>
</li>
</ul>
<p>Use the first one:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  Current block authors balance is:</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Rspan</span>&gt;</span></span></div><div class="line">    &#123;bonds.balance(bonds.head.author).map(formatBalance)&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
<h2 id="Our-balance"><a href="#Our-balance" class="headerlink" title="Our balance"></a>Our balance</h2><p>Parity can help us get information about our own accounts in a reactive manner.</p>
<p>Some apis like:</p>
<ul>
<li><p><code>bonds.coinbase</code>: evaluates to the node’s current block authoring address.</p>
</li>
<li><p><code>bonds.accounts</code>: evaluates to the list of accounts available for the dapp to use.</p>
</li>
<li><p><code>bonds.me</code>: evaluates to the preferred account for this dapp to use. In parity, this is the account visible in the Parity Signer at the bottom right of the page.</p>
</li>
<li><p><code>bonds.accountsInfo</code>: evaluates to the mapping between dapp-visible addresses and account metadata.</p>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Tutorial Part2 of Dapp]]></title>
      <url>/2017/07/13/Tutorial-Part2-of-Dapp/</url>
      <content type="html"><![CDATA[<h1 id="oo7-Bonds"><a href="#oo7-Bonds" class="headerlink" title="oo7 Bonds"></a>oo7 Bonds</h1><p>Now we have our basic dapp harness, we can start introducing more interesting functionality. Without too much ado, let’s get started. Head in to <code>src/client/scripts/app.jsx</code>. You will see our basic file:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This is a JSX file. Baiscally means that can handle embedded HTML when describing how React components should be rendered.</p>
<h2 id="Your-first-Bond"><a href="#Your-first-Bond" class="headerlink" title="Your first Bond"></a>Your first <code>Bond</code></h2><p>The first thing we’ll do is introduce the <code>oo7 library</code>. This introduces into Javascript the notion of reactive value known as ‘bonds’. Reactive values are similar to normal variables, except that any places in which they are used will automatically upate themselves as the value changes.</p>
<p>The oo7 package is still very much in development, as such there might be one or two rough edges in this tutorial.</p>
<p>Our first example will just demonstrate how <code>Bond</code> can introduce effortless reactivity by dynamically replicating the contents of an editable text field into a <code>&lt;span&gt;</code>.</p>
<p>Import the needed components by placing three lines at the top of <code>app.jsx</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Bond &#125; <span class="keyword">from</span> <span class="string">'oo7'</span></div><div class="line"><span class="keyword">import</span> &#123; Rspan &#125; <span class="keyword">from</span> <span class="string">'oo7-react'</span></div><div class="line"><span class="keyword">import</span> &#123; InputBond &#125; <span class="keyword">from</span> <span class="string">'parity-reactive-ui'</span></div></pre></td></tr></table></figure>
<p>Next we need to introduce a new instance of a <code>Bond</code>. It will represent the current contents of a text field. We will initialize it in our class’s contructor. Insert these lines directly into the <code>App</code> class decalration.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">constructor</span> () &#123;</div><div class="line">  <span class="keyword">super</span> ()</div><div class="line">  <span class="keyword">this</span>.bond = <span class="keyword">new</span> Bond()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Your code should now look like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123; Bond &#125; <span class="keyword">from</span> <span class="string">'oo7'</span></div><div class="line"><span class="keyword">import</span> &#123; Rspan &#125; <span class="keyword">from</span> <span class="string">'oo7-react'</span></div><div class="line"><span class="keyword">import</span> &#123; InputBond &#125; <span class="keyword">from</span> <span class="string">'parity-reactive-ui'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span> () &#123;</div><div class="line">    <span class="keyword">super</span> ()</div><div class="line">    <span class="keyword">this</span>.bond = <span class="keyword">new</span> Bond()</div><div class="line">  &#125;</div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Next we need to create the text entry field and the <code>&lt;span&gt;</code> element(in which the text field’s contents will be reflected). We will use a version of Semantic UI’s <code>Input</code> element which has been specially modified to propagate the value into a named <code>Bond</code>. This is called <code>InputBond</code>.</p>
<p>Similarly, for the <code>span</code> we will use a special ‘reactive’ version of the <code>span</code> element which is able to accept <code>Bond</code>s as children and values of certain properties. This is known as <code>Rspan</code>.</p>
<p>Change the <code>&lt;div&gt;Hello World&lt;/div&gt;</code> line to:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">InputBond</span> <span class="attr">bond</span>=<span class="string">&#123;this.bond&#125;</span> <span class="attr">placeholder</span>=<span class="string">"Go ahead and type some text"</span> /&gt;</span></span></div><div class="line">  <span class="tag">&lt;<span class="name">Rspan</span>&gt;</span>&#123;this.bond&#125;<span class="tag">&lt;/<span class="name">Rspan</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>As you see there’s not all that much here, we just tell the text field input <code>InputBond</code> to place its value into <code>this.bond</code> and conversely tell <code>Rspan</code> to display that value from <code>this.bond</code>.</p>
<p>Run webpack and let it watch your files to ensure your dapp is continuously rebuilt.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm start</div></pre></td></tr></table></figure>
<h2 id="Transforming-Bonds"><a href="#Transforming-Bonds" class="headerlink" title="Transforming Bonds"></a>Transforming Bonds</h2><p><code>Bond</code>s don’t just have to pass on data; they can also represent transformations on the data.</p>
<p>One example of a transform on text would be simple upper-casing. A function to upper-case text would be <code>text =&gt; text.toUpperCase()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Rspan&gt;&#123;<span class="keyword">this</span>.bond.map(<span class="function"><span class="params">t</span> =&gt;</span> t.toUpperCase())&#125;&lt;<span class="regexp">/Rspan&gt;</span></div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Tutorial Par1 of Dapp]]></title>
      <url>/2017/07/13/Tutorial-Par1-of-Dapp/</url>
      <content type="html"><![CDATA[<h1 id="Spawning-a-new-Dapp"><a href="#Spawning-a-new-Dapp" class="headerlink" title="Spawning a new Dapp"></a>Spawning a new Dapp</h1><p>The dapp will use modern JS technologies: NPM, Webpack2, React, Babel, ES6, JSX and oo7.</p>
<p>Clone a <code>skeleton</code> repo from parity:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/paritytech/skeleton mydapp</div></pre></td></tr></table></figure>
<p>This will make your a new repo with everything ready.</p>
<p><code>cd</code> in to it and remove the origin repository lest it confuse Git.</p>
<p>It’s liberally licensed (Apache 2.0) so you don’t have to worry about open sourcing your own code(though obviously you’ll be enlightened and want to do that anyway.)</p>
<p>The next stage is to get all dependencies installed, NPM makes this rather easy, but the bundled script makes it even easier</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./init.sh</div></pre></td></tr></table></figure>
<p>This should grab and install all that is required. The next thing to do is to build the final web-ready version of the fledling dapp. We use webpack for this.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack</div></pre></td></tr></table></figure>
<p>You now have a basic dapp built.</p>
<h1 id="Configuring-its-look"><a href="#Configuring-its-look" class="headerlink" title="Configuring its look"></a>Configuring its look</h1><p>While your dapp may well be built, it is not yet easily discoverable. You would have to host it somewhere. This can be done traditionally with a web server but for development, we will use Parity’s in-built hosting.</p>
<p>Parity uses a special ‘manifest’ file called to figure out how to display the entry for your dapp in Parity Wallet. This file is called <code>manifest.json</code> and must be placed in the root of your dapp’s directory, in our case, thi sis our ‘build’ directory, <code>dist</code>.</p>
<p>Open an editor to edit <code>dist/manifest.json</code> you’ll see something like:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"id"</span>: <span class="string">"skeleton"</span>,</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"Skeleton"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">"A skeleton dapp"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"0.1"</span>,</div><div class="line">  <span class="attr">"author"</span>: <span class="string">"parity Technologies Ltd"</span>,</div><div class="line">  <span class="attr">"iconUrl"</span>: <span class="string">"title.png"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>The <code>id</code> is the dapp’s unique identity: change that from <code>skeleton</code> to <code>mydapp</code></p>
</li>
<li><p>The <code>name</code> is the dapp’s user-visible name: change that to <code>My Dapp</code></p>
</li>
<li><p>The <code>description</code> is a user-visible by-line describing what the dapp is good for.</p>
</li>
<li><p><code>version</code> is the dapp’s version - you can leave that at <code>0.1</code> for now.</p>
</li>
<li><p>You can change the <code>author</code> to your name.</p>
</li>
<li><p>The <code>iconUrl</code> is the path(within <code>dist</code>) to a square(best to make it 128 x 128) icon for your dapp.</p>
</li>
</ul>
<h1 id="Getting-it-visible-in-Parity"><a href="#Getting-it-visible-in-Parity" class="headerlink" title="Getting it visible in Parity"></a>Getting it visible in Parity</h1><p>To get Parity to discover your dapp, it needs to be placed into a place that Parity will see it in its local ‘dapps’ directory. We will make a symbolic linke for our dapp’s <code>dist</code> directory(containing all of the ready-built dapp) in Parity’s dapp directory.</p>
<p>Parity’s directory structure is different depending on your system.</p>
<p>For Mac, Parity’s local dapp directory sits at <code>$HOME/Library/Application Support/io.parity.ethereum/dapps</code></p>
<p>Once you have it linked, you should start(or restart, if already running) Parity and head to the Application Page of Parity Wallet. There you will see your new dapp:</p>
<p>Note: If you are not running <code>npm start</code> in parity/src/js to have a development instance your URL is likely <code>localhost:8180</code> instead of port 3000.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[d3-scale]]></title>
      <url>/2017/07/13/d3-scale/</url>
      <content type="html"></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[d3-shape]]></title>
      <url>/2017/07/12/d3-shape/</url>
      <content type="html"><![CDATA[<h3 id="d3-shape"><a href="#d3-shape" class="headerlink" title="d3.shape"></a>d3.shape</h3><p>Visualization typically consist of discrete  graphical marks, such as <code>Symbols</code>, <code>arcs</code>, <code>lines</code> and <code>areas</code>. While the ractangles of a bar chart may be easy enough to generate directly using <code>SVG</code> or <code>Canvas</code>, other shapes are complex, such as roudned annular sectors and centripetal Catmull-Rom splines. This module provides a variety of shape generators for your convenience.</p>
<p>As with other aspects of D3, these shapes are driven by data: each shape generator exposes accessors that control how the input data are mapped to a visual representation.</p>
<p>You might define a line generator for a time series by <code>scaling</code> field of your data to fit the chart.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> lineGen = d3.line()</div><div class="line">    .x(<span class="function"><span class="params">d</span> =&gt;</span> (d.date))</div><div class="line">    .y(<span class="function"><span class="params">d</span> =&gt;</span> (d.value))</div></pre></td></tr></table></figure>
<p>This line generator can then be used to compute the <code>d</code> attribute of an SVG path element:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">path.datum(data).attr(<span class="string">'d'</span>, lineGen)</div></pre></td></tr></table></figure>
<p>Or you can use it to render to a Canvas 2D context:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lineGen.context(context)(data)</div></pre></td></tr></table></figure>
<h3 id="Installing"><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3-path.v1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3-shape.v1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add d3-shape</div></pre></td></tr></table></figure>
<h3 id="Arcs"><a href="#Arcs" class="headerlink" title="Arcs"></a>Arcs</h3><p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/pie.png" alt=""></p>
<p>The arc genrateor produces a circular or annular sector, as in a pie or donut chart. If the difference between the start and end angles(the regular span) is greater than 2 <em> Math.PI, the arc generator will produce a complete circle or annulus. If it is less than 2 </em> Math.PI, arcs may have rounded corners and angular padding.</p>
<p>Arcs are always centered at <0, 0="">, use a transform to move the arc to a different position.</0,></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> arc = d3.arc() <span class="comment">// construct a new arc genrator with default settings.</span></div><div class="line"></div><div class="line">arc(&#123;</div><div class="line">  <span class="attr">innerRadius</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">outerRadius</span>: <span class="number">100</span>,</div><div class="line">  <span class="attr">startAngle</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">endAngle</span>: <span class="built_in">Math</span>.PI / <span class="number">2</span>,</div><div class="line">&#125;)</div><div class="line"><span class="comment">// or</span></div><div class="line"><span class="keyword">const</span> arc = d3.arc()</div><div class="line">    .innerRadius(<span class="number">0</span>)</div><div class="line">    .outerRadius(<span class="number">100</span>)</div><div class="line">    .startAngle(<span class="number">0</span>)</div><div class="line">    .endAngle(<span class="built_in">Math</span>.PI/<span class="number">2</span>)</div><div class="line"></div><div class="line">arc()</div></pre></td></tr></table></figure>
<p><strong>arc.centroid(arguments)</strong> computes the midpoint <x, y=""> of the center line of the arc that would be generated by the given arguments. The arguments are arbitrary. They are simple propagated to the arc generator’s accessor functions along with the <code>this</code> object.</x,></p>
<p>To be consistent with the generated arc, the accessors must be deterministirc, i.e., return the same value given the same arguments. The midpoint is defined as (startAngle + endAngle) / 2 and (innerRadius + outerRadius) / 2</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/centroid-annular-sector.png" alt=""></p>
<p><strong>arc.cornerRadius([radius])</strong> sets the corner radius to the specified function or number and returns the arc generator.</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/rounded-annular-sector.png" alt=""></p>
<p><strong>arc.padAngle([angle])</strong> sets the pad angle to the specifid function or number and returns this arc generator. The pad angle is converted to a fixed linear distances seperateing adajacent arcs, defined as <strong>padRadius * padAngle</strong>.</p>
<p><strong>arc.context([context])</strong> sets the context and returns this arc generator. If <em>context</em> is not specified, returns the current context, which defaults to null. If the context is not null, then the generated arc is rendered to this context as a sequence of path method calls. Otherwise, a path data string representing the generated arc is returned.</p>
<h3 id="Pies"><a href="#Pies" class="headerlink" title="Pies"></a>Pies</h3><p>This pie generator does not produce a shape directly, but instead <strong>computes</strong> the necessary angles to represent a tabular dataset as a pie or donut chart. These angles can be passed to an arc generator.</p>
<p><strong>d3.pie()</strong> constructs a new pie generator with the default settings.</p>
<p><strong>pie(data[, arguments])</strong> generates a pie for the given array of data, <strong>returning an array of objects representing each datum’s arc angle</strong>. Any additional arguments are arbitrary. They are simply propagated to the pie generator’s accessor functions along with the <code>this</code> object.</p>
<p>The length of the returned array is the same as data and each element <em>i</em> in the returned array corresponds to the element <em>i</em> in the input data. Each object in the returned array has the following properties:</p>
<ul>
<li><p>data: the input datum; the corresponding element in the input data array.</p>
</li>
<li><p>value: the numeric value of the arc</p>
</li>
<li><p>index: the zero-based sorted index of arc</p>
</li>
<li><p>startAgnle: the start angle of the arc</p>
</li>
<li><p>endAngle: the end angle of the arc</p>
</li>
<li><p>padAngle: the pad angle of the arc</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">21</span>];</div><div class="line"><span class="keyword">var</span> arcs = d3.pie()(data);</div><div class="line"><span class="comment">// to</span></div><div class="line">[</div><div class="line">  &#123;<span class="string">"data"</span>:  <span class="number">1</span>, <span class="string">"value"</span>:  <span class="number">1</span>, <span class="string">"index"</span>: <span class="number">6</span>, <span class="string">"startAngle"</span>: <span class="number">6.050474740247008</span>, <span class="string">"endAngle"</span>: <span class="number">6.166830023713296</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>:  <span class="number">1</span>, <span class="string">"value"</span>:  <span class="number">1</span>, <span class="string">"index"</span>: <span class="number">7</span>, <span class="string">"startAngle"</span>: <span class="number">6.166830023713296</span>, <span class="string">"endAngle"</span>: <span class="number">6.283185307179584</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>:  <span class="number">2</span>, <span class="string">"value"</span>:  <span class="number">2</span>, <span class="string">"index"</span>: <span class="number">5</span>, <span class="string">"startAngle"</span>: <span class="number">5.817764173314431</span>, <span class="string">"endAngle"</span>: <span class="number">6.050474740247008</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>:  <span class="number">3</span>, <span class="string">"value"</span>:  <span class="number">3</span>, <span class="string">"index"</span>: <span class="number">4</span>, <span class="string">"startAngle"</span>: <span class="number">5.468698322915565</span>, <span class="string">"endAngle"</span>: <span class="number">5.817764173314431</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>:  <span class="number">5</span>, <span class="string">"value"</span>:  <span class="number">5</span>, <span class="string">"index"</span>: <span class="number">3</span>, <span class="string">"startAngle"</span>: <span class="number">4.886921905584122</span>, <span class="string">"endAngle"</span>: <span class="number">5.468698322915565</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>:  <span class="number">8</span>, <span class="string">"value"</span>:  <span class="number">8</span>, <span class="string">"index"</span>: <span class="number">2</span>, <span class="string">"startAngle"</span>: <span class="number">3.956079637853813</span>, <span class="string">"endAngle"</span>: <span class="number">4.886921905584122</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>: <span class="number">13</span>, <span class="string">"value"</span>: <span class="number">13</span>, <span class="string">"index"</span>: <span class="number">1</span>, <span class="string">"startAngle"</span>: <span class="number">2.443460952792061</span>, <span class="string">"endAngle"</span>: <span class="number">3.956079637853813</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;,</div><div class="line">  &#123;<span class="string">"data"</span>: <span class="number">21</span>, <span class="string">"value"</span>: <span class="number">21</span>, <span class="string">"index"</span>: <span class="number">0</span>, <span class="string">"startAngle"</span>: <span class="number">0.000000000000000</span>, <span class="string">"endAngle"</span>: <span class="number">2.443460952792061</span>, <span class="string">"padAngle"</span>: <span class="number">0</span>&#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>The first pair of parens, <code>pie()</code> constructs a default pie generator, the second <code>pie()(data)</code> invokes this generator on the dataset, returning an array of objects.</p>
<p>Note that the returned array is in the same order as the data.</p>
<h3 id="Lines"><a href="#Lines" class="headerlink" title="Lines"></a>Lines</h3><p>The line generator produces a spline or polyline, as in a line chart. Lines also appear in many other visualization types, such as the links in hierarchical edge bundling.</p>
<p><strong>d3.line()</strong> constructs a new line generator with default settings.</p>
<p><strong>line(data)</strong> generates a line for the given array of data. Depending on this line generator’s assciated curve, the given input data may need to be sorted by x-value before being passed to the line generator. If the line generator has a context, then the line is rendered to this context as a sequence of path method calls and this function returns void.</p>
<p><strong>line.x(fn)</strong> specifies the x accessor.</p>
<p><strong>line.y(fn)</strong> specifies the y accessor.</p>
<p><strong>line.defined([defined])</strong> sets the defined accessor.</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/line-defined.png" alt=""></p>
<p><strong>line.curve([curve])</strong> sets the curve factory and returns this line genrator. If curve is not specified, returns the current curve factory, which defaults to <strong>curveLinear</strong>.</p>
<p><strong>d3.lineRadial()</strong> constructs a new radial line generator with the default settings.</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/line-radial.png" alt=""></p>
<p>A radial line generator is equivalent to the standard cartesian line generator, except the x and y accessor are replaced with angle and readius accessors.</p>
<p>Radial lines are always positioned relative to <0, 0="">, use a transform to change the origin.</0,></p>
<h3 id="Areas"><a href="#Areas" class="headerlink" title="Areas"></a>Areas</h3><p>The area generator produces an area, as in an area chart. An area is defined by two bounding lines, either splines or polilines. Typically two lines share the same x-value, differing only in y-value; most commonly, y0 is defined as a constant representing zero.  The first line (the top line) is defined by x1 and y1 and is rendered first; the second line (the base line) is defined by x0 and y0 and is rendered second, with the points in reverse order.</p>
<p><strong>d3.area()</strong> constructs a new area generator with the default settings.</p>
<p><strong>area.data()</strong> generats area for the given array of data. Depending on this area generator’s associated curve.</p>
<p><strong>area.x([x])</strong> sets x0 to x and x1 to null.</p>
<p><strong>area.x0()</strong> sets the x0 accessor.</p>
<p><strong>area.defined()</strong></p>
<p><strong>d3.areaRadial()</strong></p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/area-radial.png" alt=""></p>
<h3 id="Curves"><a href="#Curves" class="headerlink" title="Curves"></a>Curves</h3><p>Curves are typically not constructed or used directly, insread being passed to <code>line.curve</code> and <code>arec.curve</code>. For example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> line = d3.line()</div><div class="line">  .x(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> x(d.date) &#125;)</div><div class="line">  .y(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> y(d.value) &#125;)</div><div class="line">  .curve(d3.curveCatmullRom.alpha(<span class="number">0.5</span>))</div></pre></td></tr></table></figure>
<ul>
<li><p>d3.curveBasis(context)</p>
</li>
<li><p>d3.curveBasisClosed(context)</p>
</li>
<li><p>d3.curveBasisOpen(context)</p>
</li>
<li><p>d3.curveBundle(context)</p>
</li>
<li><p>d3.curveCardinal(context)</p>
</li>
<li><p>d3.curveCardinalClosed(context)</p>
</li>
<li><p>d3.curveLinear(context)</p>
</li>
<li><p>d3.curveStep(context)</p>
</li>
<li><p>d3.curveStepAfter(context)</p>
</li>
<li><p>d3.curveStepBefore(context)</p>
</li>
</ul>
<h3 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h3><p>The link shape generates a smooth cubic Bezier curve from a source point to a target point. The tangents of the curve at the start and end are either <code>vertical</code>, <code>horizontal</code>, or <code>radial</code>.</p>
<p><strong>d3.linkVertical()</strong>, returns a new link generator with vertical tangents.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> link = d3.linkVertical()</div><div class="line">    .x(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123; <span class="keyword">return</span> d.x &#125;)</div><div class="line">    .y(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123; <span class="keyword">return</span> d.y &#125;)</div></pre></td></tr></table></figure>
<p><strong>d3.linkHorizontal()</strong>, returns a new link generator with horizontal tangents.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> link = d3.linkHorizontal()</div><div class="line">    .x(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> d.y &#125;)</div><div class="line">    .y(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> d.x &#125;)</div></pre></td></tr></table></figure>
<h3 id="Stacks"><a href="#Stacks" class="headerlink" title="Stacks"></a>Stacks</h3><p>Some shape types can be stakced, placing one shape adjacent to another.</p>
<p>Stacked charts can show overall value and per-category value simultaneously.</p>
<p><strong>d3.stack()</strong>, constructs a new stack generator with the default settings.</p>
<p><strong>stack(data[, arguments])</strong>, generates a stack for the given array of data, returning an array of representing each series. Any additional arguments are arbitrary, they are simply propagated to accessors along with <code>this</code> object.</p>
<p>The series are determined by the keys accessor; each series <em>i</em> in the returned array corresponds to the <em>i</em> th key. Each series is an array o points, where each point <em>j</em> corresponds to the <em>j</em> th element in the input <em>data</em>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = [</div><div class="line">  &#123;<span class="attr">month</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2015</span>, <span class="number">0</span>, <span class="number">1</span>), <span class="attr">apples</span>: <span class="number">3840</span>, <span class="attr">bananas</span>: <span class="number">1920</span>, <span class="attr">cherries</span>: <span class="number">960</span>, <span class="attr">dates</span>: <span class="number">400</span>&#125;,</div><div class="line">  &#123;<span class="attr">month</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>), <span class="attr">apples</span>: <span class="number">1600</span>, <span class="attr">bananas</span>: <span class="number">1440</span>, <span class="attr">cherries</span>: <span class="number">960</span>, <span class="attr">dates</span>: <span class="number">400</span>&#125;,</div><div class="line">  &#123;<span class="attr">month</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2015</span>, <span class="number">2</span>, <span class="number">1</span>), <span class="attr">apples</span>:  <span class="number">640</span>, <span class="attr">bananas</span>:  <span class="number">960</span>, <span class="attr">cherries</span>: <span class="number">640</span>, <span class="attr">dates</span>: <span class="number">400</span>&#125;,</div><div class="line">  &#123;<span class="attr">month</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2015</span>, <span class="number">3</span>, <span class="number">1</span>), <span class="attr">apples</span>:  <span class="number">320</span>, <span class="attr">bananas</span>:  <span class="number">480</span>, <span class="attr">cherries</span>: <span class="number">640</span>, <span class="attr">dates</span>: <span class="number">400</span>&#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">// To produce a stack of this data</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> stack = d3.stack()</div><div class="line">    .keys([ <span class="string">'apples'</span>, <span class="string">'bananas'</span>, <span class="string">'cherries'</span>, <span class="string">'dates'</span> ])</div><div class="line">    .order(d3.stackOrderNone)</div><div class="line">    .offset(d3.stackOffsetNone)</div><div class="line"></div><div class="line"><span class="comment">// returned</span></div><div class="line"></div><div class="line">[</div><div class="line">  [[   <span class="number">0</span>, <span class="number">3840</span>], [   <span class="number">0</span>, <span class="number">1600</span>], [   <span class="number">0</span>,  <span class="number">640</span>], [   <span class="number">0</span>,  <span class="number">320</span>]], <span class="comment">// apples</span></div><div class="line">  [[<span class="number">3840</span>, <span class="number">5760</span>], [<span class="number">1600</span>, <span class="number">3040</span>], [ <span class="number">640</span>, <span class="number">1600</span>], [ <span class="number">320</span>,  <span class="number">800</span>]], <span class="comment">// bananas</span></div><div class="line">  [[<span class="number">5760</span>, <span class="number">6720</span>], [<span class="number">3040</span>, <span class="number">4000</span>], [<span class="number">1600</span>, <span class="number">2240</span>], [ <span class="number">800</span>, <span class="number">1440</span>]], <span class="comment">// cherries</span></div><div class="line">  [[<span class="number">6720</span>, <span class="number">7120</span>], [<span class="number">4000</span>, <span class="number">4400</span>], [<span class="number">2240</span>, <span class="number">2640</span>], [<span class="number">1440</span>, <span class="number">1840</span>]], <span class="comment">// dates</span></div><div class="line">]</div></pre></td></tr></table></figure>
<p><strong>stack.keys([keys])</strong>, sets the keys accessor to the specified function or array and returns this stack generator.</p>
<p><strong>stack.order([order])</strong>, sets the order accessor to the specified functino or array and returns this stack generator. If order is not specified, returns the current order accessor, which default to <code>stackOrderNone</code>, this uses the order given by the key accessor.</p>
<ul>
<li><p>d3.stackOrderAscending(series)</p>
</li>
<li><p>d3.stackOrderDescending(series)</p>
</li>
<li><p>d3.stackOrderInsideOut(series)</p>
</li>
<li><p>d3.stackOrderNone(series)</p>
</li>
<li><p>d3.stackOrderReverse(series)</p>
</li>
</ul>
<p><strong>stack.offset([offest])</strong>, sets the offset accessor to the specified function or array, and returns this stack generator. If no offset is specified, returns the current offset accessor, which default to <code>stackOffsetNone</code>, this uses a zero baseline.</p>
<ul>
<li><p>d3.stackOffsetDiverging(series, order)</p>
</li>
<li><p>d3.stackOffsetExpand(series, order)</p>
</li>
<li><p>d3.stackOffsetNone(series, order)</p>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[d3.range]]></title>
      <url>/2017/07/12/d3-range/</url>
      <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d3.range([start, ]stop[, step])</div></pre></td></tr></table></figure>
<p>Returns an array containing an arithmetic progression, similar to the Python built-in range. This method is often used to iterate over a sequence of uniformly-spaced numeric values, such as the indexes of an array or the ticks of a linear scale.</p>
<p>If <em>step</em> is ommitted, it defaults to 1. If <em>start</em> ommitted, it defaults to 0. The <em>stop</em> value is exclusive; it is not included in the result.</p>
<p>The arguments are not required to be integers; however, the results are more predicable if they are.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">d3.range(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>/<span class="number">49</span>) <span class="comment">// BAD, and returns 50 elements</span></div><div class="line">d3.range(<span class="number">49</span>).map(<span class="function"><span class="params">d</span> =&gt;</span> (d/<span class="number">49</span>)) <span class="comment">// GOOD, and returns 49 elements</span></div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Quick Reference of D3]]></title>
      <url>/2017/07/11/Quick-Reference-of-D3/</url>
      <content type="html"><![CDATA[<h1 id="Selections"><a href="#Selections" class="headerlink" title="Selections"></a>Selections</h1><h3 id="d3-select"><a href="#d3-select" class="headerlink" title="d3.select()"></a>d3.select()</h3><p>Returns a reference to the first element found.</p>
<h3 id="d3-selectAll"><a href="#d3-selectAll" class="headerlink" title="d3.selectAll()"></a>d3.selectAll()</h3><p>Returns references to all found elements</p>
<h3 id="selection-append"><a href="#selection-append" class="headerlink" title="selection.append()"></a>selection.append()</h3><p>Takes a selection, creates a new element inside of it, then returns a reference to the newly created element.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> newCirlce = svg.append(<span class="string">'circle'</span>)</div></pre></td></tr></table></figure>
<h3 id="selection-remove"><a href="#selection-remove" class="headerlink" title="selection.remove()"></a>selection.remove()</h3><p>Takes a selection, removes it from the DOM, and returns a reference to the deleted selection.</p>
<h3 id="selection-text"><a href="#selection-text" class="headerlink" title="selection.text()"></a>selection.text()</h3><p>Takes a selection, sets its text content, and returns a reference to the acted-upon selection.</p>
<h3 id="selection-attr"><a href="#selection-attr" class="headerlink" title="selection.attr()"></a>selection.attr()</h3><p>Takes a selection, sets an attribute value, and returns a reference to the acted-upon selection.</p>
<h3 id="selection-style"><a href="#selection-style" class="headerlink" title="selection.style()"></a>selection.style()</h3><p>Takes a selection, sets an inline CSS style, and returns a reference to the acted-upon selection.</p>
<h3 id="selection-classed"><a href="#selection-classed" class="headerlink" title="selection.classed()"></a>selection.classed()</h3><p>Takes a selection, adds or remove a class, and returns a reference to the acted-upon selection; <code>true</code> adds the specified class, <code>false</code> removes it.</p>
<h3 id="selection-each"><a href="#selection-each" class="headerlink" title="selection.each()"></a>selection.each()</h3><p>Takes a selection, and runs an arbitrary function for each element in the selection, with the <code>this</code> context set to the element being acted upon.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d3.selectAll(<span class="string">'circle'</span>).each(zoomAndEnhance)</div></pre></td></tr></table></figure>
<h1 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h1><h3 id="selection-data"><a href="#selection-data" class="headerlink" title="selection.data()"></a>selection.data()</h3><p>Takes a selection, calculates the difference between the number of elements and number of data value, and binds the array of data value to any existing elements(or not existing placeholder elements).</p>
<h3 id="selection-datum"><a href="#selection-datum" class="headerlink" title="selection.datum()"></a>selection.datum()</h3><p>Takes a selection, and binds a single data value to a single element.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svg.append(<span class="string">'path'</span>).datum(dataset).attr(<span class="string">'d'</span>, line)</div></pre></td></tr></table></figure>
<h3 id="selection-enter"><a href="#selection-enter" class="headerlink" title="selection.enter()"></a>selection.enter()</h3><p>Takes a selection and returns a subselection of ‘new’ placeholder elements.</p>
<h3 id="selection-merge"><a href="#selection-merge" class="headerlink" title="selection.merge()"></a>selection.merge()</h3><p>Takes a selection and merges it with another specified selection, returning a newly merged selection.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bars.enter().append(<span class="string">'rect'</span>).merge(bars) <span class="comment">// merge enter subselection with existing selection.</span></div></pre></td></tr></table></figure>
<h3 id="selection-exit"><a href="#selection-exit" class="headerlink" title="selection.exit()"></a>selection.exit()</h3><p>Takes a selection and returns a subselection of ‘exiting’ elements.</p>
<h3 id="selection-remove-1"><a href="#selection-remove-1" class="headerlink" title="selection.remove()"></a>selection.remove()</h3><p>Takes a selection and removes associated elements from the DOM.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bars.exit().remove()</div></pre></td></tr></table></figure>
<h3 id="function-d-…"><a href="#function-d-…" class="headerlink" title="function (d) { … }"></a>function (d) { … }</h3><p>Use anonymouse functions to access data values bound to element via <code>d</code>.</p>
<h3 id="function-d-i-…"><a href="#function-d-i-…" class="headerlink" title="function (d, i) { … }"></a>function (d, i) { … }</h3><p>Including <code>i</code> to get the index value of each element in the selection.</p>
<h3 id="selection-fitler"><a href="#selection-fitler" class="headerlink" title="selection.fitler()"></a>selection.fitler()</h3><p>Takes a selection and returns a new (sub)selection</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">d3.selectAll(<span class="string">'circle'</span>)</div><div class="line">  .filter(<span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> d &gt; <span class="number">15</span></div><div class="line">  &#125;)</div><div class="line">  .style(<span class="string">'color'</span>, <span class="string">'red'</span>)</div></pre></td></tr></table></figure>
<h3 id="d3-csv"><a href="#d3-csv" class="headerlink" title="d3.csv()"></a>d3.csv()</h3><p>Loads an external CSV file, parses the contents into JSON, then hands off the results to a callback function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">d3.csv(<span class="string">'food.csv'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(data)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="d3-json"><a href="#d3-json" class="headerlink" title="d3.json()"></a>d3.json()</h3><p>Loads an external JSON file, parse the content into JSON, then hands off the results to a callback function.</p>
<h3 id="d3-request"><a href="#d3-request" class="headerlink" title="d3.request()"></a>d3.request()</h3><p>Loads an arbitrary external file, then hands off the result to a callback function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">d3.request(<span class="string">'interesting_data.txt'</span>)</div><div class="line">  .get(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</div><div class="line">    <span class="comment">// Do something</span></div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
<h1 id="Transitions"><a href="#Transitions" class="headerlink" title="Transitions"></a>Transitions</h1><h3 id="selection-transition"><a href="#selection-transition" class="headerlink" title="selection.transition()"></a>selection.transition()</h3><p>Takes a selection, and initiates a new transition, so values specified after this point will be interpolated over time(rather than set immediately).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">d3.selectAll(<span class="string">'circle'</span>)</div><div class="line">  .attr(<span class="string">'cx'</span>, <span class="number">0</span>)</div><div class="line">  .transition()</div><div class="line">  .attr(<span class="string">'cx'</span>, <span class="number">100</span>)</div></pre></td></tr></table></figure>
<h3 id="selection-delay"><a href="#selection-delay" class="headerlink" title="selection.delay()"></a>selection.delay()</h3><p>Takes a transition, and sets the delay, in milliseconds.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">d3.selectAll(<span class="string">'circle'</span>)</div><div class="line">  .attr(<span class="string">'cx'</span>, <span class="number">0</span>)</div><div class="line">  .transition()</div><div class="line">  .delay(<span class="number">1000</span>)</div><div class="line">  .attr(<span class="string">'cx'</span>, <span class="number">100</span>)</div></pre></td></tr></table></figure>
<h3 id="transition-duration"><a href="#transition-duration" class="headerlink" title="transition.duration()"></a>transition.duration()</h3><p>Takes a transition and sets the duration in milliseconds.</p>
<h3 id="transition-ease"><a href="#transition-ease" class="headerlink" title="transition.ease()"></a>transition.ease()</h3><p>Takes a transition and sets the easing to be used.</p>
<h3 id="transition-on"><a href="#transition-on" class="headerlink" title="transition.on()"></a>transition.on()</h3><p>Takes a transition, and binds a function to be executed at either the <code>start</code> or <code>end</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">d3.selectAll(<span class="string">'circle'</span>)</div><div class="line">  .attr(<span class="string">'cx'</span>, <span class="number">0</span>)</div><div class="line">  .transition()</div><div class="line">  .attr(<span class="string">'cx'</span>, <span class="number">100</span>)</div><div class="line">  .on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'All done'</span>)</div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
<h1 id="Scale"><a href="#Scale" class="headerlink" title="Scale"></a>Scale</h1><h3 id="d3-scaleLinear"><a href="#d3-scaleLinear" class="headerlink" title="d3.scaleLinear()"></a>d3.scaleLinear()</h3><p>Creates a new linear scale function.</p>
<h3 id="scaleLinear-domain"><a href="#scaleLinear-domain" class="headerlink" title="scaleLinear.domain()"></a>scaleLinear.domain()</h3><p>Sets a linear scale’s input domain.</p>
<h3 id="scaleLinear-range"><a href="#scaleLinear-range" class="headerlink" title="scaleLinear.range()"></a>scaleLinear.range()</h3><p>Sets a linear scale’s output range.</p>
<h3 id="scaleLinear-rangeRound"><a href="#scaleLinear-rangeRound" class="headerlink" title="scaleLinear.rangeRound()"></a>scaleLinear.rangeRound()</h3><p>Sets a linear scale’s output range, and have all values output by the scale rounded to the nearest whole number.</p>
<h3 id="scaleLinear-nice"><a href="#scaleLinear-nice" class="headerlink" title="scaleLinear.nice()"></a>scaleLinear.nice()</h3><p>Expands a linear sclae’s domain to the nearest round values.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xScale.nice()</div></pre></td></tr></table></figure>
<h3 id="scaleLinear-clamp"><a href="#scaleLinear-clamp" class="headerlink" title="scaleLinear.clamp()"></a>scaleLinear.clamp()</h3><p>Forces any values output by this scale to be constrainted (rounded to be) within the specified range.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xScale.clamp(<span class="literal">true</span>)</div></pre></td></tr></table></figure>
<h3 id="d3-min"><a href="#d3-min" class="headerlink" title="d3.min()"></a>d3.min()</h3><p>Returns the smallest value in an array.</p>
<h3 id="d3-max"><a href="#d3-max" class="headerlink" title="d3.max()"></a>d3.max()</h3><p>Returns the largest value in an array.</p>
<h1 id="Axes"><a href="#Axes" class="headerlink" title="Axes"></a>Axes</h1><h3 id="d3-axisTop-d3-axisRight-d3-axisBottom-d3-axisLeft"><a href="#d3-axisTop-d3-axisRight-d3-axisBottom-d3-axisLeft" class="headerlink" title="d3.axisTop, d3.axisRight, d3.axisBottom, d3.axisLeft"></a>d3.axisTop, d3.axisRight, d3.axisBottom, d3.axisLeft</h3><p>Create a new axis generator function, with specified orientation.</p>
<h3 id="axis-scale"><a href="#axis-scale" class="headerlink" title="axis.scale()"></a>axis.scale()</h3><p>Takes an axis, and specifies the scale to be used.</p>
<h3 id="axis-ticks"><a href="#axis-ticks" class="headerlink" title="axis.ticks()"></a>axis.ticks()</h3><p>Takes an axis, and specifies a target number of ticks to be used.</p>
<h3 id="axis-tickValues"><a href="#axis-tickValues" class="headerlink" title="axis.tickValues()"></a>axis.tickValues()</h3><p>Takes an axis, and specifies the values to be labeled with ticks.</p>
<h3 id="selection-call"><a href="#selection-call" class="headerlink" title="selection.call()"></a>selection.call()</h3><p>Takes a selection, and calls an arbitrary method to act upon the selection; commonly used to generate an axis.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svg.append(<span class="string">'g'</span>).call(xAxis)</div></pre></td></tr></table></figure>
<h1 id="Interactivity"><a href="#Interactivity" class="headerlink" title="Interactivity"></a>Interactivity</h1><h3 id="selection-on"><a href="#selection-on" class="headerlink" title="selection.on()"></a>selection.on()</h3><p>Takes a selection, and binds an event listener</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">d3.select(<span class="string">'#button'</span>)</div><div class="line">  .on(<span class="string">'click'</span>, () =&gt; &#123; ... &#125;)</div></pre></td></tr></table></figure>
<h3 id="d3-select-this"><a href="#d3-select-this" class="headerlink" title="d3.select(this)"></a>d3.select(this)</h3><p>Within an anonymous function, <code>this</code> refers to <code>the element current being acted upon</code></p>
<h1 id="Numebrs-Dates-and-Times"><a href="#Numebrs-Dates-and-Times" class="headerlink" title="Numebrs, Dates, and Times"></a>Numebrs, Dates, and Times</h1><h3 id="d3-range"><a href="#d3-range" class="headerlink" title="d3.range()"></a>d3.range()</h3><p>Generates an array of sequential numbers.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d3.range(<span class="number">5</span>); <span class="comment">// Returns [0, 1, 2, 3, 4]</span></div></pre></td></tr></table></figure>
<h3 id="d3-format"><a href="#d3-format" class="headerlink" title="d3.format()"></a>d3.format()</h3><p>Creates a new number formatter, for convertiing numbers to strings.</p>
<h3 id="d3-timeParse"><a href="#d3-timeParse" class="headerlink" title="d3.timeParse()"></a>d3.timeParse()</h3><p>Creates a new time parser, for converting strings to Date Object.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> parseTime = d3.timeParse(<span class="string">"%m/%d/%y"</span>)</div><div class="line">parseTime(<span class="string">'02/20/17'</span>)</div></pre></td></tr></table></figure>
<h3 id="d3-timeFormat"><a href="#d3-timeFormat" class="headerlink" title="d3.timeFormat()"></a>d3.timeFormat()</h3><p>Creates a new time formatter, for converting Data Object to strings.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> formatTime = d3.timeFormat(<span class="string">"%b %e"</span>)</div><div class="line">formatTime(<span class="keyword">new</span> <span class="built_in">Date</span>)</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Simple Api of Mongoose]]></title>
      <url>/2017/07/10/Simple-Api-of-Mongoose/</url>
      <content type="html"><![CDATA[<h3 id="Two-methods-to-connect-to-Mongo-DB"><a href="#Two-methods-to-connect-to-Mongo-DB" class="headerlink" title="Two methods to connect to Mongo DB"></a>Two methods to connect to Mongo DB</h3><ul>
<li><p><code>mongoose.connect</code></p>
</li>
<li><p><code>mongoose.createConnection</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> dbURL = <span class="string">'mongodb://...'</span></div><div class="line"><span class="keyword">const</span> dbOptions = &#123;</div><div class="line">  <span class="attr">user</span>: <span class="string">'db_user'</span>,</div><div class="line">  <span class="attr">pass</span>: <span class="string">'db_pass'</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> adminConnection = mongoose.createConnection(dbURL, dbOptions)</div></pre></td></tr></table></figure>
<h3 id="Close-Connection"><a href="#Close-Connection" class="headerlink" title="Close Connection"></a>Close Connection</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mongoose.connection.close(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Connection cvlosed'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">adminConnection.close(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'adminConnection closed'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// auto close when process exit</span></div><div class="line">process..on(<span class="string">'SIGINT'</span> () =&gt; &#123;</div><div class="line">  mongoose.connection.close(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Mongoose disconnected through app termination'</span>)</div><div class="line">    process.exit(<span class="number">0</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Cache-Error"><a href="#Cache-Error" class="headerlink" title="Cache Error"></a>Cache Error</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mongoose.connection.on(<span class="string">'error'</span>, (err) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Mongoose connection error: '</span> + err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="db-js"><a href="#db-js" class="headerlink" title="db.js"></a>db.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// /model/db.js</span></div><div class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> dbURL = <span class="string">'mongodb://...'</span></div><div class="line"></div><div class="line">mongoose.connect(dbURL)</div><div class="line"></div><div class="line">mongoose.connection.on(<span class="string">'connected'</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Mongoose connected to '</span> + dbURL)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">mongoose.connection.on(<span class="string">'error'</span>, (err) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Mongoose connection error: '</span> + err)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">mongoose.connection.on(<span class="string">'disconnected'</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Mongoose disconnected'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">process.on(<span class="string">'SIGINT'</span>, () =&gt; &#123;</div><div class="line">  mongoose.connection.close(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Mongoose disconnected through app termination'</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// app.js</span></div><div class="line">db = <span class="built_in">require</span>(<span class="string">'./model/db'</span>)</div></pre></td></tr></table></figure>
<h2 id="Schema-and-Model-in-Mongoose"><a href="#Schema-and-Model-in-Mongoose" class="headerlink" title="Schema and Model in Mongoose"></a>Schema and Model in Mongoose</h2><blockquote>
<p>Everything in Mongoose starts with a Schema. Each schema maps to a MongoDB collection and defines the shape of the documents within that collection.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Schema = mongoose.Schema</div><div class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> Schema(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="built_in">String</span>,</div><div class="line">  <span class="attr">pass</span>: <span class="built_in">String</span>,</div><div class="line">  <span class="attr">email</span>: <span class="built_in">String</span>,</div><div class="line">  <span class="attr">createTime</span>: <span class="built_in">String</span>,</div><div class="line">  <span class="attr">lastLogin</span>: <span class="built_in">String</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Schema to define table structure.</p>
<p>Model to manipulate collection.</p>
<p>Use model to create documents in Mongodb.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create model</span></div><div class="line"><span class="keyword">const</span> User = mongoose.model(<span class="string">'User'</span>, userSchema)</div><div class="line"></div><div class="line"><span class="comment">// create instance, namely document</span></div><div class="line"><span class="keyword">const</span> newUser = <span class="keyword">new</span> User(&#123;</div><div class="line">  ...</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// insert document to db</span></div><div class="line">newUser.save(<span class="function">(<span class="params">err, doc</span>) =&gt;</span> &#123;</div><div class="line">  err &amp;&amp; <span class="built_in">console</span>.error(err)</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'doc is saved'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// create and insert</span></div><div class="line">User.create(&#123;...&#125;, (err, doc) =&gt; &#123;</div><div class="line">  err &amp;&amp; <span class="built_in">console</span>.error(err)</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'doc saved'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// add staitc methods</span></div><div class="line">userSchema.statics.findUsersByType = <span class="function"><span class="keyword">function</span> (<span class="params">type, cb</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.find(&#123; <span class="attr">type</span>: <span class="keyword">this</span>.type &#125;, cb)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Model.$where(argument: string | Function): <query>, creates a Query and specifies a <em>$where</em> condition</query></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Blog.$where(<span class="string">'this.username.indexOf("val") !== -1'</span>).exec(<span class="function"><span class="keyword">function</span> (<span class="params">err, docs</span>) </span>&#123;&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>Model#increment()</li>
</ul>
<h3 id="search"><a href="#search" class="headerlink" title="search"></a>search</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">User.find(&#123; <span class="attr">type</span>: <span class="string">'type'</span> &#125;).where(<span class="string">'age'</span>).gt(<span class="number">2</span>).limit(<span class="number">10</span>).exec()</div></pre></td></tr></table></figure>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">User.remove(&#123; <span class="attr">type</span>: <span class="string">'type'</span> &#125;, (err, res) =&gt; &#123;</div><div class="line">  err &amp;&amp; <span class="built_in">console</span>.error(err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">User.find(&#123; <span class="attr">type</span>: <span class="string">'type'</span> &#125;).update(&#123;</div><div class="line">  <span class="attr">$set</span>: &#123;</div><div class="line">    <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()</div><div class="line">  &#125;</div><div class="line">&#125;, (err) =&gt; &#123;</div><div class="line">  err &amp;&amp; <span class="built_in">console</span>.error(err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>More…</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Notes on Interactive Data Visualization for the Web]]></title>
      <url>/2017/07/07/Notes-on-Interactive-Data-Visualization-for-the-Web/</url>
      <content type="html"><![CDATA[<h1 id="Introducing-D3"><a href="#Introducing-D3" class="headerlink" title="Introducing D3"></a>Introducing D3</h1><p>D3 – also referred to as d3.js – is a JavaScript library for creating data visualization. But that kind of undersell it.</p>
<p>The abbreviation D3 reference the tool’s full name, <em>Data-Driven Documents</em>. The <em>data</em> is provided by you, and the <em>documents</em> are web-based documents, meaning anything that can be rendered by a web browser, such as HTML and SVG. D3 does the <em>driviing</em>, in the sense that it connects the data to the documents.</p>
<h1 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h1><p><em>Data</em> is an extemely broad term, only slightly less vague than the nearly all-encompassing <em>information</em>.</p>
<p>Boradly speaking, data is a structured information with potential for meaning.</p>
<p>In the context of programming for visualization, data is stored in a digital file, typically in either text or binary form. Of course, potentially every piece of digital ephemera may be considered <code>data</code> – not just text, but bits and bytes representing images, audio, video, database, streams, models, archives, and anything else.</p>
<p>Within the scope of D3 and browser-based visualization, however, we will limit ourselves to <em>text-based</em>. That is, anything that can be presented as numbers and strings of alpha charaters.</p>
<h2 id="Binding-Data"><a href="#Binding-Data" class="headerlink" title="Binding Data"></a>Binding Data</h2><p>We use D3’s <code>data()</code> method to bind data to DOM elements. But there are two things we need in place first, before we can bind data:</p>
<ul>
<li><p>The data</p>
</li>
<li><p>A selection of DOM elements</p>
</li>
</ul>
<p>Anytime after you call <code>data()</code>, you can craete an anonymous function accepts <code>d</code> as input.</p>
<p>The magical <code>data()</code> method ensures that <code>d</code> is set to the corresponding value in your original dataset, given the current element at hand.</p>
<h2 id="Drawing-with-Data"><a href="#Drawing-with-Data" class="headerlink" title="Drawing with Data"></a>Drawing with Data</h2><p><code>.attr</code>, <code>.classed</code>, <code>.style</code></p>
<h1 id="Scales"><a href="#Scales" class="headerlink" title="Scales"></a>Scales</h1><blockquote>
<p>Scales are functions that map from an input domain to an output domain.</p>
</blockquote>
<p>The values in any dataset are unlikely to correspond exactly to pixel measurement for use in your visuallization.  Scales provide a convenient way to map those data values to new values useful for visuallization purposes.</p>
<p>D3 scales are <em>functions</em> with parameters that you define. Once they are created, you call the <code>scale</code> function , pass it a data value and it nicely returns a scaled output value.</p>
<p>A scale is a mathematical relationship, with no direct visual output.</p>
<h2 id="Domains-and-Ranges"><a href="#Domains-and-Ranges" class="headerlink" title="Domains and Ranges"></a>Domains and Ranges</h2><p>A scale’s <em>input domain</em> is the range of possible input data values.</p>
<p>A scale’s <em>output range</em> is the range of possible output values, commonly used as display values in pixel units.</p>
<h2 id="Normalization"><a href="#Normalization" class="headerlink" title="Normalization"></a>Normalization</h2><p>Normalization is the process of mapping a numeric value to a new value between 0 and 1, based on the possible minumum and maximum values.</p>
<h2 id="Creating-a-Scale"><a href="#Creating-a-Scale" class="headerlink" title="Creating a Scale"></a>Creating a Scale</h2><p>D3’s linear scale function generator is accessed with <code>d3.scaleLiner()</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> scale = d3.scaleLinear()</div></pre></td></tr></table></figure>
<p>Now <code>scale</code> is a function to which you can pass input values.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scale(<span class="number">2.5</span>) <span class="comment">// return 2.5</span></div></pre></td></tr></table></figure>
<p>Because we haven’t set a domain and a range yet, this function will map input to output on a <code>1:1</code> scale.</p>
<p>We set the scale’s input domain to 100, 500 by passing those values to the <code>domain()</code> method as an array.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scale.domain([<span class="number">100</span>, <span class="number">500</span>])</div></pre></td></tr></table></figure>
<p>Set the output range in similar fashion, with <code>range()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scale.range([<span class="number">10</span>, <span class="number">350</span>])</div></pre></td></tr></table></figure>
<p>These steps can be chained:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> scale = d3.scaleLinear()</div><div class="line">  .domain([<span class="number">100</span>, <span class="number">500</span>])</div><div class="line">  .range([<span class="number">10</span>, <span class="number">350</span>])</div></pre></td></tr></table></figure>
<p>Now it’s effective</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">scale(<span class="number">100</span>) <span class="comment">// return 10</span></div><div class="line">scale(<span class="number">300</span>) <span class="comment">// return 180</span></div><div class="line">scale(<span class="number">500</span>) <span class="comment">// return 350</span></div></pre></td></tr></table></figure>
<h3 id="d3-max-and-d3-min"><a href="#d3-max-and-d3-min" class="headerlink" title="d3.max() and d3.min()"></a>d3.max() and d3.min()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dataset = [</div><div class="line">  [<span class="number">5</span>, <span class="number">20</span>], [<span class="number">480</span>, <span class="number">90</span>], [<span class="number">250</span>, <span class="number">50</span>], [<span class="number">100</span>, <span class="number">33</span>], [<span class="number">330</span>, <span class="number">95</span>],</div><div class="line">  [<span class="number">410</span>, <span class="number">12</span>], [<span class="number">475</span>, <span class="number">44</span>], [<span class="number">25</span>, <span class="number">67</span>], [<span class="number">85</span>, <span class="number">21</span>], [<span class="number">220</span>, <span class="number">88</span>]</div><div class="line">]</div><div class="line"></div><div class="line">d3.max(dataset, <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> d[<span class="number">0</span>]</div><div class="line">&#125;)</div><div class="line"><span class="comment">// this function will return the value 480</span></div></pre></td></tr></table></figure>
<h3 id="Setting-Up-Dynamic-Scales"><a href="#Setting-Up-Dynamic-Scales" class="headerlink" title="Setting Up Dynamic Scales"></a>Setting Up Dynamic Scales</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xScale = d3.scaleLinear()</div><div class="line">  .domain([<span class="number">0</span>, d3.max(dataset, <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">    retrun d[<span class="number">0</span>]</div><div class="line">  &#125;)])</div><div class="line">  .range([<span class="number">0</span>, w])</div></pre></td></tr></table></figure>
<p>Output range is set to 0 and w, the SVG’s width.</p>
<p>Use the scale</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.attr(<span class="string">'x'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> xScale(d[<span class="number">0</span>])</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<blockquote>
<p><code>d3.scaleLinear()</code> has several other handly methods that deserve a breif mention here:</p>
</blockquote>
<ul>
<li><p><code>nice()</code>: this tells the scale to take whatever input domain that you gave to <code>domian()</code> and expand both ends to the nearest round value.</p>
</li>
<li><p><code>rangeRound()</code>: User <code>rangeRound()</code> in place of <code>range()</code>, and all values output by the scale will be rounded to nearest whole number.</p>
</li>
<li><p><code>clamp()</code>: By default, a linear scale can return values outside of the specified range. For example, if if given a value outside of its expected input domain, a scale will return a number also outside of the output range. Calling <code>clamp(true)</code> on a scale, forces all output values to be within the specified range. This means excessive values will be rounded to the range’s low or high value.</p>
</li>
</ul>
<p>To use any of these special methods, just tack them onto the chain in which you define the original scale function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> scale = d3.scaleLinear().domain([<span class="number">0.123</span>, <span class="number">4.67</span>]).range([<span class="number">0</span>, <span class="number">500</span>]).nice()</div></pre></td></tr></table></figure>
<blockquote>
<p>Other Scales</p>
</blockquote>
<ul>
<li><p><code>sclaeSqrt</code></p>
</li>
<li><p><code>scalePow</code></p>
</li>
<li><p><code>scaleLog</code></p>
</li>
<li><p><code>scaleQuantize</code></p>
</li>
<li><p><code>scaleQuantile</code></p>
</li>
<li><p><code>scaleOrdinal</code></p>
</li>
<li><p><code>scaleTime</code></p>
</li>
</ul>
<h1 id="Axes"><a href="#Axes" class="headerlink" title="Axes"></a>Axes</h1><p>D3’s axes are actually <code>function</code> whose parameters you define. Unlike scales, when an axis function is called, it doesn’t return a value, but generates the visual elements of the axis, including lines, labels, and ticks.</p>
<h2 id="Setting-Up-an-Axis"><a href="#Setting-Up-an-Axis" class="headerlink" title="Setting Up an Axis"></a>Setting Up an Axis</h2><p>There are four different axis function constructors, each one corresponding to a different orientation and placement of labels: <code>d3.axisTop</code>, <code>d3.axisBottom</code>, <code>d3.axisLeft</code>, <code>d3.axisRight</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> xAxis = d3.axisBottom()</div></pre></td></tr></table></figure>
<p>At a minimum, each axis also needs to be told on what <em>scale</em> to operate.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> xAxis = d3.axisBottom().scale(xScale)</div><div class="line"><span class="comment">// or</span></div><div class="line"><span class="keyword">const</span> xAxis = d3.axisBottom(xScale)</div></pre></td></tr></table></figure>
<p>Finally, to actually generate the axis and insert all those little lines and labels into our SVG, we must <code>call</code> teh <code>xAxis</code> function. This is similar to the scale functions, which we first configured by setting parameters, and then later <code>called</code> to put them into action.</p>
<p>Here we put this code at the end of script, so the axis is generated after the other elements in the SVG, and therefore appears ‘on top’</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svg.append(<span class="string">'g'</span>).call(xAxis)</div></pre></td></tr></table></figure>
<p>This is where things get a little funky. You might be wondering why this looks so different from our friendly scale functions. Here’s why: because an axis function actually draws something to the screen (by appending SVG elements to the DOM), we need to specify where in the DOM it should place new elements.</p>
<p>In the svg, we <code>append()</code> a new <code>g</code> element to the end of the SVG. In SVG land, a <code>g</code> element is a <code>group</code> element. Group elements are invisible, unlike <code>line</code>, <code>rect</code>, and <code>circle</code> and they have no visual presence themselves.</p>
<p>The <code>g</code> element can keep our code nice and be transformed.</p>
<p>So we’ve created a new <code>g</code>, and then finally, the function <code>call()</code> is called on our new <code>g</code>.</p>
<p>D3’s <code>call()</code> function takes the incoming <code>selection</code>, as received from the prior link in the chain, and hands that selection off to any <code>function</code>.</p>
<p>This this case, the selection is our new <code>g</code> group element. Although the <code>g</code> isn’t strictly necessary, we are using it because the axis function is about to generate lots of crazy lines and numbers, and it’s noce to contain all those element within a single group object.</p>
<p><code>call()</code> hands off <code>g</code> to the <code>xAxis</code> function, so our axis is genrated within <code>g</code></p>
<h3 id="Positioning-Axes"><a href="#Positioning-Axes" class="headerlink" title="Positioning Axes"></a>Positioning Axes</h3><p>By default, an axis is positioned using the range values of the specified scale. In our case, <code>xAxis</code> is referencing <code>xScale</code>, which has a range of [20, 460], because we applied 20 pixels of padding on all edge of the SVG. We can transform the axis by:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">svg.append(<span class="string">'g'</span>)</div><div class="line">  .attr(<span class="string">'class'</span>, <span class="string">'axis'</span>)</div><div class="line">  .attr(<span class="string">'tranform'</span>, <span class="string">'translate(0, '</span> + (h - padding) + <span class="string">')'</span>)</div><div class="line">  .call(xAxis)</div></pre></td></tr></table></figure>
<p>In the end, we would like  our <code>g</code> to look like this in the DOM:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">g</span> <span class="attr">class</span>=<span class="string">"axis"</span> <span class="attr">transform</span>=<span class="string">"translate(0, 280)"</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="CSS-styles-on-axis"><a href="#CSS-styles-on-axis" class="headerlink" title="CSS styles on axis"></a>CSS styles on axis</h3><p>The axes themselves are made up of <code>path</code>, <code>line</code>, <code>text</code> element, so those are the three elemnts to target in your CSS.</p>
<p>The paths and lines can be styled together, with the same rules, and text gets its own rules around for font and font size.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.axis</span> <span class="selector-tag">path</span>, <span class="selector-class">.axis</span> <span class="selector-tag">line</span> &#123;</div><div class="line">  <span class="attribute">stroke</span>: teal;</div><div class="line">  <span class="attribute">shape-rendering</span>: crispEdges;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.axis</span> <span class="selector-tag">text</span> &#123;</div><div class="line">  <span class="attribute">font-family</span>: Optima, Futura, sans-serif;</div><div class="line">  <span class="attribute">font-weight</span>: bold;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</div><div class="line">  <span class="attribute">fill</span>: teal;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>These CSS rules will override D3’s default styles.</p>
<p>Note that when we use CSS rules to style SVG elements, only SVG attribute names – not regular CSS properties – should be used.</p>
<h3 id="Check-for-Ticks"><a href="#Check-for-Ticks" class="headerlink" title="Check for Ticks"></a>Check for Ticks</h3><p>Some ticks spread disease, but D3’s ticks communicates information.</p>
<p>You can customize all aspects of your axes, starting with the rough number of ticks, using <code>ticks()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> xAxis = d3.axisBottom().scale(xScale).ticks(<span class="number">6</span>) <span class="comment">// set rough # of ticks</span></div></pre></td></tr></table></figure>
<p>Specifying tick values manually</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> xAixs = d3.axisBottom().scale(xScale).tickValues([<span class="number">0</span>, <span class="number">100</span>, <span class="number">250</span>, <span class="number">700</span>])</div></pre></td></tr></table></figure>
<h3 id="Formatting-Tick-labels"><a href="#Formatting-Tick-labels" class="headerlink" title="Formatting Tick labels"></a>Formatting Tick labels</h3><p>Enter <code>tickFormat()</code>, which enables you to specify how your numbers should be formatted.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> formatAsPercentage = d3.format(<span class="string">".1%"</span>)</div><div class="line">xAxis.tickFormat(formatAsPercentage)</div></pre></td></tr></table></figure>
<h1 id="Updates-Transtions-and-Motion"><a href="#Updates-Transtions-and-Motion" class="headerlink" title="Updates, Transtions, and Motion"></a>Updates, Transtions, and Motion</h1><blockquote>
<p>Transtion: .transition(), .duration()</p>
<p>Motion: .delay(), .ease()</p>
</blockquote>
<p>The argument could be number or function</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.transition()</div><div class="line">.delay(<span class="function">(<span class="params">d, i</span>) =&gt;</span> <span class="number">100</span> * i)</div><div class="line">.duration(<span class="number">300</span>)</div></pre></td></tr></table></figure>
<p>The default easing is <code>d3.easeCubicInOut</code>, which produces the gradual acceleration and deceleration.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.transition()</div><div class="line">.duration(<span class="number">3000</span>)</div><div class="line">.ease(d3.easeLinear)</div></pre></td></tr></table></figure>
<ul>
<li><p>d3.easeCircleIn</p>
</li>
<li><p>d3.easeElasticOut</p>
</li>
<li><p>d3.easeBounceOut</p>
</li>
</ul>
<h3 id="on-Transition-Starts-and-Ends"><a href="#on-Transition-Starts-and-Ends" class="headerlink" title="on() Transition Starts and Ends"></a>on() Transition Starts and Ends</h3><p>There will be times when you want to make something happen at the start or end of a transition. In those time you can use <code>on()</code> to execute arbitrary code for each element in the selection.</p>
<p><code>on()</code> expects two arguments:</p>
<ul>
<li><p>Either “start” or “end”</p>
</li>
<li><p>An anonymous function, to be executed either at the start of a transition, or as soon as it has ended.</p>
</li>
</ul>
<blockquote>
<p>Notice: Only one transition can be active on any given element at any given time.</p>
</blockquote>
<h3 id="Containing-Visual-Elements-With-Clipping-Paths"><a href="#Containing-Visual-Elements-With-Clipping-Paths" class="headerlink" title="Containing Visual Elements With Clipping Paths"></a>Containing Visual Elements With Clipping Paths</h3><p>SVG has support for <em>clipping paths</em>, which you might know as <em>masks</em> in many drawing tools.</p>
<p>Much like <code>g</code>, <code>clipPath</code> has no visual presence of its own, but it contains visual elements.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;clipPath id=<span class="string">"chart-area"</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">"30"</span> <span class="attr">y</span>=<span class="string">"30"</span> <span class="attr">width</span>=<span class="string">"410"</span> <span class="attr">height</span>=<span class="string">"240"</span>&gt;</span><span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span></div><div class="line">&lt;<span class="regexp">/clipPath&gt;</span></div></pre></td></tr></table></figure>
<p>Note that outer <code>clipPath</code> element has been given an ID of <code>chart-area</code>. We can use that ID to reference it later. Within the <code>clipPath</code> is a <code>rect</code>, which will function as the mask.</p>
<p>3 steps to using a clipping path:</p>
<ol>
<li><p>Define a <code>clipPath</code> and give it an ID</p>
</li>
<li><p>Put visual elements within the <code>clipPath</code> (usuallly just a <code>rect</code>, but this could be <code>circles</code> or any other visual elements)</p>
</li>
<li><p>Add a reference to the <code>clipPath</code> form whatever elements you wish to be masked.</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">svg.append(<span class="string">'clipPath'</span>)</div><div class="line">  .attr(<span class="string">'id'</span>, <span class="string">'chart-area'</span>) <span class="comment">// assign an id</span></div><div class="line">  .append(<span class="string">'rect'</span>) <span class="comment">// within the clippath, create new rect</span></div><div class="line">  .attr(<span class="string">'x'</span>, padding)</div><div class="line">  .attr(<span class="string">'y'</span>, padding)</div><div class="line">  .attr(<span class="string">'width'</span>, w - padding * <span class="number">2</span>)</div><div class="line">  .attr(<span class="string">'height'</span>, h - padding * <span class="number">2</span>)</div><div class="line"></div><div class="line">svg.append(<span class="string">'g'</span>)</div><div class="line">  .attr(<span class="string">'id'</span>, <span class="string">'circles'</span>)</div><div class="line">  .attr(<span class="string">'clip-path'</span>, <span class="string">'url(#chart-area)'</span>)</div><div class="line">  .selectAll(<span class="string">'circle'</span>)</div><div class="line">  .data(dataset)</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'circle'</span>)</div></pre></td></tr></table></figure>
<h1 id="Interactivity"><a href="#Interactivity" class="headerlink" title="Interactivity"></a>Interactivity</h1><p>D3 allows you to bind event listener to more than one element at a time.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">svg.selectAll(<span class="string">'rect'</span>)</div><div class="line">  .data(dataset)</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'rect'</span>)</div><div class="line">  ....</div><div class="line">  .on(<span class="string">'click'</span>, (d) =&gt; &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
<p>Within anonymous function , D3 automatically sets the context of <code>this</code>  so it references <code>current element upon which we are acting</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">svg</span> <span class="selector-tag">text</span> &#123;</div><div class="line">  <span class="attribute">pointer-event</span>: none;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">svg.append(<span class="string">'text'</span>).style(<span class="string">'pointer-event'</span>, <span class="string">'none'</span>)</div></pre></td></tr></table></figure>
<h3 id="Grouping-SVG-Element"><a href="#Grouping-SVG-Element" class="headerlink" title="Grouping SVG Element"></a>Grouping SVG Element</h3><p>Note that <code>g</code> group elements do not, by themselves, trigger any mouse events. The reason for this is that <code>g</code> elements have no pixels.</p>
<p>You can still bind event listener to <code>g</code> elements, just keep in mind that the elements within that <code>g</code> will then behave as a group. If any of the enclosed elements are clicked or moused over, then the listener function will be activated.</p>
<h3 id="Tooltips"><a href="#Tooltips" class="headerlink" title="Tooltips"></a>Tooltips</h3><p>In interactive visualizations, tooltips are small overlays that present data values. In many cases, it’s not necessary to label every individual data value in the default value, but that level of detail should still be accessible to users.</p>
<h4 id="SVG-Element-Tooltips"><a href="#SVG-Element-Tooltips" class="headerlink" title="SVG Element Tooltips"></a>SVG Element Tooltips</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">.on(<span class="string">'mouseover'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> xPosition = <span class="built_in">parseFloat</span>(d3.select(<span class="keyword">this</span>)).attr(<span class="string">'x'</span>) + xScale.bandWidth()</div><div class="line">  <span class="keyword">const</span> yPosition = <span class="built_in">parseFloat</span>(d3.select(<span class="keyword">this</span>)).attr(<span class="string">'y'</span>) + <span class="number">14</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// create the tooltip label</span></div><div class="line"></div><div class="line">svg.append(<span class="string">'text'</span>)</div><div class="line">  .attr(<span class="string">'id'</span>, <span class="string">'tooltip'</span>)</div><div class="line">  .attr(<span class="string">'x'</span>, xPosition)</div><div class="line">  .attr(<span class="string">'y'</span>, yPosition)</div><div class="line">  .attr(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>)</div><div class="line">  .attr(<span class="string">'font-family'</span>, <span class="string">'sans-serif'</span>)</div><div class="line">  .attr(<span class="string">'font-size'</span>, <span class="string">'11px'</span>)</div><div class="line">  .attr(<span class="string">'font-weight'</span>, <span class="string">'bold'</span>)</div><div class="line">  .attr(<span class="string">'fill'</span>, <span class="string">'black'</span>)</div><div class="line">  .text(d)</div><div class="line"></div><div class="line">.on(<span class="string">'mouseout'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  d3.select(<span class="string">'#tooltip'</span>).remove()</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Using-Paths"><a href="#Using-Paths" class="headerlink" title="Using Paths"></a>Using Paths</h1><h3 id="Line-Charts"><a href="#Line-Charts" class="headerlink" title="Line Charts"></a>Line Charts</h3><h4 id="Scale-setup"><a href="#Scale-setup" class="headerlink" title="Scale setup"></a>Scale setup</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> xScale = d3.scaleTime()</div><div class="line">  .domain([</div><div class="line">    d3.min(dataset, (d) =&gt; d.date),</div><div class="line">    d3.max(dataset, (d) =&gt; da.date)</div><div class="line">  ])</div><div class="line">  .range([<span class="number">0</span>, w])</div><div class="line"></div><div class="line"><span class="keyword">const</span> yScale = d3.scaleLinear()</div><div class="line">  .domain([</div><div class="line">    <span class="number">0</span>,</div><div class="line">    d3.max(dataset, (d) =&gt; d.avarage)</div><div class="line">  ])</div><div class="line">  .range([h, <span class="number">0</span>])</div></pre></td></tr></table></figure>
<p>Define a line generator</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> lineGen = d3.line()</div><div class="line">  .x(<span class="function"><span class="params">d</span> =&gt;</span> xScale(d.date))</div><div class="line">  .y(<span class="function"><span class="params">d</span> =&gt;</span> yScale(d.avarage))</div></pre></td></tr></table></figure>
<p>The x and y accessors tell the line generator how to decide <code>where</code> to place each point on the line.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> svg = d3.select(<span class="string">'body'</span>)</div><div class="line">  .append(<span class="string">'svg'</span>)</div><div class="line">  .attr(<span class="string">'width'</span>, w)</div><div class="line">  .attr(<span class="string">'height'</span>, h)</div><div class="line"></div><div class="line">svg.append(<span class="string">'path'</span>)</div><div class="line">  .datum(dataset)</div><div class="line">  .attr(<span class="string">'class'</span>, <span class="string">'line'</span>)</div><div class="line">  .attr(<span class="string">'d'</span>, lineGen)</div></pre></td></tr></table></figure>
<p>Instead of using <code>data()</code> to bind each value in our <code>dataset</code> array to a different element, we use <code>datum()</code>, the method for binding a <em>single</em> data value to a single element. The entire <code>dataset</code> array is bound to the new <code>path</code> we just created.</p>
<p>We set a <code>d</code> attribute, passing in our line generator function as an argument.</p>
<p>Since the data has already been bound to the <code>path</code>, the line generator simply grabs taht data. plots the pointers as we specified, and draws a line connecting them.</p>
<h3 id="Dealing-with-Missing-Data"><a href="#Dealing-with-Missing-Data" class="headerlink" title="Dealing with Missing Data"></a>Dealing with Missing Data</h3><p>Assume a -99.99 value is not a true measurement, namely one value is missed.</p>
<p><code>defined()</code> is just an configuration method, like <code>x()</code> and <code>y()</code>. If the result of its anonymous function is true, then that data value is included, or the value is excluded.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> lineGen = d3.line()</div><div class="line">  .defined(<span class="function"><span class="params">d</span> =&gt;</span> (d.avarage &gt; <span class="number">0</span>))</div><div class="line">  .x(<span class="function"><span class="params">d</span> =&gt;</span> x.date)</div><div class="line">  .y(<span class="function"><span class="params">d</span> =&gt;</span> x.avatarge)</div></pre></td></tr></table></figure>
<h3 id="Area-Charts"><a href="#Area-Charts" class="headerlink" title="Area Charts"></a>Area Charts</h3><p>Areas are not too different from lines. If a line is a series of connected (x, y) points, then an area is just that same line, plus a second such line (usually a flat baseline), with all the space in between filled in.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> area = d3.area()</div><div class="line">  .defined(<span class="function"><span class="params">d</span> =&gt;</span> (d.avarage &gt; <span class="number">0</span>))</div><div class="line">  .x(<span class="function"><span class="params">d</span> =&gt;</span> (xScale(d.date)))</div><div class="line">  .y0(<span class="function"><span class="params">()</span> =&gt;</span> (yScale.range()[<span class="number">0</span>]))</div><div class="line">  .y1(<span class="function">(<span class="params">d</span>) =&gt;</span> (yScale(d.avarge)))</div></pre></td></tr></table></figure>
<p><code>y0</code> represents the area’s baseline, which <code>y1</code> represents the top.</p>
<h1 id="Selections"><a href="#Selections" class="headerlink" title="Selections"></a>Selections</h1><h3 id="A-Closer-Look-at-Selections"><a href="#A-Closer-Look-at-Selections" class="headerlink" title="A Closer Look at Selections"></a>A Closer Look at Selections</h3><p><img src="https://www.safaribooksonline.com/library/view/interactive-data-visualization/9781491921296/assets/dvw2_1201.png" alt=""></p>
<p><code>d3.select(&#39;body&#39;)</code> returns a <code>Selection</code>, which consists of <code>_groups</code> and <code>_parents</code></p>
<p>So a selection contains two arrays: <code>_groups</code> and <code>_parents</code></p>
<p><code>_groups</code> contains yet another array, which itself contains a list of elements – ony one in this case, <code>body</code>.</p>
<p>Let’s expand <code>body</code> and will see a lot of properties associated with <code>body</code>.</p>
<p>Selections are just very special objects generated and interpreted by D3. You will never manipulate a selection yourself – don’t bother trying to reach int <code>_groups</code> – as that’s what all of D3’s selection methods are for.</p>
<p><code>d3.select()</code> and <code>d3.selectAll()</code> operate at the page level, which means</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> allGroups = d3.selectAll(<span class="string">'g'</span>)</div></pre></td></tr></table></figure>
<p>The <code>select()</code> and <code>selectAll()</code> statements create <em>new</em> selections, and hand those new selections off to the subsequent methods.</p>
<p>To minimize the confusion from old and new selections, Mike Bostock recommends using an indentation convetion of four space when the selection is unchanged, but only two when a new selection is returned.</p>
<p><code>select()</code> and <code>append()</code> are methods that return new selections, <code>attr()</code> does not, but merely relays whatever selection it just acted on.</p>
<h3 id="Storing-Selections"><a href="#Storing-Selections" class="headerlink" title="Storing Selections"></a>Storing Selections</h3><p>Selections are immutable. All selection methods that affect which elements are selected (or their order) return a new selection rather tahn modifying the current selection.</p>
<p>That is, once you make a selection, you can’t modify it. You can only make a new one, which could be a subset of the original, and overwrite it.</p>
<h3 id="Enter-Merge-and-Exit"><a href="#Enter-Merge-and-Exit" class="headerlink" title="Enter, Merge and Exit"></a>Enter, Merge and Exit</h3><h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">d3.select(<span class="string">'body'</span>).selectAll(<span class="string">'p'</span>)</div><div class="line">  .data(dataset)</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'p'</span>)</div><div class="line">  .text(<span class="function"><span class="params">d</span> =&gt;</span> (<span class="string">'I can count up to '</span> + d))</div><div class="line">  .filter(<span class="function"><span class="params">d</span> =&gt;</span> (d &gt; <span class="number">15</span>))</div><div class="line">  .style(<span class="string">'color'</span>, <span class="string">'red'</span>)</div></pre></td></tr></table></figure>
<p><code>filter()</code> takes a selection and an anonymous function. If the function return <code>true</code> for a given element, then that element is included in the new selection returned by <code>filter()</code>.</p>
<h3 id="Each"><a href="#Each" class="headerlink" title="Each"></a>Each</h3><p>The most common purpose of creating a selection is to ultimately to modify it in some way, such as by using <code>attr()</code> or <code>style()</code>. But it can be useful to define your own functions, espectially for custom calculation or modifications that will be repeated.</p>
<p>We can use <code>each()</code> to run an arbitrary function once for each element in a selection. <code>each()</code> takes whatever selection it’s given and calls the specified function once for each item in the selection.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">selection.each(<span class="function">(<span class="params">d, i</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Some serious points to note:</p>
<ul>
<li><p>Since the <code>d</code> and <code>i</code> arguments are specified in the function definition, D3 will populate them for you.</p>
</li>
<li><p>The value of <code>this</code> will also be set by D3 to reflect <code>the element upon which we&#39;re currently acting</code>, So <code>d3.select(this)</code> will create a selection with whatever that element is.</p>
</li>
<li><p>In <code>delay()</code> or any other function within (d, i) =&gt; {}, we can reference the value <code>d</code>, and <code>i</code> directly, no need to write <code>(d, i)</code></p>
</li>
</ul>
<h1 id="Layouts"><a href="#Layouts" class="headerlink" title="Layouts"></a>Layouts</h1><p>Contrary to what the name implies, D3 <em>layouts</em> do not, in fact, lay anything out for you on the screen. The layout methods have no direct <em>visual</em> output. Rather, D3 layouts take data that you provided and remap or otherwise transform it, thereby generating <em>new</em> data that is more convenient for a specific visual task.</p>
<p>The list of D3 layouts includes:</p>
<ul>
<li><p>Chord</p>
</li>
<li><p>Cluster</p>
</li>
<li><p>Force</p>
</li>
<li><p>Pack</p>
</li>
<li><p>Partition</p>
</li>
<li><p>Pie</p>
</li>
<li><p>Stack</p>
</li>
<li><p>Tree</p>
</li>
<li><p>Treemap</p>
</li>
</ul>
<h3 id="Pie-Layout"><a href="#Pie-Layout" class="headerlink" title="Pie Layout"></a>Pie Layout</h3><p><code>d3.pie()</code> might not be as delicious as it sounds, but it’s still worthy of your attention. It is typically used to create a doughnut or pie chart.</p>
<p>Start with simple dataset</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> dataset = [ <span class="number">5</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">45</span>, <span class="number">6</span>, <span class="number">25</span> ]</div></pre></td></tr></table></figure>
<p>Wd define a default pie layout</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> pie = d3.pie()</div></pre></td></tr></table></figure>
<p>Then, all that remains is to hand off our data to the new <code>pie()</code> function, as in <code>pie(dataset)</code>.</p>
<p>The pie layout takes our simple array of numbers and generates an array of objects, one object for each value. Each of those objects now has a few new values – most important, <code>startAngle</code> and <code>endAngle</code>.</p>
<p>To actually draw the wedges, we turn to <code>d3.arc()</code>, a handy built-in function for drawing arcs as SVG <code>path</code> elements.</p>
<p>Arcs are defiend as custom functions, and they require inner and outer redius values.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> w = <span class="number">300</span></div><div class="line"><span class="keyword">const</span> h = <span class="number">300</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> outerRadius = w / <span class="number">2</span></div><div class="line"><span class="keyword">const</span> innerRadius = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> arc = d3.arc()</div><div class="line">  .innerRadius(innerRadius)</div><div class="line">  .outerRadius(outerRadius)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> svg = d3.select(<span class="string">'body'</span>)</div><div class="line">  .append(<span class="string">'svg'</span>)</div><div class="line">  .attr(<span class="string">'width'</span>, w)</div><div class="line">  .attr(<span class="string">'height'</span>, h)</div></pre></td></tr></table></figure>
<p>Then we can create new groups for each incoming wedge, binding the pie-ified data to the new elements, and translating each group into the center of the chart, so the <code>path</code>s will appear in the right place</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// set up groups</span></div><div class="line"><span class="keyword">const</span> arcs = svg.selectAll(<span class="string">'g.arc'</span>)</div><div class="line">  .data(pie(dataset))</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'g'</span>)</div><div class="line">  .attr(<span class="string">'class'</span>, <span class="string">'arc'</span>)</div><div class="line">  .attr(<span class="string">'transform'</span>, <span class="string">'translate('</span> + outerRadius + <span class="string">', '</span> + outerRadius + <span class="string">')'</span>)</div></pre></td></tr></table></figure>
<p>Note that we’re saving a reference to each newly created <code>g</code> in a variable called <code>arcs</code></p>
<p>Finally, within each new <code>g</code>, we append a <code>path</code>. A <code>path</code>‘s path description is defined in the <code>d</code> attribute. So we call the <code>arc</code> generator, which generates the path information based on the data already bound to this group.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// draw arc paths</span></div><div class="line">arcs.append(<span class="string">'path'</span>)</div><div class="line">  .attr(<span class="string">'fill'</span>, (d, i) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> colors(i)</div><div class="line">  &#125;)</div><div class="line">  .attr(<span class="string">'d'</span>, arc)</div></pre></td></tr></table></figure>
<p><code>arc</code> is our path generator function.</p>
<p>When a named function is specified as a parameter in this way, D3 automcatically passes in the datum and index values, without us having to write them out explicitly.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">.attr(<span class="string">'d'</span>, arc)</div><div class="line"></div><div class="line"><span class="comment">// equivalent</span></div><div class="line"></div><div class="line">.attr(<span class="string">'d'</span>, (d, i) =&gt; (arc(d, i)))</div></pre></td></tr></table></figure>
<p>D3 has a number of handy ways to generate categorical colors</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> color = d3.scaleOrdinal(d3.schemeCategory10)</div></pre></td></tr></table></figure>
<p>Generate text labels for each wedge:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">arcs.append(<span class="string">'text'</span>)</div><div class="line">  .artr(<span class="string">'transform'</span>, (d) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'translate('</span> + arc.centroid(d) + <span class="string">')'</span></div><div class="line">  &#125;)</div><div class="line">  .attr(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>)</div><div class="line">  .text(<span class="function">(<span class="params">d</span>) =&gt;</span> &#123; <span class="keyword">return</span> d.value &#125;)</div></pre></td></tr></table></figure>
<p>A <em>centroid</em> is the calculated center point of any shape, whether that shape is regular(like a square) or highly irregular(like an outline of the state of Maryland).</p>
<p><code>arc.centroid()</code> is super-helpful function that calculates and returns the center point of any arc.</p>
<blockquote>
<p>Note: The pie layout automatically reordered out data values from largest to smallest.</p>
</blockquote>
<h3 id="Stack-Layout"><a href="#Stack-Layout" class="headerlink" title="Stack Layout"></a>Stack Layout</h3><p><code>d3.stack()</code> converts two-dimentional data into ‘stacked’ data.</p>
<p>It calculates a baseline value for each datum, so you can <code>stack</code> layers of data on top of one another.</p>
<p>Start with some data</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> dataset = [</div><div class="line">  &#123; <span class="attr">apples</span>: <span class="number">5</span>, <span class="attr">oranges</span>: <span class="number">10</span>, <span class="attr">grapes</span>: <span class="number">22</span> &#125;,</div><div class="line">	&#123; <span class="attr">apples</span>: <span class="number">4</span>, <span class="attr">oranges</span>: <span class="number">12</span>, <span class="attr">grapes</span>: <span class="number">28</span> &#125;,</div><div class="line">	&#123; <span class="attr">apples</span>: <span class="number">2</span>, <span class="attr">oranges</span>: <span class="number">19</span>, <span class="attr">grapes</span>: <span class="number">32</span> &#125;,</div><div class="line">	&#123; <span class="attr">apples</span>: <span class="number">7</span>, <span class="attr">oranges</span>: <span class="number">23</span>, <span class="attr">grapes</span>: <span class="number">35</span> &#125;,</div><div class="line">	&#123; <span class="attr">apples</span>: <span class="number">23</span>, <span class="attr">oranges</span>: <span class="number">17</span>, <span class="attr">grapes</span>: <span class="number">43</span> &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>The <code>dataset</code> is organized by <em>column</em>. The stack layout reconfigures the data to be organized by <em>categories</em>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Set up stack method</span></div><div class="line"><span class="keyword">const</span> stack = d3.stack().keys([<span class="string">'apples'</span>, <span class="string">'oranges'</span>, <span class="string">'grapes'</span>])</div><div class="line"></div><div class="line"><span class="comment">// Data, stacked</span></div><div class="line"><span class="keyword">const</span> series = stack(dataset)</div></pre></td></tr></table></figure>
<p>Now <code>series</code> is an array with three values, each one itself an array corresponding to each categorical series: apples, oranges, and grapes(in that order because we specified as such in <code>keys()</code>)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//'series', the array formerly known as 'dataset'</span></div><div class="line">[</div><div class="line">	[ [ <span class="number">0</span>,  <span class="number">5</span>], [ <span class="number">0</span>,  <span class="number">4</span>], [ <span class="number">0</span>,  <span class="number">2</span>], [ <span class="number">0</span>,  <span class="number">7</span>], [ <span class="number">0</span>, <span class="number">23</span>] ],  <span class="comment">// apples</span></div><div class="line">	[ [ <span class="number">5</span>, <span class="number">15</span>], [ <span class="number">4</span>, <span class="number">16</span>], [ <span class="number">2</span>, <span class="number">21</span>], [ <span class="number">7</span>, <span class="number">30</span>], [<span class="number">23</span>, <span class="number">40</span>] ],  <span class="comment">// oranges</span></div><div class="line">	[ [<span class="number">15</span>, <span class="number">37</span>], [<span class="number">16</span>, <span class="number">44</span>], [<span class="number">21</span>, <span class="number">53</span>], [<span class="number">30</span>, <span class="number">65</span>], [<span class="number">40</span>, <span class="number">83</span>] ]   <span class="comment">// grapes</span></div><div class="line">]</div></pre></td></tr></table></figure>
<p>To stack element visually, now we can reference each data object’s baseline and top line values.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Add a group for each row of data</span></div><div class="line"><span class="keyword">const</span> groups = svg.selectAll(<span class="string">'g'</span>)</div><div class="line">  .data(series)</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'g'</span>)</div><div class="line">  .style(<span class="string">'fill'</span>, (di, i) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> colors(i)</div><div class="line">  &#125;)</div><div class="line"></div><div class="line"><span class="comment">// Add a rect for each data value</span></div><div class="line"><span class="keyword">const</span> rects = groups.selectAll(<span class="string">'rect'</span>)</div><div class="line">  .data(<span class="function">(<span class="params">d</span>) =&gt;</span> (d))</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'rect'</span>)</div><div class="line">  .attr(<span class="string">'x'</span>, (d, i) =&gt; &#123;</div><div class="line">    retrun xScale(i)</div><div class="line">  &#125;)</div><div class="line">  .attr(<span class="string">'y'</span>, (d) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> ySclae(d[<span class="number">0</span>])</div><div class="line">  &#125;)</div><div class="line">  .attr(<span class="string">'height'</span>, (d) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> yScale(d[<span class="number">1</span>]-d[<span class="number">0</span>])</div><div class="line">  &#125;)</div><div class="line">  .attr(<span class="string">'width'</span>, xScale.bandWidth())</div></pre></td></tr></table></figure>
<p>Within each group, we select all the <code>rect</code>s and bind a subset of the data with this line</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.data(<span class="function">(<span class="params">d</span>) =&gt;</span> (d))</div></pre></td></tr></table></figure>
<h4 id="A-New-Order"><a href="#A-New-Order" class="headerlink" title="A New Order"></a>A New Order</h4><p>Unless otherwise specified, series will be stacked in the order specified in <code>keys()</code>.</p>
<p>But you can use <code>order()</code> to specify an alternate sequence to be applied before all the stacked values are calculated.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> stack = d3.stack()</div><div class="line">  .keys([ <span class="string">'apples'</span>, <span class="string">'oranges'</span>, <span class="string">'grapes'</span> ])</div><div class="line">  .order(d3.stackOrderDesending)</div></pre></td></tr></table></figure>
<ul>
<li><p>d3.stackOrderNone</p>
</li>
<li><p>d3.stackOrderReverse</p>
</li>
<li><p>d3.stackOrderAscending</p>
</li>
<li><p>d3.stackOrderDescending</p>
</li>
</ul>
<h3 id="Stacked-Areas"><a href="#Stacked-Areas" class="headerlink" title="Stacked Areas"></a>Stacked Areas</h3><p>This can be a valuable way to represent time series data, when a sum total is derived from several related categories.</p>
<h3 id="Force-Layout"><a href="#Force-Layout" class="headerlink" title="Force Layout"></a>Force Layout</h3><p>Force-directed layouts are so-called because they use simulations of physical <em>force</em> to arrange elements on the screen.</p>
<p>Force layouts are typically used with network data. In computer science, this kind of dataset is called a <code>graph</code>. A simple graph is a list of <code>node</code> and <code>edge</code>. The nodes are entities in the dataset, and the edges are the <code>connection</code>s between nodes. Some nodes will be connected by edges and others won’t.</p>
<p>Nodea are commonly represented as circles and edges as lines.</p>
<p>The physical metaphor here is of particles that repel each other, yet are also connected by strings.  The repelling forces push particles away from each other, preventing visual overlap, and the strings prevent them from just flying out into space, thereby keeping them on the screen where we can see them.</p>
<h4 id="Preparing-the-network-data"><a href="#Preparing-the-network-data" class="headerlink" title="Preparing the network data"></a>Preparing the network data</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dataset = &#123;</div><div class="line">	<span class="attr">nodes</span>: [</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Adam"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Bob"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Carrie"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Donovan"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Edward"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Felicity"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"George"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Hannah"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Iris"</span> &#125;,</div><div class="line">		&#123; <span class="attr">name</span>: <span class="string">"Jerry"</span> &#125;</div><div class="line">	],</div><div class="line">	<span class="attr">edges</span>: [</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">0</span>, <span class="attr">target</span>: <span class="number">1</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">0</span>, <span class="attr">target</span>: <span class="number">2</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">0</span>, <span class="attr">target</span>: <span class="number">3</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">0</span>, <span class="attr">target</span>: <span class="number">4</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">1</span>, <span class="attr">target</span>: <span class="number">5</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">2</span>, <span class="attr">target</span>: <span class="number">5</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">2</span>, <span class="attr">target</span>: <span class="number">5</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">3</span>, <span class="attr">target</span>: <span class="number">4</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">5</span>, <span class="attr">target</span>: <span class="number">8</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">5</span>, <span class="attr">target</span>: <span class="number">9</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">6</span>, <span class="attr">target</span>: <span class="number">7</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">7</span>, <span class="attr">target</span>: <span class="number">8</span> &#125;,</div><div class="line">		&#123; <span class="attr">source</span>: <span class="number">8</span>, <span class="attr">target</span>: <span class="number">9</span> &#125;</div><div class="line">	]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="Defining-the-Force-Simulation"><a href="#Defining-the-Force-Simulation" class="headerlink" title="Defining the Force Simulation"></a>Defining the Force Simulation</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Initialize a simple force layout, using the nodes and edges in dataset</span></div><div class="line"><span class="keyword">const</span> layout = d3.forceSimulation(dataset.nodes)</div><div class="line">  .force(<span class="string">'charge'</span>, d3.forceManyBody())</div><div class="line">  .force(<span class="string">'link'</span>, d3.forceLink(dataset.edges))</div><div class="line">  .force(<span class="string">'center'</span>, d3.forceCenter().x(w/<span class="number">2</span>).y(h/<span class="number">2</span>))</div></pre></td></tr></table></figure>
<p>Call <code>d3.forceSimulation()</code> and pass in a reference to the nodes. This will generate a new simulator and automatically start running it, but without any forces applied, it won’t be very interesting.</p>
<p>To create force, call <code>force()</code> as many times as you like, each time specifying an arbitrary name for each force(in case you want to reference it later) and the name of a force function.</p>
<ul>
<li><p><code>d3.forceManyBody()</code>: Create a <em>many-body</em> force which acts on <strong>all</strong> nodes, meaning this can be used to either attract all nodes to each other or repel all nodes from each other. Try different <code>strength()</code> values, and see what happens. The default <code>strength()</code> is -30, so we will see a slight repelling force.</p>
</li>
<li><p><code>d3.forceLink()</code>: Our nodes are connected by edges, so we apply this force, specifying <code>dataset.edges</code>. Specify a target <code>distance()</code> (the default is 30 pixles), and this force will struggle agains any competing forces to achieve that distance.</p>
</li>
<li><p><code>d3.forceCenter()</code>: This force centers the entire simulation around whatever point you specify with <code>x()</code> and <code>y()</code>.</p>
</li>
</ul>
<h4 id="Creating-the-Visual-Elements"><a href="#Creating-the-Visual-Elements" class="headerlink" title="Creating the Visual Elements"></a>Creating the Visual Elements</h4><p>After defining our force simulation, we proceed to generate visual elements.</p>
<p>First we create a line for each edge:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Create edges as lines</span></div><div class="line"><span class="keyword">const</span> edges = svg.selectAll(<span class="string">'line'</span>)</div><div class="line">  .data(dataset.edges)</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'line'</span>)</div><div class="line">  .style(<span class="string">'stroke'</span>, <span class="string">'#ccc'</span>)</div><div class="line">  .style(<span class="string">'stroke-width'</span>, <span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>Then create a circle for each node:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nodes = svg.selectAll(<span class="string">'circle'</span>)</div><div class="line">  .data(dataset.nodes)</div><div class="line">  .enter()</div><div class="line">  .append(<span class="string">'circle'</span>)</div><div class="line">  .attr(<span class="string">'r'</span>, <span class="number">10</span>)</div><div class="line">  .style(<span class="string">'fill'</span>, (d, i) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> colors(i)</div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
<p>Add simple tooltip:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Add a simple tooltip</span></div><div class="line"></div><div class="line">nodes.append(<span class="string">'title'</span>)</div><div class="line">  .text(<span class="function">(<span class="params">d</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> d.name</div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
<h4 id="Updating-Visuals-Over-Time"><a href="#Updating-Visuals-Over-Time" class="headerlink" title="Updating Visuals Over Time"></a>Updating Visuals Over Time</h4><p>D3’s force simulation ‘ticks’ forward through time, just like every other physics simulation. With each tick, the simulation adjusts the position values for each node and edge according to the rules we specified when the layout was first initialized. To see this progress visually, we need to update the associated elements – the lines and circles – on every tick.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Every time the simulation 'ticks', this will be called</span></div><div class="line">force.on(<span class="string">'tick'</span>, () =&gt; &#123;</div><div class="line">  edges.attr(<span class="string">'x1'</span>, d =&gt; (d.source.x))</div><div class="line">    .attr(<span class="string">'y1'</span>, d =&gt; (d.source.y))</div><div class="line">    .attr(<span class="string">'x2'</span>, d =&gt; (d.target.x))</div><div class="line">    .attr(<span class="string">'y2'</span>, d =&gt; (d.target.y))</div><div class="line"></div><div class="line">  nodes.attr(<span class="string">'cx'</span>, d =&gt; (d.x))</div><div class="line">    .attr(<span class="string">'cy'</span>, d =&gt; (d.y))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>This tells D3, ‘Ok, every time you tick, take the new (x, y) values for each line and circle and update them in the DOM’</p>
<p>Here the (x, y) are calculated and appeded by D3.</p>
<h4 id="Draggable-Nodes"><a href="#Draggable-Nodes" class="headerlink" title="Draggable Nodes"></a>Draggable Nodes</h4><p>Add the <code>call()</code> statement to our <code>Nodes</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">.cal(d3.drag()</div><div class="line">  .on(<span class="string">'start'</span>, dragStarted)</div><div class="line">  .on(<span class="string">'drag'</span>, dragging)</div><div class="line">  .on(<span class="string">'end'</span>, dragEnded))</div></pre></td></tr></table></figure>
<p>This bit code ‘calls’ the <code>d3.drag()</code> method on each node.</p>
<p><code>d3.drag()</code>, in turn, sets event listeners for the three drag-related events, and specifies functions to trigger whenever one of those events occurs.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragStarted</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!d3.event.active) force.alphaTarget(<span class="number">0.3</span>).restart()</div><div class="line">  d.fx = d.x</div><div class="line">  d.fy = d.y</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragging</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  d.fx = d3.event.x</div><div class="line">  d.fy = d3.event.y</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragEnded</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!d3.event.active) force.alphaTarget(<span class="number">0</span>)</div><div class="line">  d.fx = <span class="literal">null</span></div><div class="line">  d.fy = <span class="literal">null</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Geomapping"><a href="#Geomapping" class="headerlink" title="Geomapping"></a>Geomapping</h1><p>…</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Simple usage of SW]]></title>
      <url>/2017/07/01/Simple-usage-of-SW/</url>
      <content type="html"><![CDATA[<h1 id="Register"><a href="#Register" class="headerlink" title="Register"></a>Register</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">navigator.serviceWorker.register(<span class="string">'your_service_worker,js'</span>, &#123; <span class="attr">scope</span>: <span class="string">'your_path_name'</span> &#125;)</div><div class="line">.then(<span class="function">(<span class="params">worker</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[SW] Registration succeeded.'</span>)</div><div class="line">&#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[SW] Registration failed with '</span> + err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Unregister"><a href="#Unregister" class="headerlink" title="Unregister"></a>Unregister</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">navigator.serviceWorker.getRegistration(<span class="string">'your_service_worker.js'</span>, &#123; <span class="attr">scope</span>: <span class="string">'your_path_name'</span> &#125;)</div><div class="line">.then(<span class="function">(<span class="params">worker</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (worker &amp;&amp; worker.unregister) &#123;</div><div class="line">    worker.unregister()</div><div class="line">    .then(<span class="function">(<span class="params">isUnregistered</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">if</span> (isUnregistered) &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'[SW] Unregister succeeded'</span>)</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'[SW] Unregister failed'</span>)</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">.catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[SW] Unregister failed with '</span> + err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Worker-js"><a href="#Worker-js" class="headerlink" title="Worker.js"></a>Worker.js</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">self.addEventListener(<span class="string">'install'</span>, (event) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[Worker] installing'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">self.addEventListener(<span class="string">'activate'</span>, (event) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[Worker] ready'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">self.addEventListener(<span class="string">'fetch'</span>, (event) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(event.request.url)</div><div class="line">  <span class="keyword">return</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="LifeCycle"><a href="#LifeCycle" class="headerlink" title="LifeCycle"></a>LifeCycle</h1><p><img src="http://foio.github.io/images/sw-lifecycle.png" alt=""></p>
<h1 id="Download-and-Parse"><a href="#Download-and-Parse" class="headerlink" title="Download and Parse"></a>Download and Parse</h1><p>After registration of Service Worker, browser will download and parse the script from specified url.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* In main.js */</span></div><div class="line"><span class="keyword">if</span> (<span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</div><div class="line">  navigator.serviceWorker.register(<span class="string">'./sw.js'</span>)</div><div class="line">  .then(<span class="function">(<span class="params">worker</span>) =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Service Worker Registered'</span>)</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Service Worker Failed to Register'</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Installing"><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h1><p>After successfully parsed, browser will install the Service Worker. Once the Install finished, the worker will emit <code>install</code> event, and waiting for <code>activating</code>. If the install failed, Service Worker will be <code>Redundant</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* In sw.js */</span></div><div class="line">self.addEventListener(<span class="string">'install'</span>, (event) =&gt; &#123;</div><div class="line">  event.waitUntil(</div><div class="line">    caches.open(currentCacheName)</div><div class="line">    .then(<span class="function">(<span class="params">cache</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> cache.addAll(arrayOfFilesToCache)</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>If there is an <code>event.waitUntil(promiseObj)</code> method in the event, the installing event will not be successful until the Promise within it is solved. If the Promise is rejected, the install event fails and the Service Worker became <strong>redundant</strong></p>
<h1 id="Installed-Waiting"><a href="#Installed-Waiting" class="headerlink" title="Installed / Waiting"></a>Installed / Waiting</h1><p>If the installation is successful, the Service Worker moves to the <strong>installed</strong>(also called <strong>waiting</strong>) state. In this state it is a valid, but not yet active, worker. It is not yet in control of the document., but rather is waiting to take control form the current worker.</p>
<h1 id="Activating"><a href="#Activating" class="headerlink" title="Activating"></a>Activating</h1><p>The <strong>activating</strong> state will be triggered for a waiting Service Worker in one of the following scenarios -</p>
<ul>
<li><p>if there is no current active worker already</p>
</li>
<li><p>if the <code>self.skipWaiting()</code> method is called in the Service Worker script</p>
</li>
<li><p>if the user has navigated away from the page, thereby releasing the previous active worker.</p>
</li>
<li><p>if a specified period of time has passed, thereby releasing the previous active worker</p>
</li>
</ul>
<p>During the activating state, the <strong>active</strong> event in the Service Worker script is carried out. In a typical activate event, we clear files from old caches.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* In sw.js */</span></div><div class="line">self.addEventListener(<span class="string">'activate'</span>, (event) =&gt; &#123;</div><div class="line">  event.waitUntil(</div><div class="line">    <span class="comment">// get all the cache names</span></div><div class="line">    caches.keys().then(<span class="function">(<span class="params">cacheNames</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.all(</div><div class="line">        cacheNames.filter(<span class="function">(<span class="params">cacheName</span>) =&gt;</span> &#123;</div><div class="line"></div><div class="line">        &#125;)</div><div class="line">      )</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Activate"><a href="#Activate" class="headerlink" title="Activate"></a>Activate</h1><p>If the worker is activated, it will emit <code>active</code> event, and take over all fetch from page. If active failed, the worker will be <code>Redundant</code></p>
<h1 id="Redundant"><a href="#Redundant" class="headerlink" title="Redundant"></a>Redundant</h1><p>Once a worker is redundant, it won’t have effect on page.</p>
<h1 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h1><ul>
<li><p>fetch</p>
</li>
<li><p>promise</p>
</li>
<li><p>CacheStorage: store Cache Object</p>
</li>
<li><p>Cache: store Request/Response Pair Object</p>
</li>
</ul>
<p><img src="http://foio.github.io/images/sw-cache-storage.png" alt=""></p>
<h1 id="Example-Cache-Static-Resource"><a href="#Example-Cache-Static-Resource" class="headerlink" title="Example: Cache Static Resource"></a>Example: Cache Static Resource</h1><ul>
<li><p>listen to install to cache static resource</p>
</li>
<li><p>listen to fetch to intercept request and return cached static Resource</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> CACHE_NAME = <span class="string">'my-site-cache-v1'</span></div><div class="line"><span class="keyword">var</span> urlsToCache = [</div><div class="line">  <span class="string">'/'</span>,</div><div class="line">  <span class="string">'/styles/main.css'</span>,</div><div class="line">  <span class="string">'/script/main.js'</span>,</div><div class="line">]</div><div class="line"></div><div class="line"><span class="comment">// cache resource after installation</span></div><div class="line">self.addEventListener(<span class="string">'install'</span>, (event) =&gt; &#123;</div><div class="line">  <span class="comment">// perform install steps</span></div><div class="line">  event.waitUntil(</div><div class="line">    caches.open(CACHE_NAME)</div><div class="line">    .then(<span class="function">(<span class="params">cache</span>) =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'Opened Cache'</span>)</div><div class="line">      <span class="keyword">return</span> cache.addAll(urlsToCache)</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// listen to fetch, use cache if cached</span></div><div class="line">self.addEventListener(<span class="string">'fetch'</span>, (event) =&gt; &#123;</div><div class="line">  event.responseWith(</div><div class="line">    caches.match(event.request)</div><div class="line">    .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">if</span> (response) &#123;</div><div class="line">        <span class="keyword">return</span> response</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> fetch(event.request)</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Version-Controls"><a href="#Version-Controls" class="headerlink" title="Version Controls"></a>Version Controls</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> deleteObsoleteCache = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> caches.keys().then(<span class="function">(<span class="params">keys</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">var</span> all = keys.map(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">if</span> (key.indexOf(CACHE_PREFIX) !== <span class="number">-1</span> &amp;&amp; key.indexOf(CACHE_VERSION) === <span class="number">-1</span>) &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'[SW] Delete cache: '</span> + key)</div><div class="line">        <span class="keyword">return</span> caches.delete(key)</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.all(all)</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Whitelist"><a href="#Whitelist" class="headerlink" title="Whitelist"></a>Whitelist</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// resource whitelist</span></div><div class="line"><span class="keyword">const</span> allAssets = [</div><div class="line">  <span class="string">'//your.cdn.com/app.css'</span>,</div><div class="line">  <span class="string">'//your.cdn.com/app.js'</span>,</div><div class="line">]</div><div class="line"></div><div class="line"><span class="comment">// match</span></div><div class="line"><span class="keyword">const</span> matchAssets = <span class="function">(<span class="params">requestUrl</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> urlObj = <span class="keyword">new</span> URL(requestUrl)</div><div class="line">  <span class="keyword">const</span> noProtocolUrl = urlObj.href.substr(urlObj.protocol.length)</div><div class="line">  <span class="keyword">if</span> (allAssets.includes(noProtocolUrl)) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// listen to fetch, proxy fetch matching Whitelist</span></div><div class="line">self.addEventListener(<span class="string">'fetch'</span>, (event) =&gt; &#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">const</span> requestUrl = event.target.url</div><div class="line">    <span class="keyword">const</span> isGet = event.request.method === <span class="string">'GET'</span></div><div class="line">    <span class="keyword">const</span> assetMatches = matchAssets(requestUrl)</div><div class="line">    <span class="keyword">if</span> (!assetMatches || !isGet) &#123;</div><div class="line">      <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> resource = cacheFirstResponse(event)</div><div class="line">    event.responseWith(resource)</div><div class="line">  &#125; cache (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'[SW] handle fetch event error'</span>)</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Glossary of Terms on InfluxDB]]></title>
      <url>/2017/07/01/Glossary-of-Terms-on-InfluxDB/</url>
      <content type="html"><![CDATA[<h1 id="aggregation"><a href="#aggregation" class="headerlink" title="aggregation"></a>aggregation</h1><p>An InfluxQL function that returns an aggregated value across a set of points</p>
<h1 id="batch"><a href="#batch" class="headerlink" title="batch"></a>batch</h1><p>A collection of points in line protocol format, separated by newlines(0x0A). A batch of points may be submitted to the database using a single HTTP request to the write endpoint. This makes writes via the HTTP API much more performant by drastically reducting the HTTP overhead. InfluxData recommends batch size of 5,000-10,000 points, although different use cases may be better served by significantly smaller or larger batches.</p>
<h1 id="continuous-query-CQ"><a href="#continuous-query-CQ" class="headerlink" title="continuous query(CQ)"></a>continuous query(CQ)</h1><p>An InfluxQL query that runs automatically and periodically within a database. Continuous queries require a function in the <code>SELECT</code> clause and must include a <code>GROUP BY time()</code> clause.</p>
<h1 id="database"><a href="#database" class="headerlink" title="database"></a>database</h1><p>A logical container for users, retention policies, continuous queries, and time series data.</p>
<h1 id="duration"><a href="#duration" class="headerlink" title="duration"></a>duration</h1><p>The attribute of the retention policy that determines how long InfluxDB stores data. Data older than the duration are automatically dropped from the database.</p>
<h1 id="field"><a href="#field" class="headerlink" title="field"></a>field</h1><p>The key-value pair in InfluxDB’s data structure that records metadata and the actual data value. Fields are required in InfluxDB’s data structure and they are not indexed - queries on field values scan all points that match the specified time range and , as a result, are not performant relative to tags.</p>
<blockquote>
<p>Query tip: Compare fields to tags: tags are indexed</p>
</blockquote>
<h1 id="field-key"><a href="#field-key" class="headerlink" title="field key"></a>field key</h1><p>The key part of the key-value pair that makes up a field. Field keys are strings and they store metadata.</p>
<h1 id="field-set"><a href="#field-set" class="headerlink" title="field set"></a>field set</h1><p>The collection of field keys and field values on a point.</p>
<h1 id="field-value"><a href="#field-value" class="headerlink" title="field value"></a>field value</h1><p>The value part of the key-value pair that makes up a field. Field values are the actual data: they can be strings, floats, integers, or booleans. A field value is always associated with a timestamp.</p>
<p>Field values are not indexed - queries on field values scan all points that match the specified time range and, as a result, are not performant.</p>
<h1 id="function"><a href="#function" class="headerlink" title="function"></a>function</h1><p>InfluxQL aggregation, selectors, and transformations.</p>
<h1 id="identifier"><a href="#identifier" class="headerlink" title="identifier"></a>identifier</h1><p>Tokens that refer to continuous query names, database names, field keys, measurement names, retention policy names, subscription names, tag keys and user names.</p>
<h1 id="line-protocol"><a href="#line-protocol" class="headerlink" title="line protocol"></a>line protocol</h1><p>The text based format for writing points to InfluxDB.</p>
<h1 id="measurement"><a href="#measurement" class="headerlink" title="measurement"></a>measurement</h1><p>The part of InfluxDB’s structure that describes the data stored in the associated fields. Measurements are strings.</p>
<h1 id="metastore"><a href="#metastore" class="headerlink" title="metastore"></a>metastore</h1><p>Contains internal information about the status of the system. The metastore contains the user information, databse, retention policies, shard metadata, continuous queries, and subscriptions.</p>
<h1 id="node"><a href="#node" class="headerlink" title="node"></a>node</h1><p>An independent <code>influxd</code> process</p>
<h1 id="now"><a href="#now" class="headerlink" title="now()"></a>now()</h1><p>The local server’s nanosecond timestamp</p>
<h1 id="point"><a href="#point" class="headerlink" title="point"></a>point</h1><p>The part of InfluxDB’s data structure taht consists of a single collection of fields in a series. Each point is uniquely idenfified by its series and timestamp.</p>
<p>You cannot store more than one point with the same timestamp in the same series. Instead, when you write a new point to the same series with the same timestamp as an existing point in that series, the field set becomes the union of the old field set and the new field set, where any ties tgo to the new field set.</p>
<h1 id="query"><a href="#query" class="headerlink" title="query"></a>query</h1><p>An operation that retrieves data from InfluxDB.</p>
<h1 id="replication-factor"><a href="#replication-factor" class="headerlink" title="replication factor"></a>replication factor</h1><p>The attribute of the retention policy that determines how many copies of the data are stored <strong>in the cluster</strong>.</p>
<blockquote>
<p>Replication factors do not seve a purpose with single node instances.</p>
</blockquote>
<h1 id="retention-policy-RP"><a href="#retention-policy-RP" class="headerlink" title="retention policy (RP)"></a>retention policy (RP)</h1><p>The part of InfluxDB’s data structure that describes for how long InfluxDB keeps data(ducation), how many copies of those data are stored in the cluster(<strong>replication factor</strong>), and the time range covered by shard groups(shard group duration). RPs are unique per databse and along with the measurement and tag set define a series.</p>
<p>When you create a database, InfluxDB automatically creates a retention policy called <code>autogen</code> with an infinite duration, a replication factor set to one, and a shard group duration set to seven days.</p>
<h1 id="schema"><a href="#schema" class="headerlink" title="schema"></a>schema</h1><p>How the data are organized in InfluxDB. The fundamentals of the InfluxDB schema are database, retention policies, series, measurements, tag keys, tag values, and field keys.</p>
<h1 id="selector"><a href="#selector" class="headerlink" title="selector"></a>selector</h1><p>An InfluxQL function that returns a single point from the range of specified points.</p>
<h1 id="series"><a href="#series" class="headerlink" title="series"></a>series</h1><p>The collection of data in InfluxDB’s data structure that share a measurement, tag set and retention policy.</p>
<blockquote>
<p>The field set is not part of the series identification.</p>
</blockquote>
<h1 id="series-cardinality"><a href="#series-cardinality" class="headerlink" title="series cardinality"></a>series cardinality</h1><p>The number of unique database, measurement, and tag set combinations in an InfluxDB instance.</p>
<p>For example, assume that an InfluxDB instance has a single database and one measurement. The single measurement has two tag keys: <code>email</code> and <code>status</code>. If there are three different <code>email</code>s, and each email address is associated with two different <code>status</code>, then the series cardinality for the measurement is 6.</p>
<p>Note that, in some cases, simply performing that multiplication may overestimate series cardinality because of the presence of dependent tags.</p>
<h1 id="server"><a href="#server" class="headerlink" title="server"></a>server</h1><p>A machine virtual or physical, that is running InfluxDB. There should only be one InfluxDB process per server.</p>
<h1 id="shard"><a href="#shard" class="headerlink" title="shard"></a>shard</h1><p>A shard contains the actual encoded and compressed data, and is represented by a TSM file on disk. Every shard belongs to one and only one shard group. Multiple shards may exist in a single shard group. Each shard contains a specific set of series. All points falling on a given series in a given shard group will be stored in the same shard(TSM file) on disk.</p>
<h1 id="shard-duration"><a href="#shard-duration" class="headerlink" title="shard duration"></a>shard duration</h1><p>The shard duration determines hwo much time each shard group spans. The specific interval is determined by the <code>SHARD DURATION</code> of the retention policy.</p>
<p>For example, given a retention policy with <code>SHARD DURATION</code> set to <code>1w</code>, each shard group will span a single week and contain all points with timestamps in that week.</p>
<h1 id="shard-group"><a href="#shard-group" class="headerlink" title="shard group"></a>shard group</h1><p>Shard groups are logical container for shards. Shard groups are organized by <strong>time and retention policy</strong>. Every retention policy that contains data has at least one associated shard group. A given shard group contains all shards with data for the interval covered by the shard group. The interval spanned by each shard group is the shard duration.</p>
<h1 id="subscription"><a href="#subscription" class="headerlink" title="subscription"></a>subscription</h1><p>Subscription allows <code>Kapacitor</code> to receive data from InfluxDB in a push model rather than the pull model based on querying data. When Kapacitor is configured to work with InfluxDB, the subscription will automatically push every write for the subscribed databse form InfluxDB to Kapacitor. Subscription can use TCP or UDP for transmitting the writes.</p>
<h1 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h1><p>The key-value pair in InfluxDB’s data structure that records metadata. Tags are an optional part of InfluxDB’s data structure but they are useful for storing commonly-queried metadata; tags are indexed so queries on tags are performant</p>
<h1 id="tag-key"><a href="#tag-key" class="headerlink" title="tag key"></a>tag key</h1><p>The key part of the key-value pair that makes up a tag. Tag keys are strings and they store metadata. Tag keys are indexed so queires on tag keys are performant.</p>
<h1 id="tag-set"><a href="#tag-set" class="headerlink" title="tag set"></a>tag set</h1><p>The collection of tag keys and tag values on a point.</p>
<h1 id="tag-value"><a href="#tag-value" class="headerlink" title="tag value"></a>tag value</h1><p>The value part of the key-value pair that makes up a tag. Tag values are strings and they store metadata. Tag values are indexed so queries on tag values are performant.</p>
<h1 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp"></a>timestamp</h1><p>The date and time associated with a point. All time in influxDB is UTC.</p>
<h1 id="transformation"><a href="#transformation" class="headerlink" title="transformation"></a>transformation</h1><p>An InfluxQl function that returns a value or a set of values calculated from specified points, but does not return an aggregated value across those points.</p>
<h1 id="tsm-Time-Structured-Merge-Tree"><a href="#tsm-Time-Structured-Merge-Tree" class="headerlink" title="tsm (Time Structured Merge Tree)"></a>tsm (Time Structured Merge Tree)</h1><p>The purpose-built data storage format for InfluxDB. TSM allows for greater compaction and higher write and read throughput than exsiting B+ or LSM tree implementations.</p>
<h1 id="user"><a href="#user" class="headerlink" title="user"></a>user</h1><p>There are two kinds of users in InfluxDB:</p>
<ul>
<li><p><em>Admin users</em> have <code>READ</code> and <code>WRITE</code> access to all database and full across to administrative queries and user management commands.</p>
</li>
<li><p><em>Non-admin users</em> have <code>READ</code>, <code>WRITE</code>, or <code>ALT</code> (both <code>READ</code>, <code>WRITE</code>) access to per database.</p>
</li>
</ul>
<p>When authentication is enabled, InfluxDB only executes HTTP requests that are spent with a valid username and password.</p>
<h1 id="values-per-second"><a href="#values-per-second" class="headerlink" title="values per second"></a>values per second</h1><p>The preferred measurement of the rate at which data are persisted to InfluxDB. Write speeds are generally quoted in values per second.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[APIs of InfluxDB]]></title>
      <url>/2017/06/30/APIs-of-InfluxDB/</url>
      <content type="html"><![CDATA[<p>The InfluxDB API provides a simple way interact with the database. It uses HTTP response codes, HTTP authentication, JWT Token, and basic authentication and responses are returned in JSON.</p>
<p>The following sections assume your InfluxDB instance is running on <code>localhost</code> port <code>8086</code> and HTTPS is not enabled.</p>
<h1 id="Endpoints"><a href="#Endpoints" class="headerlink" title="Endpoints"></a>Endpoints</h1><table>
<thead>
<tr>
<th style="text-align:left">Endpoint</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/ping</td>
<td style="text-align:left">use <code>/ping</code> to check the status of your InfluxDB instance and your version of InfluxDB</td>
</tr>
<tr>
<td style="text-align:left">/query</td>
<td style="text-align:left">use <code>/query</code> to query data and manage databsae, retention policies and users</td>
</tr>
<tr>
<td style="text-align:left">/write</td>
<td style="text-align:left">use <code>/write</code> to write data to a pre-exising databse</td>
</tr>
</tbody>
</table>
<h2 id="ping"><a href="#ping" class="headerlink" title="/ping"></a>/ping</h2><p>The ping endpoint accepts both <code>GET</code> and <code>POST</code> HTTP requests. Use this endpoint to check the status of your InfluxDB instance and your version of InfluxDB.</p>
<h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET http://localhost:8086/ping</div><div class="line"></div><div class="line">HEAD http://localhost:8086/ping</div></pre></td></tr></table></figure>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Extract the version of your InfluxDB instance in the <code>X-Influxdb-Version</code> field of the header</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ curl -sl -I localhost:8086/ping</div><div class="line"></div><div class="line">HTTP/1.1 204 No Content</div><div class="line">Content-Type: application/json</div><div class="line">Request-Id: [...]</div><div class="line">X-Influxdb-Version: 1.2.x</div><div class="line">Date: Wed, 01 Mar 2017 00:09:51 GMT</div></pre></td></tr></table></figure>
<h3 id="Status-Codes-and-Responses"><a href="#Status-Codes-and-Responses" class="headerlink" title="Status Codes and Responses"></a>Status Codes and Responses</h3><p>The response body is empty</p>
<table>
<thead>
<tr>
<th style="text-align:center">HTTP Status Code</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">      204</td>
<td style="text-align:center">Success! Your InfluxDB instance is up and running</td>
</tr>
</tbody>
</table>
<h2 id="query"><a href="#query" class="headerlink" title="/query"></a>/query</h2><p>The <code>/query</code> endpoint accepts <code>GET</code> and <code>POST</code> HTTP requests. Use this endpoint to query data and manage databases, retention policies, and users.</p>
<h3 id="Definition-1"><a href="#Definition-1" class="headerlink" title="Definition"></a>Definition</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET http://localhost:8086/query</div><div class="line"></div><div class="line">POST http://localhost:8086/query</div></pre></td></tr></table></figure>
<h3 id="Verb-usage"><a href="#Verb-usage" class="headerlink" title="Verb usage"></a>Verb usage</h3><table>
<thead>
<tr>
<th style="text-align:center">verb</th>
<th style="text-align:center">Query Type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">use for all queries that start with <code>SETECT</code>, <code>SHOW</code></td>
</tr>
<tr>
<td style="text-align:center">POST</td>
<td style="text-align:center">use for all queries that start with <code>ALTER</code>, <code>CREATE</code>, <code>DELETE</code>, <code>DROP</code>, <code>GRANT</code>, <code>KILL</code>, <code>REVOKE</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>THe only exceptions are <code>SELECT</code> queries that include an <code>INTO</code> <strong>clause</strong>. Those <code>SELECT</code> queries require a <code>POST</code> request.</p>
</blockquote>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><h5 id="Example-1-Query-data-with-a-SELECT-statement"><a href="#Example-1-Query-data-with-a-SELECT-statement" class="headerlink" title="Example 1: Query data with a SELECT statement"></a>Example 1: Query data with a <code>SELECT</code> statement</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">curl -G <span class="string">'http://localhost:8086/query?db=mydb'</span> --data-urlencoded <span class="string">'q=SELECT * FROM "mymeas"'</span></div><div class="line"></div><div class="line">&#123;<span class="string">"results"</span>:[&#123;<span class="string">"statement_id"</span>:0,<span class="string">"series"</span>:[&#123;<span class="string">"name"</span>:<span class="string">"mymeas"</span>,<span class="string">"columns"</span>:[<span class="string">"time"</span>,<span class="string">"myfield"</span>,<span class="string">"mytag1"</span>,<span class="string">"mytag2"</span>],<span class="string">"values"</span>:[[<span class="string">"2017-03-01T00:16:18Z"</span>,33.1,null,null],[<span class="string">"2017-03-01T00:17:18Z"</span>,12.4,<span class="string">"12"</span>,<span class="string">"14"</span>]]&#125;]&#125;]&#125;</div></pre></td></tr></table></figure>
<p>The <code>mymeas</code> <strong>measurement</strong> has two points. The first point has the <strong>timestamp</strong> <code>2017-03--1T00:15:18Z</code>, a <code>myfield</code> value of <code>33.1</code> and no tag values for the <code>mytag1</code> and <code>mytag2</code> tag keys.</p>
<p>The second point has the timestamp <code>2017-03--1T00:18:18Z</code>, a <code>myfield</code> value of <code>12</code>, a <code>mymeas</code> value of <code>12</code>, a <code>mytag1</code> value of <code>12</code> and a <code>mytag2</code> value of <code>14</code></p>
<p>The same query in InfluxDB’s Command Line Interface(CLI) returns the following table:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">name: mymeas</div><div class="line">time                   myfield   mytag1   mytag2</div><div class="line">----                   -------   ------   ------</div><div class="line">2017-03--1T00:15:18Z    33.1</div><div class="line">2017-03--1T00:18:18Z    12        12       14</div></pre></td></tr></table></figure>
<h5 id="Example-2-Query-data-with-a-SELECT-statement-and-an-INTO-clause"><a href="#Example-2-Query-data-with-a-SELECT-statement-and-an-INTO-clause" class="headerlink" title="Example 2: Query data with a SELECT statement and an INTO clause"></a>Example 2: Query data with a <code>SELECT</code> statement and an <code>INTO</code> clause</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -XPOST <span class="string">'http://localhost:8086/query?db=mydb'</span> --data-urlencoded <span class="string">'q=SELECT * INTO "newmeas" FROM "mymeas"'</span></div></pre></td></tr></table></figure>
<blockquote>
<p><code>SELECT</code> queries that include and <code>INTO</code> clause require a <code>POST</code> requests</p>
</blockquote>
<h5 id="Example-3-Create-a-database"><a href="#Example-3-Create-a-database" class="headerlink" title="Example 3: Create a database"></a>Example 3: Create a database</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -XPOST <span class="string">'http://localhost:8086/query'</span> --data-urlencoded <span class="string">'q=CREATE DATABASE "mydb"'</span></div></pre></td></tr></table></figure>
<p>A successful <code>CREATE DATABASE</code> query returns no additional information.</p>
<h4 id="Query-String-Parameter"><a href="#Query-String-Parameter" class="headerlink" title="Query String Parameter"></a>Query String Parameter</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Query String Parameter         |                                            Optional/Required                                             |                                                                                Definition</div></pre></td></tr></table></figure>
<p>:———————————–: | :——————————————————————————————————: | :———————————————————————————————————————————————————————–: chunked=[true | &lt;number_of_points] | Optional | Returns points in streamed batches instead of in a single response. If set to <code>true</code>, InfluxDB chunks responses by series or by every 10,000 point, whichever occurs first. It set to a specific value, InfluxDB chunks responses by series or by that number of points db=</p>
<database_name><br></database_name>

<p> | Required for database-dependent queries(most <code>SELECT</code> queries and <code>SHOW</code> queries require this parameter) | Sets the target database for the query epoch=[ns,u,ms,s,m,h] | Optional | Returns epoch timestamps with the specified precision. By default, InfluxDB returns timestamps in RFC3339 format with nanosecond precision. Both <code>u</code> indicate microsecond p=</p>
<password><br></password>

<p> | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the password for authentication if you’ve enabled authentication. Use with the query string parameter <code>u</code> pretty=true | Optional | Enables pretty-printed JSON output. While this is useful for debugging it is not recommended for production use as it consumes unnecessary network bandwidth u=</p>
<username><br></username>

<p> | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the username for authentication if you’ve enabled authentication. The user must have read access to the database. Use with the query string parameter <code>p</code></p>
<blockquote>
<p>In versions 1.2.0 and 1.2.1, InfluxDB automatically truncates the number of rows returned for requests without the <code>chunked</code> parameter. By default, the maximum number of rows returned is set to 10000, if a query has more than 10000 rows to return, InfluxDB includes a <code>&#39;partial&#39;: true</code> tag in the response body.</p>
<p>The HTTP API also supports basic authentication. Use basic authentication if you’ve enabled authentication and aren’t using the query string parameter <code>u</code> and <code>p</code>.</p>
</blockquote>
<h5 id="Example-Create-a-database-using-HTTP-authentication"><a href="#Example-Create-a-database-using-HTTP-authentication" class="headerlink" title="Example: Create a database using HTTP authentication"></a>Example: Create a database using HTTP authentication</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -XPOST <span class="string">'http://localhost:8086/query?u=myusername&amp;p=mypassword'</span> --data-urlencoded <span class="string">'q=CREATE DATABASE "mydb"'</span></div></pre></td></tr></table></figure>
<h2 id="write"><a href="#write" class="headerlink" title="/write"></a>/write</h2><p>The <code>/write</code> endpoint accepts <code>POST</code> HTTP requests. Use this endpoint to write data to a pre-existing databse.</p>
<h3 id="Definition-2"><a href="#Definition-2" class="headerlink" title="Definition"></a>Definition</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">POST http://localhost:8086/write</div></pre></td></tr></table></figure>
<h3 id="Query-String-Parameter-1"><a href="#Query-String-Parameter-1" class="headerlink" title="Query String Parameter"></a>Query String Parameter</h3><pre><code>Query String Parameter                 | Optional/Required                                                                         | Description
</code></pre><p>:—————————————————: | :—————————————————————————————- | :————————————————————————————————————————————————————–<br>                  consistency=[any                    | one                                                                                       | quorum                                                                                                                                                          | all] | Optional, available with InfluxEnterprise clusters only | Sets the write consistency for the point. InfluxDB assumes that the write consistency is <code>one</code> if you do not specify <code>consistency</code><br>             db=</p>
<p><database><br></database>              | Required                                                                                  | Sets the target database for the write<br>             p=</p>
<p><password><br></password>               | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the password for authentication if you’ve enabled authentication. Use with the query string parameter <code>u</code><br>               precision=[ns,u,ms,m,h]                | Optional                                                                                  | Sets the precision for the supplied Unix time values. InfluxDB assumes that timestamps are in nanoseconds if you do not specify <code>precision</code><br>rp=</p>
<p><retention_policy_name><br></retention_policy_name> | Optional                                                                                  | Sets the target retention policy for the write. InfluxDB writes to the <code>DEFAULT</code> retention policy if you do not specify a retention policy<br>             u=</p>
<p><username><br></username>               | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the username for authentication if you’ve enabled authentication. The user must have write access to the database. Use with the query string parameter <code>p</code></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Writing Data in InfluxDB with HTTP API]]></title>
      <url>/2017/06/30/Writing-Data-in-InfluxDB-with-HTTP-API/</url>
      <content type="html"><![CDATA[<h1 id="Create-a-database-using-the-HTTP-API"><a href="#Create-a-database-using-the-HTTP-API" class="headerlink" title="Create a database using the HTTP API"></a>Create a database using the HTTP API</h1><p>To create a database send a <code>POST</code> request to the <code>/query</code> endpoint and set the URL parameter <code>q</code> to <code>CREATE DATABASE &lt;new_database_name&gt;</code>. The example below sends a request to InfluxDB running on <code>locahost</code> and create the database <code>mydb</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -i -XPOST http://localhost:8086/query --data-urlencoded <span class="string">"q=CREATE DATABASE mydb"</span></div></pre></td></tr></table></figure>
<h1 id="Writing-data-using-the-HTTP-API"><a href="#Writing-data-using-the-HTTP-API" class="headerlink" title="Writing data using the HTTP API"></a>Writing data using the HTTP API</h1><p>The HTTP API is the primary means of writing data into InfluxDB, by sending <code>POST</code> requests to the <code>/write</code> endpoint. The example below writes a single point to the <code>mydb</code> database. The data consist of the <strong>measurement</strong> <code>cpu_load_short</code>. the <strong>tag keys</strong> <code>host</code> and <code>region</code> with the <strong>tag values</strong> <code>server01</code> and <code>us-west</code>, the <strong>field key</strong> <code>value</code> with a <strong>field value</strong> of <code>0.64</code> and the <strong>timestamp</strong> <code>434055562000000000</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -i -XPOST <span class="string">'http://localhost:8086/write?db=mydb'</span> --data-binary <span class="string">'cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000'</span></div></pre></td></tr></table></figure>
<p>When writing points, you must specify an existing database in the <code>db</code> query parameter. Points will be written to <code>db</code>‘s default retention policy if you do not supply a retention policy via the <code>rp</code> query parameter.</p>
<p>The body of the POST - we call this the <code>Line Protocol</code> - contains the time-series data that you wish to store. They consist of a <strong>measurement</strong>, <strong>tags</strong>, <strong>fields</strong>, and a <strong>timestamp</strong>. InfluxDB requires a measurement name.</p>
<p>Strictly speaking, tags are optional but most series include tags to differentiate data sources and to make querying both easy and efficient. Both tag keys and tag values are strings.</p>
<p>Field keys are required and always strings, and <strong>by default</strong>, field values are floats. The timestamp - supplied at the end of the line in Unix time in nanoseconds since January 1, 1970 UTC - is optional. If you do not specify a timestamp InfluxDB uses the server’s local nanoseconds timestamp in Unix epoch.</p>
<p>Anything that has to do with tim ein InfluxDB is always UTC.</p>
<h2 id="Writing-multiple-points"><a href="#Writing-multiple-points" class="headerlink" title="Writing multiple points"></a>Writing multiple points</h2><p>Post multiple points to multiple series at the same time by separating each point with a new line. Batching points in this manner results in much higher performance.</p>
<p>The following example writes three points to the database <code>mydb</code>.</p>
<p>The first point belongs to the series with the measurement <code>cpu_load_short</code> and tag set <code>host-server02</code> and has the server’s local timestamp</p>
<p>The second point belongs to the series with the measurement <code>cpu_load_short</code> and tag set <code>host=server02,region=us-west</code> and has the specified timestamp <code>1422568543702900257</code>.</p>
<p>The third point has the same specified timestamp as the second point, but it is written to the series with the measruement <code>cpu_load_short</code> and tag set <code>direction=in,host=server01,region=us-west</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -i -XPOST <span class="string">'http://localhost:8086/write?db=mydb'</span> --data-binary <span class="string">'cpu_load_short,host=server02 value=0.67 cpu_load_short,host=server02,region=us-west value=0.5 cpu_load_short,direction=in,host=server01,region=us-west value=0.2'</span></div></pre></td></tr></table></figure>
<h2 id="Writing-points-from-a-file"><a href="#Writing-points-from-a-file" class="headerlink" title="Writing points from a file"></a>Writing points from a file</h2><p>Write points from a <strong>file</strong> by passing <code>@filename</code> to <code>curl</code>. The data in the file should follow InfluxDB’s <strong>line protocol syntax</strong></p>
<p>Example of a properly-formatted file(<code>cpu_data.txt</code>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cpu_load_short,host=server02 value=0.2</div><div class="line">cpu_load_short,host=server02,region=us-west value=0.5</div><div class="line">cpu_load_short,direction=in,host=server01,region=us-west value=0.2</div></pre></td></tr></table></figure>
<p>Write the data in <code>cpu_data.txt</code> to the <code>mydb</code> datbase with:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -i -XPOST <span class="string">'http://localhost:8086/write?db=mydb'</span> --data-binary @cpu_data.txt</div></pre></td></tr></table></figure>
<blockquote>
<p>Note: If your data file has more than 5000 points, it may be necessary to split that file into several files in order to write your data in batches to influxDB. By default, the HTTP request times out after five seconds. InfluxDB will still attempt to write the points after that time out but there will be no confirmation that they were successfully written.</p>
</blockquote>
<h2 id="Schemaless-Design"><a href="#Schemaless-Design" class="headerlink" title="Schemaless Design"></a>Schemaless Design</h2><p>InfluxDB is a schemaless database. You can add new measurement, tags, and fields at any time. Note that if you attempt to write data with a different type than previous used(for example, writing a string to a field that previously accepted integers), InfluxDB will reject those data.</p>
<h2 id="HTTP-response-summary"><a href="#HTTP-response-summary" class="headerlink" title="HTTP response summary"></a>HTTP response summary</h2><ul>
<li><p>2xx: If you write request received <code>HTTP 204 No Content</code>, it was a success</p>
</li>
<li><p>4xx: InfluxDB could not understand the request</p>
</li>
<li><p>5xx: The system is overloaded or significantly impaired.</p>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Querying InfluxDB with the HTTP API]]></title>
      <url>/2017/06/30/Querying-InfluxDB-with-the-HTTP-API/</url>
      <content type="html"><![CDATA[<p>The HTTP API is the primary means for querying data in InfluxDB.</p>
<p>To perform a query send a <code>GET</code> request to the <code>/query</code> endpoint, set the URL parameter <code>db</code> as the target database, and set the URL parameter <code>q</code> as your query.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -G <span class="string">'http://localhost:8086/query?pretty=true'</span> --data-urlencode <span class="string">"db=mydb"</span> --data-urlencode <span class="string">"q=SELECT \"value\" FROM \"cpu_load_short\" WHERE \"region\"='us-west'"</span></div></pre></td></tr></table></figure>
<p>InfluxDB returns JSON. The results of your query appear in the <code>&#39;result&#39;</code> array. If an error occurs, InfluxDB sets an <code>&#39;error&#39;</code> key with an explanation of the error.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"results"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"statement_id"</span>: <span class="number">0</span>,</div><div class="line">      <span class="attr">"series"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"name"</span>: <span class="string">"cpu_load_start"</span>,</div><div class="line">          <span class="attr">"columns"</span>: [</div><div class="line">            <span class="string">"time"</span>,</div><div class="line">            <span class="string">"value"</span></div><div class="line">          ],</div><div class="line">          <span class="attr">"values"</span>: [</div><div class="line">            [</div><div class="line">                <span class="string">"2015-01-29T21:55:43.702900257Z"</span>,</div><div class="line">                <span class="number">2</span></div><div class="line">            ],</div><div class="line">            [</div><div class="line">                <span class="string">"2015-01-29T21:55:43.702900257Z"</span>,</div><div class="line">                <span class="number">0.55</span></div><div class="line">            ],</div><div class="line">            [</div><div class="line">                <span class="string">"2015-06-11T20:46:02Z"</span>,</div><div class="line">                <span class="number">0.64</span></div><div class="line">            ]</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Note: Appending <code>pretty=true</code> to the URL enables pretty-printed JSON output. While this is useful for debugging or when queryting directly with tools like <code>curl</code>, it is not recommended for production use as it consumes unnecessary network bandwidth.</p>
</blockquote>
<h1 id="Multiple-queries"><a href="#Multiple-queries" class="headerlink" title="Multiple queries"></a>Multiple queries</h1><p>Send multiple queries to InfluxDB in a single API call. Simply delimit each query using a semicolon</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -G <span class="string">'http://localhost:8086/query?pretty=true'</span> --data-urlencode <span class="string">"db=mydb"</span> --data-urlencode <span class="string">"q=SELECT \"value\" FROM \"cpu_load_short\" WHERE \"region\"='us-west';SELECT count(\"value\") FROM \"cpu_load_short\" WHERE \"region\"='us-west'"</span></div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Simple about InfluxDB]]></title>
      <url>/2017/06/30/Simple-about-InfluxDB/</url>
      <content type="html"><![CDATA[<h1 id="Install-InfluxDB-on-MacOS"><a href="#Install-InfluxDB-on-MacOS" class="headerlink" title="Install InfluxDB on MacOS"></a>Install InfluxDB on MacOS</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">brew update</div><div class="line">brew install influxdb</div></pre></td></tr></table></figure>
<p>To run influxDB at startup, run this command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ln -sfv /usr/<span class="built_in">local</span>/opt/influxdb/*.plist ~/Library/LaunchAgents</div></pre></td></tr></table></figure>
<p>Now, to start InfluxDB, run this command(Accept the request of incoming connections in the window that appears)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">influxd -config /usr/<span class="built_in">local</span>/etc/influxdb.conf</div></pre></td></tr></table></figure>
<h1 id="Check-if-InfluxDB-works"><a href="#Check-if-InfluxDB-works" class="headerlink" title="Check if InfluxDB works"></a>Check if InfluxDB works</h1><p>InfluxDB exposes an API with which one can easily check its good working condition. Here’s what you will receive in return for this curl command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">curl -sl -I localhost:8086/ping</div><div class="line">HTTP/1.1 204 No Content</div><div class="line">Content-Type: application/json</div><div class="line">Request-Id: 95b307f8-5d6b-11e7-8002-000000000000</div><div class="line">X-Influxdb-Version: v1.3.0</div><div class="line">Date: Fri, 30 Jun 2017 08:10:31 GMT</div></pre></td></tr></table></figure>
<h1 id="Terminology-difference-with-SQL-database"><a href="#Terminology-difference-with-SQL-database" class="headerlink" title="Terminology, difference with SQL database"></a>Terminology, difference with SQL database</h1><p>Like all non-relational database, InfluxDB for its own vocabulary your need to know before starting</p>
<ul>
<li><p><strong>Measurement</strong> is equivalent to <strong>SQL table</strong></p>
</li>
<li><p><strong>Tags</strong> is similar to a <strong>indexed column</strong> in a SQL database</p>
</li>
<li><p><strong>Fields</strong> is similar to the <strong>column not indexed</strong> in a SQL database</p>
</li>
<li><p><strong>Points</strong> is equivalent to <strong>line(row)</strong> in a SQL database</p>
</li>
</ul>
<h1 id="Database-Management-Methods"><a href="#Database-Management-Methods" class="headerlink" title="Database Management Methods"></a>Database Management Methods</h1><p>There are 6 methods to manage database</p>
<ul>
<li><p>CREATE DATABASE</p>
</li>
<li><p>DROP DATABASE</p>
</li>
<li><p>DROP SETS</p>
</li>
<li><p>DELETE</p>
</li>
<li><p>DROP MEASUREMENT</p>
</li>
<li><p>DROP SHARD</p>
</li>
</ul>
<h2 id="Create-a-Database"><a href="#Create-a-Database" class="headerlink" title="Create a Database"></a>Create a Database</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CREATE DATABASE &lt;database_name&gt; [WITH [DURATION &lt;duration&gt;] [REPLICATION &lt;n&gt;] [SHARD DURATION &lt;shard_duration&gt;] [NAME &lt;retention-policy-name&gt;]]</div></pre></td></tr></table></figure>
<p><strong>Basic Setting</strong></p>
<ul>
<li><p>database_name: name of the database</p>
</li>
<li><p>duration: you can set the period of data retention(conversation) but it makes more sense to implement a retention policy.</p>
</li>
</ul>
<h2 id="Delete-a-database-drop-database"><a href="#Delete-a-database-drop-database" class="headerlink" title="Delete a database (drop database)"></a>Delete a database (drop database)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DROP DATABASE &lt;database_name&gt;</div></pre></td></tr></table></figure>
<h1 id="Establish-a-retention-policy"><a href="#Establish-a-retention-policy" class="headerlink" title="Establish a retention policy"></a>Establish a retention policy</h1><p>InfluxDB incorporates a system of automatic deletion of data. It is the policy of Retention. Spent some time, data is automatically deleted from the base. This mechanism is very convenient because it for a good grasp of size of the base and we don’t have to worry about the maintenance operation. Free to each set the lifetime of any particular measure. If you want to follow the temperature of its microprocessor, one less may be sufficient, instead the retention policy must be more flexible if we want to compare the temperature in a House form one year to the other. It will also think about the system upstream, you don’t have to store a measurement of atmosphere temperature every 10 seconds! A measurement per minutes, 15 minutes, that’s enough. Instead in an industrial process, we certainly want to go for the second… or a lot less.</p>
<p>We therefore for 3 methods</p>
<ul>
<li><p>Create: to create a rule of conservation of data</p>
</li>
<li><p>Alter: to change a rule</p>
</li>
<li><p>Drop: to remove a rule</p>
</li>
</ul>
<h1 id="Create-a-retention-policy"><a href="#Create-a-retention-policy" class="headerlink" title="Create a retention policy"></a>Create a retention policy</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CREATE RETENTION POLICY &lt;name_politic_retention&gt; ON &lt;name_database&gt; DURATION: &lt;duration&gt; REPLICATION: &lt;n&gt; [SHARD DURATION &lt;duration duration_shard&gt;] [DEFAULT]</div></pre></td></tr></table></figure>
<p><strong>Parameters</strong></p>
<ul>
<li><p>name_politic_retention: a short name without spaces of preference</p>
</li>
<li><p>name_database: the database on which applies the retention policy</p>
</li>
<li><p>duration: duration of data retention. It’s a literal expression which must respect the convention InfluxDB</p>
</li>
<li><p>duration_shard: the duration of storage of the data in the buffer zone</p>
</li>
<li><p>n: number of replication(required), put 1 if no cluster installed</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CREATE RETENTION POLICY <span class="string">'one_day_only'</span> WE <span class="string">'NOAA_water_database'</span> DURATION 1 d REPLICATION 1</div></pre></td></tr></table></figure>
<p>This policy keeps the records during a day(one_day_only) based NOAA_water_database. The data are stored in space shard 1 day. Replication 1 indicates that a copy of each item is copied in the cluster.</p>
<h1 id="Modify-retention-policy-alter-retention-policy"><a href="#Modify-retention-policy-alter-retention-policy" class="headerlink" title="Modify retention policy(alter retention policy)"></a>Modify retention policy(alter retention policy)</h1><p>This method allows to change an existing retention policy</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ALTER ...</div></pre></td></tr></table></figure>
<h1 id="Destroyed-a-retention-policy-drop-retention-policy"><a href="#Destroyed-a-retention-policy-drop-retention-policy" class="headerlink" title="Destroyed a retention policy(drop retention policy)"></a>Destroyed a retention policy(drop retention policy)</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DROP RETENTION ...</div></pre></td></tr></table></figure>
<h1 id="Discover-the-InfluxDB-Shell"><a href="#Discover-the-InfluxDB-Shell" class="headerlink" title="Discover the InfluxDB Shell"></a>Discover the InfluxDB Shell</h1><p>Now we know some methods, we will provide to run some test</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Usage of Node-Influx]]></title>
      <url>/2017/06/30/Usage-of-Node-Influx/</url>
      <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>InfluxDB is a time series database, so it would make sense that the concept of time is moderately important when dealing with it.</p>
<p>By default, Influx will store all dates you give to it as a nanosecond precision timestamp, whereas in JavaScript, most of the time we’re dealing with millisecond precision timestamps, which we get from <code>Date.now()</code> or <code>myDate.getTime()</code>. This presents a bit of a problem for us JavaScripters, since nanosecond-precision timestamps are stored as 64-bit unsigned integers that JavaScript simply cannot represent accurately.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">node-influx git:(master) node</div><div class="line">&gt; <span class="number">1475985480231035677</span></div><div class="line"><span class="number">1475985480231035600</span></div></pre></td></tr></table></figure>
<p>This module tries to make dates as easy as possible for you to deal with, and out of the box everything should ‘just work’.</p>
<p>There are three places that dates can get passed around:</p>
<ul>
<li><p>Dates coming rom Influx queries, like <code>select * from my_series</code></p>
</li>
<li><p>Dates being interpolated <em>into</em> Influx queries</p>
</li>
<li><p>Dates being used when writing points on the line protocol, via <code>.writePoints()</code> or <code>.writeMeasurement()</code>.</p>
</li>
</ul>
<p>To deal with this, we introduce a new type called <code>NanoDate</code>. These dates behave just like the normal <code>Date</code> type, but have two additional methods: <code>.getNanoTime()</code> and <code>.getNanoISOString()</code>. They behave just like the normal <code>.getTime()</code> and <code>getISOString</code> methods, but they both return nanosecond-precision strings instead of millisecond-precision numbers and timestamps.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">expect(myNanoDate.getTime()).to.equal(<span class="number">1475985480231</span>)</div><div class="line">expect(myNanoDate.getNanoTime()).to.equal(<span class="string">'1475985480231035677'</span>)</div><div class="line">expect(myNanoDate.toISOString()).to.equal(<span class="string">'2016-10-09T03:58:00.231Z'</span>)</div><div class="line">expect(myNanoDate.toNanoISOString()).to.equal(<span class="string">'2016-10-09T03:58:00.231035677Z'</span>)</div></pre></td></tr></table></figure>
<p>All times returned from Influx queries are parsed to INanoDates. For example you can do something like the following:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">influx.query(<span class="string">'select * from perf'</span>).then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</div><div class="line">  result.forEach(<span class="function"><span class="params">row</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">`Used <span class="subst">$&#123;row.cpu&#125;</span> at <span class="subst">$&#123;row.time.toNanoISOString()&#125;</span>`</span>))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>When writing data to Influx, all write methods accept INanoDates in all situation. This means if you select data from Influx and want to update a data point, you can pass the time right back into <code>write</code> method. (Remember, points within series are unique by their time) If you have a nanosecond timestamp from some external source, you can convert it to INanoDate using <code>toNanoDate</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; toNanoDate &#125; <span class="keyword">from</span> <span class="string">'influx'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> myNanoDate = toNanoDate(<span class="string">'1475985480231035600'</span>)</div><div class="line">expect(myNanoDate.getTime()).to.equal(<span class="number">1475985480231</span>)</div><div class="line">expect(myNanoDate.getNanoTime()).to.equal(<span class="string">'1475985480231035600'</span>)</div><div class="line">expect(myNanoDate.toNanoISOString()).to.equal(<span class="string">'2016-10-09T03:58:00.231035600Z'</span>)</div></pre></td></tr></table></figure>
<p>Finally, if you want to embed a iNanoDate into an Influx query, you should use <code>toNanoString</code> to do so:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">influx.query(<span class="string">`select * from perf where time &gt; "<span class="subst">$&#123;myNanoDate.toNanoISOString()&#125;</span>"`</span>)</div></pre></td></tr></table></figure>
<h1 id="Browser-Setup"><a href="#Browser-Setup" class="headerlink" title="Browser Setup"></a>Browser Setup</h1><p>For Node.js, <code>influx</code> can be installed and you can use it out of the box.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add influx@next</div></pre></td></tr></table></figure>
<p>You can tell Webpack to use this module by adding the following section in your <code>webpack.config.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> http = path.resolve(__dirname, <span class="string">'node_modules/stream-http/index.js'</span>)</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">resolve</span>: &#123;</div><div class="line">    <span class="attr">alias</span>: &#123; http, <span class="attr">https</span>: http &#125;,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><h2 id="Class-Summary"><a href="#Class-Summary" class="headerlink" title="Class Summary"></a>Class Summary</h2><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">ExponentialBackoff</td>
</tr>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">Expression:<br></td>
</tr>
</tbody>
</table>
<p>Expression is used to build filtering expression, like those used in WHERE clauses<br>public | InfluxDB:<br><br>InfluxDB is the public interface to run queries against your database<br>public | Measurement:<br><br>Measurement creates a reference to a particular measurement<br>public | Pool:<br><br>The Pool maintains a list available Influx hosts and dispatches requests to them<br>public | Raw:<br><br>You can provide Raw values to Influx methods to prevent it from escaping your provided string.<br>public | RequestError:<br><br>An RequestError is thrown when a query generates errorful results in a 300&lt;= error &lt;=500<br>public | ResultError:<br><br>An ResultError is thrown when a query generates errorful results from Influx<br>public | ServiceNotAvailableError:<br><br>An ServiceNotAvailableError is returned as an error from requests that result in a &gt;500 error code</p>
<h3 id="interface-Summary"><a href="#interface-Summary" class="headerlink" title="interface Summary"></a>interface Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">IBackoffStrategy:<br></td>
</tr>
</tbody>
</table>
<p>The IBackoffStrategy dictates behavior to use when hosts in the connection pool start failing<br>public | INanoDate:<br><br>An INanoDate is a type of Date that holds a nanosecond-precision unix timestamp<br>public | IResults:<br><br>IResults are returned from the InfluxBD#query mehtod</p>
<h3 id="Function-Summary"><a href="#Function-Summary" class="headerlink" title="Function Summary"></a>Function Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">toNanoDate(timestamp: String): NanoDate:<br></td>
</tr>
</tbody>
</table>
<p>Covers a nanoseconds unix timestamp to a INanoDate for node-influx.</p>
<h3 id="Variable-Summary"><a href="#Variable-Summary" class="headerlink" title="Variable Summary"></a>Variable Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">Precision: Object</td>
</tr>
</tbody>
</table>
<p><string, string="">:<br>Precision is a map of available influx time precision</string,><br>public | escape: Object:<br><br>tagEscaper escapes tag keys, tag values and field keys.</p>
<h3 id="Typedef-Summary"><a href="#Typedef-Summary" class="headerlink" title="Typedef Summary"></a>Typedef Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">FieldType: Number:<br></td>
</tr>
</tbody>
</table>
<p>FieldType is an enumeration of influxDB field data types<br>public | IClusterConfig: Object:<br><br>A IClusterConfig can be provided into <code>new InfluxDB(config)</code> when you have a multiple influx nodes to connect to<br>public | IPingStats: Object:<br><br>IPingStats is returned from InfluxDB#ping<br>public | IPoint: Object<br><br>IPoint is passed to the client’s write methods to store a point in InfluxDB<br>public | IPoolOptions: Object<br><br>Pool options can be passed into the database to configure the behavior of the connection Pool<br>public | IQueryOptions: Object<br><br>The IQueryOptions allows you to configure how queries are run against Influx<br>public | ISchemaOptions: Object<br><br>Schema options can be passed into the <code>new InfluxDB()</code> constructor to help define the shape of your data.<br>public | ISingleHostConfig: Object<br><br>A ISingleHostConfig can be provided into <code>new InfluxDB(config)</code> when you have a single Influx address to connect to<br>public | IWriteOptions: Object<br><br>IWriteOptions configure how points are written in the database.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Example of node-influx]]></title>
      <url>/2017/06/30/Example-of-node-influx/</url>
      <content type="html"><![CDATA[<h1 id="Express-Response-Times-Example"><a href="#Express-Response-Times-Example" class="headerlink" title="Express Response Times Example"></a>Express Response Times Example</h1><p>In this example we’ll create a server which has an index page that prints out ‘hello world’, and a page</p>
<p><code>http://localhost:3000/times</code> which prints out the last ten response times that influxDB gave us.</p>
<p>The end result should look something like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">curl <span class="_">-s</span> localhost:3000</div><div class="line">Hello world</div><div class="line"></div><div class="line">curl <span class="_">-s</span> localhost:3000/<span class="built_in">times</span> | jq</div><div class="line">[</div><div class="line">  &#123;</div><div class="line">    <span class="string">"time"</span>: <span class="string">"2016-10-09T19:13:26.815Z"</span>,</div><div class="line">    <span class="string">"duration"</span>: 205,</div><div class="line">    <span class="string">"host"</span>: <span class="string">"ares.peet.io"</span>,</div><div class="line">    <span class="string">"path"</span>: <span class="string">"/"</span></div><div class="line">    &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>Get started by installing and importing everything we need. This example requires Node 6.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install influx express</div></pre></td></tr></table></figure>
<p>Now create a new file <code>app.js</code> and start writing</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Influx = <span class="built_in">require</span>(<span class="string">'../../'</span>)</div><div class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</div><div class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> app = express()</div></pre></td></tr></table></figure>
<p>Create a new influx client. We tell it to use the <code>express_response_db</code> database by default, and give it some information about the schema we’re writing. It can use this to be smarter about what data formats it writes and do some basic validation for us.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> influx = <span class="keyword">new</span> Influx.InfluxBD(&#123;</div><div class="line">  <span class="attr">host</span>: <span class="string">'localhost'</span>,</div><div class="line">  <span class="attr">database</span>: <span class="string">'express_response_db'</span>,</div><div class="line">  <span class="attr">schema</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">measurement</span>: <span class="string">'response_time'</span>,</div><div class="line">      <span class="attr">fields</span>: &#123;</div><div class="line">        <span class="attr">path</span>: Influx.FieldType.STRING,</div><div class="line">        <span class="attr">duration</span>: Influx.FieldType.INTEGER</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">tags</span>: [</div><div class="line">        <span class="string">'host'</span></div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Now we have a working influx client!</p>
<p>We’ll make sure the database exists and boot the app.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">influx.getDatabaseName()</div><div class="line">.then(<span class="function"><span class="params">names</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (!names.includes(<span class="string">'express_response_db'</span>)) &#123;</div><div class="line">    <span class="keyword">return</span> influx.createDatabase(<span class="string">'express_response_db'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  http.createServer(app).listen(<span class="number">3000</span>, () =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Listening on port 3000'</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line">.catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.error(<span class="string">'Error creating Influx database'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Finally we’ll define the middleware and routes we’ll use. We have a generic middleware that records the time between when requests comes in, and the time we response to them. We also have another route called <code>/times</code> which prints out the last ten timings we recorded.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">app.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> start = <span class="built_in">Date</span>.now()</div><div class="line">  res.on(<span class="string">'finish'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> duration = <span class="built_in">Date</span>.now() - start</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Request to <span class="subst">$&#123;req.path&#125;</span> took <span class="subst">$&#123;duration&#125;</span> ms`</span>)</div><div class="line">    influx.writePoints([</div><div class="line">      &#123;</div><div class="line">        <span class="attr">measurement</span>: <span class="string">'response_times'</span>,</div><div class="line">        <span class="attr">tags</span>: &#123; <span class="attr">host</span>: os.hostname() &#125;,</div><div class="line">        <span class="attr">fields</span>: &#123; duration, <span class="attr">path</span>: req.path &#125;</div><div class="line">      &#125;</div><div class="line">    ]).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">`Error saving data to InfluxDB: <span class="subst">$&#123;err.stack&#125;</span>`</span>)</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">  <span class="keyword">return</span> next()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> res.end(<span class="string">'Hello world'</span>), <span class="built_in">Math</span>.random() * <span class="number">500</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.get(<span class="string">'/times'</span>, (req, res) =&gt; &#123;</div><div class="line">  influx.query(<span class="string">`</span></div><div class="line">      select * from response_times</div><div class="line">      where host = <span class="subst">$&#123;Influx.<span class="built_in">escape</span>.stringLit(os.hostname())&#125;</span></div><div class="line">      order by time desc</div><div class="line">      limit 10</div><div class="line">  `).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">    res.json(result)</div><div class="line">  &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">    res.status(<span class="number">500</span>).send(err.stack)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[snippets of koa middlewares]]></title>
      <url>/2017/06/29/snippets-of-koa-middlewares/</url>
      <content type="html"><![CDATA[<h1 id="koa-compress"><a href="#koa-compress" class="headerlink" title="koa-compress"></a>koa-compress</h1><p>Compress middleware for Koa</p>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> compress = <span class="built_in">require</span>(<span class="string">'koa-compress'</span>)</div><div class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</div><div class="line">app.use(compress(&#123;</div><div class="line">  <span class="attr">filter</span>: <span class="function">(<span class="params">content_type</span>) =&gt;</span> /text/i.test(content_type),</div><div class="line">  <span class="attr">threshold</span>: <span class="number">2048</span>,</div><div class="line">  <span class="attr">flush</span>: <span class="built_in">require</span>(<span class="string">'zlib'</span>).Z_SYNC_FLUSH,</div><div class="line">&#125;))</div></pre></td></tr></table></figure>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><p>The options are passed to <code>zlib</code></p>
<blockquote>
<p>filter: An optional function that checks the response content type to decide whether to compress. By default, it uses <a href="https://github.com/expressjs/compressible" target="_blank" rel="external">compressible</a></p>
<p>threshold: Minimum response size in bytes to compress. Default 1024 byte or 1kb.</p>
</blockquote>
<h3 id="koa-morgan"><a href="#koa-morgan" class="headerlink" title="koa-morgan"></a>koa-morgan</h3><p>HTTP Request logger middleware for node.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> morgan = <span class="built_in">require</span>(<span class="string">'morgan'</span>)</div></pre></td></tr></table></figure>
<h4 id="morgan-format-options"><a href="#morgan-format-options" class="headerlink" title="morgan(format, options)"></a>morgan(format, options)</h4><p>Create a new morgan logger middleware function using the given <code>format</code> and <code>options</code>.</p>
<p>The <code>format</code> argument amay be a string of a predefined name, a string fo a format string, or a function that will produce a log entry.</p>
<p>The <code>format</code> function will be called with three arguments <code>tokens</code>, <code>req</code> and <code>res</code>, where <code>tokens</code> is object with all tokens, <code>req</code> is the HTTP request and <code>res</code> is the HTTP response. The function is expected to return a string that will be the log line, or <code>undefined</code>/<code>null</code> to skip logging.</p>
<h4 id="predefined-format-string"><a href="#predefined-format-string" class="headerlink" title="predefined format string"></a>predefined format string</h4><blockquote>
<p><code>combined</code>: Standard Apache combined log output</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:remote-addr - :remote-user [:date[clf]] <span class="string">":method :url HTTP/:http-version"</span> :status :res[content-length] <span class="string">":referrer"</span> <span class="string">":user-agent"</span></div></pre></td></tr></table></figure>
<blockquote>
<p><code>common</code>: Standard Apache common log output</p>
<p><code>dev</code></p>
<p><code>short</code></p>
<p><code>tiny</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:method :url :status :res[content-length] - :response-time ms</div></pre></td></tr></table></figure>
<h4 id="write-logs-to-a-file"><a href="#write-logs-to-a-file" class="headerlink" title="write logs to a file"></a>write logs to a file</h4><p>Single file</p>
<p>Simple app that will log all request in the Apache combined format to the file <code>access.log</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</div><div class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</div><div class="line"><span class="keyword">const</span> morgan = <span class="built_in">require</span>(<span class="string">'koa-morgan'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> accessLogStream = fs.createWriteStream(__dirname + <span class="string">'/access.log'</span>, &#123; <span class="attr">flags</span>: <span class="string">'a'</span> &#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</div><div class="line"></div><div class="line"><span class="comment">// setup the logger</span></div><div class="line"></div><div class="line">app.use(morgan(<span class="string">'combined'</span>, &#123; <span class="attr">stream</span>: accessLogStream &#125;))</div><div class="line"></div><div class="line">app.use(<span class="function">(<span class="params">ctx</span>) =&gt;</span> &#123;</div><div class="line">  ctx.body = <span class="string">'hello world'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>)</div></pre></td></tr></table></figure>
<h3 id="koa-session"><a href="#koa-session" class="headerlink" title="koa-session"></a>koa-session</h3><p>Simple session middleware for koa. Default is cookie-based session and support external store.</p>
<p><em>Require Node 7.6 or greater for asycn/await support</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'koa-session'</span>)</div><div class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</div><div class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</div><div class="line"></div><div class="line">app.keys = [<span class="string">'some secret hurr'</span>]</div><div class="line"></div><div class="line"><span class="keyword">const</span> CONFIG = &#123;</div><div class="line">  <span class="attr">key</span>: <span class="string">'koa:sess'</span>, <span class="comment">// (string) cookie key, default is koa:sess</span></div><div class="line">  maxAge: <span class="number">86400000</span>, <span class="comment">// (number) in ms, default is 1 day,</span></div><div class="line">  overWrite: <span class="literal">true</span>, <span class="comment">// (boolean) can overwrite or not, default true</span></div><div class="line">  httpOnly: <span class="literal">true</span>, <span class="comment">// (boolean) httpOnly or not, default true</span></div><div class="line">  signed: <span class="literal">true</span>, <span class="comment">// (boolean) signed or not, default true</span></div><div class="line">  rolling: <span class="literal">false</span>, <span class="comment">// (boolean) Force a session identifier cookie to be set on every response. The expiration is reset to the original maxAge.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">app.use(session(CONFIG, app)) <span class="comment">// or if you prefer to default config, you can use =&gt; app.use(session(app))</span></div><div class="line"></div><div class="line">app.use(<span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (ctx.path === <span class="string">'/favicon.ico'</span>) <span class="keyword">return</span></div><div class="line">  <span class="keyword">let</span> n = ctx.session.views || <span class="number">0</span></div><div class="line">  ctx.session.views = ++n</div><div class="line">  ctx.body = n + <span class="string">' views'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'listening on port 3000'</span>)</div></pre></td></tr></table></figure>
<h4 id="Options-1"><a href="#Options-1" class="headerlink" title="Options"></a>Options</h4><p>The cookie name is controlled by the key option, which default to ‘koa:sess’. All other options are passed to <code>ctx.cookies.get()</code> and <code>ctx.cookies.set()</code> allowing you to control security, domain, path and signing among other setting.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[git merge and rebase]]></title>
      <url>/2017/06/14/git-merge-and-rebase/</url>
      <content type="html"><![CDATA[<h1 id="Conceptual-Overview"><a href="#Conceptual-Overview" class="headerlink" title="Conceptual Overview"></a>Conceptual Overview</h1><p>The first thing to understand about <code>git rebase</code> is that it solves the same problem as <code>git merge</code>. Both of these commands are designed to integrate changes from one branch into another branch – they just do it in very different ways.</p>
<p>Consider what happens when you start working on a new feature in a dedicated branch, then another team member updates the <code>master</code> branch with new commits. The results in a forked history which should be familiar to anyone who has used Git as a collaboration tool.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:01b0b04e-64f3-4659-af21-c4d86bc7cb0b/01.svg?cdnVersion=ey" alt=""></p>
<p>Now, let’s say that the new commits in <code>master</code> are relevant to the feature that you’re working on. To incorporate the new commits into your <code>feature</code> branch, you have two options: <code>mergin</code>or <code>rebasing</code>.</p>
<h1 id="The-Merge-Option"><a href="#The-Merge-Option" class="headerlink" title="The Merge Option"></a>The Merge Option</h1><p>The easiest option is to merge the <code>master</code> branch into the <code>feature</code> branch using something like the following:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git checkout feature</div><div class="line">git merge master</div></pre></td></tr></table></figure>
<p>Or you can condense this to a one-liner:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git merge master feature</div></pre></td></tr></table></figure>
<p>This creates a new <code>merge commit</code> in the <code>feature</code> branch that ties together the histories of the both branches, giving you a branch structure that looks like this:</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:e229fef6-2c2f-4a4f-b270-e1e1baa94055/02.svg?cdnVersion=ey" alt=""></p>
<p>Merging is nice because it’s a <code>non-destructive</code> operation. The existing branches are not changed in any way. This avoids all of the potential pitfalls of rebasing.</p>
<p>On the other hand, this also means that the <code>feature</code> branch will have an extraneous merge commit every time you need to incorporate upstream changes. If <code>master</code> is very active, this can pollute your <code>feature</code> branch history quite a bit. While it’s possible to migrate this issue with advanced <code>git log</code> options, it can make it hard to other developers to understand the history of the project.</p>
<h1 id="The-Rebase-Option"><a href="#The-Rebase-Option" class="headerlink" title="The Rebase Option"></a>The Rebase Option</h1><p>As an alternative to merge, you can rebase the <code>feature</code> branch onto <code>master</code> branch using the following commands:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git checkout feature</div><div class="line">git rebase master</div></pre></td></tr></table></figure>
<p>This moves the entire <code>feature</code> branch to begin on the top of the <code>master</code> branch, effectively incorporating all of the new commits in <code>master</code>. But, instead of using a merge commit, rebasing <code>re-writes</code> the project history by creating brand new commits for each commit in the original branch.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:5b153a22-38be-40d0-aec8-5f2fffc771e5/03.svg?cdnVersion=ey" alt=""></p>
<p>The major benefit of rebasing is that you get a much cleaner project history. First, it eliminates the unnecessary merge commits required by <code>git merge</code>. Second, as you can see in the above diagram, rebasing also results in a perfectly linear project history – you can follow the top of <code>feature</code> all the way to the beginning of the project without any forks. This makes it easier to navigate your project with commands like <code>git log</code>.</p>
<h1 id="Interactive-Rebasing"><a href="#Interactive-Rebasing" class="headerlink" title="Interactive Rebasing"></a>Interactive Rebasing</h1><p>Interactive rebasing gives you the opportunity to alter commits as they are moved to the new branch. This is even more powerful than an automated rebase, since it offers complete control over the branch’s commit history. Typically, this is used to clean up a messy history before merging a feature branch into <code>master</code>.</p>
<p>To begin an interactive rebasing session, pass the <code>-i</code> option to the <code>git rebase</code> command.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git checkout feature</div><div class="line">git rebase -i master</div></pre></td></tr></table></figure>
<p>This will open a text editor listing all of the commits that are about to be moved:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pick 33d5b7a Message <span class="keyword">for</span> commit <span class="comment">#1</span></div><div class="line">pick 9480b3d Message <span class="keyword">for</span> commit <span class="comment">#2</span></div><div class="line">pick 5c67e61 Message <span class="keyword">for</span> commit <span class="comment">#3</span></div></pre></td></tr></table></figure>
<p>This listing defines exactly what the branch will look like after the rebase is performed. By changing the <code>pick</code> command and/or reordering the entries, you can make the branch’s history look like whatever you want.</p>
<p>For example, if the 2nd commit fixes a small problem in the 1st commit, you can condense them into a single comit with the <code>fixup</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pick 33d5b7a Message <span class="keyword">for</span> commit <span class="comment">#1</span></div><div class="line">fixup 9480b3d Message <span class="keyword">for</span> commit <span class="comment">#2</span></div><div class="line">pick 5c67e61 Message <span class="keyword">for</span> commit <span class="comment">#3</span></div></pre></td></tr></table></figure>
<p>When you save and close the file, Git will perform the rebase according to your instructions, resulting in project history that looks like the following:</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:fe6942b4-7a60-4464-9181-b67e59e50788/04.svg?cdnVersion=ey" alt=""></p>
<p>Eliminating insignificant commits like this makes your feature’s history much easier to understand. <strong>This is something that <code>git merge</code> simply cannot do</strong>.</p>
<h1 id="The-Golden-Rule-of-Rebasing"><a href="#The-Golden-Rule-of-Rebasing" class="headerlink" title="The Golden Rule of Rebasing"></a>The Golden Rule of Rebasing</h1><p>The Golden Rule of <code>git rebase</code> is to never use it on <em>public</em> branches.</p>
<p>For example, think about what would happen if you rebased <code>master</code> onto your <code>feature</code> branch.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:1d22f018-b2c7-4096-9db1-c54940cf4f4e/05.svg?cdnVersion=ey" alt=""></p>
<p>The rebase moves all of the commits in <code>master</code> onto the tip of <code>feature</code>. The problem is that only happened in <em>your</em> repo. All of the other developers are still working with the origin master. Since rebasing results in brand new commits, Git will think that your <code>master</code> branch’s history has diverged from everybody else’s.</p>
<p>The only way to synchronize the two <code>master</code> branches is to merge them back together, resulting in an extra merge commit <strong>and</strong> two sets of commits that contain the same changes.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Type Compatibility in TypeScript]]></title>
      <url>/2017/06/12/Type-Compatibility-in-TypeScript/</url>
      <content type="html"><![CDATA[<p>Type Compaibility in TypeScript is based on <strong>Structural Subtyping</strong>. Structural Typing is a way of relating types based solely on their members. This is in contrast with nominal typing. Consider the following code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">interface Named &#123;</div><div class="line">  <span class="attr">name</span>: string</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  name: string</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> p: Named</div><div class="line"><span class="comment">// OK, because of structural typing</span></div><div class="line">p = <span class="keyword">new</span> Person()</div></pre></td></tr></table></figure>
<p>In nominally-typed language like C# or Java, the equivalnet code would be error because the <code>Person</code> class does not explicitly describe itself as being an implementor of the <code>Named</code> interface.</p>
<p>TypeScript’s structural type system was designed based on how JavaScript code is typically written. Because JavaScript widely uses anonymous objects like function expressions and object literals, it’s much more natural to represent the kinds of relationship found in JavaScript libraries with a structural type system instead of a nominal one.</p>
<p>The basic rule for TypeScript’s structural type system is the <code>x</code> is compatible with <code>y</code> if <code>y</code> has at least the same members as <code>x</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">interface Named &#123;</div><div class="line">  <span class="attr">name</span>: string;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> x: Named;</div><div class="line"><span class="comment">// y's inferred type is &#123; name: string, location: string &#125;</span></div><div class="line"><span class="keyword">let</span> y = &#123; <span class="attr">name</span>: <span class="string">'Alice'</span>, <span class="attr">location</span>: <span class="string">'Seattle'</span> &#125;</div><div class="line">x = y</div></pre></td></tr></table></figure>
<p>To check whether <code>y</code> can be assigned to <code>x</code>, the compiler checks each property of <code>x</code> to find a corresponding compatible property in <code>y</code>. In this case, <code>y</code> must have a member called <code>name</code> that is a string, so the assignment is allowed.</p>
<p>The same rule for assignment is used when checking function call arguments</p>
<blockquote>
<p>The Type Compatibility in Variable Assignment and Function Arguments.</p>
</blockquote>
<h1 id="Comparing-Two-Functions"><a href="#Comparing-Two-Functions" class="headerlink" title="Comparing Two Functions"></a>Comparing Two Functions</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x = <span class="function">(<span class="params">a: number</span>) =&gt;</span> <span class="number">0</span></div><div class="line"><span class="keyword">let</span> y = <span class="function">(<span class="params">b: number, s: string</span>) =&gt;</span> <span class="number">0</span></div><div class="line"></div><div class="line">y = x <span class="comment">// OK</span></div><div class="line">x = y <span class="comment">// Error</span></div></pre></td></tr></table></figure>
<p>The check if <code>x</code> is assignable to <code>y</code>, we first look at the parameter list. Each parameter in <code>x</code> must have a corresponding parameter in <code>y</code> with a compabile type.</p>
<p>So <code>x</code> is assignable to <code>y</code>, but <code>y</code> is not assignable to <code>x</code></p>
<p>Now let’s look at how return types are treated, using two functions that differs only by their return type:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">name</span>: <span class="string">'Alice'</span> &#125;)</div><div class="line"><span class="keyword">let</span> y = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">name</span>: <span class="string">'Alice'</span>, <span class="attr">location</span>: <span class="string">'Seattle'</span> &#125;)</div><div class="line"></div><div class="line">x = y <span class="comment">// OK</span></div><div class="line">y = x <span class="comment">// Error</span></div></pre></td></tr></table></figure>
<p>The type system enforces that the source function’s return type be a subtype of the target type’s return type.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Mannual of Ownership in Rust ]]></title>
      <url>/2017/06/09/mannual-of-ownership-in-rust/</url>
      <content type="html"><![CDATA[<p>Ownership is Rust’s most unique feature, and it enables Rust to make memory safety guarantees without needing a garbage collector. Therefore, it’s important to understand how ownership works in Rust. In this chapter we’ll talk about ownership as well as several related features: borrowing, slices, and how Rust lays data out in memory.</p>
<h1 id="What-is-Ownership"><a href="#What-is-Ownership" class="headerlink" title="What is Ownership"></a>What is Ownership</h1><p>Rust’s central feature is <em>ownership</em>, although the feature is staightforward to explain, it has deep implications of the rest of the language.</p>
<p>All programs have to manage the way they use a computer’s memory while running. Some languages ahve garbage collecion that constantly looks for no longer used memory as the program runs. In other languages, the programmer must explicitly allocate and free the memory. Rust uses a third approach: <strong>memory is managed through a system of ownership with a set of rules that the compiler checks at compile time.</strong> No run-time costs are iccured for any of the ownership features.</p>
<p>Because ownership is a new concept for many programmers, it does take some time to get used to. The good news is that the more experienced you become with Rust and the rules of the ownership system, the more you’ll be able to naturally develop code that is safe and efficient.</p>
<h1 id="Ownership-Rules"><a href="#Ownership-Rules" class="headerlink" title="Ownership Rules"></a>Ownership Rules</h1><p>First, let’s take a look at the ownership rules.</p>
<blockquote>
<ol>
<li><p>Each Value in Rust has a variable that’s called its <em>owner</em>.</p>
</li>
<li><p>There can only be one owner at a time.</p>
</li>
<li><p>When the owner goes out of scope, the value will be dropped.</p>
</li>
</ol>
</blockquote>
<h1 id="Variable-Scope"><a href="#Variable-Scope" class="headerlink" title="Variable Scope"></a>Variable Scope</h1><p>A scope is the range within a program for which an item is valid.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span> </span>() &#123;</div><div class="line">  <span class="keyword">let</span> s = <span class="string">"hello"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The variable <code>s</code> refers to a string literal, where the value of the string is hardcoded into the text of our program. The variable is valid from the point at which it’s declared until the end of the current <em>scope</em>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;                       <span class="comment">// s is not valid here</span></div><div class="line">  <span class="keyword">let</span> s = <span class="string">"hello"</span>;      <span class="comment">// s is valid here</span></div><div class="line">&#125;                       <span class="comment">// the scope is over, and s is no longer valid.</span></div></pre></td></tr></table></figure>
<ul>
<li><p>When <code>s</code> comes <em>into scope</em> it is valid</p>
</li>
<li><p>It remains so until it goes <em>out of scope</em></p>
</li>
</ul>
<p>At this point, the relationship between scopes and the valid variables are valid is similar to other programming languages. Now we’ll build on top of this understanding by introducing the <code>String</code> type.</p>
<h1 id="The-String-Type"><a href="#The-String-Type" class="headerlink" title="The String Type"></a>The String Type</h1><p>To illustrate the rules of ownership, we need a data type that is complex.</p>
<p>We’ll use <code>String</code> as the example here and concentrate on the parts of <code>String</code> that relate to ownership. These aspects also apply to other complex data types provided by the standard library and that you create.</p>
<p>We’ve already seen string literals, where a string value is hardcoded into our program. String literals are conveient, but they aren’t always suitable for every situation in which you want to use text. One reason is that they’re immutable. Another is that not every string value can be known when we write our code. For these situations, Rust has a second string type, <code>String</code>. This type is allocated on the heap and as such is able to store an amount of text that is unknown to us at compile time. You can create a <code>String</code> from a string literal using the <code>from</code> function, like so:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>)</div></pre></td></tr></table></figure>
<p>The double colon(<code>::</code>) is an operator that allows us to namespace this particular <code>from</code> function under the <code>String</code> type rather than using some sort of name like <code>string_from</code>.</p>
<p>This kind of string <em>can</em> be mutated:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="symbol">'Hello</span>')</div><div class="line">s.push_str(<span class="string">", world!"</span>)</div><div class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, s);</div></pre></td></tr></table></figure>
<p>So why can <code>String</code> be mutated but literals cannot.</p>
<h1 id="Memory-and-Allocation"><a href="#Memory-and-Allocation" class="headerlink" title="Memory and Allocation"></a>Memory and Allocation</h1><p>In the case of a string literal, <em>we know the contents at compile</em> so the text is hardcoded directly in to the final executable, making string literals fast and efficient. But these properties only come from its immutability. Unfortunately, <em>we can’t put a blob of memory into the binary for each piece of text whose size is unknown at compile time</em> and whose size might change while running the program.</p>
<p>With the <code>String</code> type, in order to support a mutable, growable piece of text, we need to allocate an amount of memory on the heap, unknown at compile time, to hold the contents. This means:</p>
<ul>
<li><p>The memory must be requested from the operating system at runtime.</p>
</li>
<li><p>We need a way of returning this memory to the operating system when we’re done with our <code>String</code></p>
</li>
</ul>
<p>That first part is done by us: when we call <code>String::from</code>, its implementation requests the memory if needs. This is pretty much universal in programming languages.</p>
<p>However, the second part is different. In languages with a <code>garbage collector(GC)</code>, the GC keeps track and cleans up memory that isn’t being used anymore, and we, as the programmer, don’t need to think about it. Without a GC, it’s the programmer’s responsibility to identify when memory is no longer being used and call code to explicitly return it, just as we did to request it. Doing this correctly has historically been a difficult programming problem. If we forget, we’ll waste memory. If we do it too early, we’ll have an invalid vairable. If we do it twice, that’s a bug too. We need to pair exactly one <code>allocate</code> with exact one <code>free</code></p>
<p>Rust takes a different path: the memory is automatically returned once the variable that owns it goes out of scope.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"Helloe"</span>); <span class="comment">// s is valid from this point</span></div><div class="line"></div><div class="line">&#125;  <span class="comment">// the scope is over</span></div></pre></td></tr></table></figure>
<p>These is a natural point at which we can return the memory our <code>String</code> needs to operating system: when <code>s</code> goes out of scope. When a variables goes out of scope, Rust calls a special function for us. This function is called <code>drop</code>, and it’s where the author of <code>String</code> can put the code to return the memory. Rust calls <code>drop</code> automatically at the closing <code>}</code>.</p>
<blockquote>
<p>Note: In C++, this pattern of deallocating resources at the end of an item’s lifetime is sometimes called <em>Resource Acquisition Is Initialization(RAII)</em>. The <code>drop</code> function in Rust will be familiar to you if you’ve used RAII patterns.</p>
</blockquote>
<p>This patterns has profound impact on the way Rust code is written. It may seem simple right now, but the behavior of code can be unexpected in more complicated situations when we want to have multiple variables use the data we’ve allocated ont the heap.</p>
<h1 id="Ways-Variables-and-Data-Interact-Move"><a href="#Ways-Variables-and-Data-Interact-Move" class="headerlink" title="Ways Variables and Data Interact: Move"></a>Ways Variables and Data Interact: Move</h1><p>Multiple variables can interact with the same data in different ways in Rust. Let’s look at an example using an integer.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</div><div class="line"><span class="keyword">let</span> y = x;</div></pre></td></tr></table></figure>
<p>Here we got two independent variables <code>x</code> and <code>y</code>, this is because integers are simple values with a known, fixed size, and two <code>5</code> are pushed onto the stack.</p>
<p>Now let’s look at the <code>String</code> version.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>);</div><div class="line"><span class="keyword">let</span> s2 = s1;</div></pre></td></tr></table></figure>
<p>This looks very similar to the previous code, so we might assume that the way it works would be the same: that is, the second line would make a copy of the value in <code>s1</code> and bind it to <code>s2</code>. But this isn’t quite what happens.</p>
<p>To explain this more thoroughly, let’s look at what <code>String</code> looks like under the covers in the Figure.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-01.svg" alt=""></p>
<p>A <code>String</code> is made up of three parts, shown on the left: a pointer to the memory that holds the contents of the string, a length, and a capacity. This group of data is stored on the stack. On the right is the memory on the heap that holds the contents.</p>
<p>The length is how much memory, in bytes, the contents of the <code>String</code> is currently using. The capacity is the total amount of memory, in bytes, that the <code>String</code> has received from the operating system. The difference between length and capacity matters, but not in this context, so far now, it’s fine to ignore the capacity.</p>
<p>When we assign <code>s1</code> to <code>s2</code>, the <code>String</code> data is copied, meaning we copy the pointer, the length and the capacity that are on the stack. We do not copy the data on the heap that the pointer refers to. In other words, the data representation in memory looks like the figure following.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-02.svg" alt=""></p>
<p>Eariler, we said that when a variable goes out of scope, Rust automatically calls the <code>drop</code> function and cleans up the heap memory for the variable. But the fact is that both data pointers pointing to the same location. This is a problem: when <code>s2</code> and <code>s1</code> go out of scope, they will both try to free the same memory. This is known as a <em>double free</em> error. Freeing memory twice can lead to memory corruption, which can potentially lead to security vulnerabilities.</p>
<p>To ensure memory safety, there’s one more detail to what happens in this situation in Rust. Instead of trying to copy the allocated memory, Rust considers <code>s1</code> to no longer be valid and therefore, Rust doesn’t need to free anything when <code>s1</code> goes out of scope. Check out what happens when you try to use <code>s1</code> after <code>s2</code> is created.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</div><div class="line"><span class="keyword">let</span> s2 = s1;</div><div class="line"></div><div class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, s1);</div></pre></td></tr></table></figure>
<p>You’ll get an error like this because Rust prevents you from using the invalidated reference:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">error[E0382]: use of moved value: `s1`</div><div class="line"> --&gt; src/main.rs:4:27</div><div class="line">  |</div><div class="line">3 |  <span class="built_in">let</span> s2 = s1;</div><div class="line">  |     -- value moved here</div><div class="line">4 |  println!(<span class="string">"&#123;&#125;"</span>, s1);</div><div class="line">  |                 ^^ value used here after move</div><div class="line">  |</div><div class="line">  = note: move occurs because `s1` has <span class="built_in">type</span> `std::string::String`,</div><div class="line"><span class="built_in">which</span> does not implement the `Copy` trait</div></pre></td></tr></table></figure>
<p>This action in Rust, similar to <code>shallow copy</code>, it copy pointer, length and capacity in stack, but Rust also invalidates the first variable.</p>
<p>We call it <code>move</code>.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-04.svg" alt=""></p>
<p><code>s1</code> has been invalidated.</p>
<p>That solves our problem, with only <code>s2</code> valid, when it goes out of scope, it alone will freee the memory, and we’re done.</p>
<p>In addition, there’s a design choice that’s implied by this: Rust will never automatically create ‘deep’ copies of your data. Therefore, any <em>automatic</em> copying can be assumed to be inexpensive in terms of runtime performance.</p>
<h1 id="Ways-Variables-and-Data-Interact-Clone"><a href="#Ways-Variables-and-Data-Interact-Clone" class="headerlink" title="Ways Variables and Data Interact: Clone"></a>Ways Variables and Data Interact: Clone</h1><p>If we do want to deeply copy the heap data of the <code>String</code>, not just the stack data, we can use a common method called <code>clone</code>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>);</div><div class="line"><span class="keyword">let</span> s2 = s1.clone();</div><div class="line"><span class="built_in">println!</span>(<span class="string">"s1 = &#123;&#125;, s2 = &#123;&#125;"</span>, s1, s2);</div></pre></td></tr></table></figure>
<p>This works just fine, the heap data does get copied.</p>
<p>When you see a call to <code>clone</code>, you know that some arbitrary code is being executed and that code may be expensive. It’s a visual indicator that something different is going on.</p>
<h1 id="Stack-Only-Data-Copy"><a href="#Stack-Only-Data-Copy" class="headerlink" title="Stack-Only Data: Copy"></a>Stack-Only Data: Copy</h1><p>There’s another wrinkle we haven’t talked about yet. This code using integers.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</div><div class="line"><span class="keyword">let</span> y = x;</div><div class="line"></div><div class="line"><span class="built_in">println!</span>(<span class="string">"x = &#123;&#125;, y = &#123;&#125;"</span>, x, y);</div></pre></td></tr></table></figure>
<p>This code runs correctly because those types like integers that have a <strong>known size</strong> at compile time are stored entirely on the stack, so copied of the actual values are quick to make. That means there’s no reason we would want to prevent <code>x</code> from being valid after we created the variable <code>y</code>. In other words, there’s no difference between deep and shallow copying here, so calling <code>clone</code> wouldn’t do anything differently from the usual shallow copying and we can leave it out.</p>
<p>Rust has a special annotation called the <code>Copy</code> trait that we can place on types like integers that are stored on stack.</p>
<p>If a type has the <code>Copy</code> trait, an older variable is still usable after the assignment. Rust won’t let us annotate a type with the <code>Copy</code> trait if the type, or any of its parts, has implemented the <code>Drop</code> trait. If the type needs something special to happen when the value goes out of scope and we add the <code>Copy</code> annotation to that type, we’ll get a compile time error.</p>
<p>As a general rule, any group of simple scalar values can be <code>Copy</code>, and nothing that requires allocation or is some form of resource is <code>Copy</code>. Here are some of the types that are <code>Copy</code>:</p>
<ul>
<li><p>All the integer types</p>
</li>
<li><p>The boolean type</p>
</li>
<li><p>All the floating point types</p>
</li>
<li><p>Tuples, but only if they contain types a also <code>Copy</code>.</p>
</li>
</ul>
<h1 id="Ownership-and-Functions"><a href="#Ownership-and-Functions" class="headerlink" title="Ownership and Functions"></a>Ownership and Functions</h1><p><strong>The semantics for passing a value to a function are similar to assigning a value to a variable.</strong> Passing a variable to a function <strong>will move or copy</strong>, just like assignment.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span> </span>() &#123;</div><div class="line">  <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>); <span class="comment">// s comes into scope</span></div><div class="line"></div><div class="line">  take_ownership(s); <span class="comment">// s's value moves into the function</span></div><div class="line">                     <span class="comment">// s is no longer valid here</span></div><div class="line">  <span class="keyword">let</span> x = <span class="number">5</span>;         <span class="comment">// x comes into scope</span></div><div class="line"></div><div class="line">  make_copy(x);      <span class="comment">// x would move into the function, but i32 is Copy, so it's okay to still use x afterward.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">take_ownership</span> </span>(some_string: <span class="built_in">String</span>) &#123; <span class="comment">// some_string comes into scope</span></div><div class="line">  <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, some_string);</div><div class="line">&#125; <span class="comment">// here, some_string goes out of scope and `drop` is called. The backing memory is freed.</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">make_copy</span> </span>(some_integer: <span class="built_in">i32</span>) &#123; <span class="comment">//  some_integer comes into scope</span></div><div class="line">  <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, some_integer);</div><div class="line">&#125; <span class="comment">// Here some_integer goes out of scope.</span></div></pre></td></tr></table></figure>
<p>If we tried to use <code>s</code> after the call to <code>take_ownership</code>, Rust would throw a compile time error. These static checks protect us from mistakes.</p>
<h1 id="Return-Values-and-Scope"><a href="#Return-Values-and-Scope" class="headerlink" title="Return Values and Scope"></a>Return Values and Scope</h1><p>Returning values can also transfer ownership.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span> </span>() &#123;</div><div class="line">  <span class="keyword">let</span> s1 = give_ownership(); <span class="comment">// give_ownership moves its return value into s1</span></div><div class="line">  <span class="keyword">let</span> s2 = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>); <span class="comment">// s2 comes into scope</span></div><div class="line">  <span class="keyword">let</span> s2 = take_and_give_back(s2); <span class="comment">// s2 is moved into take_and_give_back, which aslo move its returned value into s2</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">give_ownership</span> </span>() -&gt; <span class="built_in">String</span> &#123;</div><div class="line">  <span class="keyword">let</span> some_string = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>); <span class="comment">// some_string comes into scope</span></div><div class="line">  some_string      <span class="comment">// some_string is returned and moves out to the calling function</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">take_and_give_back</span></span>(a_string: <span class="built_in">String</span>) -&gt; &#123; <span class="comment">// a_string comes into scope</span></div><div class="line">  a_string <span class="comment">// a_string is returned and moves out to the calling function</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It’s possible to return mutiple values using a tuple.</p>
<h2 id="Reference-and-Borrowing"><a href="#Reference-and-Borrowing" class="headerlink" title="Reference and Borrowing"></a>Reference and Borrowing</h2><p>Here is how you would define and use a <code>calculate_length</code> function that has a <em>reference</em> to an object as a parameter instead of taking ownership of the value.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span> </span>() &#123;</div><div class="line">  <span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>);</div><div class="line"></div><div class="line">  <span class="keyword">let</span> len = calculate_length(&amp;s1);</div><div class="line"></div><div class="line">  <span class="built_in">println!</span>(<span class="string">"The length of '&#123;&#125;' is &#123;&#125;."</span>, s1, len);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">calculate_length</span></span>(s: &amp;<span class="built_in">String</span>) - <span class="built_in">usize</span> &#123;</div><div class="line">  s.len()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>First notice that all the tuple code in the variable declaration and the function return value is gone. Second, note that we pass <code>&amp;s1</code> into <code>calculate_length</code>, and in its definition, we take <code>&amp;String</code> rather than <code>String</code>.</p>
<p>These ampersands(&amp;) are <em>reference</em>, and they allow you to refer to some value without taking ownership of it.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-05.svg" alt=""></p>
<p>In this figure, <code>&amp;String s</code> pointing to <code>String s1</code></p>
<p>Let’s take a closer look at the function call here:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>)</div><div class="line"><span class="keyword">let</span> len = calculate_length(&amp;s1)</div></pre></td></tr></table></figure>
<p>The <code>&amp;s1</code> syntax lets us create a reference that <em>refer</em> to the value of <code>s1</code>, but does not own it.</p>
<p><strong>Because it does not own it, the value it points to will not be dropped when the reference goes out of scope.</strong></p>
<p>Likewise, the signature of the function uses <code>&amp;</code> to indicate that the type of the paramter <code>s</code> is a reference.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">calculate_length</span></span>(s: &amp;<span class="built_in">String</span>) -&gt; <span class="built_in">usize</span> &#123; <span class="comment">// s is a reference to a String</span></div><div class="line">  s.len()</div><div class="line">&#125; <span class="comment">// Here, s goes out of the scope. But because it does not have ownership of what it refers to, no drop happens.</span></div></pre></td></tr></table></figure>
<p>The scope in which the variable <code>s</code> is valid is the same as any function parameter’s scope, but we don’t drop what the reference points to when it goes out of scope because we don’t have ownership.</p>
<p>Functions that have references as parameters instead of the actual values mean we won’t need to return the values in order to give back ownership, since we never had ownership.</p>
<p>We call having references as function paramters <code>borrowing</code>. As in real life, if a person owns something, you can borrow it from them, When you’re done, you have to give it back.</p>
<p>If we try to modify something we’re borrowing, it won’t work.</p>
<h2 id="Mutable-References"><a href="#Mutable-References" class="headerlink" title="Mutable References"></a>Mutable References</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span> </span>() &#123;</div><div class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>);</div><div class="line">  change(&amp;<span class="keyword">mut</span> s);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">change</span></span>(some_string: &amp;<span class="keyword">mut</span> <span class="built_in">String</span>) &#123;</div><div class="line">  some_string.push_str(', world')</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>First, we had to change <code>s</code> to be <code>mut</code>. Then we had to create mutable reference with <code>&amp;mut s</code> and accept a mutable reference with <code>some_string: &amp;mut String</code>.</p>
<p>But mutable references have one big restriction: you can only mutable reference to a particular piece of data in a particular scope.</p>
<p>This restriction allows for mutation but in a very controlled fashion. It’s something that new Rustaceans struggle with, because most languages let you mutate whenever you’d like. The benefit of having this restriction is that <em>Rust can prevent data races at compile time</em>.</p>
<p>A <code>data race</code> is a particular type of race condition in which these three behaviors occur:</p>
<ul>
<li><p>Two or more pointers access the same data at the same time.</p>
</li>
<li><p>At least one of the pointers is being used to write to the data.</p>
</li>
<li><p>There’s no mechanism being used to synchrnize access to the data.</p>
</li>
</ul>
<p>Data races cause undefined behavior and can be difficult to diagnose and fix when you’re trying to track them down at runtime. Rust prevents this problem from happening because it won’t even compile code with data race.</p>
<p>As always, we can use curly brackets to create a new scope, allowing for multiple mutable references, just not <em>simultaneous</em> ones:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>);</div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> r1 = &amp;<span class="keyword">mut</span> s;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> r2 = &amp;<span class="keyword">mut</span> s;</div></pre></td></tr></table></figure>
<p>A similar rule exists for combining mutable and immutable references. This code results in an error:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"Hello"</span>);</div><div class="line"><span class="keyword">let</span> r1 = &amp;s; <span class="comment">// no problem</span></div><div class="line"><span class="keyword">let</span> r2 = &amp;s; <span class="comment">// no problem</span></div><div class="line"><span class="keyword">let</span> r3 = &amp;<span class="keyword">mut</span> s; <span class="comment">//BIG PROBLEM, mutable borrow occurs</span></div></pre></td></tr></table></figure>
<p>We also cannot have mutable reference while we have an immutable one.</p>
<p>Users of an immutable reference don’t expect the values to suddently change out from under them.</p>
<h2 id="Dangling-References"><a href="#Dangling-References" class="headerlink" title="Dangling References"></a>Dangling References</h2><p>In languages with pointers, it’s easy to erroneously to create a <em>dangling pointer</em>, a pointer that references a location in memory that may have been given to someone else, by freeing some memory while preserving a pointer to that memory. In Rust, by contrast, the compiler guarantees the references will never be dangling references: if we have a reference to some data, the compiler will ensure that the data will not go out of scope before reference to the data does.</p>
<h2 id="The-Rules-of-References"><a href="#The-Rules-of-References" class="headerlink" title="The Rules of References"></a>The Rules of References</h2><ul>
<li><p>At any given time, you can have <code>either</code> but not both of</p>
<ul>
<li><p>One mutable reference</p>
</li>
<li><p>Any number of immutable references</p>
</li>
</ul>
</li>
<li><p>Referecences must always be valid.</p>
</li>
</ul>
<h2 id="Slices"><a href="#Slices" class="headerlink" title="Slices"></a>Slices</h2><p>Another data type that doesn’t have ownership is the <code>slice</code>. Slices let you reference a configuous sequence of elements in a collection rather tahn the whole collection.</p>
<h2 id="String-Slice"><a href="#String-Slice" class="headerlink" title="String Slice"></a>String Slice</h2><p>A <em>string slice</em> is a reference to part of a <code>String</code>, and looks like this:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"Hello world"</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> hello = &amp;s[<span class="number">0</span>..<span class="number">5</span>];</div><div class="line"><span class="keyword">let</span> world = &amp;s[<span class="number">6</span>..<span class="number">11</span>];</div></pre></td></tr></table></figure>
<p>This is similar to taking a reference to the whole <code>String</code>, but with the extra <code>[0..5]</code> but. Rather than a reference to the entire <code>String</code>, it’s a reference to an internal position in the <code>String</code> and the number of elements that it refers to.</p>
<p>We create slices with a range of <code>[start_index..end_index]</code>, but the slice data structure acutally <strong>stores the starting position and the length of the slice</strong>.</p>
<p>So in the case of <code>let world = &amp;s[6..11];</code>, <code>world</code> would be a slice that contains a pointer to the 6th byte of <code>s</code> and a length of value of 5.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-06.svg" alt=""></p>
<p>With Rust’s <code>..</code> range syntax, if you want to start at the first index(0), you can drop the value before the two periods. In other words</p>
<p>By the same token, if your slice includes the last byte of the <code>String</code>, you can drop the trailing number.</p>
<p>You can also drop both values to take a slice of the entire string.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">first_word</span> </span>(s: &amp;<span class="built_in">String</span>) -&gt; &amp;<span class="built_in">str</span> &#123;</div><div class="line">  <span class="keyword">let</span> bytes = s.as_bytes();</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (i, &amp;item) <span class="keyword">in</span> bytes.iter().enumerate() &#123;</div><div class="line">    <span class="keyword">if</span> item == <span class="string">b' '</span> &#123;</div><div class="line">      <span class="keyword">return</span> &amp;s[<span class="number">0</span>..i]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  &amp;s[..]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="String-Literals-Are-Slices"><a href="#String-Literals-Are-Slices" class="headerlink" title="String Literals Are Slices"></a>String Literals Are Slices</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s = <span class="string">"Hello, World"</span>;</div></pre></td></tr></table></figure>
<p>The type of <code>s</code> here is <code>&amp;str</code>: it’s a slice pointing to the specific point of the binary. This is also why string literals are immutable; <code>&amp;str</code> is an immutable reference.</p>
<h2 id="String-Slices-as-Parameters"><a href="#String-Slices-as-Parameters" class="headerlink" title="String Slices as Parameters"></a>String Slices as Parameters</h2><p>Knowing that you can take slices of literals and <code>String</code>s leads us to one more improvement on <code>first_word</code>, and that’s its signature:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fn</span> <span class="title">first_word</span></span>(s: &amp;<span class="built_in">String</span>) -&gt; &amp;<span class="built_in">str</span> &#123;</div></pre></td></tr></table></figure>
<p>If we have a string slice, we can pass that directly. If we have a <code>String</code>, we can pass a slice of the entire <code>String</code>. Defining a function to take a string slcie instead of a reference to a String makes our API more general and useful without losing any functionality.</p>
<h2 id="Other-Slices"><a href="#Other-Slices" class="headerlink" title="Other Slices"></a>Other Slices</h2><p>String slices, as you might imagine, are specific to strings. But there’s a more general slice type, too.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="keyword">let</span> slice = &amp;a[<span class="number">1</span>..<span class="number">3</span>];</div></pre></td></tr></table></figure>
<p>This slice has the type <code>&amp;[i32]</code>. It works the same way as string slices do, by storing a reference to the first element and the length.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Basic Info of Web Worker]]></title>
      <url>/2017/06/06/Basic-Info-of-Web-Worker/</url>
      <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="keyword">var</span> worker = <span class="keyword">new</span> Worker (<span class="string">'worker.js'</span>)</div><div class="line">worker.postMessage() <span class="comment">// start the worker</span></div></pre></td></tr></table></figure>
<p>postMessage 方法可以接受字符串或 JSON 对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line">worker.addEventListener(<span class="string">'message'</span>, (e) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'worker said: '</span>, e.data)</div><div class="line">&#125;, <span class="literal">false</span>)</div><div class="line"></div><div class="line">worker.postMessage(<span class="string">'hello world'</span>)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// worker.js</span></div><div class="line">self.addEventListener(<span class="string">'message'</span>, (e) =&gt; &#123;</div><div class="line">  self.postMessage(e.data)</div><div class="line">&#125;, <span class="literal">false</span>)</div></pre></td></tr></table></figure>
<p>index.js 中调用 postMessage() 时, worker.js 通过 message 时间处理消息, index.js 的有效信息在 e.data 上.</p>
<p>index.js 和 worker.js 传递的消息是幅值而不是共享(序列化+反序列化)</p>
<p>Example</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"sayHi()"</span>&gt;</span>SayHi<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"unknownCmd()"</span>&gt;</span>unknownCmd<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"stop()"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">output</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">output</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  worker.postMessage(&#123;</div><div class="line">    <span class="attr">cmd</span>: <span class="string">'start'</span>,</div><div class="line">    <span class="attr">msg</span>: <span class="string">'Hi'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">stop</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  worker.postMessage(&#123;</div><div class="line">    <span class="attr">cmd</span>: <span class="string">'stop'</span>,</div><div class="line">    <span class="attr">msg</span>: <span class="string">'Bye'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">unknownCmd</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  worker.postMessage(&#123;</div><div class="line">    <span class="attr">cmd</span>: <span class="string">'foobar'</span>,</div><div class="line">    <span class="attr">msg</span>: <span class="string">'???'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> worker = <span class="keyword">new</span> Worker(<span class="string">'worker.js'</span>)</div><div class="line"></div><div class="line">worker.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'result'</span>).textContent = e.data</div><div class="line">&#125;, <span class="literal">false</span>)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// worker.js</span></div><div class="line">self.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> data = e.data</div><div class="line">  <span class="keyword">switch</span> (data.cmd) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'start'</span>: &#123;</div><div class="line">      self.postMessage(<span class="string">'WORKER STARTED: '</span> + data.msg)</div><div class="line">      <span class="keyword">break</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">case</span> <span class="string">'stop'</span>: &#123;</div><div class="line">      self.postMessage(<span class="string">'WORKER STOPPED: '</span> + data.msg + <span class="string">'. (buttons will no longer work)'</span>)</div><div class="line">      self.close()</div><div class="line">      <span class="keyword">break</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">default</span>: &#123;</div><div class="line">      self.postMessage(<span class="string">'Unknown command: '</span> + data.msg)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;, <span class="literal">false</span>)</div></pre></td></tr></table></figure>
<p>停止 worker 的方法两种</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line">worker.terminate()</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// worker.js</span></div><div class="line">self.close()</div></pre></td></tr></table></figure>
<h1 id="Worker-环境"><a href="#Worker-环境" class="headerlink" title="Worker 环境"></a>Worker 环境</h1><h2 id="Worker-作用域"><a href="#Worker-作用域" class="headerlink" title="Worker 作用域"></a>Worker 作用域</h2><p>在 worker.js 中, self 和 this 都是指 worker 的全局作用域</p>
<h1 id="适用于-worker-的功能"><a href="#适用于-worker-的功能" class="headerlink" title="适用于 worker 的功能"></a>适用于 worker 的功能</h1><p>由于web worker 的多线程行为, 所以他们只能使用 js 功能的子集</p>
<ul>
<li><p>navigator 对象</p>
</li>
<li><p>location 对象</p>
</li>
<li><p>XMLHttpResponse</p>
</li>
<li><p>setTimeout() / clearTimeout() / setInterval() / clearInterval()</p>
</li>
<li><p>应用缓存</p>
</li>
<li><p>使用 importScripts() 方法导入外部脚本</p>
</li>
<li><p>生成其他 worker</p>
</li>
</ul>
<p>worker 无法使用:</p>
<ul>
<li><p>DOM</p>
</li>
<li><p>window 对象</p>
</li>
<li><p>document 对象</p>
</li>
<li><p>parent 对象</p>
</li>
</ul>
<h1 id="加载外部脚本"><a href="#加载外部脚本" class="headerlink" title="加载外部脚本"></a>加载外部脚本</h1><p>worker 可以通过 importScripts() 函数将外部脚本文件或库加载到 worker 中, 该方法采用零个或多个字符串表示要导入的资源名.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// worker.js</span></div><div class="line">importScripts(<span class="string">'script1.js'</span>)</div><div class="line">importScripts(<span class="string">'script2.js'</span>)</div><div class="line"></div><div class="line">importScripts(<span class="string">'script3.js'</span>, <span class="string">'script4.js'</span>)</div></pre></td></tr></table></figure>
<h1 id="添加子-worker"><a href="#添加子-worker" class="headerlink" title="添加子 worker"></a>添加子 worker</h1><ul>
<li><p>subWorker 必须托管在与福网页相同的来源中</p>
</li>
<li><p>subWorker 中的 URI 应相对于 worker 的位置来解析</p>
</li>
</ul>
<h1 id="处理错误"><a href="#处理错误" class="headerlink" title="处理错误"></a>处理错误</h1><p>执行的 worker 发生错误时, 会触发 ErrorEvent, 包含三个属性: filename, lineno, message</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Deep in Viewport]]></title>
      <url>/2017/06/05/Deep-in-Viewport/</url>
      <content type="html"><![CDATA[<p><code>vw</code>(viewport width) and <code>vh</code>(viewport height) are legnth units that represent exactly 1% of the size of any given viewport, regardless of its measurements. <code>rem</code>(short for root em) is also similar in its functionality, although it deals specifically with font sizes, and derives its name from the value fo the font size of the root element – which should default to 16 pixels on most browsers.</p>
<p>There are also a few more viewport units available for use, such as <code>vmin</code> and <code>vmax</code> which refer respectively to 1% of the viewport’s smaller dimension, and 1% of its larger dimension.</p>
<p>Interestingly enough, browsers actually calculate the entire browser window when it comes to width, meaning they factor the scrollbar into this dimension. Should you attempt to set the width of an element to a value of 100vw, it would force a horizontal bar to appear, since you’d be lightly stretching your viewport.</p>
<h1 id="Device-Pixels-and-CSS-Pixels"><a href="#Device-Pixels-and-CSS-Pixels" class="headerlink" title="Device Pixels and CSS Pixels"></a>Device Pixels and CSS Pixels</h1><p>Device Pixels are the kind of pixels we intuitively assume to be ‘right’. These pixels give the formal resolution of whichever device you’re working on, and can be read out from <code>screen.width/height</code>.</p>
<p>If you give a certain element a <code>width: 128px</code>, and your monitor is 1024px wide, and you maximize your browser screen, the element would fit out on your monitor eight times.</p>
<p>If the user zooms, however, this calculation is going to change. If the user zooms to 200%, your element with <code>width: 128px</code> will fit only four times on this 1024px wide monitor.</p>
<p>Zooming as implemented in modern browsers consists of nothing more than ‘stretching up’ pixels. That is, the width of the elemtn is not changed from 128 to 256px, instead <em>the actual pixels</em> are doubled in size. Formally, the element still has width of 128 CSS pixels, even though it happens to take the space of 256px.</p>
<p>In other words, zooming to 200% makes one css pixels grow to four times the size of one device pixels(two times the width, two times the height)</p>
<p>A few images will clarify the concept. Here are four pixels on 100% zoom level. Here CSS px fully overlap with device px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/csspixels_100.gif" alt=""></p>
<p>Let’s zoom out. The CSS pixels start to shrink, meaning that one device px now overlaps several CSS px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/csspixels_out.gif" alt=""></p>
<p>If you zoom in, the opposite happens. The CSS px start to grow, and now one CSS px overlap several device px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/csspixels_in.gif" alt=""></p>
<p>The point is that you are only interested in CSS px. It’s those px that dictate how your style sheet is rendered.</p>
<p>Device px are almost entirely useless to you.</p>
<blockquote>
<p>At zoom level 100% one CSS px is exactly equal to Device px.</p>
</blockquote>
<h1 id="Screen-Size"><a href="#Screen-Size" class="headerlink" title="Screen Size"></a>Screen Size</h1><p><code>screen.width</code> and <code>screen.height</code> means the total width width and height of the user’s screen. <strong>These dimensions are measured in device px because they never change: they’re feature of the monitor and not of the browser.</strong></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_screen.jpg" alt=""></p>
<h1 id="Window-Size"><a href="#Window-Size" class="headerlink" title="Window Size"></a>Window Size</h1><p><code>window.innerWidth</code> and <code>window.innerHeight</code></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_inner.jpg" alt=""></p>
<p>Window Size is measured in CSS px.</p>
<h1 id="Scrolling-Offset"><a href="#Scrolling-Offset" class="headerlink" title="Scrolling Offset"></a>Scrolling Offset</h1><p><code>window.pageXOffset</code> and <code>window.pageYOffset</code> contains the horizontal and vertical scrolling offsets of the document. Thus you can find out how much the user has scrolled.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_page.jpg" alt=""></p>
<p>These properties measured in CSS px.</p>
<h1 id="Viewport"><a href="#Viewport" class="headerlink" title="Viewport"></a>Viewport</h1><p>The function of the viewport is to constrain the element, which is the uppermost containing block of your site.</p>
<p>Suppose you have a liquid layout and one of your sidebar has <code>width: 10%</code>. Now the sidebar neatly grows and shrinks as your resize the browser window. How does it work.</p>
<p>Technically, what happens is that the sidebar gets 10% of the width of its parent. Let’s say the . Normally all block-level element take 100% of the width of their parent ().</p>
<p>So your sidebar get width of 10% of browser.</p>
<p>In theory, the width of the element is restricted by the width of the viewport. The element takes 100% of the width of that viewport.</p>
<p>The viewport, in turn, is exactly equal to the browser window: it’s been defined as such. The viewport is not an HTML construct, so you cannot influence it by CSS. It just has the width and height of the browser window – on desktop. On mobile it’s quite a bit more complicated.</p>
<p>White <code>width: 100%</code> works fine at 100% zoom, if we zoomed in the viewport has become smaller than the total width of the site, the content will spills out of the element, but that element has <code>overflow: visible</code>, which means that the spilled-out content will be show in any case.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_100percent.jpg" alt=""></p>
<h1 id="Measuring-the-viewport"><a href="#Measuring-the-viewport" class="headerlink" title="Measuring the viewport"></a>Measuring the viewport</h1><p>The Viewport size can be found in <code>document.documentElement.clientHeight</code> and <code>document.documentElement.clientWidth</code></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_client.jpg" alt=""></p>
<p>If you know your DOM, you know that <code>document.documentElement</code> is in fact the <code>&lt;html&gt;</code> element: the root element of any HTML document. However, the viewport is one level higher, so to speak, it’s the element that contains the <code>&lt;html&gt;</code> element. That matters if you give the <code>&lt;html&gt;</code> element a <code>width</code>.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_client_smallpage.jpg" alt=""></p>
<p>So <code>document.documentElement.clientWidth</code> and <code>document.documentElement.clientHeight</code> always give the viewport dimensions, regardless of the dimensions of the <code>&lt;html&gt;</code> element.</p>
<h1 id="Measuring-the-element"><a href="#Measuring-the-element" class="headerlink" title="Measuring the element"></a>Measuring the element</h1><p><code>document.documentElement.offsetWidth</code> and <code>document.documentElement.offsetHeight</code> will give size.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_offset.jpg" alt=""></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_offset_smallpage.jpg" alt=""></p>
<h2 id="Event-coordinates"><a href="#Event-coordinates" class="headerlink" title="Event coordinates"></a>Event coordinates</h2><p>There are the event coordinates. When a mouse event occurs, no less than five property pairs are exposed to give you information abou the exact place of the event. For our discussion three of them are important:</p>
<ul>
<li><p><code>pageX/pageY</code> gives the coordinates relative to the <code>&lt;html&gt;</code> element in CSS px.</p>
</li>
<li><p><code>clientX/Y</code> gives the coordinates relative to the viewport in CSS px.</p>
</li>
<li><p><code>screenX/Y</code> gives the coordinate relative to the screen in DEVICE px.</p>
</li>
</ul>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_pageXY.jpg" alt=""></p>
<p>You’ll use <code>pageX/Y</code> 90% of the time. Usually you want to know the event position relative to the document.</p>
<p>The other 10% of the time you’ll use <code>clientX/Y</code></p>
<p>You never ever need to know the event coordiantes relative to the screen.</p>
<h3 id="Media-queries"><a href="#Media-queries" class="headerlink" title="Media queries"></a>Media queries</h3><p>There are two relavant media queries: <code>width/height</code> and <code>device-width/device-height</code></p>
<ul>
<li><p><code>width/height</code> uses the same values as <code>document.Element.clientWidth/clientHeight</code>, namely the viewport, it works with CSS px.</p>
</li>
<li><p><code>device-width/device-height</code> uses the same values as <code>screen.width/height</code> with device px.</p>
</li>
</ul>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_mediaqueries.jpg" alt=""></p>
<h1 id="The-problem-of-mobile-browser"><a href="#The-problem-of-mobile-browser" class="headerlink" title="The problem of mobile browser"></a>The problem of mobile browser</h1><p>Let’s go back to our sidebar with <code>width:10%</code>, if mobile browsers would do exactly the same as desktop browser, they’d make the element about 40px (if the device-width is 400px). and that’s too narrow. Your liquid layout would look horribly squashed.</p>
<h1 id="Two-viewports"><a href="#Two-viewports" class="headerlink" title="Two viewports"></a>Two viewports</h1><p>The viewport is too narrow to serve as a basis for your CSS layout. The obvious solution is to make the viewport wider. That however requires it to be split into two: the visual viewport and the layout viewport.</p>
<p>A simple explanation at StackOverFlow:</p>
<blockquote>
<p>Imagine the layout viewport as being a large image which does not change size or shape. Now image you have a smaller frame through which you look at the large image. The small frame is surrounded by opaque material which obscures your view of all but a portion of the large image. The portion of the large image that you can see through the frame is the visual port. You can back away from the large image while holding your frame(zoom out) to see the entire image at once, or you can move closer(zoom in) to see only a portion. You can also change the orientation of the frame, but the size and shape of the large image (layout viewport) never changes.</p>
</blockquote>
<p>The visual viewport is the part of the page that’s currently shown on-screen.</p>
<p>The user may scroll to change the part of the page he sees, or zoom to change the size of the visual viewport.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_visualviewport.jpg" alt=""></p>
<p>However, the CSS layout, especially percentual widths, are calculated relative to the <strong>layout viewport</strong>, which is considerably wider than the visual viewport.</p>
<p>Thus the <code>&lt;html&gt;</code> element tabkes the width of the layout viewport initially, and your CSS is interpreted as if the screen were significantly wider than the phone screen. This makes sure that your site’s layout behaves as it does on a desktop browser.</p>
<p>How wide is the layout viewport? That differs per browser.</p>
<ul>
<li><p>Safari uses 980px</p>
</li>
<li><p>Opera uses 850px</p>
</li>
<li><p>Android 800px</p>
</li>
<li><p>IE 974px</p>
</li>
</ul>
<h1 id="Understanding-the-layout-viewport"><a href="#Understanding-the-layout-viewport" class="headerlink" title="Understanding the layout viewport"></a>Understanding the layout viewport</h1><p>In order to understand the size of the layout viewport we have to take a look at what happens when the page if fully zoomed out. Many mobile browsers initially show any page in fully zoomed-out mode.</p>
<p>The point is: browser have chosen their dimensions of the layout viewport such that it completely covers the screen if fully zoomed-out mode(equal to the visual viewport)</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_viewportzoomedout.jpg" alt=""></p>
<p>Thus the width and the height of the layout viewport are equal to whatever can be shown on the screen in the maximally zoomed-out mode. When the user zooms in these dimensions stay the same.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_layoutviewport.jpg" alt=""></p>
<p>The layout viewport width is always the same, if you rotate your phone, the visual viewport changes, but the browser adapts to this new orientation by zooming in slightly so that the layout viewport is again as wide as the visual viewport.</p>
<p>This has consequences for the layout viewport’s height, which is now substantially less than in portrait mode. But web developers don’t care about the height, only about the width.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_layoutviewport_la.jpg" alt=""></p>
<h1 id="Measuring-the-layout-viewport"><a href="#Measuring-the-layout-viewport" class="headerlink" title="Measuring the layout viewport"></a>Measuring the layout viewport</h1><p><code>document.documentElement.clientWidth</code> and <code>document.documentElement.clientHeight</code> contain the layout viewport’s dimensions.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_client.jpg" alt=""></p>
<p>The orientation matters for the height, but not for the width.</p>
<h1 id="Measuring-the-visual-viewport"><a href="#Measuring-the-visual-viewport" class="headerlink" title="Measuring the visual viewport"></a>Measuring the visual viewport</h1><p>As to the visual viewport, it is measured by <code>window.innerWidth/innerHeight</code>. Obviously the measurements change when the user zooms out or in, since more or fewer CSS px fit into the screen.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_inner.jpg" alt=""></p>
<h1 id="The-Screen"><a href="#The-Screen" class="headerlink" title="The Screen"></a>The Screen</h1><p>As on desktop, <code>screen.width/height</code> gives the screen size, in device pixels. As on the desktop, you never need this information as a web developer.</p>
<h1 id="Visual-viewport-position-relative-to-Layout-viewport"><a href="#Visual-viewport-position-relative-to-Layout-viewport" class="headerlink" title="Visual viewport position relative to Layout viewport"></a>Visual viewport position relative to Layout viewport</h1><p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_page.jpg" alt=""></p>
<h1 id="html-element"><a href="#html-element" class="headerlink" title="html element"></a>html element</h1><p>Just as on desktop, <code>document.documentElemetn.offsetWidth/offsetHeight</code> gives the total size of the <code>&lt;html&gt;</code> element in CSS px.</p>
<h1 id="Meta-Viewport"><a href="#Meta-Viewport" class="headerlink" title="Meta Viewport"></a>Meta Viewport</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=320"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>It is meant to resize the layout viewport.</p>
<p>Suppose you build a simple page and give your elemnet no <code>width</code>. Now they stretch up to take 100% of the width of the layout viewport. Most browsers zoom out to show the entire layout viewport on the screen, giving an effect like this</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_none.jpg" alt=""></p>
<p>All user will immediately zoom in, which works, but most browsers keep the width of the elements intact, whcih makes the text hard to read.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_none_zoomed.jpg" alt=""></p>
<p>Now what you can try is setting <code>html {width: 320px}</code> then</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_html300.jpg" alt=""></p>
<p>When you set</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=320"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>You set the width of the layout viewport to 320px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_yes.jpg" alt=""></p>
<p>Of course now we use</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>to adapt to various browsers.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[utils in axios]]></title>
      <url>/2017/06/05/utils-in-axios/</url>
      <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// global toString</span></div><div class="line"><span class="keyword">var</span> toString = <span class="built_in">Object</span>.prototype.toString</div><div class="line"></div><div class="line"><span class="comment">// isArray</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> toString.call(val) === <span class="string">'[object Array]'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isArrayBuffer</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArrayBuffer</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> toString.call(val) === <span class="string">'[object arrayBuffer]'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isFormData</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFormData</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (<span class="keyword">typeof</span> FormData !== <span class="string">'undefined'</span> &amp;&amp; (val <span class="keyword">instanceof</span> FormData))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isString</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isString</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">'string'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isNumber</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNumber</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">'number'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isUndefinded</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isUndefined</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">'undefined'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isObject</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> val !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> val === <span class="string">'object'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isDate</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isDate</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> toString.call(val) === <span class="string">'[object Date]'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isFile</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFile</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> toString.call(val) === <span class="string">'[object File]'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isBlob</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isBlob</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> toString.call(val) === <span class="string">'[object Blob]'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isFunction</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFunction</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> toString.call(val) === <span class="string">'[object Function]'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isStream</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isStream</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> isObject(val) &amp;&amp; isFunction(val.pipe)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isURLSearchParams</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isURLSearchParams</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> URLSearchParams !== <span class="string">'undefined'</span> &amp;&amp; val <span class="keyword">instanceof</span> URLSearchParams</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// trim</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">trim</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/^\s*/</span>, <span class="string">''</span>).replace(<span class="regexp">/\s*$/</span>, <span class="string">''</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// isStandardBrowserEnv</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isStandardBrowserEnv</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> navigator !== <span class="string">'undefined'</span> &amp;&amp; navigator.product === <span class="string">'ReactNative'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span></div><div class="line">    &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">document</span> !== <span class="string">'undefined'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Iterate over an Array or an Object invoking a function for each item</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">forEach</span> (<span class="params">obj, fn</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (obj === <span class="literal">null</span> || <span class="keyword">typeof</span> obj === <span class="string">'undefined'</span>) &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">'object'</span> &amp;&amp; !isArray(obj)) &#123;</div><div class="line">    obj = [obj]</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (isArray(obj)) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l = obj.length; i &lt; l; i++) &#123;</div><div class="line">      fn.call(<span class="literal">null</span>, obj[i], i, obj)</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</div><div class="line">      <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, key)) &#123;</div><div class="line">        fn.call(<span class="literal">null</span>, obj[key], key, obj)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[concept of PWA]]></title>
      <url>/2017/06/01/concept-of-PWA/</url>
      <content type="html"><![CDATA[<h1 id="Advantages-of-Progressive-Web-Apps"><a href="#Advantages-of-Progressive-Web-Apps" class="headerlink" title="Advantages of Progressive Web Apps:"></a>Advantages of Progressive Web Apps:</h1><ul>
<li><p>Reliable - Load instantly and never show the dinasaur.</p>
</li>
<li><p>Fast - Respond quickly to user interactions with silky smooth animations.</p>
</li>
<li><p>Enaging - Feel like a natural app on the device, with immersive user experience.</p>
</li>
</ul>
<h1 id="What-is-a-Progressive-Web-App"><a href="#What-is-a-Progressive-Web-App" class="headerlink" title="What is a Progressive Web App"></a>What is a Progressive Web App</h1><ul>
<li><p>Progressive - Works for every user, regardless of browser choice because it’s built with progressive enhancement as a core tenet.</p>
</li>
<li><p>Responsive - Fits any form factor: desktop, mobile, tablet, or whatever is next.</p>
</li>
<li><p>Connectively independent - Enhanced with service workers to work offline or on low-quality networks.</p>
</li>
<li><p>App-like - Feels like an app, because the app shell model seperates the application <em>functionality</em> from application <em>content</em>.</p>
</li>
<li><p>Fresh - Always up-to-date thanks to the service worker update process.</p>
</li>
<li><p>Safe - Served via HTTPS to prevent snooping and to ensure content hasn’t been tampered with.</p>
</li>
<li><p>Discoverable - Is identifiable as an ‘application’ thanks to <em>W3C manifest</em> and <em>service worker registration</em> scope, allowing search engines to find it.</p>
</li>
<li><p>Re-engagable - Makes Re-engagement easy through features like push notification.</p>
</li>
<li><p>Installable - Allows users to add apps they find most useful to their home screen without the hassle of an app store.</p>
</li>
<li><p>Linkable - Easily share the application via URL, doesn’t require complex installation.</p>
</li>
</ul>
<h2 id="What-is-App-Shell"><a href="#What-is-App-Shell" class="headerlink" title="What is App Shell"></a>What is App Shell</h2><p>The app’s shell is the minimal HTML, CSS, JavaScript that is required to power the user interface of a progressive web app and is one of the components that ensures reliably good performance. Its first load should be extremely quick and immediately cached.</p>
<p>‘Chched’ means that the shell files are loaded once over the network and then saved to the local device. Every subsequent time that the user opens the app, the shell files are loaded from the local device’s cache, which results in blazing-fast startup times.</p>
<p>App shell architecture seperates the core application infrastructure and UI from the data. All of the UI and infrastructure is cached locally using a <em>service worker</em> so that on subsequent loads, the PWA only needs to retrieve the necessary data, instead of having to load everything.</p>
<p>A service worker is a script that your browser runs in the background, seperate from a web page, opening the door to features that don’t need a web page or user interaction.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/156b5e3cc8373d55.png" alt=""></p>
<p>The app shell is similar to the bundle of code that you’d publish to an app store when building a native app. It is the core components necessary to get your app off the ground, but likely doesn’t contain the data.</p>
<p>Using the app shell architecture allows you to focus on speed, giving the PWA similar properties to native apps:</p>
<ul>
<li><p>instant loading</p>
</li>
<li><p>regular updates</p>
</li>
</ul>
<h2 id="Implement-App-Shell"><a href="#Implement-App-Shell" class="headerlink" title="Implement App Shell"></a>Implement App Shell</h2><h3 id="Create-the-HTML-for-the-App-Shell"><a href="#Create-the-HTML-for-the-App-Shell" class="headerlink" title="Create the HTML for the App Shell"></a>Create the HTML for the App Shell</h3><p>The Components consist of:</p>
<ul>
<li><p>Header with a title, and app/refresh button</p>
</li>
<li><p>Container for forecast cards</p>
</li>
<li><p>A forecast card template</p>
</li>
<li><p>A dialog for adding new cities</p>
</li>
<li><p>A loading indicator</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Weather PWA<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"styles/inline.css"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"header__title"</span>&gt;</span>Weather PWA<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"butRefresh"</span> <span class="attr">class</span>=<span class="string">"headerButton"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"butAdd"</span> <span class="attr">class</span>=<span class="string">"headerButton"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">main</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card cardTemplate weather-forecase"</span> <span class="attr">hidden</span>&gt;</span></div><div class="line">        ...</div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">main</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"dialog-container"</span>&gt;</span></div><div class="line">      ...</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"loader"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">viewBox</span>=<span class="string">"0 0 32 32"</span> <span class="attr">with</span>=<span class="string">"32"</span> <span class="attr">height</span>=<span class="string">"32"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">"spinner"</span> <span class="attr">cx</span>=<span class="string">"16"</span> <span class="attr">cy</span>=<span class="string">"16"</span> <span class="attr">r</span>=<span class="string">"14"</span> <span class="attr">fill</span>=<span class="string">"none"</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- insert link to app.js here --&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Notice the loader is visible by default. This ensures that the user sees the loader immediately as the page loads, giving them a clear indication that the content is loading.</p>
<h3 id="Start-with-a-fast-load"><a href="#Start-with-a-fast-load" class="headerlink" title="Start with a fast load"></a>Start with a fast load</h3><h4 id="Differentiating-the-first-run"><a href="#Differentiating-the-first-run" class="headerlink" title="Differentiating the first run"></a>Differentiating the first run</h4><p>User preferences, like the list of cities a user has subscribed to, should be stored locally using IndexedBD or another fast storage mechanism. To simplify this code, here we use localStorage, which is not ideal for production apps because it is a blocking, synchronous storage mechanism that is potentially very slow on some device.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Save list of cities to lcoalStorage</span></div><div class="line">app.saveSelectedCities = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> selectedCities = <span class="built_in">JSON</span>.stringify(app.selectedCities)</div><div class="line">  localStorage.selectedCities = selectedCities</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Next, let’s add the startup code to check if the user has any saved cities and render those</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">app.selectedCities = lcoalStorage.selectedCities</div><div class="line"><span class="keyword">if</span> (app.selectedCities) &#123;</div><div class="line">  app.selectedCities = <span class="built_in">JSON</span>.parse(app.selectedCities)</div><div class="line">  app.selectedCities.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">city</span>) </span>&#123;</div><div class="line">    app.getForecast(city.key, city.label)</div><div class="line">  &#125;)</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  app.updateForecastCard(initialWeatherForecast)</div><div class="line">  app.selectedCities = [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">key</span>: initialWeatherForecast.key,</div><div class="line">      <span class="attr">label</span>: initialWeatherForecast.label,</div><div class="line">    &#125;,</div><div class="line">    app.saveSelectedCities()</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Use-service-workers-to-pre-cache-the-App-Shell"><a href="#Use-service-workers-to-pre-cache-the-App-Shell" class="headerlink" title="Use service workers to pre-cache the App Shell"></a>Use service workers to pre-cache the App Shell</h3><p>PWA has to be fast, and installable, which means that they work online, offline, and on intermittent, slow connections.</p>
<p>To achieve this, we need to cache our app shell using service worker, so that it’s always available quickly and reliably.</p>
<p>Features provided via service workers should be considered a progressive enhancement, and added only if supported by the browser.</p>
<h4 id="Register-the-service-worker-if-it’s-available"><a href="#Register-the-service-worker-if-it’s-available" class="headerlink" title="Register the service worker if it’s available"></a>Register the service worker if it’s available</h4><p>The first step to making the app work offline is to register a service worker, a script that allows background functionality without the need of an open web page or user interaction.</p>
<p>This takes two simple steps:</p>
<ul>
<li><p>Tell the browser to register the JavaScript file as the service worker</p>
</li>
<li><p>Create a JavaScript file containing the service worker</p>
</li>
</ul>
<p>First, we need to check if the browser supports service worker, and if it does, register the service worker. Add the following code to <code>app.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</div><div class="line">  navigator.serviceWorker</div><div class="line">  .register(<span class="string">'./service-worker.js'</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Service Worker Registered'</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Cache-the-site-assets"><a href="#Cache-the-site-assets" class="headerlink" title="Cache the site assets"></a>Cache the site assets</h4><p>When the service worker is registered, an install event is triggered the first time the user visits the page.</p>
<p>In this event handler, we will cache all the assets that are needed for the application.</p>
<p>When the service worker is fired, it should open the <code>caches</code> object and populate it with the assets necessary to load the App Shell. Create a file called <code>service-worker.js</code> in your application root folder. This file must live in the application root because the scope for service worker is defined by the directory in which the file resides. Add this code to your new <code>service-worker.js</code> file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cacheName = <span class="string">'weatherPWA'</span></div><div class="line"><span class="keyword">var</span> filesToCache = []</div><div class="line"></div><div class="line">self.addEventListener(<span class="string">'install'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Install'</span>)</div><div class="line">  e.waitUntil(</div><div class="line">    caches.open(cacheName).then(<span class="function"><span class="keyword">function</span> (<span class="params">cache</span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Caching app shell'</span>)</div><div class="line">      <span class="keyword">return</span> cache.addAll(filesToCache)</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>First, we need to open the cache with <code>caches.open()</code> and provide a cache name. Providing a cache name allows us to version files, or separate data from the app shell so that we can easily update one but not affect other.</p>
<p>Once the cache is open, we can then call <code>cache.addAll()</code>, which takes a list of URLs, then fetches them from the server and adds the response to the cache. Unfortunately, <code>cache.addAll()</code> is atomic, if any of the files fail, the entire cache step fails.</p>
<p>DevTools can debug service workers. Before reloading your page, open up DevTools, go the <code>Service Worker</code> pane on the <code>Application</code> panel.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/ed4633f91ec1389f.png" alt=""></p>
<p>When you see a blank page like this, it means that the currently open page doesn’t have any registered service workers.</p>
<p>Now reload your page. The Service Worker pane should look like this.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/bf15c2f18d7f945c.png" alt=""></p>
<p>When you see information like this, it means the page has a service worker running.</p>
<p>Let’s add some logic on the <code>activate</code> event listener to update the cache.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">self.addEventListener(<span class="string">'activate'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Activate'</span>)</div><div class="line">  e.waitUntil(</div><div class="line">    caches.keys().then(<span class="function"><span class="keyword">function</span> (<span class="params">keyList</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.all(keyList.map(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (key !== cacheName) &#123;</div><div class="line">          <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Removing old cache'</span>, key)</div><div class="line">          <span class="keyword">return</span> caches.delete(key)</div><div class="line">        &#125;</div><div class="line">      &#125;))</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">  <span class="keyword">return</span> self.clients.claim()</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>This code ensures that your service worker updates its cache whenever any of the app shell files change. In order for this to work, you’d need to increment the <code>cacheName</code> variable at the top of your service worker file.</p>
<p>When the app is complete, <code>self.clients.claim()</code> fixes a corner case in which the app wasn’t returning the latest data. You can reproduce the corner case by commenting out the line below and then doing the following steps:</p>
<ul>
<li><p>load app for first time so that the initial City data is shown</p>
</li>
<li><p>press the refresh button on the app</p>
</li>
<li><p>go offline</p>
</li>
<li><p>reload the app</p>
</li>
</ul>
<p>You expect to see the newer data, but you actually see the initial data. This happens because the service worker is not yet activated. <code>self.clients.claim()</code> essentially lets you activate the service worker faster.</p>
<p>Finally, let’s update the list of files required for the app shell. In the array, we need to include all of the files our app needs, including images, js, css, etc.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> filesToCache = [</div><div class="line">  <span class="string">'/'</span>,</div><div class="line">  <span class="string">'/index.html'</span>,</div><div class="line">  <span class="string">'/scripts/app.js'</span>,</div><div class="line">  <span class="string">'/styles/inline.css'</span>,</div><div class="line">  <span class="string">'/images/clear.png'</span>,</div><div class="line">  <span class="comment">// ...</span></div><div class="line">]</div></pre></td></tr></table></figure>
<h4 id="Serve-the-app-shell-from-the-cache"><a href="#Serve-the-app-shell-from-the-cache" class="headerlink" title="Serve the app shell from the cache"></a>Serve the app shell from the cache</h4><p>Service workers provide the ability to intercept requests made from our PWA and handle them within the service worker. That means we can determine how we want to handle the request and potentially serve our own cached response.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">self.addEventListener(<span class="string">'fetch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Fetch'</span>, e.request.url)</div><div class="line">  e.responseWith(</div><div class="line">    caches.match(e.request).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> response || fetch(e.request)</div><div class="line">    &#125;)</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Stepping from inside, out, <code>caches.match()</code> evaluates the web request that triggered the <code>fetch</code> event, and checks to see if it’s available in the cache. It then either responds with the cached version, or uses <code>fetch</code> to get a copy from the network. The <code>response</code> is passed back to the web page with <code>e.responseWith()</code></p>
<h3 id="Beware-of-the-edge-cases"><a href="#Beware-of-the-edge-cases" class="headerlink" title="Beware of the edge cases"></a>Beware of the edge cases</h3><p>This code must not be used in production because of the many unhandled edge cases</p>
<ul>
<li><p>Cache depends on updating the cache key for every change</p>
</li>
<li><p>Requires everything to be redownloaded for every change</p>
</li>
<li><p>Browser cache may prevent the service worker cache from updating</p>
</li>
<li><p>Beware of cache-first strategies in production</p>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Simple Guide of Jest]]></title>
      <url>/2017/05/31/Simple-Guide-of-Jest/</url>
      <content type="html"><![CDATA[<h1 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add --dev jest</div></pre></td></tr></table></figure>
<h1 id="Simple-Case"><a href="#Simple-Case" class="headerlink" title="Simple Case"></a>Simple Case</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sum.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a + b</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = sum</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sum.test.js</span></div><div class="line"><span class="keyword">const</span> test = <span class="built_in">require</span>(<span class="string">'jest'</span>)</div><div class="line"><span class="keyword">const</span> expect = <span class="built_in">require</span>(<span class="string">'expect'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> sum = <span class="built_in">require</span>(<span class="string">'./sum'</span>)</div><div class="line">test(<span class="string">'adds 1 + 2 to equals 3'</span>, () =&gt; &#123;</div><div class="line">  expect(sum(<span class="number">1</span>, <span class="number">2</span>).toBe(<span class="number">3</span>))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="With-Babel"><a href="#With-Babel" class="headerlink" title="With Babel"></a>With Babel</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add --dev babel-jest</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// .babelrc</div><div class="line">&#123;</div><div class="line">  "presets": [</div><div class="line">    [ "env", &#123;</div><div class="line">      "targets": &#123;</div><div class="line">        "node": "current"</div><div class="line">      &#125;</div><div class="line">    &#125;]</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Jest will automatically define <code>NODE_ENV</code> as <code>test</code>. It will not use <code>development</code> section like Babel does by default when no <code>NODE_ENV</code> is set.</p>
<p><code>babel-jest</code> is automatically installed when installing Jest and will automatically transform files if a babel configuration exists in your project. To avoid this, you can explicitly reset the <code>transform</code> configuration option:</p>
</blockquote>
<p>In <code>package.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"jest"</span>: &#123;</div><div class="line">    <span class="attr">"transform"</span>: &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Globals"><a href="#Globals" class="headerlink" title="Globals"></a>Globals</h2><p>In your test files, Jest puts each of its methods and objects into the global environment. You don’t need to require or import anything to use them.</p>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><ul>
<li>afterAll(fn): Runs a function after all the tests in this file have completed. If the function returns a promise, Jest waits for that promise to resolve before continuing. This is often useful if you want to clean up some global setup state that is shared across tests.</li>
</ul>
<p>If <code>afterAll</code> is inside a <code>describe</code> block, it runs at the end of the describe block.</p>
<ul>
<li>afterEach(fn): Runs a function after each test in this file. If the function returns a promise, Jest waits for the promise to resolve before continuing. This is often useful if you want to clean up some temprary state that is created by each test.</li>
</ul>
<p>If <code>afterEach</code> is inside a <code>describe</code> block, it only runs after the tests that are inside this describe block.</p>
<ul>
<li><p>beforeAll(fn): similar to <code>afterAll()</code></p>
</li>
<li><p>beforeEach(fn): similar to <code>afterEach()</code></p>
</li>
<li><p>describe(name, fn): create a block that groups together several related tests in one ‘test suite’. For example, if you have a <code>myBeverage</code> object that is supposed to be delicious but not sour, you could test it with:</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> myBeverage = &#123;</div><div class="line">  <span class="attr">delicious</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">sour</span>: <span class="literal">false</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line">describe(<span class="string">'my beverage'</span>, () =&gt; &#123;</div><div class="line">  test(<span class="string">'is delicious'</span>, () =&gt; &#123;</div><div class="line">    expect(myBeverage.delicious).toBeTruthy()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">  test(<span class="string">'is not sour'</span>, () =&gt; &#123;</div><div class="line">    expect(myBeverage.sour).toBeFalsy()</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>This isn’t required - you can just write the <code>test</code> block directly at the top level.</p>
<ul>
<li>describe.only(name, fn): You can use <code>describe.only</code> if you want to run only one describe block</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">describe.only(<span class="string">'my beverage'</span>, () =&gt; &#123;</div><div class="line">  test(<span class="string">'is delicious'</span>, () =&gt; &#123;</div><div class="line">    expect(myBeverage.delicious).toBeTruthy()</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">describe(<span class="string">'my other beverage'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ...will be skipped</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>describe.skip(name, fn): you can use <code>describe.skip</code> if you do not want to run a particular describe block:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'my beverage'</span>, () =&gt; &#123;</div><div class="line">  test(<span class="string">'is delicious'</span>, () =&gt; &#123;</div><div class="line">    expect(myBeverage.delicious).toBeTruthy()</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">describe.skip(<span class="string">'my other beverage'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// ... will be skipped</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li><p>require.requireActual(moduleName): returns the actual module instead of a mock, bypassing all checks on whether the module should receive a mock implementation or not.</p>
</li>
<li><p>require.requireMock(moduleName): returns a mock module instead of the actual module, bypassing all checks on whether the module should be required normally or not.</p>
</li>
<li><p>test(name, fn): Also under the alias <code>it(name, fn)</code>, all you need in a test file is that the <code>test</code> method which runs a test. For example, let’s say there’s a function <code>inchesOfRain()</code> that should be zero. Your whole test could be:</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">test(<span class="string">'did not rain'</span>, () =&gt; &#123;</div><div class="line">  expect(inchesOfRain()).toBe(<span class="number">0</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>The first argument is the test name; the second argument is a function that contains the expectations to test</p>
<p>If a promise is returned from <code>test</code>, Jest will wait for the promise to resolve before letting the test complete.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">test(<span class="string">'has lemon in it'</span>, () =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> fetchBeverageList().then(<span class="function"><span class="params">list</span> =&gt;</span> &#123;</div><div class="line">    expect(list).toContain(<span class="string">'lemon'</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Even though the call to <code>test</code> will return right away, the test doesn’t complete until the promise resolves as well.</p>
<ul>
<li><p>test.only(name, fn): similar to <code>describe.only()</code></p>
</li>
<li><p>test.skip(name, fn): similar to <code>describe.skip()</code></p>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack code splitting - async]]></title>
      <url>/2017/05/30/webpack-code-splitting-async/</url>
      <content type="html"><![CDATA[<p>Currently a ‘function-like’ <code>import()</code> module loading syntax proposal is on the way into ECMAScript.</p>
<p>The ES6 Defines <code>import()</code> as method to load ES6 modules dynamically onruntime.</p>
<p>Webpack treats <code>import()</code> as a split-point and puts the requested module in a seperate chunk. <code>import()</code> takes the module name as argument and returns a <code>Promise</code>: <code>import(name) =&gt; Promise</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">determineDate</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'moment'</span>).then(<span class="function">(<span class="params">moment</span>) =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(moment().format())</div><div class="line">  &#125;).catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'failed'</span>))</div><div class="line">&#125;</div><div class="line"></div><div class="line">determineDate()</div></pre></td></tr></table></figure>
<p>Note that the fully dynamic statement, such as <code>import(foo)</code> will fail because webpack requries at least some file location information. This is because <code>foo</code> could potentially be any path to any file in your system or project. The <code>import()</code> must contain at least some information about where the module is located. so bundling can be limited to a specific directory or set of files.</p>
<h1 id="Chunk-Name"><a href="#Chunk-Name" class="headerlink" title="Chunk Name"></a>Chunk Name</h1><p>Since webpack 2.4.0, chunk names for dynamic imports can be specified using a “magic comment”</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'my-chunk-name' */</span> <span class="string">'module'</span>)</div></pre></td></tr></table></figure>
<p>Since webpack 2.6.0, the placeholder <code>[request]</code>, <code>[index]</code> are supported:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// will generate files like `i18n/namespace-i18n-bundle-en.json`</span></div><div class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'i18n/[request]' */</span> <span class="string">`i18n/<span class="subst">$&#123;namespace&#125;</span>-i18n-bundle-<span class="subst">$&#123;language&#125;</span>.json`</span>)</div><div class="line"></div><div class="line"><span class="comment">// will generate files `i18n-0`, `i18n-1`</span></div><div class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'i18n-[index]' */</span> <span class="string">'`i18n/$&#123;namespace&#125;-i18n-bundle-$&#123;language&#125;.json`'</span>)</div></pre></td></tr></table></figure>
<h1 id="import-mode"><a href="#import-mode" class="headerlink" title="import mode"></a>import mode</h1><p>Since webpack 2.6.0, different modes for resolving dynamic imports can be specified:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span>(<span class="comment">/* webpackMode: lazy */</span> <span class="string">`i18n/<span class="subst">$&#123;namespace&#125;</span>-i18n-<span class="subst">$&#123;language&#125;</span>.json`</span>)</div></pre></td></tr></table></figure>
<ul>
<li><p>lazy: The default behavior. Lazy generates a chunk per request. So everything is lazy loaded.</p>
</li>
<li><p>lazy-once: Only available for imports with expression. Generate a single chunk for all possible requests. So the first request causes a network request for all modules, all following requests are already fulfilled.</p>
</li>
<li><p>eager: Eager generates no chunk. All files are included in the current chunk. No network request is required to load the files. It still returns a Promise, but it’s already resolved.</p>
</li>
</ul>
<p>You can combine both options ( webpackChunkName and webpackMode ), it’s parsed a JSON5 object without curly brackets:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span>(<span class="comment">/* webpackMode: 'lazy-once', webpackChunkName: 'all-i18n-data' */</span> <span class="string">`i18n/<span class="subst">$&#123;namespace&#125;</span>-i18n-<span class="subst">$&#123;lanaguage&#125;</span>.json`</span>)</div></pre></td></tr></table></figure>
<h1 id="Usage-with-Babel"><a href="#Usage-with-Babel" class="headerlink" title="Usage with Babel"></a>Usage with Babel</h1><p>If you want to use <code>import</code> with Babel, you’ll need to install the <code>syntax-dynamic-import</code> plugin while it’s still Stage 3 to get around the parser error.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add --dev babel-core babel-loader babel-plugin-syntax-dynamic-import babel-preset-es2015</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">determineDate</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'moment'</span>).then(<span class="function"><span class="params">moment</span> =&gt;</span> moment().format()).then(<span class="function"><span class="params">str</span> =&gt;</span> <span class="built_in">console</span>.log(str)).catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e))</div><div class="line">&#125;</div><div class="line">determineDate()</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./index'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'app.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">rules</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel-loader'</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"presets"</span>: [[<span class="string">"es2015"</span>, &#123; <span class="attr">"modules"</span>: <span class="literal">false</span> &#125;]],</div><div class="line">  <span class="attr">"plugins"</span>: [<span class="string">"syntax-dynamic-import"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Diabled default import in es6.</p>
</blockquote>
<p>Not using the <code>syntax-dynamic-import</code> plugin will fail the build with</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Module build failed: SyntaxError: <span class="string">'import'</span> and <span class="string">'export'</span> may only appear at the top level</div></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Module build failed: SyntaxError: Unexpected token, expected \&#123;</div></pre></td></tr></table></figure>
<h1 id="Usage-with-Babel-and-async-await"><a href="#Usage-with-Babel-and-async-await" class="headerlink" title="Usage with Babel and async / await"></a>Usage with Babel and <code>async / await</code></h1><p>To use es7 <code>async</code>/<code>await</code> with <code>import()</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add --dev babel-plugin-transform-async-to-generator babel-plugin-trasnform-regenerator babel-plugin-transform-runtime babel-plugin-syntax-async-functions</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">determineDate</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> moment = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'moment'</span>)</div><div class="line">  <span class="keyword">return</span> moment().format()</div><div class="line">&#125;</div><div class="line"></div><div class="line">determineDate().then(<span class="function"><span class="params">str</span> =&gt;</span> <span class="built_in">console</span>.log(str))</div></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"presets"</span>: [[<span class="string">"es2015"</span>, &#123; <span class="attr">"modules"</span>: <span class="literal">false</span> &#125;]],</div><div class="line">  <span class="attr">"plugins"</span>: [</div><div class="line">    <span class="string">"syntax-async-functions"</span>,</div><div class="line">    <span class="string">"syntax-dynamic-import"</span>,</div><div class="line">    <span class="string">"transform-async-to-generator"</span>,</div><div class="line">    <span class="string">"trasnform-regenerator"</span>,</div><div class="line">    <span class="string">"transform-runtime"</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="import-imports-the-entire-module-namespace"><a href="#import-imports-the-entire-module-namespace" class="headerlink" title="import() imports the entire module namespace"></a><code>import()</code> imports the entire module namespace</h1><p>Note that the promise is resolved with the module namespace. Consider the following two examples:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Example 1: top-level import</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Component <span class="keyword">from</span> <span class="string">'./component'</span></div><div class="line"></div><div class="line"><span class="comment">// Example 2: Code Splitting With Import()</span></div><div class="line"><span class="keyword">import</span>(<span class="string">'./component'</span>).then(<span class="function"><span class="params">Component</span> =&gt;</span> <span class="comment">/* ... */</span>)</div></pre></td></tr></table></figure>
<p><code>Component</code> in both of the cases resolves to the same thing, meaning in the case of using <code>import()</code> with ES2015 moduels you have to explicitly access default and named exports:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Destructing Example</span></div><div class="line">  <span class="keyword">const</span> &#123; <span class="attr">default</span>: Component &#125; = <span class="keyword">await</span> <span class="keyword">import</span> (<span class="string">'./component'</span>)</div><div class="line">  <span class="comment">// Inline example</span></div><div class="line">  render((<span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'./component'</span>)).default)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[mongodb simple guide]]></title>
      <url>/2017/05/30/mongodb-simple-guide/</url>
      <content type="html"><![CDATA[<ul>
<li><p><code>yarn add mongoose</code></p>
</li>
<li><p><code>import mongoose from &#39;mongoose&#39;</code></p>
</li>
<li><p><code>const db = mongoose.conenct(MONGODB_URI)</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">'mongoose'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> db = mongoose.connect(MONGODB_URI)</div><div class="line"></div><div class="line">db.connection.on(<span class="string">'open'</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'connected'</span>)</div><div class="line">&#125;)</div><div class="line">db.connection.on(<span class="string">'error'</span>, (err) =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`db error: <span class="subst">$&#123;err&#125;</span>`</span>)</div><div class="line">  process.exit</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h1><p>Schema defines the skeleton of minimal unit</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">'mongoose'</span></div><div class="line"><span class="keyword">const</span> TestSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</div><div class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="built_in">String</span> &#125;,</div><div class="line">  <span class="attr">age</span>: &#123; <span class="attr">type</span>: <span class="built_in">Number</span>, <span class="attr">default</span>: <span class="number">0</span> &#125;,</div><div class="line">  <span class="attr">time</span>: &#123; <span class="attr">type</span>: <span class="built_in">Date</span>, <span class="attr">default</span>: <span class="built_in">Date</span>.now() &#125;,</div><div class="line">  <span class="attr">email</span>: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">default</span>: <span class="string">''</span> &#125;,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<blockquote>
<p>Primitive Types: String, Number, Boolean, null, Array, Document, Date</p>
</blockquote>
<h1 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h1><p>Instance of Schema, it has ability to operate db</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> db = mongoose.connect(MONGODB.URI)</div><div class="line"><span class="keyword">const</span> testModal = db.model(<span class="string">'test1'</span>, TestSchema)</div></pre></td></tr></table></figure>
<ul>
<li>test1: Name of Collection in the DB</li>
</ul>
<h1 id="Entity"><a href="#Entity" class="headerlink" title="Entity"></a>Entity</h1><p>Instance of Model, it has ability to operate db</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TestEntity = <span class="keyword">new</span> TestModel(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'Lenka'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">35</span>,</div><div class="line">  <span class="attr">email</span>: <span class="string">'lenka@gmail.com'</span>,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(TestEntity.name) <span class="comment">// Lenka</span></div><div class="line"><span class="built_in">console</span>.log(TestEntity.age) <span class="comment">// 35</span></div></pre></td></tr></table></figure>
<h1 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">'mongoose'</span></div><div class="line"><span class="keyword">const</span> db = mongoose.connect(MONGODB.URI)</div><div class="line"><span class="keyword">const</span> TestSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</div><div class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="built_in">String</span> &#125;,</div><div class="line">  <span class="attr">age</span>: &#123; <span class="attr">type</span>: <span class="built_in">Number</span>, <span class="attr">default</span>: <span class="number">0</span> &#125;,</div><div class="line">  <span class="attr">email</span>: &#123; <span class="attr">type</span>: <span class="built_in">String</span> &#125;,</div><div class="line">  <span class="attr">time</span>: &#123; <span class="attr">type</span>: <span class="built_in">Date</span>, <span class="attr">default</span>: <span class="built_in">Date</span>.now() &#125;,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> TestModel = db.model(<span class="string">'test1'</span>, TestSchema)</div><div class="line"><span class="keyword">const</span> TestEntity = <span class="keyword">new</span> TestModel(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'hello world'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">12</span>,</div><div class="line">  <span class="attr">email</span>: <span class="string">'helloworld@gmail.com'</span>,</div><div class="line">&#125;)</div><div class="line">TestEntity.save(<span class="function">(<span class="params">err, doc</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (err) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'error: '</span> + err)</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(doc)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Find"><a href="#Find" class="headerlink" title="Find"></a>Find</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.find(condition, field, callback)</div></pre></td></tr></table></figure>
<p>if <code>fields</code> is omited, or <code>null</code>, the docs will return all attributes</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Model.find(&#123; <span class="string">'age'</span>: <span class="number">25</span> &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</div><div class="line">  <span class="built_in">console</span>.log(docs)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">Model.find(&#123;&#125;, &#123; <span class="attr">name</span>: <span class="number">1</span>, <span class="attr">age</span>: <span class="number">1</span>, <span class="attr">_id</span>: <span class="number">0</span> &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// the specific attributes will be returned if corresponding fields are set to positive(here they are name and age), and _id is default to be displayed, if you want to omit it, you should set it to be 0.</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="findOne"><a href="#findOne" class="headerlink" title="findOne"></a>findOne</h1><p>Same as <code>find</code>, except it will return only one matched</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">TestModel.findOne(condition, fields, (err, doc) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="findById"><a href="#findById" class="headerlink" title="findById"></a>findById</h1><p>Same as <code>findOne</code>, but it only find by <code>_id</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">TestModel.findById(<span class="string">'obj._id'</span>, (err, doc) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Model.create(&#123;&#125;, callback)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Model.create(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'test'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">12</span>,</div><div class="line">&#125;, (err, doc) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</div><div class="line">  <span class="built_in">console</span>.log(doc)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">TestModel.create([</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test1'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test2'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test3'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test4'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test5'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test6'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test7'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test8'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">'test9'</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</div><div class="line">])</div></pre></td></tr></table></figure>
<h1 id="Save"><a href="#Save" class="headerlink" title="Save"></a>Save</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Entity.save(&#123;&#125;, callback)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Entity = <span class="keyword">new</span> Model(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'entity_save'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">Entity.save(<span class="function">(<span class="params">err, doc</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</div><div class="line">  <span class="built_in">console</span>.log(doc)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<blockquote>
<p>Model.create</p>
<p>Entity.save</p>
</blockquote>
<h1 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.update(&#123;&#125;, callback)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> conditions = &#123; <span class="attr">name</span>: <span class="string">'test_upate'</span> &#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> update = &#123; <span class="attr">$set</span>: &#123; <span class="attr">age</span>: <span class="number">16</span> &#125; &#125;</div><div class="line"></div><div class="line">TestModel.update(conditions, update, (err) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'success'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Remove"><a href="#Remove" class="headerlink" title="Remove"></a>Remove</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">obj.remove(&#123;&#125;, callback)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> conditions = &#123; <span class="attr">name</span>: <span class="string">'tim'</span> &#125;</div><div class="line"></div><div class="line">TestModel.remove(conditions, (err) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'success'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Advanced-Search"><a href="#Advanced-Search" class="headerlink" title="Advanced Search"></a>Advanced Search</h1><ul>
<li><p><code>$lt</code>: less than</p>
</li>
<li><p><code>$lte</code>: less than or equal to</p>
</li>
<li><p><code>$gt</code>: greater than</p>
</li>
<li><p><code>$gte</code>: greater than or equal to</p>
</li>
<li><p><code>$ne</code>: not equal to</p>
</li>
<li><p><code>$in</code>: belong to</p>
</li>
<li><p><code>$or</code>: or</p>
</li>
<li><p><code>$exists</code>: exist</p>
</li>
<li><p><code>$all</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Model.find(&#123; <span class="string">"age"</span>: &#123; <span class="string">"$gt"</span>: <span class="number">18</span>, <span class="string">"$lt"</span>: <span class="number">50</span> &#125; &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">Model.find(&#123; <span class="string">"age"</span>: &#123; <span class="string">"$in"</span>: [<span class="number">20</span>, <span class="number">30</span>] &#125; &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">Model.find(&#123;</div><div class="line">  <span class="string">"$or"</span>: [</div><div class="line">    &#123; <span class="string">"name"</span>: <span class="string">"yaya"</span> &#125;,</div><div class="line">    &#123; <span class="string">"age"</span>: <span class="number">28</span> &#125;,</div><div class="line">  ]</div><div class="line">&#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">Model.find(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">"$exists"</span></div><div class="line">&#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Limit"><a href="#Limit" class="headerlink" title="Limit"></a>Limit</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">find(condition, &#123; <span class="attr">limit</span>: <span class="number">20</span> &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, docs</span>) =&gt; </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Model.find(&#123;&#125;, <span class="literal">null</span>, &#123; <span class="attr">limit</span>: <span class="number">20</span> &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Skip"><a href="#Skip" class="headerlink" title="Skip"></a>Skip</h1><p>Skim first n docs</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">find(&#123;&#125;, <span class="literal">null</span>, &#123; <span class="attr">skip</span>: <span class="number">4</span> &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>if total docs less than 4, it will output nothing</p>
<h1 id="Sort"><a href="#Sort" class="headerlink" title="Sort"></a>Sort</h1><p><code>-1</code>: descending, <code>1</code>: ascending</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Model.find(&#123;&#125;, <span class="literal">null</span>, &#123; <span class="attr">sort</span>: &#123; <span class="attr">age</span>: <span class="number">-1</span> &#125; &#125;, (err, docs) =&gt; &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="ObjectId"><a href="#ObjectId" class="headerlink" title="ObjectId"></a>ObjectId</h1><p>The default id <code>_id</code> could be any types in mongodb, and default to be <code>ObjectId</code></p>
<p>ObjectId, is a 12-types BSON String.</p>
<ul>
<li><p>4 byte: UNIX TimeStamp</p>
</li>
<li><p>3 byte: Represents the OS where mongodb running on</p>
</li>
<li><p>2 byte: Represents the process where this <code>_id</code> in on</p>
</li>
<li><p>3 byte: Rnadom Number</p>
</li>
</ul>
<h1 id="Schema-add-Attribute"><a href="#Schema-add-Attribute" class="headerlink" title="Schema add Attribute"></a>Schema add Attribute</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">'mongoose'</span></div><div class="line"><span class="keyword">const</span> TestSchema = <span class="keyword">new</span> mongoose.Schema</div><div class="line">TestSchema.add(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'String'</span>,</div><div class="line">  <span class="attr">email</span>: <span class="string">'String'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="string">'Number'</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="Schema-add-instance-method"><a href="#Schema-add-instance-method" class="headerlink" title="Schema add instance method"></a>Schema add instance method</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">'mongoose'</span></div><div class="line"><span class="keyword">const</span> TextSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'String'</span>,</div><div class="line">&#125;)</div><div class="line"></div><div class="line">TestSchema.method(<span class="string">'test'</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'hah'</span>)</div><div class="line">&#125;)</div><div class="line"><span class="keyword">const</span> say = mongoose.model(<span class="string">'say'</span>, TestSchema)</div><div class="line"><span class="keyword">var</span> lenka = say()</div><div class="line">lenka.say() <span class="comment">// 'hah'</span></div></pre></td></tr></table></figure>
<h1 id="Schema-add-static-method"><a href="#Schema-add-static-method" class="headerlink" title="Schema add static method"></a>Schema add static method</h1><p>```javascript import mongoose from ‘mongoose’ const db = mongoose.connect(MONGODB.URI) const TestSchema = new mongoose.Schema({ name: { type: String }, age: { type: Number }, })</p>
<p>TestSchema.static(‘findByName’, (name, cb) =&gt; { return this.find({name: name}, cb) })</p>
<p>const TestModel = db.model(‘test’, TestSchema) TestModel.findByName(‘tim’, (err, docs) =&gt; { // … })</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[TypeScript with Node]]></title>
      <url>/2017/05/30/start-in-typescript/</url>
      <content type="html"><![CDATA[<h1 id="Configuring-TypeScript-Compilation"><a href="#Configuring-TypeScript-Compilation" class="headerlink" title="Configuring TypeScript Compilation"></a>Configuring TypeScript Compilation</h1><p>TypeScript uses the file <code>tsconfig.json</code> to adjust project compile options</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">"compilerOptions": &#123;</div><div class="line">  "module": "commonjs",</div><div class="line">  "target": "es6",</div><div class="line">  "noImplicityAny": true,</div><div class="line">  "moduleResolution": "node",</div><div class="line">  "sourceMap": true,</div><div class="line">  "outDir": "dist",</div><div class="line">  "baseUrl": ".",</div><div class="line">  "paths": &#123;</div><div class="line">    "*": [</div><div class="line">      "node_modules/*",</div><div class="line">      "src/types/*"</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th><code>compilerOptions</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>“module”: “commonjs”</td>
<td>The <strong>output</strong> module type (in your <code>.js</code> files). Node uses commonjs</td>
</tr>
<tr>
<td>“target”: “es6”</td>
<td>The output language level. Node supports ES6</td>
</tr>
<tr>
<td>“noImplicityAny”: true</td>
<td>Enables a stricter setting which throws errors when something has a default <code>any</code> value</td>
</tr>
<tr>
<td>“moduleResolution”: “node”</td>
<td>TypeScript attempts to mimic Node’s module resolution strategy</td>
</tr>
<tr>
<td>“sourceMap”: true</td>
<td></td>
</tr>
<tr>
<td>“ourDir”: “dist”</td>
<td>Location to output <code>.js</code> files after compilation</td>
</tr>
<tr>
<td>“baseUrl”: “.”</td>
<td>Part of configuring module resolution</td>
</tr>
<tr>
<td>“paths”: {…}</td>
<td>Part of configuring module resolution</td>
</tr>
</tbody>
</table>
<p>The rest of the file define the TypeScript project context. The project context is basically a set of options that determine which files are compiled when the compiler is invoked with a specific <code>tsconfig.json</code>.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"include": [</div><div class="line">  "src/**/*"</div><div class="line">]</div></pre></td></tr></table></figure>
<p><code>include</code> takes an array of glob pattern of files to include in the compilation.</p>
<h1 id="Type-Definition-d-ts-Files"><a href="#Type-Definition-d-ts-Files" class="headerlink" title="Type Definition (.d.ts) Files"></a>Type Definition (<code>.d.ts</code>) Files</h1><p>TypeScript uses <code>.d.ts</code> files to provide types for JavaScript libraries that were not written in TypeScript. This is great because once you have a <code>.d.ts</code> file, TypeScript can type check that library and provide you better help in your editor. The TypeScript community actively shares all the most up-to-date <code>.d.ts</code> files for popular libraries on a Github repository called <strong>DefinitelyTyped</strong>.</p>
<p>Because the <code>&quot;noImplicityAny&quot;: true</code>, we are required to have a <code>.d.ts</code> file for every library used. You could set <code>noImplicityAny</code> to <code>false</code> to silence errors about missing <code>.d.ts</code> files. It’s a best practice to have a <code>.d.ts</code> file for every library(Even the <code>.d.ts</code> file is basically empty)</p>
<h1 id="Installing-d-ts-files-from-DefinitelyTyped"><a href="#Installing-d-ts-files-from-DefinitelyTyped" class="headerlink" title="Installing .d.ts files from DefinitelyTyped"></a>Installing <code>.d.ts</code> files from DefinitelyTyped</h1><p>For the most part, you’ll find <code>d.ts</code> files for the libraries you are using on DefinitelyTyped. These <code>.d.ts</code> files can be easily installed into your project by using npm scope <code>@types</code>. For example, if we want the <code>.d.ts</code> file for jQuery, we can do so with <code>npm install --save-dev @types/jquery</code>.</p>
<p>Once <code>.d.ts</code> files have been installed using npm, you should see them in your <code>node_modules/@types</code> folder. The compiler will always look in this folder for <code>.d.ts</code> files when resolving JavaScript libraries.</p>
<h1 id="What-if-a-library-isn’t-on-DefinitelyTyped"><a href="#What-if-a-library-isn’t-on-DefinitelyTyped" class="headerlink" title="What if a library isn’t on DefinitelyTyped?"></a>What if a library isn’t on DefinitelyTyped?</h1><p>Setting up TypeScript to look for <code>.d.ts</code> files in another folder</p>
<p>The Compiler knows to look in <code>node_modules/@types</code> by default, but to help the compiler find our own <code>.d.ts</code> files we have to configure path mapping in our <code>tsconfig.json</code>. Path mapping can get pretty confusing, but the basic idea is that the TypeScript compiler will look in specific places, in a specific order when resolving modules, and we have the ability to tell the compiler exactly how to do it. In the <code>tsconfig.json</code> for this project you’ll see the following:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">"baseUrl": ".",</div><div class="line">"paths": &#123;</div><div class="line">  "*": [</div><div class="line">    "src/types/*"</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This tells the TypeScript compiler that in addition to looking in <code>node_module/@types</code> for every import (<code>*</code>) also look in our own <code>.d.ts</code> file location <code>&lt;baseUrl&gt; + src/types/*</code></p>
<p>First the compiler will look for a <code>.d.ts</code> file in <code>node_modules/@types</code> and then <code>src/types</code></p>
<h1 id="Summary-of-d-ts-management"><a href="#Summary-of-d-ts-management" class="headerlink" title="Summary of .d.ts management"></a>Summary of <code>.d.ts</code> management</h1><p>In general if you stick to the following steps you should have minimal <code>.d.ts</code> issues:</p>
<ul>
<li><p>After installing any npm package as a dependency or dev dependency, immediately try to install the <code>.d.ts</code> file via <code>@types</code></p>
</li>
<li><p>If the library has a <code>.d.ts</code> file on DefinitelyTyped, the install wil succeed and you are done, if the install fails because the package doesn’t exist, generate <code>.d.ts</code> by yourself</p>
</li>
</ul>
<h1 id="Source-Map"><a href="#Source-Map" class="headerlink" title="Source Map"></a>Source Map</h1><p>In the <code>tsconfig.json</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"compilerOptiosn": &#123;</div><div class="line">  "sourceMaps": true</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>With this option enabled, next to every <code>.js</code> file that the TypeScript compiler outputs there will be a <code>.map.js</code> file as well. This <code>.map.js</code> file provides the information necessary to map back to the source <code>.ts</code> file while debugging.</p>
<h1 id="Using-Debugger-in-VS-Code"><a href="#Using-Debugger-in-VS-Code" class="headerlink" title="Using Debugger in VS Code"></a>Using Debugger in VS Code</h1><p>When debugging in VS Code, it looks for a top level <code>.vscode</code> folder with a <code>launch.json</code> file. In this file, you can tell VS Code exactly what you want to do:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"type"</span>: <span class="string">"node"</span>,</div><div class="line">  <span class="attr">"request"</span>: <span class="string">"launch"</span>,</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"Debug"</span>,</div><div class="line">  <span class="attr">"program"</span>: <span class="string">"$&#123;workspaceRoot&#125;/dist/server.js"</span>,</div><div class="line">  <span class="attr">"smartStep"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">"outFiles"</span>: [</div><div class="line">    <span class="string">"../dist/**/*.js"</span></div><div class="line">  ],</div><div class="line">  <span class="attr">"protocal"</span>: <span class="string">"inspector"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This is mostly identical to the “Node.js: Launch Program” template with a couple minor changes:</p>
<table>
<thead>
<tr>
<th><code>launch.json</code> Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>“program”: “${workspaceRoot}/dist/server.js”</td>
<td>Modified to point to our entry point in <code>dist</code></td>
</tr>
<tr>
<td>“smartStep”: true</td>
<td>Won’t step into code that doesn’t have a source map</td>
</tr>
<tr>
<td>“outFiles”: […]</td>
<td>Specify where output files a dropped. Use with source map</td>
</tr>
<tr>
<td>“protocal”: “inspector”</td>
<td>Use the new Node Debug Protocal because we’re on the latest node</td>
</tr>
</tbody>
</table>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[drag, upload and progress]]></title>
      <url>/2017/05/29/drag-upload-and-progress/</url>
      <content type="html"><![CDATA[<p>Dragging and dropping files from your desktop to a browser is one of the ultimate goals for web application integration, which consists of:</p>
<ul>
<li><p>enable file dragging and dropping onto a web page element</p>
</li>
<li><p>analyze dropped files in JavaScript</p>
</li>
<li><p>load and parse files on the client</p>
</li>
<li><p>asynchronously upload files to the server using XMLHttpRequest2</p>
</li>
<li><p>show a graphical progress bar while the upload occurs</p>
</li>
<li><p>use progressive enhancement to ensure your file upload from works in any browser</p>
</li>
</ul>
<h1 id="The-File-API"><a href="#The-File-API" class="headerlink" title="The File API"></a>The File API</h1><ul>
<li><p>FileList: represents an array of selected files</p>
</li>
<li><p>File: represents an individual file</p>
</li>
<li><p>FileReader: an interface which allows us to read file data on the client and use it within JavaScript</p>
</li>
</ul>
<h1 id="JavaScript-Events"><a href="#JavaScript-Events" class="headerlink" title="JavaScript Events"></a>JavaScript Events</h1><h2 id="Dragged-Object"><a href="#Dragged-Object" class="headerlink" title="Dragged Object"></a>Dragged Object</h2><ul>
<li><p>dragstart</p>
</li>
<li><p>drag</p>
</li>
<li><p>dragend</p>
</li>
</ul>
<h2 id="Target-Object"><a href="#Target-Object" class="headerlink" title="Target Object"></a>Target Object</h2><ul>
<li><p>dragenter</p>
</li>
<li><p>dragover</p>
</li>
<li><p>dragleave</p>
</li>
<li><p>drop</p>
</li>
</ul>
<h2 id="dataTransfer"><a href="#dataTransfer" class="headerlink" title="dataTransfer"></a>dataTransfer</h2><ul>
<li><p>dropEffect: copy | move | link | none</p>
</li>
<li><p>effectAllowed: copy | move | link | copyLink | copyMove | linkMove | none | all (default)</p>
</li>
<li><p>files</p>
</li>
<li><p>types</p>
</li>
<li><p>setDragImage(imgElement, x, y): set custom icon along dragging</p>
</li>
<li><p>setData(format, data)</p>
</li>
<li><p>getData(format)</p>
</li>
<li><p>clearData()</p>
</li>
</ul>
<h1 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h1><p>By default, brower will refuse all drag actions(and file will be opened in browser if files from desktop dragged into the browser), so <code>e.preventDefault()</code> should be added in <code>dropover</code> and <code>drop</code> event</p>
<p>Dragging Text will automatically set <code>e.dataTransfer.setData(&#39;text/plain&#39;, node.innerText)</code></p>
<p>Dragging File will add files to <code>e.dataTransfer.files</code></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[simple usage of flatMap]]></title>
      <url>/2017/05/26/simple-usage-of-flatMap/</url>
      <content type="html"><![CDATA[<p><a href="http://2ality.com/2017/04/flatmap.html" target="_blank" rel="external">origin</a></p>
<p>Both <code>map()</code> and <code>flatMap()</code> take a function <code>f</code> as a parameter that controls how an input Array is translated to an output Array:</p>
<ul>
<li><p>With <code>map()</code>, each input Array element is translated to exactly one output element, aka, <code>f</code> returns a single value</p>
</li>
<li><p>With <code>flatMap()</code>, each input Array element is translated to zero or more output elements, aka, <code>f</code> returns an Array of values.</p>
</li>
</ul>
<p>An smiple implementation of <code>flatMap</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatMap</span> (<span class="params">arr, mapFunc</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> result = []</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> [index, value] <span class="keyword">of</span> arr.entries()) &#123;</div><div class="line">    <span class="keyword">const</span> x = mapFunc(value, index, arr)</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(x)) &#123;</div><div class="line">      result.push(...x)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      result.push(x)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>flatMap</code> is simpler if <code>mapFunc</code> is only allowed to return Arrays, but we don’t impose this restriction here, because non-Array values are occasionally useful.</p>
<h1 id="Filtering-and-mapping-at-the-same-time"><a href="#Filtering-and-mapping-at-the-same-time" class="headerlink" title="Filtering and mapping at the same time"></a>Filtering and mapping at the same time</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processArray</span> (<span class="params">arr, processFunc</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> arr.map(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      <span class="keyword">return</span> &#123; <span class="attr">value</span>: processFunc(x) &#125;</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">      <span class="keyword">return</span> &#123; <span class="attr">error</span>: e &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> results = processArray(myArray, myFunc)</div><div class="line"></div><div class="line"><span class="keyword">const</span> values = flatMap(results, result =&gt; result.value ? [result.value] : []) <span class="comment">// here we use [result.value] to avoid destructing value if it is an array.</span></div><div class="line"><span class="keyword">const</span> errors = flapMap(results, result =&gt; result.error ? result.error : [])</div></pre></td></tr></table></figure>
<h1 id="Mapping-to-multiple-values"><a href="#Mapping-to-multiple-values" class="headerlink" title="Mapping to multiple values"></a>Mapping to multiple values</h1><p>The Array method <code>map()</code> maps each input Array element to one output. But if we want to map it to multiple output elements?</p>
<p>That becomes necessary in the following example: The React component <code>TagList</code> is invoked with two attributes</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;TagList tags=&#123;[<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>]&#125; handleClick=&#123;x =&gt; <span class="built_in">console</span>.log(x)&#125; /&gt;</div></pre></td></tr></table></figure>
<p>The attributes are:</p>
<ul>
<li><p>An Array of tags, each tag being a string</p>
</li>
<li><p>A callback for handling clicks on tags</p>
</li>
</ul>
<p><code>TagList</code> is rendered as a series of links seperated by commas:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">class TagList extends React.Component &#123;</div><div class="line">  render () &#123;</div><div class="line">    const &#123; tags, handleClick &#125; = this.props</div><div class="line">    return flatMap(tags, (tag, index) =&gt; [</div><div class="line">      ...(index &gt; 0 ? [', '] : []),</div><div class="line">      &lt;a key=&#123;index&#125; href="" onClick=&#123;e =&gt; handleClick(tag, e)&#125;&gt;</div><div class="line">        &#123;tag&#125;</div><div class="line">      &lt;/a&gt;</div><div class="line">    ])</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Here each tag (except the first) provide two elements in the rendered Array</p>
<h1 id="Arbitrary-Iterables"><a href="#Arbitrary-Iterables" class="headerlink" title="Arbitrary Iterables"></a>Arbitrary Iterables</h1><p><code>flatMap</code> can be generalized to work with arbitrary iterables</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">flatMapIter</span>(<span class="params">iterable, mapFunc</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> index = <span class="number">0</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> x <span class="keyword">of</span> iterable) &#123;</div><div class="line">    <span class="keyword">yield</span>* mapFunc(x, index)</div><div class="line">    index++</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>flatMapIter</code> function works with Arrays:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fillArray</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Array</span>(x).fill(x)</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log([...flatMapIter([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], fillArray)])</div></pre></td></tr></table></figure>
<h1 id="Implementing-flatMap-via-reduce"><a href="#Implementing-flatMap-via-reduce" class="headerlink" title="Implementing flatMap via reduce"></a>Implementing <code>flatMap</code> via <code>reduce</code></h1><p>You can use the Array method <code>reduce</code> to implement a simple version of <code>flatMap</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatMap</span> (<span class="params">arr, mapFunc</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> arr.reduce(</div><div class="line">    <span class="function">(<span class="params">prev, x</span>) =&gt;</span> prev.concat(mapFunc(x)),</div><div class="line">    [],</div><div class="line">  )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Related-to-flatMap-flatten"><a href="#Related-to-flatMap-flatten" class="headerlink" title="Related to flatMap: flatten"></a>Related to <code>flatMap</code>: <code>flatten</code></h1><p><code>flatten</code> is an operation that concatenates all the elements of an Array</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; flatten([<span class="string">'a'</span>, [<span class="string">'b'</span>, <span class="string">'c'</span>], [<span class="string">'d'</span>]])</div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</div></pre></td></tr></table></figure>
<p>It can be implemented as follows:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> flatten = <span class="function">(<span class="params">arr</span>) =&gt;</span> [].concat(...arr)</div></pre></td></tr></table></figure>
<p>So the following expressions are equivalent</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">flatten(arr.map(func))</div><div class="line">flatMap(arr, x =&gt; x)</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[new babel preset - env]]></title>
      <url>/2017/05/21/new-babel-preset-env/</url>
      <content type="html"><![CDATA[<p><code>babel-preset-env</code> is a new preset which let you specify an environment and automatically enables the necessary plugins.</p>
<p>At the moment, several presets let you determine what features Babel should support:</p>
<ul>
<li><p><code>babel-preset-es2015</code>, <code>babel-preset-es2016</code>, etc: incrementally support various versions of ECMAScript. <code>babel-preset-es2015</code> transpiles what’s new in ES6 to ES5, <code>babel-preset-es2016</code> transpiles what’s new in ES7 to ES6.</p>
</li>
<li><p><code>babel-preset-latest</code>: supports all features that are either part of an ECMAScript version or at stage 4.</p>
</li>
</ul>
<p>The problem with these presets is that they often do too much. For example, most modern browsers support ES6 generator. Yet if you use <code>babel-preset-es2015</code>, generator functions will always be transpiled to complex ES5 code.</p>
<p><code>babel-preset-env</code> works like <code>babel-preset-latest</code>, but it lets you specify an environment and only transpiles features that are missing in that environment.</p>
<p>Note that you need to install and enable plugins and/or presets for experimental features(that are not part of <code>babel-preset-latest</code>)</p>
<p>On the plus side, you don’t need <code>es2015</code> presets anymore.</p>
<h1 id="Browsers"><a href="#Browsers" class="headerlink" title="Browsers"></a>Browsers</h1><p>For browsers you have the option to specify either:</p>
<ul>
<li><p>Browsers via <code>browserslist</code> query syntax</p>
<ul>
<li><p>Support the last two versions of browsers and IE 7+</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="string">"babel"</span>: &#123;</div><div class="line">  <span class="string">"presets"</span>: [</div><div class="line">    [</div><div class="line">      <span class="string">"env"</span>,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"targets"</span>: &#123;</div><div class="line">          <span class="string">"browsers"</span>: [<span class="string">"last 2 versions"</span>, <span class="string">"ie &gt;= 7"</span>]</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Support browsers that have more than 5% market share</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">"targets"</span>: &#123;</div><div class="line">  <span class="string">"browsers"</span>: <span class="string">"&gt; 5%"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Fixed versions of browsers:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">"targets"</span>: &#123;</div><div class="line">  <span class="string">"chrome"</span>: <span class="number">56</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h1><p>If you compile your code for Node.js on the fly via Babel, <code>babel-preset-env</code> is especially useful, because it react to the currently running version of Node.js if you set the target <code>node</code> to <code>current</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="string">"babel"</span>: &#123;</div><div class="line">  <span class="string">"presets"</span>: [</div><div class="line">    [</div><div class="line">      <span class="string">"env"</span>,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"target"</span>: &#123;</div><div class="line">          <span class="string">"targets"</span>: &#123;</div><div class="line">            <span class="string">"node"</span>: <span class="string">"current"</span></div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Additional-Options-for-babel-preset-env"><a href="#Additional-Options-for-babel-preset-env" class="headerlink" title="Additional Options for babel-preset-env"></a>Additional Options for <code>babel-preset-env</code></h1><h2 id="modules-string-default-‘commonjs’"><a href="#modules-string-default-‘commonjs’" class="headerlink" title="modules(string, default: ‘commonjs’)"></a>modules(string, default: ‘commonjs’)</h2><p>This options lets you configure to which module format ES6 modules are transpiled:</p>
<ul>
<li><p>Transpile to popular module formats: ‘amd’, ‘commonjs’, ‘systemjs’, ‘umd’</p>
</li>
<li><p>Don’t transpile: false</p>
</li>
</ul>
<h2 id="include-exclude-Array-of-strings-default"><a href="#include-exclude-Array-of-strings-default" class="headerlink" title="include, exclude (Array of strings, default [])"></a>include, exclude (Array of strings, default [])</h2><ul>
<li><p>include: always enables certain plugins</p>
</li>
<li><p>exclude: prevents certain plugins from being enabled</p>
</li>
</ul>
<h2 id="useBuiltIns-boolean-default-false"><a href="#useBuiltIns-boolean-default-false" class="headerlink" title="useBuiltIns (boolean, default: false)"></a>useBuiltIns (boolean, default: false)</h2><p>Babel comes with a polyfill for new functionality in standard library. <code>babel-preset-env</code> can optionally import only those parts of the polyfill that are needed on the specified platforms:</p>
<p>There are two ways of using the polyfill:</p>
<ul>
<li><p><code>core-js</code> polyfills ES5, ES6+ as needed</p>
<ul>
<li><p>install polyfill: <code>yarn add core-js</code></p>
</li>
<li><p>activate polyfill: <code>import &#39;core-js&#39;</code></p>
</li>
</ul>
</li>
<li><p><code>babel-polyfill</code>: polyfills <code>core-js</code> and regenerator runtime(to emulate generators on ES5)</p>
<ul>
<li><p>install polyfill: <code>yarn add babel-polyfill</code></p>
</li>
<li><p>activate polyfill: <code>import &#39;babel-polyfill&#39;</code></p>
</li>
</ul>
</li>
</ul>
<p>Either of the two import statements is transpiled to an environment-specific sequence of more fine-grained imports:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/es7.string.pad-start"</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/es7.string.pad-end"</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/web.timers"</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/web.immediate"</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/web.dom.iterable"</span>;</div></pre></td></tr></table></figure>
<h2 id="debug-boolean-default-false"><a href="#debug-boolean-default-false" class="headerlink" title="debug (boolean, default: false)"></a>debug (boolean, default: false)</h2><p>Logs the following information via <code>console.log()</code></p>
<ul>
<li><p>Targeted environments</p>
</li>
<li><p>Enabled transformers</p>
</li>
<li><p>Enabled plugins</p>
</li>
<li><p>Enabled polyfills</p>
</li>
</ul>
<h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"presets"</span>: [</div><div class="line">    [<span class="string">"env"</span>,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"targets"</span>: &#123;</div><div class="line">          <span class="attr">"safari"</span>: <span class="number">10</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">"modules"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">"useBuiltIns"</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">"debug"</span>: <span class="literal">true</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[babel-polyfill or babel-runtime]]></title>
      <url>/2017/05/21/babel-polyfill-or-babel-runtime/</url>
      <content type="html"><![CDATA[<p>The <code>babel-polyfill</code> and <code>babel-runtime</code> modules are sued to serve the same function in two different ways. Both modules ultimately serve to emulate an ES6 environment.</p>
<p>Both <code>babel-polyfill</code> and <code>babel-runtime</code> emulate an ES6 environment with two things:</p>
<ul>
<li><p>a slew of polyfills as provided by <code>core-js</code></p>
</li>
<li><p>complete generator runtime</p>
</li>
</ul>
<p><code>babel-polyfill</code> accomplishes this task by assigning methods on the global or on native type prototypes which means that once required, as far as the javascript runtime you’re using is concerned, ES6 methods and object simply exist. If you were to require <code>babel-polyfill</code> in a script run under <strong>node v0.1.0</strong> – a runtime which does not natively support the <code>Promise</code> API – your script would then have access to the <code>Promise</code> object. As far as you are concerned, you’re suddenly using an environment that support the <code>Promise</code> object.</p>
<p><code>babel-runtime</code> does something very similar, but in a way that does not pollute native object prototypes or the global namespace. Instead, <code>babel-runtime</code> is a module that you can list as a dependency of your application like any other module, which polyfills ES6 methods. In other words and continuing the example from above, while you may not have the <code>Promise</code> object available to you, you now have the same functionality available to you from <code>require(&#39;babel-runtime/core-js/promise&#39;)</code>. By itself, this is useful but inconvenient. Fortunately, <code>babel-runtime</code> is not intended to be used by itself. Rather, <code>babel-runtime</code> is intended to be paired with the transform – <code>babel-plugin-transform-runtime</code> – which will automatically rewrite your code such that you can write your code using the <code>Promise</code> API and it will be transformed to use the Promise-like object exported by <code>babel-runtime</code></p>
<p><code>babel-polyfill</code> offers you the conveniences of gloablly defined objects without having to transform your code further. However, as with anything that mutates a global, this can introduce collision between versions, etc.</p>
<p><code>babel-runtime</code>, on the other hand, will not suffer from collision as everything is name-spcaed. Since the module will be defined in your package.json, it can be versioned like everything else. The tradeoff, however, is that a transform can only do so much. The runtime remaps methods according to a definitions map. Anecdotally, this has covered each of my use-cases but there may be an obscure method or two which is not remapped. There are also certain cases where your intent is ambiguous. In such cases, the transform won’t know exactly what to do.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>To summarize, with the general case for Babel 6, there are two main steps you’ll need to perform:</p>
<ul>
<li>Provide your code with an emulated ES6 environment by either requiring <code>babel-polyfill</code> or requiring the <code>babel-runtime</code> module plus the <code>babel-plugin-transform-runtime</code> transform:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// for babel-polyfill, either add:</span></div><div class="line"><span class="built_in">require</span>(<span class="string">'babel-polyfill'</span>)</div><div class="line"></div><div class="line"><span class="comment">// for babel-runtime, install the module, then use the babel-plugin-transform-runtime transform by including it in your .babelrc file.</span></div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Deep in Runtime-Transform]]></title>
      <url>/2017/05/21/Deep-in-Runtime-Transform/</url>
      <content type="html"><![CDATA[<p>This plugin is recommended in a <strong>library/tool</strong></p>
<blockquote>
<p>Note: Instance methods such as <code>&#39;foobar&#39;.includes(&#39;foo&#39;)</code> will not work since that would require modification of existing built-ins(Use <code>babel-polyfill</code> for that)</p>
</blockquote>
<p>Babel uses very small helpers for common functions such as <code>_extend</code>. By default this will be added to every file that requires it. This duplication is sometimes unnecessary, especially when your application is spread out over multiple files.</p>
<p>This is where the <code>transform-runtime</code> plugin comes in: all of the helpers will reference the module <code>babel-runtime</code> to avoid duplication across your compiled output. The runtime will be compiled into your build.</p>
<p>Another purpose of this transformer is to create a sandboxed environment for your code. If you use <code>babel-polyfill</code> and the built-ins it provides such as <code>Promise</code>, <code>Set</code> and <code>Map</code>, those will pollute the global scope. While this might be ok for an app or a command line tool, it becomes a problem if your code is a library which you intend to publish for other to use or if you can’t exactly control the environment in which your code will run.</p>
<p>The transformer will alias these built-ins to <code>core-js</code> so you can use them seamlessly without having to require the polyfill.</p>
<h1 id="Prod-and-Dev"><a href="#Prod-and-Dev" class="headerlink" title="Prod and Dev"></a>Prod and Dev</h1><p>In most cases, you should install <code>babel-plugin-transform-runtime</code> as a development dependency, and <code>babel-runtime</code> as a production dependency.</p>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>I prefer to use <code>.babelrc</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;plugins&quot;: [</div><div class="line">    [&quot;transform-runtime&quot;, &#123;</div><div class="line">      &quot;helpers&quot;: false,</div><div class="line">      &quot;polyfill&quot;: false,</div><div class="line">      &quot;regenerator&quot;: true,</div><div class="line">      &quot;moduleName&quot;: &quot;babel-runtime&quot;</div><div class="line">    &#125;]</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>There the options are referred.</p>
<ul>
<li>helpers: boolean, default to <code>true</code></li>
</ul>
<p>Toggles whether or not inlined babel helpers (<code>classCallCheck</code>, <code>extends</code>, etc) are replaced with calls to <code>moduleName</code>.</p>
<ul>
<li>polyfill: boolean, default to be <code>true</code></li>
</ul>
<p>Toggles whether or not new built-ins(<code>Promise</code>, <code>Set</code>, <code>Map</code>, etc) are transformed to use a non-global polluting polyfill.</p>
<ul>
<li>renegerator: boolean, default to <code>true</code></li>
</ul>
<p>Toggles whether or not generator functions are transforms to use a regenerator runtime that does not pollute the global scope.</p>
<ul>
<li>moduleName: string, default to <code>babel-runtime</code></li>
</ul>
<p>Set the name/path of the module used when importing helpers.</p>
<p>Example:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"moduleName"</span>: <span class="string">"flavortown/runtime"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> extends <span class="keyword">from</span> <span class="string">'flavortown/runtime/helpers/extend'</span></div></pre></td></tr></table></figure>
<h1 id="Technical-Details"><a href="#Technical-Details" class="headerlink" title="Technical Details"></a>Technical Details</h1><p>The <code>runtime</code> transformer plugin does three things:</p>
<ul>
<li><p>Automatically requires <code>babel-runtime/renegerator</code> when you use generator/async functions;</p>
</li>
<li><p>Automatically requires <code>babel-runtime/core-js</code> and maps ES6 static methods and built-ins;</p>
</li>
<li><p>Removes the inline Babel helpers and uses the module <code>babel-runtime/helpers</code> instead.</p>
</li>
</ul>
<p>You can use built-ins such as <code>Promise</code>, <code>Set</code>, <code>Symbol</code>, etc., as well as use all the Babel features taht require a polyfill seamlessly, without global pollution, making it extremely suitable for libraries.</p>
<h2 id="Regenerator-aliasing"><a href="#Regenerator-aliasing" class="headerlink" title="Regenerator aliasing"></a>Regenerator aliasing</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> * <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>the following is generated</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> _marked = [foo].map(regeneratorRuntime.mark)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> regeneratorRuntime.wrap(<span class="function"><span class="keyword">function</span> <span class="title">foo$</span>(<span class="params">_context</span>) </span>&#123;</div><div class="line">    <span class="keyword">while</span> (<span class="number">1</span>) <span class="keyword">switch</span> (_context_prev = _context.next) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">      <span class="keyword">case</span> <span class="string">'end'</span>:</div><div class="line">        <span class="keyword">return</span> _context.stop()</div><div class="line">    &#125;</div><div class="line">  &#125;, _marked[<span class="number">0</span>], <span class="keyword">this</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This isn’t ideal as then you have to include the regenerator runtime which pollutes the global scope.</p>
<p>Instead what the <code>runtime</code> transformer does it compile that to:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> _regenerator = <span class="built_in">require</span>(<span class="string">'babel-runtime/regenerator'</span>)</div><div class="line"><span class="keyword">var</span> _regenerator2 = _interopRequireDefault(_regenerator)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">_interopRequireDefault</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : &#123; <span class="attr">default</span>: obj &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> _marked = [foo].map(_regenerator2.default.mark)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> regeneratorRuntime.wrap(<span class="function"><span class="keyword">function</span> <span class="title">foo$</span>(<span class="params">_context</span>) </span>&#123;</div><div class="line">    <span class="keyword">while</span> (<span class="number">1</span>) <span class="keyword">switch</span> (_context_prev = _context.next) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'0'</span>:</div><div class="line">      <span class="keyword">case</span> <span class="string">'end'</span>:</div><div class="line">        <span class="keyword">return</span> _context.stop()</div><div class="line">    &#125;</div><div class="line">  &#125;, _marked[<span class="number">0</span>], <span class="keyword">this</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This means that you can use the regenerator runtime without polluting your current environment.</p>
<p>The same actions with Core-js Aliasing and Helper Aliasing.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[More Faster React Functional Component]]></title>
      <url>/2017/05/21/More-Faster-React-Functional-Component/</url>
      <content type="html"><![CDATA[<p><a href="https://medium.com/missive-app/45-faster-react-functional-components-now-3509a668e69f" target="_blank" rel="external">origin</a></p>
<p>An basic <code>Avatar</code> Component:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Avatar</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;this.props.url&#125;</span> /&gt;</span></span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>And its functional component style is:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Avatar = <span class="function">(<span class="params">&#123; url &#125;</span>) =&gt;</span> &lt;img src=&#123;url&#125; /&gt;</div></pre></td></tr></table></figure>
<p>As you can see, it’s just a simple js function returning an element.</p>
<p>React still does a lot of stuff on functional components that, by nature, will never be used.</p>
<p>But we can skip React internals for these functional component.</p>
<p>They are just plain JavaScritp functions, which means we can call it in the render function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ReactDOM.render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">    &#123;Avatar(&#123; url: avatarUrl &#125;)&#125;</div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;commentBody&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span>,</div><div class="line">  mountNode,</div><div class="line">)</div></pre></td></tr></table></figure>
<p>As we know, the traditional usage:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Avatar url=&#123;avatarUrl&#125; /&gt;</div></pre></td></tr></table></figure>
<p>will be compiled into</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">React.createElement(Avatar, &#123; <span class="attr">url</span>: avatarUrl &#125;)</div></pre></td></tr></table></figure>
<p>It will cost a lifecycle of a React Component.</p>
<p>But with direct calling of plain JavaScritp Function, all these consumption can be eliminated.</p>
<p>By the way, <code>transform-react-inline-elements</code> does the same as a bebel transform, so there’s no need to change the source code.</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[css shorthand collection]]></title>
      <url>/2017/05/19/css-shorthand-collection/</url>
      <content type="html"><![CDATA[<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">  <span class="attribute">background</span>:</div><div class="line">    <span class="built_in">url</span>(...) <span class="comment">/* image */</span></div><div class="line">    top center / <span class="number">200px</span> <span class="number">200px</span> <span class="comment">/* position / size */</span></div><div class="line">    no-repeat <span class="comment">/* repeat */</span></div><div class="line">    fixed <span class="comment">/* attachment */</span></div><div class="line">    padding-box <span class="comment">/* origin */</span></div><div class="line">    content-box <span class="comment">/* clip */</span></div><div class="line">    red; <span class="comment">/* color */</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[usage of grid in css]]></title>
      <url>/2017/05/18/usage-of-grid-in-css/</url>
      <content type="html"><![CDATA[<p><a href="https://css-tricks.com/snippets/css/complete-guide-grid/" target="_blank" rel="external">origin</a></p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>CSS Grid Layout (aka ‘Grid’), is a two-dimensional grid-based layout system that aims to do nothing less than completely change the way we design grid-based user interfaces.</p>
<h1 id="Terminology"><a href="#Terminology" class="headerlink" title="Terminology"></a>Terminology</h1><h2 id="Grid-Container"><a href="#Grid-Container" class="headerlink" title="Grid Container"></a>Grid Container</h2><p>The element on which <code>display: grid</code> is applied. It’s the direct parent of all the grid items. In this example <code>container</code> is the grid container.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item item-1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item item-2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item item-3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="Grid-Item"><a href="#Grid-Item" class="headerlink" title="Grid Item"></a>Grid Item</h2><p>The children (e.g. <strong>direct</strong> descendants) of the grid container. Here the <code>item</code> elements are grid items, but <code>sub-item</code> isn’t.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"sub-item"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="Grid-Line"><a href="#Grid-Line" class="headerlink" title="Grid Line"></a>Grid Line</h2><p>The dividing lines that make up the structure of the grid. They can be either vertical(<code>column grid line</code>) or horizontal(<code>row grid line</code>) and reside on either side of a row or column. Here the yellow line is an example of a column grid line.</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-line.png" alt=""></p>
<h2 id="Grid-Track"><a href="#Grid-Track" class="headerlink" title="Grid Track"></a>Grid Track</h2><p>The space between two adjacent grid lines. You can think of them like the columns or rows of the grid. Here’s the grid track between second and third row grid lines.</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-track.png" alt=""></p>
<h2 id="Grid-Cell"><a href="#Grid-Cell" class="headerlink" title="Grid Cell"></a>Grid Cell</h2><p>The space between two adjacent row and two adjacent column lines. It’s a single ‘unit’ of the grid. Here’s the grid cell between row grid lines 1 and line2, and column grid lines 2 and 3.</p>
<h2 id="Grid-Area"><a href="#Grid-Area" class="headerlink" title="Grid Area"></a>Grid Area</h2><p>The total space surrounded by four grid lines. A grid area may be comprised of any number of grid cells. Here’s the grid area between row and grid lines 1 and 3, and column grid lines 1 and 3.</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-area.png" alt=""></p>
<h1 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h1><h2 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h2><ul>
<li><p>display</p>
<ul>
<li><p>grid: generates a <strong>block-level</strong> grid</p>
</li>
<li><p>inline-grid: generates an inline level grid</p>
</li>
<li><p>subgrid: if your grid container is itself a grid item(i.e. nested grids), you can use this property to indicate that you want the sizes of its rows/columns to be taken from its parent rather than specifying its own.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line"> <span class="attribute">display</span>: grid | inline-grid | subgrid;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p><code>column</code>, <code>float</code>, <code>clear</code> and <code>vertical-align</code> have no effect on a grid container</p>
</blockquote>
</li>
</ul>
</li>
<li><p>grid-template-rows &amp; grid-template-columns</p>
<ul>
<li><p><track-size>: can be a length, a percentage, or a function of the free space in the grid(using the <code>fr</code> unit)</track-size></p>
</li>
<li><p><line-name>: an arbitrary name of your choosing</line-name></p>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line">  <span class="attribute">grid-template-columns</span>: &lt;track-size&gt; | [&lt;line-name&gt;] &lt;track-size&gt;;</div><div class="line">  <span class="attribute">grid-template-rows</span>: &lt;track-size&gt; | &lt;line-name&gt; &lt;track-size&gt;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>A line can have more than one name, seperated by spcae.</p>
</blockquote>
<p>You can use <code>repeat()</code> notation to streamline things:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(3, 20px [col-start]) <span class="number">5%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The <code>fr</code> unit allows you to set the size of a track as a fraction of the free space of the grid container.</p>
<p>The free space is calculated <strong>after</strong> any non-flexible items.</p>
</li>
<li><p>grid-template-areas:</p>
<ul>
<li><p><grid-area-name>: the name of a grid area specified with <code>grid-area</code></grid-area-name></p>
</li>
<li><p><code>.</code>: a period signifies an empty grid cell.</p>
</li>
<li><p>none: no grid areas are defined.</p>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line">  <span class="attribute">grid-template-areas</span>: &lt;grid-area-name&gt; | . | none;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.item-a</span> &#123;</div><div class="line">  <span class="attribute">grid-area</span>: header;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.item-b</span> &#123;</div><div class="line">  <span class="attribute">grid-area</span>: main;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.item-c</span> &#123;</div><div class="line">  <span class="attribute">grid-area</span>: sidebar;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.item-d</span> &#123;</div><div class="line">  <span class="attribute">grid-area</span>: footer;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(4, 50px);</div><div class="line">  <span class="attribute">grid-template-rows</span>: auto;</div><div class="line">  <span class="attribute">grid-template-areas</span>:</div><div class="line">    <span class="string">'header header header header'</span></div><div class="line">    <span class="string">'main main . sidebar'</span></div><div class="line">    <span class="string">'footer footer footer footer'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-template-areas.png" alt=""></p>
</li>
<li><p>grid-template: a shorthand for setting <code>grid-template-rows</code>, <code>grid-template-columns</code> and <code>grid-template-areas</code> in a single decalration.</p>
<ul>
<li><p>none: sets all three properties to their initial values</p>
</li>
<li><p>subgrid: sets <code>grid-template-rows</code>, <code>grid-template-columns</code> to <code>subgrid</code>, and <code>grid-template-areas</code> to its initial value.</p>
</li>
<li><p><grid-template-rows>/<grid-template-columns>: sets <code>grid-template-rows</code> and <code>grid-template-columns</code> to the specified values, respectively, and sets <code>grid-template-areas</code> to <code>none</code></grid-template-columns></grid-template-rows></p>
</li>
</ul>
</li>
<li><p>grid-column-gap &amp; grid-column-gap: Specifies the size of the grid lines. You can think of it like setting the width of the gutters between the columns/rows.</p>
<ul>
<li><line-size>: a length value</line-size></li>
</ul>
</li>
<li><p>grid-gap: a shorthand for <code>grid-row-gap</code> and <code>grid-column-gap</code></p>
</li>
<li><p>justify-items: Aligns the content inside a grid item along with the <em>row</em> axis</p>
<ul>
<li><p>start: aligns the content to the left end of the grid area</p>
</li>
<li><p>end: aligns the content to the right end of the grid area</p>
</li>
<li><p>center: aligns the content in the center of the grid area</p>
</li>
<li><p>stretch: fills the whole width of the grid area(this is the default)</p>
</li>
</ul>
<blockquote>
<p>This behavior can also be set on individual grid items via the <code>justify-self</code> property</p>
</blockquote>
</li>
<li><p>align-items: aligns the content inside a grid item along the <em>column</em> axis. This value applies to all grid items inside the container.</p>
<ul>
<li><p>start: aligns the content to the top of the grid area</p>
</li>
<li><p>end: aligns the content to the bottom of the grid area</p>
</li>
<li><p>center: aligns the content in the center of the grid area</p>
</li>
<li><p>stretch: fills the whole height of the grid area(this is the default)</p>
</li>
</ul>
<blockquote>
<p>This behavior can also be set on individual grid items via the <code>align-self</code> properties.</p>
</blockquote>
</li>
<li><p>justify-content: Sometimes the total size of your grid might be less than the size of its grid container. This could happen if all of your grid items are sized with non-flexible units like <code>px</code>. In this case you can set the alignment of the grid within the grid container. This property aligns the grid along the <em>row</em> axis.</p>
<ul>
<li><p>start: aligns the grid to the left end of the grid container</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch: <strong>resize</strong> the grid items to allow the grid to fill the full width of the grid container.</p>
</li>
<li><p>space-around: places an even amount of space between each grid item, with half-sized spaces on the far ends.</p>
</li>
<li><p>space-between: places an event amount of space between each grid item, with no space at the far ends.</p>
</li>
<li><p>space-evenly: places an even amount of space between each grid item, including the far ends</p>
</li>
</ul>
</li>
<li><p>align-content:</p>
<ul>
<li><p>start</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch</p>
</li>
<li><p>space-around</p>
</li>
<li><p>space-between</p>
</li>
<li><p>space-evenly</p>
</li>
</ul>
</li>
<li><p>grid-auto-columns &amp; grid-auto-rows:</p>
<ul>
<li><track-size>: can be a length, a percentage, or a fraction of the free space in the grid(using the <code>fr</code> unit)</track-size></li>
</ul>
<p>To illustrate how implicit grid tracks get created, think about this:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">60px</span> <span class="number">60px</span>;</div><div class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">90px</span> <span class="number">90px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This creates a 2 x 2 grid</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-auto.png" alt=""></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.item-a</span> &#123;</div><div class="line">  <span class="attribute">grid-row</span>: <span class="number">2</span>/<span class="number">3</span>;</div><div class="line">  <span class="attribute">grid-column</span>: <span class="number">1</span>/<span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.item-b</span> &#123;</div><div class="line">  <span class="attribute">grid-row</span>: <span class="number">2</span>/<span class="number">3</span>;</div><div class="line">  <span class="attribute">grid-column</span>: <span class="number">5</span>/<span class="number">6</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/implicit-tracks.png" alt=""></p>
<p>We told <code>.item-b</code> to start on column line 5 and end at column line 6, <em>but we never defined a column 5 or 6</em>.</p>
<p>Because we referenced lines that don’t exist, implicit track with widths of 0 are created to fill in the gap.</p>
<p>We can use <code>grid-auto-column</code> and <code>grid-auto-row</code> to specify the widths of these implicit tracks:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span> &#123;</div><div class="line">  <span class="attribute">grid-auto-columns</span>: <span class="number">60px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/implicit-tracks-with-widths.png" alt=""></p>
</li>
<li><p>grid-auto-flow: If you have grid items that you don’t explicitly place on the grid, the <em>auto-placement algorithm</em> kicks in to automatically place the items. This properties controls how the auto-placement algorithm works.</p>
<ul>
<li><p>row: tells the auto-placement algorithm to fill in each row in turn. adding new rows as necessary.</p>
</li>
<li><p>column: tells the auto-placement algorithm to fill in each column in turn, adding new columns as necessary.</p>
</li>
<li><p>dense: tells the auto-placement algorithm to attempt to fill in holes earlier in the grid if smaller items come up later.</p>
</li>
</ul>
<blockquote>
<p><code>dense</code> might cause your items to appear out of order</p>
</blockquote>
</li>
<li><p>grid: a shorthand for setting all of the following properties in a single declaration:</p>
<ul>
<li><code>grid-template-rows</code>, <code>grid-template-columns</code>, <code>grid-template-areas</code>, <code>grid-auto-rows</code>, <code>grid-auto-columns</code>, <code>grid-auto-flow</code></li>
</ul>
</li>
</ul>
<h2 id="Items"><a href="#Items" class="headerlink" title="Items"></a>Items</h2><ul>
<li><p>grid-column-start &amp; grid-column-end &amp; grid-row-start &amp; grid-row-end</p>
<ul>
<li><p>determines a grid item’s location within the grid by referring to specific grid line.</p>
</li>
<li><line></line>: can be number to refer to a numbered grid line, or a name to refer to a named grid line
</li>
<li><p>span</p>
<number>: the item will span across the provided number of grid tracks</number>
</li>
<li><p>span</p>
<name>: the item will span across until it hits the next line with the provided name</name>
</li>
<li><p>auto</p>
</li>
</ul>
</li>
<li><p>grid-column &amp; grid-row: shorthand for <code>grid-column-start</code> + <code>grid-column-end</code> and <code>grid-row-start</code> + <code>grid-row-end</code>, respectively.</p>
<ul>
<li><start-value> / <end-value><br></end-value></start-value></li>
</ul>
</li>
<li><p>grid-area: gives an item a name so that it can be referenced by a template created with the <code>grid-template-areas</code> property. Alternatively, this property can be used as an even shorter shorthand for <code>grid-row-start</code> + <code>grid-column-start</code> + <code>grid-row-end</code> + <code>grid-column-end</code>.</p>
<ul>
<li><name>: a name of your choosing</name>
</li>
<li><p><row-start> / <column-start> / <row-end> / <column-end><br></column-end></row-end></column-start></row-start></p>
</li>
</ul>
</li>
<li><p>justify-self: aligns the content inside a grid item along the row axis. This value applies to the content inside a single item.</p>
<ul>
<li><p>start</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch</p>
</li>
</ul>
</li>
<li><p>align-self: aligns the content inside a grid item along the column axis. This value applies to the content inside a single grid item.</p>
<ul>
<li><p>start</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch</p>
</li>
</ul>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[simple usage of scp]]></title>
      <url>/2017/05/17/simple-usage-of-scp/</url>
      <content type="html"><![CDATA[<p><a href="https://www.tecmint.com/scp-commands-examples/" target="_blank" rel="external">origin</a></p>
<h1 id="Basic-Syntax-of-SCP"><a href="#Basic-Syntax-of-SCP" class="headerlink" title="Basic Syntax of SCP"></a>Basic Syntax of SCP</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp source_file_name username@destination_host:destination_folder</div></pre></td></tr></table></figure>
<h1 id="Provider-the-detail-information-of-SCP-process-using-v-parameter"><a href="#Provider-the-detail-information-of-SCP-process-using-v-parameter" class="headerlink" title="Provider the detail information of SCP process using -v parameter"></a>Provider the detail information of SCP process using <code>-v</code> parameter</h1><p>Baisc SCP command without parameter will copy the files in background. User will see nothing unless the process is done or something error appears.</p>
<p>You can use <code>-v</code> parameter to print debug information into screen.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># verbose</span></div><div class="line">scp -v source_file_name username@destination_host:destination_folder</div></pre></td></tr></table></figure>
<h1 id="Provider-modification-times-access-times-and-modes-from-original-files"><a href="#Provider-modification-times-access-times-and-modes-from-original-files" class="headerlink" title="Provider modification times, access times, and modes from original files"></a>Provider modification times, access times, and modes from original files</h1><p>The <code>-p</code> (lowercase) parameter will help you on this. An estimated time and the connection speed will apear on the screen.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># process</span></div><div class="line">scp -p source_file_name username@destination_host:destination_folder</div></pre></td></tr></table></figure>
<h1 id="Make-file-transfer-faster-using-C-parameter"><a href="#Make-file-transfer-faster-using-C-parameter" class="headerlink" title="Make file transfer faster using -C parameter"></a>Make file transfer faster using <code>-C</code> parameter</h1><p>One of parameter that can faster your file transfer is <code>-C</code> parameter. The <code>-C</code> parameter will compress your file on the go. The unique thing is the compression is only happen in the network. When the file is arrived to the destination server, it will returning into the original size as before the compression happen.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Compression</span></div><div class="line">scp -Cpv source_file_name username@destination_host:destination_folder</div></pre></td></tr></table></figure>
<h1 id="Specify-specific-port-to-use-with-SCP"><a href="#Specify-specific-port-to-use-with-SCP" class="headerlink" title="Specify specific port to use with SCP"></a>Specify specific port to use with SCP</h1><p>Usually SCP is using port 22 as a default port. But for security reason, you may change the port into another port.</p>
<p>Use <code>-P</code> (uppercase) to specify the port.</p>
<p><code>`bash
scp -P 2212 source_file_name username@destination_host:destination_folder</code></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Rxjs API]]></title>
      <url>/2017/05/08/Rxjs-API/</url>
      <content type="html"><![CDATA[<h1 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h1><p>You can create an Observable from scratch by using the <code>Create</code> operator. You pass this operator a function that accepts the observer as its parameter. Write this function so that it behaves as an Observable – by calling the observer’s <code>onNext</code>, <code>onError</code>, and <code>onCompleted</code> methods appropraitely.</p>
<p>A well-formed finite Observable must attempt to call either the observer’s <code>onCompleted</code> method exactly once or its <code>onError</code> method exactly once, and must not thereafter attempt to call any of the observer’s other methods.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> source = Rx.Observable.create(<span class="function"><span class="keyword">function</span>(<span class="params">observer</span>) </span>&#123;</div><div class="line">  observer.onNext(<span class="number">32</span>)</div><div class="line">  observer.onCompleted()</div><div class="line">  <span class="comment">// this is optional.</span></div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'disposed'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">var</span> subscription = source.subscribe(</div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Next: '</span> + x)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Error: '</span> + err)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Completed'</span>)</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h1 id="Defer"><a href="#Defer" class="headerlink" title="Defer"></a>Defer</h1><p>Do not create the Observable until the observer subscribes, and create a fresh Observable for each observer.</p>
<p>The <code>Defer</code> operator waits until an observer subscribes to it, and then it generates an Observable, typically with an Observable factory function. It does this afresh for each subsciber, so although each subscriber may think it is subscribing to the same Observable, in fact each subscriber gets its own individual sequence.</p>
<p>In some circumstances, waiting until the last minute to generate the Observable can ensure that this Observable contains the freshest data.]</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> source = Rx.Observable.defer(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> Rx.Observable.return(<span class="number">42</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">var</span> subscription = source.subscribe(</div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Next: '</span> + x)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Error: '</span> + err)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Completed'</span>)</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h1 id="Empty-Never-Throw"><a href="#Empty-Never-Throw" class="headerlink" title="Empty/Never/Throw"></a>Empty/Never/Throw</h1><p><code>Empty</code> create an Observable that emits no items but terminates normally</p>
<p><code>Never</code> create an Observable that emits no items and does not terminates</p>
<p><code>Throw</code> create an Observable that emits no items and terminates with an error</p>
<p>The <code>Empty</code>, <code>Never</code>, <code>Throw</code> operators generate Observables with very specific and limited behavior. These are useful for testing purposes, and sometimes also for combining with other Observables or as parameters to operators that expect other Observables as parameters.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> source = Rx.Observable.empty()</div><div class="line"></div><div class="line"><span class="keyword">var</span> source = Rx.Observable.never()</div><div class="line"></div><div class="line"><span class="keyword">var</span> source = Rx.Observable.return(<span class="number">52</span>).selectMany(Rx.Observable.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error'</span>)))</div></pre></td></tr></table></figure>
<h1 id="From"><a href="#From" class="headerlink" title="From"></a>From</h1><p>Convert various other objects and data types into Observables.</p>
<p>When you work with Observables, it can be more convenient if all of the data you mean to work with can be represented as Observables, rather than as a mixture of Observables and other types. This allows you to use a single set of operators to govern the entire lifespan of the data stream.</p>
<p>Iterables, for example, can be thought of as a sort of synchronous Observable; Futures, as a sort of Observable that always emits only a single item. By explicitly converting such objects to Observables, you allow them to interact as peers with other Observale.</p>
<p>In RxJS, the <code>from</code> operator converts an <em>array-like</em> or <em>iterable</em> object into an Observable that emits the items in that array or iterable. A String, in this context, is treated as an array of characters.</p>
<p>The operator also takes three additional, optional parameters:</p>
<ul>
<li><p>a transforming function that takes an item from the array or iterable as input and produces an item to be emmited by the resulting Observable as output</p>
</li>
<li><p>a second argument to pass into</p>
</li>
</ul>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[detail of node cluster]]></title>
      <url>/2017/05/02/detail-of-node-cluster/</url>
      <content type="html"><![CDATA[<h1 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h1><p>A single instance of Node.js runs in a single tread. To take advantage of multi-core systems the user will sometimes want to launch a cluster of Node.js processes to handle the load.</p>
<p>The cluster module allows you to easily create child processes that all share <strong>server port</strong>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> cluster = <span class="built_in">require</span>(<span class="string">'cluster'</span>)</div><div class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</div><div class="line"><span class="keyword">const</span> numCPUs = <span class="built_in">require</span>(<span class="string">'os'</span>).cpus().length</div><div class="line"></div><div class="line"><span class="keyword">if</span> (cluster.isMaster) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`Master <span class="subst">$&#123;process.pid&#125;</span> is running`</span>)</div><div class="line"></div><div class="line">  <span class="comment">// Fork workers</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; numCPUs; i++) &#123;</div><div class="line">    cluster.fork()</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  cluster.on(<span class="string">'exit'</span>, (worker, code, signal) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`worker <span class="subst">$&#123;worker.process.pid&#125;</span> died`</span>)</div><div class="line">  &#125;)</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  <span class="comment">// Workers can share any TCP connection</span></div><div class="line">  <span class="comment">// In this case it is an HTTP Server</span></div><div class="line"></div><div class="line">  http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</div><div class="line">    res.writeHead(<span class="number">200</span>)</div><div class="line">    res.end(<span class="string">'hello world\n'</span>)</div><div class="line">  &#125;).listen(<span class="number">8000</span>)</div><div class="line"></div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`Worker <span class="subst">$&#123;process.pid&#125;</span> started`</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Running Node.js will now share port 8000 between the workers.</p>
<h1 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works"></a>How it works</h1><p>The workder processes are spawned using the <code>child_process.fort()</code> method, so that they can communicate with the parent via IPC and pass server handles back and forth.</p>
<p>The cluster module supports two methods of distributing incoming connections.</p>
<p>The first one (and the default one on all platform except Windows), is the <strong>round-robin</strong> approch, where the master process listens on a port, accepts new connections and distributes them across the workers in a round-robin fashion, with some built-in smarts to avoid overloading a worker process.</p>
<p>The second approach is where the master process <strong>creates the listen socket and sends it to interested workers</strong>. The workers then accept incoming connection directly.</p>
<p>The second approach should, in theory, give the best performance. In practice however, distribution tends to be <strong>very unbalanced due to operating system scheduler vagaries</strong>. Loads have been observed where over 70% of all connections ended up in just two process, out of a total of eight.</p>
<p>Because <code>server.listen()</code> hands off most of the worker to the master process, there are three case where the behavior between a normal Node.js process and a cluster worker differs:</p>
<blockquote>
<p><code>server.listen({fd: 7})</code> Because the message is passed to the master, file descriptor 7 <strong>in the parent</strong> will be listened on, and the handle passed to the worker, rather than listening to the worker’s idea of what the number 7 file descriptor reference. (the fd will be used up sooner)</p>
<p><code>server.listen(handle)</code> Listening on handles explicitly wil cause the worker to use the supplied handle, rather than talk to the master process. If the worker already has the handle, then it’s presumed that you know what you are doing.</p>
<p><code>server.listen(0)</code> Normally, this will cause servers to listen on a random port. However, in a cluster, each worker will receive the same ‘random’ port each time they do <code>listen(0)</code>. In essence, the port is random the first time, but predicatable thereafter. If you want to listen on a unique port, generate a port number based on the cluster worker ID.</p>
</blockquote>
<p>There is no routing logic in Node.js, or in your program, and no shared state between the workers. Therefore, it is important to design your program such that it does not rely on heavily on in-memory data object for things like sessions and login.</p>
<p>Because workers are all separate processes, they can be killed or re-spawned depending on your program’s needs, without affecting other workers. As long as there are some workers still alive, the server will continue to accept connections. If no workers are alive, existing connections will be dropped and new connections will be refused. Node.js does not automatically manage the number of worker for you, however. It is yoru responsibility to manage the worker pool for your application’s needs.</p>
<h1 id="Class-worker"><a href="#Class-worker" class="headerlink" title="Class: worker"></a>Class: worker</h1><p>A Worder Object contains all public information and method about a worker. In the master it can be obtained using <code>cluster.workers</code>. In a worker it can be obtained using <code>cluster.worker</code></p>
<h2 id="Event-‘disconnect’"><a href="#Event-‘disconnect’" class="headerlink" title="Event: ‘disconnect’"></a>Event: ‘disconnect’</h2><p>Similar to the <code>cluster.on(&#39;disconnect&#39;)</code> event, but specific to this worker.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cluster.fork().on(<span class="string">'disconnect'</span>, () =&gt; &#123;</div><div class="line">  <span class="comment">// Worker has disconnected</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="Event-‘error’"><a href="#Event-‘error’" class="headerlink" title="Event: ‘error’"></a>Event: ‘error’</h2><p>This event is the same as the one provided by <code>child_process.fork()</code></p>
<p>In a worker you can alse use <code>process.on(&#39;error&#39;)</code></p>
<h2 id="Event-‘exit’"><a href="#Event-‘exit’" class="headerlink" title="Event: ‘exit’"></a>Event: ‘exit’</h2><blockquote>
<p><code>code</code></p>
<number> the exit code, if it exited Normally</number>

<p><code>signal</code></p>
<string> the name of the signal(e.g. <strong>SIGHUP</strong>) that caused the process to be killed.</string>

</blockquote>
<p>Similar to the <code>cluster.on(&#39;exit&#39;)</code> event, but specific to this worker</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> worker = cluster.fork()</div><div class="line">worker.on(<span class="string">'exit'</span>, (code, signal) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (signal) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`worker was killed by signal: <span class="subst">$&#123;signal&#125;</span>`</span>)</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code !== <span class="number">0</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`worker exited with error code: <span class="subst">$&#123;code&#125;</span>`</span>)</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'worker success'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="Event-‘listening’"><a href="#Event-‘listening’" class="headerlink" title="Event: ‘listening’"></a>Event: ‘listening’</h2><blockquote>
<p><code>address</code></p>
<object><br>  <p><br></p><br>  <p>Similar to the <code>cluster.on(‘listening’)</code> event, but specific to this worker.</p><br>  <pre><br><br>  <code class="lang-javascript">cluster.fork().on(‘listening’, (address) =&gt; {<br>  // Worker is listening<br>})<br></code><br></pre><br>  <p>It is not emitted in the worker</p><br>  <h4 id="event-message-">Event: ‘message’</h4><br>  <blockquote><br>  <p><code>message</code> <object><br>  <p><br></p><br>  <p><code>handle</code> <undefined> | <object><br>  <p></p><br>  <p>Similar to the <code>cluster.on(‘message’)</code> event, but specific to this worker. In a worker you can also use <code>process.on(‘message’)</code></p><br>  <p>As an example, here is a cluster that keeps count of the number of requests in the master process using the message system:</p><br>  <pre><code class="lang-javascript">const cluster = require(‘cluster’)<br>const http = require(‘http’)<br><br>if (cluster.isMaster) {<br><br>  let numReqs = 0<br><br>  setInterval(() =&gt; {<br>    console.log(<code>numReqs = ${numReqs}</code>)<br>  }, 1000)<br><br>  // Count requests<br>  function messageHandler(msg) {<br>    if (msg.cmd &amp;&amp; msg.cmd === ‘notifyRequest’) {<br>      numReqs++<br>    }<br>  }<br><br>  // Start workers and listen for messages containing notifyRequest<br><br>  const numCPUs = require(‘os’).cpus().length<br><br>  for (let i = 0; i &lt; numCPUs; i++) {<br>    cluster.fork()<br>  }<br><br>  for (const id in cluster.workers) {<br>    cluster.workers[id].on(‘message’, messageHandler)<br>  }<br><br>} else {<br>  // Worker processes have a http server<br>  http.Server((req, res) =&gt; {<br>    res.writeHead(200)<br>    res.end(‘hello world’)<br>    process.send({ cmd: ‘notifyRequest’ })<br>  }).listen(8000)<br>}<br></code></pre><br>  <h4 id="event-online-">Event: ‘online’</h4><br>  <p>Similar to the <code>cluster.on(‘online’)</code> event, but specific to this worker</p><br>  <pre><code class="lang-javascript">cluster.fork().on(‘online’, () =&gt; {<br>  // Worker is online<br>})<br></code></pre><br>  <p>It is not emitted in the worker</p><br>  <h4 id="worker-disconnect-">worker.disconnect()</h4><br>  <blockquote><p>Return: <worker> A reference to <code>worker</code></worker></p></blockquote><br>  <p>In a worker, this function will close all server, wait for the <code>close</code> event on those servers, and disconnect the IPC channel.</p><br>  <p>In the master, an internal message is sent to the worker causing it to call <code>.disconnect()</code> on itself</p><br>  <p>Cause <code>.exitedAfterDisconnect</code> to be set.</p><br>  <p>Note that after a server is closed, it will no longer accept new connections, but connections may be accepted by any other listening worker. Existing connections will be allowed to close as usual. When no more connections exist, see <code>server.close()</code>, the IPC channel to the worker will close allowing it to die gracefully.</p><br>  <p>Note that in a worker, <code>process.disconnect</code> exists, but it is not this function.</p><br>  <p>Because long living server connections may block workers from disconnecting, it may be useful to send a message, so application specific actions may be taken to close them. It also may be useful to implement a timeout, killing a worker if the <code>disconnect</code> event has not been emiited after some time.</p><br>  <pre><code class="lang-javascript">if (cluster.isMaster) {<br>  const worker = cluster.fork()<br>  let timeout<br><br>  worker.on(‘listening’, (address) =&gt; {<br>    worker.send(‘shutdown’)<br>    worker.disconnect()<br>    timeout = setTimeout(() =&gt; {<br>      worker.kill()<br>    }, 2000);<br>  })<br><br>  worker.on(‘disconnect’, () =&gt; {<br>    clearTimeout(timeout)<br>  })<br>} else if (cluster.isWorker){<br>  const net = require(‘net’)<br>  const server = net.createServer((socket) =&gt; {<br>    // connections never end<br>  })<br>  server.listen(8000)<br><br>  process.on(‘messaage’, (msg) =&gt; {<br>    if (msg === ‘shutdown’) {<br>      // initiate graceful close of any connections to server<br>    }<br>  })<br>}<br></code></pre><br>  <h4 id="worker-exitedafterdisconnect">worker.exitedAfterDisconnect</h4><br>  <blockquote><boolean><br></boolean></blockquote><br>  <p>Set by calling <code>.kill()</code> or <code>.disconnect()</code>. Until then, it is <code>undefined</code></p><br>  <p>The boolean <code>worker.exitedAfterDisconnect</code> lets you distinguish between voluntary and accidental exit, the master may choose not to respawn a worker based on this value.</p><br>  <pre><code class="lang-javascript">cluster.on(‘exit’, (worker, code, signal) =&gt; {<br>  if (worker.exitedAfterDisconnect === true) {<br>    console.log(‘Oh, it was just voluntary - no need to worry’)<br>  }<br>})<br><br>// kill worker<br>worker.kill()<br></code></pre><br>  <h4 id="worker-id">worker.id</h4><br>  <blockquote><number><br></number></blockquote><br>  <p>Each new worker is given its own unique id, this id is stored in the <code>id</code></p><br>  <p>While a worker is alive, this is the key that indixes it in cluster.workers.</p><br>  <h4 id="worker-isconnected-">worker.isConnected()</h4><br>  <p>This function returns <code>true</code> if the worker is connected to its master via its IPC channel. <code>false</code> otherwise. A worker is connected to its master after it’s been created. It is disconnected after the <code>disconnect</code> event is emitted.</p><br>  <h4 id="worker-isdead-">worker.isDead()</h4><br>  <p>This function returns <code>true</code> if the worker’s process has terminated (either because of exiting or being signaled). Otherwise, it returns <code>false</code></p><br>  <h4 id="worker-kill-signal-sigterm-">worker.kill([signal=’SIGTERM’])</h4><br>  <blockquote><p><code>signal</code> <string> Name of the kill signal to send to the worker process.</string></p></blockquote><br>  <p>This function will kill the worker. In the master it does this by disconnecting the <code>worker.process</code> and once disconnected, killing with <code>signal</code>. In the worker, it does it by disconnecting the channel and exiting with code <code>0</code></p><br>  <p>Causes <code>.exitedAfterDisconnect</code> ot be set</p><br>  <p>This method is aliased as <code>worker.destroy()</code> for backwords compatibility.</p><br>  <p>Note that ina worker, <code>process.kill()</code> exists, but it is not the function.</p><br>  <h4 id="worker-process">worker.process</h4><br>  <blockquote><childprocess><br></childprocess></blockquote><br>  <p>All Workers are created using <code>child_process.fork()</code>, the returned object from this function is stored as <code>.process</code>. In a worker, the global <code>process</code> is stored</p><br>  <p>Note that the workers will call <code>process.exit(0)</code> if the <code>disconnect</code> event occurs on <code>process</code> and <code>.exitedAfterDisconnect</code> is not <code>true</code>. This protects against accidental disconnection.</p><br>  <h4 id="worker-send-message-sendhandle-callback-">worker.send(message[, sendHandle, [callback]])</h4><br>  <blockquote><p><code>message</code> <object><br>  <p><br></p><br>  <p><code>sendHandle</code> <handle><br></handle></p><br>  <p><code>callback</code> <function><br></function></p><br>  <p>Send a message to a worker or master, optinally with a handle.</p><br>  <p>In the master this sends a message to a specific worker. It is identical to <code>ChildProcess.send()</code></p><br>  <p>In a worker this sends a message to the master. It is identical to <code>process.send()</code></p><br>  <p>This example will echo back all messages from the master</p><br>  <pre><br><br>  <code class="lang-javascript">if (cluster.isMaster) {<br>  const worker = cluster.fork()<br>  worker.send(‘hi there’)<br>} else if (cluster.isWorker) {<br>  process.on(‘message’, (msg) =&gt; {<br>    process.send(msg)<br>  })<br>}<br></code><br></pre><br>  <h4 id="event-disconnect-">Event: ‘disconnect’</h4><br>  <blockquote><br>  <p><code>worker</code> <cluster.worker><br></cluster.worker></p><br></blockquote><br>  <p>Emitted after the worker IPC channel has disconnected. This can occur when a worker exits gracefully, is killed, or is disconnected manually(such as with worker.disconnected())</p><br>  <p>There may be a delay between the <code>disconnect</code> and <code>exit</code> events. These events can be used to detect if the process is stuck in a cleanup or if there are long-living connections.</p><br>  <pre><br><br>  <code class="lang-javascript">cluster.on(‘disconnect’, (worker) =&gt; {<br>  console.log(<code>The worker #${worker.id} has disconnected</code>)<br>})<br></code><br></pre><br>  <h4 id="event-exit-">Event: ‘exit’</h4><br>  <blockquote><br>  <p><code>worker</code> <cluster.worker><br></cluster.worker></p><br>  <p><code>code</code> <number> the exit code, if it exited normally</number></p><br>  <p><code>signal</code> <string> the name of the signal (e.g. ‘SIGHUP’) that caused the process to be killed.</string></p><br></blockquote><br>  <p>When any of the workers die the cluster module will emit the ‘exit’ events</p><br>  <p>This can be used to restart the worker by calling <code>.fork()</code> again.</p><br>  <pre><br><br>  <code class="lang-javascript">cluster.on(‘exit’, (worker, code, signal) =&gt; {<br>  console.log(‘worker %d died (%s), restarting…’, worker.process.pid, signal || code)<br>  cluster.fork()<br>})<br></code><br></pre><br>  <h4 id="event-fork-">Event: ‘fork’</h4><br>  <blockquote><br>  <p><code>worker</code> <cluster.worker><br></cluster.worker></p><br></blockquote><br>  <p>When a new worker is forked the cluster module will emit a <code>fork</code> event. This can be used to log worker activity, and create your own timeout.</p><br>  <pre><br><br>  <code class="lang-javascript">const timeouts = []<br>function errorMsg () {<br>  console.error(‘Something must be wrong with the connection…’)<br>}<br><br>cluster.on(‘fork’, (worker) =&gt; {<br>  timeouts[worker.id] = setTimeout(errorMsg, 2000)<br>})<br><br>cluster.on(‘listening’, (worker, address) =&gt; {<br>  clearTimeout(timeouts[worker.id])<br>})<br><br>cluster.on(‘exit’, (worker, code, signal) =&gt; {<br>  clearTimeout(timeouts[worker.id])<br>})<br></code><br></pre><br>  <h4 id="event-listening-">Event: ‘listening’</h4><br>  <blockquote><br>  <p><code>worker</code> <cluster.worker><br></cluster.worker></p><br>  <p><code>address</code> <object><br>  <p><br></p><br>  <p>After calling <code>listen()</code> from  a worker. when the <code>listening</code> event it emitted on the server, a <code>listening</code> event will also be emitted on <code>cluster</code> in the master</p><br>  <p>The event handler is executed with two arguments, the <code>worker</code> contains the worker object and the <code>address</code> object contains the following connection properties: <code>address</code>, <code>port</code> and <code>addressType</code>. This is very useful if the worker is listening on more than one address.</p><br>  <pre><br><br>  <code class="lang-javascript">cluster.on(‘listening’, (worker, address) =&gt; {<br>  console.log(<code>A worker is now connected to ${address.address}: ${address.port}</code>)<br>})<br></code><br></pre><br>  <p>The <code>addressType</code> is one of:</p><br>  <ul><br>  <li><code>4</code>: (TCPv4)</li><br>  <li><code>6</code>: (TCPv6)</li><br>  <li><code>-1</code>: (unix domain socket)</li><br>  <li><code>“udp4”</code> or <code>“udp6”</code> (UDP v4 or v6)</li><br></ul><br>  <h4 id="event-message-">Event: ‘message’</h4><br>  <blockquote><br>  <p><code>worker</code> <cluster.worker><br></cluster.worker></p><br>  <p><code>message</code> <object><br>  <p><br></p><br>  <p><code>handle</code> <undefined> | <object><br>  <p></p><br>  <p>Emitted when the cluster master receives a message from any worker.</p><br>  <h4 id="event-online-">Event: ‘online’</h4><br>  <blockquote><p><code>worker</code> <cluster.worker><br></cluster.worker></p></blockquote><br>  <p>After forking a new worker, the worker should respond with an online message. When the master receives an online message it will emit this event. The difference between <code>fork</code> and <code>online</code> is that fork is emitted when the master forks a worker and <code>online</code> is emitted when the worker is running.</p><br>  <h4 id="event-setup-">Event: ‘setup’</h4><br>  <blockquote><p><code>settings</code> <object><br>  <p><br></p><br>  <p>Emitted every time <code>.setupMaster()</code> is called.</p><br>  <p>The <code>settings</code> object is the <code>cluster.settings</code> object at the time <code>.setupMaster()</code> was called and is advisory only. since multiple calls to <code>.setupMaster()</code> can be made in a single tick.</p><br>  <p>If accuracy is important, use <code>cluster.settings</code></p><br>  <h4 id="cluster-disconnect-callback-">cluster.disconnect([callback])</h4><br>  <p><code>callback</code> called when <strong>all</strong> workers are disconnected and handles are closed Calls <code>.disconnect()</code> on each worker in <code>cluster.workers</code></p><br>  <p>When they are disconnected all internal handles will be closed, allowing the master process to die gracefully if no other event is waiting.</p><br>  <p>The method takes an optional callback argument which will be called when finished.</p><br>  <p>This can only be called from the master process.</p><br>  <h4 id="cluster-fork-env-">cluster.fork([env])</h4><br>  <blockquote><br>  <p><code>env</code> <object> Key/Value pairs to add to worker process environment<p><br></p><p>return <cluster.worker><br></cluster.worker></p><p>Spawn a new worker process.</p><p>This can only be called from the master process.</p><h4 id="cluster-ismaster">cluster.isMaster</h4><blockquote><br>  <boolean><br></boolean><br></blockquote><p>True if the process is a master. This is determined by the <code>process.env.NODE_UNIQUE_ID</code>. If <code>process.env.NODE_UNIQUE_ID</code> is undefined, then <code>.isMaster</code> is <code>true</code></p><h4 id="cluster-isworker">cluster.isWorker</h4><blockquote><br>  <boolean><br></boolean><br></blockquote><p>True if the process is not a master (it is the negation of <code>cluster.isMaster</code>)</p><h4 id="cluster-schedulingpolicy">cluster.schedulingPolicy</h4><p>The scheduling policy, either <code>cluster.SCHED_RR</code> for round-robin or <code>cluster.SCHED_NONE</code> to leave it to the operating system. This is a global setting and effectively frozen once you spawn the first worker or call cluster <code>cluster.setupMaster()</code>, whatever comes first.</p><p><code>SCHED_RR</code> is the default on all operating systems except Windows. Windows will change to <code>SCHED_RR</code> once libuv is able to effectively distribute IOCP handles without incurring a large performance hit.</p><p><code>cluster.schedulingPolicy</code> can also be set through the <code>NODE_CLUSTER_SCHED_POLICY</code> environment variable. Valid values are <code>‘rr’</code> and <code>‘none’</code></p><h4 id="cluster-settings">cluster.settings</h4><blockquote><br>  <p><object><br>  <p><br></p><br>  <ul><br>  <li><code>execArgv</code></li><br>  <li><code>exec</code></li><br>  <li><code>args</code></li><br>  <li><code>silent</code></li><br>  <li><code>stdio</code></li><br>  <li><code>uid</code></li><br>  <li><code>gid</code></li><br></ul><br>  <h4 id="cluster-setupmaster-settings-">cluster.setupMaster([settings])</h4><br>  <blockquote><br>  <p><code>settings</code></p><br>  <ul><li><code>exec</code></li><li><code>args</code></li><li><code>silent</code></li><li><code>stdio</code></li></ul><br></blockquote><br>  <pre><br><br>  <code class="lang-javascript">const cluster = require(‘cluster’)<br>cluster.setupMaster({<br>  exec: ‘worker.js’,<br>  args: [‘–use’, ‘https’],<br>  silent: true,<br>})<br><br>cluster.fork() // https worker<br></code><br></pre><br>  <h4 id="cluster-worker">cluster.worker</h4><br>  <blockquote><br>  <object><br>  <p>A reference to the current worker object. Not available in the master process.</p><br>  <pre><br><br>  <code class="lang-javascript">const cluster = require(‘cluster’)<br><br>if (cluster.isMaster) {<br>  console.log(‘I am master’)<br>  cluster.fork()<br>  cluster.fork()<br>} else if (cluster.isWorker) {<br>  console.log(<code>I am worker #${cluster.worker.id}</code>)<br>}<br></code><br></pre><br>  <h4 id="cluster-workers">cluster.workers</h4><br>  <blockquote><br>  <object><br>  <p>A hash that stores the active worker objects, keyed by <code>id</code> field. Makes it easy to loop through all the workers. It is only available in the master process.</p><br>  <p>A worker is removed from <code>cluster.workers</code> after the worker has disconnected <strong>and</strong> exit. <strong>The order between two events cannot be determined in advance</strong>. However it is guaranteed that the removal from the cluster.workers list happens before last <code>disconnect</code> or <code>exit</code> event is emitted.</p><br>  <pre><br><br>  <code class="lang-javascript">// Go through all workers<br>function eachWorker(callback) {<br>  for (const id in cluster.workers) {<br>    callback(cluster.worker[id])<br>  }<br>}<br><br>eachWorker((worker) =&gt; {<br>  worker.send(‘big announcement to all workers’)<br>})<br></code><br></pre><br>  <p>Should you wish to reference a worker over a communication channel, using the worker’s unique id is the easiest way to find the worker.</p><br>  <pre><br><br>  <code class="lang-javascript">socket.on(‘data’, (id) =&gt; {<br>  const worker = cluster.workers[id]<br>})<br></code><br></pre><br></object><br></blockquote><br></object><br></blockquote><br></object></p><br></blockquote></object></p><br></blockquote><br></object></p></blockquote><br></object></undefined></p><br></object></p><br></blockquote><br></object></p><br></blockquote><br></object></p></blockquote><br></object></undefined></p><br></object></p><br></blockquote><br></object>
</blockquote>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[api of axios]]></title>
      <url>/2017/04/29/api-of-axios/</url>
      <content type="html"><![CDATA[<h1 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h1><blockquote>
<p>axios.request(config) axios.get(url[, config]) axios.delete(url[, config]) axios.head(url[, config]) axios.options(url[, config]) axios.post(url[, data[, config]]) axios.put(url[, data[, config]]) axios.patch(url[, data[, config]])</p>
</blockquote>
<h1 id="Config-Options"><a href="#Config-Options" class="headerlink" title="Config Options"></a>Config Options</h1><p><code>url</code> is required, and <code>get</code> is the default method</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">url</span>: <span class="string">'string'</span>,</div><div class="line">  <span class="attr">method</span>: <span class="string">'get'</span>,</div><div class="line">  <span class="attr">baseUrl</span>: <span class="string">'https://some-domain.com/api/'</span>, <span class="comment">// prepended to url unless url is absolute,</span></div><div class="line">  transformRequest: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> data</div><div class="line">  &#125;],</div><div class="line">  <span class="attr">transformResponse</span>: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> data</div><div class="line">  &#125;],</div><div class="line">  <span class="attr">headers</span>: &#123;</div><div class="line">    <span class="string">'X-Requested-With'</span>: <span class="string">'XMLHttpRequest'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">params</span>: &#123; <span class="comment">// url params to be sent with the request, plain object or URLSearchParams Object</span></div><div class="line">    ID: <span class="number">12345</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">paramsSerializer</span>: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> Qs.stringify(params, &#123; <span class="attr">arrayFormat</span>: <span class="string">'brackets'</span> &#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">data</span>: &#123; <span class="comment">// the data sent as request body, only applicable for request method 'PUT', 'POST', 'PATCH'. When no transformRequest is set, must be one of the following types: string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams, FormData(Browser only), File(browser only), Blob(browser only), Stream(Node only), Buffer(Node only)</span></div><div class="line">    firstName: <span class="string">'fred'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</div><div class="line">  <span class="attr">withCredentials</span>: <span class="literal">false</span> <span class="comment">// default</span></div><div class="line">  adapter: <span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123; <span class="comment">// allows custom handling of requests which makes testing easier.</span></div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">auth</span>: &#123;</div><div class="line">    <span class="attr">username</span>: <span class="string">'janedoe'</span>,</div><div class="line">    <span class="attr">password</span>: <span class="string">'...'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">responseType</span>: <span class="string">'json'</span>, <span class="comment">// default</span></div><div class="line">  xsrfCookieName: <span class="string">'XSRF-TOKEN'</span>, <span class="comment">// defualt</span></div><div class="line">  onUploadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">onDownloadProgress</span>: <span class="function"><span class="keyword">function</span>(<span class="params">progressEvent</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">maxContentLength</span>: <span class="number">2000</span>,</div><div class="line">  <span class="attr">validateStatus</span>: <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt; <span class="number">300</span> <span class="comment">// default</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">maxRedirects</span>: <span class="number">5</span>, <span class="comment">// default</span></div><div class="line">  httpAgent: <span class="keyword">new</span> http.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</div><div class="line">  <span class="attr">httpsAgent</span>: <span class="keyword">new</span> http.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</div><div class="line">  <span class="attr">proxy</span>: &#123; <span class="comment">// defines the hostname and port of the proxy server</span></div><div class="line">    host: <span class="string">'127.0.0.1'</span>,</div><div class="line">    <span class="attr">port</span>: <span class="number">9000</span>,</div><div class="line">    <span class="attr">auth</span>: &#123;</div><div class="line">      <span class="attr">username</span>: <span class="string">'...'</span>,</div><div class="line">      <span class="attr">password</span>: <span class="string">'...'</span>,</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">cancelToken</span>: <span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> (<span class="params">cancel</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="response-Schema"><a href="#response-Schema" class="headerlink" title="response Schema"></a>response Schema</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">data</span>: &#123;&#125;,</div><div class="line">  <span class="attr">status</span>: <span class="number">200</span>,</div><div class="line">  <span class="attr">statusText</span>: <span class="string">'OK'</span>,</div><div class="line">  <span class="attr">headers</span>: &#123;&#125;,</div><div class="line">  <span class="attr">config</span>: &#123;&#125;,</div><div class="line">  <span class="attr">request</span>: &#123;&#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="errors"><a href="#errors" class="headerlink" title="errors"></a>errors</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">axios.get(<span class="string">'/user/123'</span>)</div><div class="line">.catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (err.response) &#123;</div><div class="line">    <span class="comment">// err.response.data</span></div><div class="line">    <span class="comment">// err.response.status</span></div><div class="line">    <span class="comment">// err.response.headers</span></div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.request) &#123;</div><div class="line"></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="get"><a href="#get" class="headerlink" title="get"></a>get</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">axios.get(<span class="string">'/user?ID=12345'</span>)</div><div class="line">.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(res)</div><div class="line">&#125;)</div><div class="line">.catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(err)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">axios.get(<span class="string">'/user'</span>, &#123;</div><div class="line">  <span class="attr">params</span>: &#123;</div><div class="line">    <span class="attr">ID</span>: <span class="number">12345</span>,</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(res)</div><div class="line">&#125;)</div><div class="line">.catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="post"><a href="#post" class="headerlink" title="post"></a>post</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">axios.post(<span class="string">'/user'</span>, &#123;</div><div class="line">  <span class="attr">firstName</span>: <span class="string">'Fred'</span>,</div><div class="line">  <span class="attr">lastName</span>: <span class="string">'Flintstrong'</span>,</div><div class="line">&#125;)</div><div class="line">.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(res)</div><div class="line">&#125;)</div><div class="line">.catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(err)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="concurrency"><a href="#concurrency" class="headerlink" title="concurrency"></a>concurrency</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserAccount</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserPermissions</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345/permissions'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line">axios.all([getUserAccount(), getUserPermissions()])</div><div class="line">.then(axios.spread(<span class="function"><span class="keyword">function</span> (<span class="params">acct, perms</span>) </span>&#123;</div><div class="line">  <span class="comment">// Both request are now complete</span></div><div class="line">&#125;))</div></pre></td></tr></table></figure>
<h1 id="config"><a href="#config" class="headerlink" title="config"></a>config</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">axios(&#123;</div><div class="line">  <span class="attr">method</span>: <span class="string">'post'</span>,</div><div class="line">  <span class="attr">url</span>: <span class="string">'/user/12345'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'Fred'</span>,</div><div class="line">    <span class="attr">lastName</span>: <span class="string">'Flintstone'</span>,</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">axios(&#123;</div><div class="line">  <span class="attr">method</span>: <span class="string">'get'</span>,</div><div class="line">  <span class="attr">url</span>: <span class="string">'http://bit.ly/2mTM3n'</span>,</div><div class="line">  <span class="attr">responseType</span>: <span class="string">'stream'</span>,</div><div class="line">&#125;)</div><div class="line">.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</div><div class="line">  res.data.pipe(fs.createWriteStream(<span class="string">'ada_lovelace.jpg'</span>))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[webpackDevServer Proxy]]></title>
      <url>/2017/04/27/webpackDevServer-Proxy/</url>
      <content type="html"><![CDATA[<p><code>devServer.proxy</code>: <code>object</code></p>
<p>Proxying some URLs can be useful when you have a separate API backend development server and you want to send API requests on the same domain.</p>
<p>The dev-server makes use of the powerful <code>http-proxy-middleware</code> package.</p>
<p>With a backend on <code>localhost:3000</code>, you can use this to enable proxying:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">proxy: &#123;</div><div class="line">  &apos;/api&apos;: &apos;http://localhost:3000&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>A request to <code>/api/users</code> will now proxy to the request to <code>http://localhost:3000/api/users</code></p>
<p>If you don’t want <code>/api</code> to be passed along, we need to rewrite the path</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">proxy: &#123;</div><div class="line">  &apos;/api&apos;: &#123;</div><div class="line">    target: &apos;http://localhost:3000&apos;,</div><div class="line">    pathRewrite: &#123;</div><div class="line">      &apos;^/api&apos;: &apos;&apos;,</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>A backend server running on HTTPS with an invalid certificate will not be accepted by default. If you want to, modify config like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">proxy: &#123;</div><div class="line">  &apos;/api&apos;: &#123;</div><div class="line">    target: &apos;https://other-server.example.com&apos;,</div><div class="line">    secure: false,</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[notes in migrating from React-Router-3 to React-Router-4]]></title>
      <url>/2017/04/26/notes-in-migrating-from-React-Router-3-to-React-Router-4/</url>
      <content type="html"><![CDATA[<h1 id="HashRouter"><a href="#HashRouter" class="headerlink" title="HashRouter"></a>HashRouter</h1><p>Version 4 of React-Router seperate top level router element for the different history type. If you’re using version 4 you should be able to replace <code>&lt;Router hisotry={hashHistory}&gt;</code> with <code>&lt;HashRouter&gt;</code></p>
<h1 id="Multiple-Routes-at-same-URL"><a href="#Multiple-Routes-at-same-URL" class="headerlink" title="Multiple Routes at same URL"></a>Multiple Routes at same URL</h1><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">import React from 'react'</div><div class="line">import &#123;</div><div class="line">  BrowserRouter as Router,</div><div class="line">  Route,</div><div class="line">  Link,</div><div class="line">&#125; from 'react-router-dom'</div><div class="line"></div><div class="line">// Each logical 'route' has two components, one for the sidebar and one for the main area. We want to render both of them in different places when the path matches the current URL.</div><div class="line"></div><div class="line">const routes = [</div><div class="line">  &#123;</div><div class="line">    path: '/',</div><div class="line">    exact: true,</div><div class="line">    sidebar: () =&gt; &lt;div&gt;Home&lt;/div&gt;,</div><div class="line">    main: () =&gt; &lt;h2&gt;Home&lt;/h2&gt;,</div><div class="line">  &#125;, &#123;</div><div class="line">    path: '/bubblegum',</div><div class="line">    sidebar: () =&gt; &lt;div&gt;bubblegum&lt;/div&gt;,</div><div class="line">    main: () =&gt; &lt;h2&gt;BubbleGum&lt;/div&gt;,</div><div class="line">  &#125;, &#123;</div><div class="line">    path: '/shoelaces',</div><div class="line">    sidebar: () =&gt; &lt;div&gt;shoelaces&lt;/div&gt;,</div><div class="line">    main: () =&gt; &lt;h2&gt;ShoeLaces&lt;/h2&gt;,</div><div class="line">  &#125;,</div><div class="line">]</div><div class="line"></div><div class="line">const sidebarExample = () =&gt; (</div><div class="line">  &lt;Router&gt;</div><div class="line">    &lt;div style=&#123;&#123; display: 'flex' &#125;&#125;&gt;</div><div class="line">      // sidebar</div><div class="line">      &lt;div style=&#123;&#123;</div><div class="line">        padding: '10px',</div><div class="line">        width: '40%',</div><div class="line">        background: '#f0f0f0',</div><div class="line">        &#125;&#125;</div><div class="line">      &gt;</div><div class="line">        &lt;ul&gt;</div><div class="line">          &lt;li&gt;&lt;Link to='/'&gt;Home&lt;/Link&gt;&lt;/li&gt;</div><div class="line">          &lt;li&gt;&lt;Link to='/bubblegum'&gt;Bubblegum&lt;/Link&gt;&lt;/li&gt;</div><div class="line">          &lt;li&gt;&lt;Link to='/shoelaces'&gt;ShoeLaces&lt;/Link&gt;&lt;/li&gt;</div><div class="line">        &lt;/ul&gt;</div><div class="line"></div><div class="line">        &#123;routes.map((route, index) =&gt; (</div><div class="line">          // You can render a &lt;Router&gt; in as many places as you want in your app, it will render along with any other &lt;Router&gt;s that also match the URL.</div><div class="line">          // So a sidebar or breadcrumbs or anything else that requires you to render multiple things in multiple places at the same URL is nothing more than multiple &lt;Routes&gt;s</div><div class="line"></div><div class="line">          &lt;Route</div><div class="line">            key=&#123;index&#125;</div><div class="line">            path=&#123;route.path&#125;</div><div class="line">            exact=&#123;route.exact&#125;</div><div class="line">            component=&#123;route.sidebar&#125;</div><div class="line">          /&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/div&gt;</div><div class="line"></div><div class="line">      // main</div><div class="line">      &lt;div style=&#123;&#123; flex: 1, padding: '30px' &#125;&#125;&gt;</div><div class="line">        &#123;routes.map((route, index) =&gt; (</div><div class="line">          // Render more &lt;Route&gt;s with the same paths as above, but different components this time.</div><div class="line">          &lt;Route</div><div class="line">            key=&#123;index&#125;</div><div class="line">            path=&#123;route.path&#125;</div><div class="line">            exact=&#123;route.exact&#125;</div><div class="line">            component=&#123;route.main&#125;</div><div class="line">          /&gt;</div><div class="line">        ))&#125;</div><div class="line">      &lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/Router&gt;</div><div class="line">)</div><div class="line">export default sidebarExample</div></pre></td></tr></table></figure>
<h1 id="Animated-Transitions"><a href="#Animated-Transitions" class="headerlink" title="Animated Transitions"></a>Animated Transitions</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> ReactCSSTransitionGroup <span class="keyword">from</span> <span class="string">'react-addons-css-transition-group'</span></div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">  BrowserRouter <span class="keyword">as</span> Router,</div><div class="line">  Route,</div><div class="line">  Link,</div><div class="line">  Redirect,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-rotuer-dom'</span></div><div class="line"></div><div class="line"><span class="comment">// you'll need this CSS somewhere</span></div><div class="line"><span class="comment">// .fade-enter &#123;</span></div><div class="line"><span class="comment">//   opacity: 0;</span></div><div class="line"><span class="comment">//   z-index: 1;</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"><span class="comment">// .fade-enter.face-enter-active &#123;</span></div><div class="line"><span class="comment">//   opacity: 1;</span></div><div class="line"><span class="comment">//   transition: opacity 250ms ease-in;</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> AnimationExample = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;Router&gt;</div><div class="line">    &lt;Route render=&#123;(&#123; location &#125;) =&gt; (</div><div class="line">      &lt;div style=&#123;style.fill&#125;&gt;</div><div class="line">        &lt;Route exact path='/' render=&#123;() =&gt; (</div><div class="line">          &lt;Redirect to='/10/20/50' /&gt;</div><div class="line">        )&#125;/&gt;</div><div class="line">        &lt;ul style=&#123;style.nav&#125;&gt;</div><div class="line">          &lt;NavLink to='/10/90/50'&gt;Red&lt;/NavLink&gt;</div><div class="line">          &lt;NavLink to='/120/100/40'&gt;Green&lt;/NavLink&gt;</div><div class="line">          &lt;NavLink to='/200/100/40'&gt;Blue&lt;/NavLink&gt;</div><div class="line">          &lt;NavLink to='/310/100/50'&gt;Pink&lt;/NavLink&gt;</div><div class="line">        &lt;/ul&gt;</div><div class="line"></div><div class="line">        &lt;div style=&#123;style.content&#125;&gt;</div><div class="line">          &lt;ReactCSSTransitionGroup</div><div class="line">            transitionName='fade'</div><div class="line">            transitionEnterTimeout=&#123;300&#125;</div><div class="line">            transitionLeaveTimeout=&#123;300&#125;</div><div class="line">          &gt;</div><div class="line">            // no different than other usage of ReactCSSTransitionGroup, just make sure to pass `location` to `Route` so it can match the old location as it animate out</div><div class="line">            &lt;Route</div><div class="line">              location=&#123;loaction&#125;</div><div class="line">              key=&#123;location.key&#125;</div><div class="line">              path="/:h/:s/:l"</div><div class="line">              component=&#123;HSL&#125;</div><div class="line">            /&gt;</div><div class="line">          &lt;/ReactCSSTransitionGroup&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )&#125;/&gt;</div><div class="line">  &lt;/Router&gt;</div><div class="line">)</div><div class="line"></div><div class="line">const NavLink = (props) =&gt; (</div><div class="line">  &lt;li&gt;&lt;Link &#123;...props&#125; style=&#123;&#123;color: 'inherit'&#125;&#125; /&gt;&lt;/li&gt;</div><div class="line">)</div><div class="line"></div><div class="line">const HSL = (&#123; match: &#123; params &#125;&#125;) =&gt; (</div><div class="line">  &lt;div style=&#123;&#123;</div><div class="line">    ...style.fill,</div><div class="line">    ...style.hsl,</div><div class="line">    background: `hsl($&#123;params.h&#125;%, $&#123;params.s&#125;%, $&#123;params.l&#125;%)`</div><div class="line">  &#125;&#125;&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">)</div><div class="line"></div><div class="line">export default AnimationExample</div></pre></td></tr></table></figure>
<h1 id="Route-Config"><a href="#Route-Config" class="headerlink" title="Route Config"></a>Route Config</h1><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line">import React from 'react'</div><div class="line">import &#123;</div><div class="line">  BrowserRouter as Router,</div><div class="line">  Route,</div><div class="line">  Link,</div><div class="line">&#125; from 'react-router-dom'</div><div class="line"></div><div class="line">// Some folks find value in a centralized route config. A route config is just data. React is great at mapping data into component, and &lt;Route&gt; is a component.</div><div class="line"></div><div class="line">// first our route component</div><div class="line"></div><div class="line">const Main = () =&gt; &lt;h2&gt;Main&lt;/h2&gt;</div><div class="line"></div><div class="line">const Sandwiches = () =&gt; &lt;h2&gt;Sandwiches&lt;/h2&gt;</div><div class="line"></div><div class="line">const Tacos = (&#123; routes &#125;) =&gt; (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h2&gt;Tacos&lt;/h2&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">      &lt;li&gt;&lt;Link to='/tacos/bus'&gt;Bus&lt;/Link&gt;&lt;/li&gt;</div><div class="line">      &lt;li&gt;&lt;Link to='/tacos/cart'&gt;Cart&lt;/Link&gt;&lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line"></div><div class="line">    &#123;routes.map((route, index) =&gt; (</div><div class="line">      &lt;RouteWithSubRoutes key=&#123;index&#125; &#123;...route&#125;/&gt;</div><div class="line">    ))&#125;</div><div class="line">  &lt;/div&gt;</div><div class="line">)</div><div class="line"></div><div class="line">const Bus = () =&gt; &lt;div&gt;Bus&lt;/div&gt;</div><div class="line">const Cart = () =&gt; &lt;div&gt;Cart&lt;/div&gt;</div><div class="line"></div><div class="line">// then our route config</div><div class="line"></div><div class="line">const routes = [</div><div class="line">  &#123;</div><div class="line">    path: '/sandwiches',</div><div class="line">    component: sandwiches,</div><div class="line">  &#125;, &#123;</div><div class="line">    path: '/tacos',</div><div class="line">    component: Tacos,</div><div class="line">    routes: [</div><div class="line">      &#123;</div><div class="line">        path: '/tacos/bus',</div><div class="line">        component: Bus,</div><div class="line">      &#125;, &#123;</div><div class="line">        path: '/tacos/cart',</div><div class="line">        component: Cart,</div><div class="line">      &#125;,</div><div class="line">    ],</div><div class="line">  &#125;,</div><div class="line">]</div><div class="line"></div><div class="line">// wrap &lt;Route&gt; and use this everywhere instead, then when sub routes are added to any route it'll work</div><div class="line"></div><div class="line">const RouteWithSubRoutes = (route) =&gt; (</div><div class="line">  &lt;Route path=&#123;route.path&#125; render=&#123;props =&gt; (</div><div class="line">    // pass the sub-routes down to keep nesting</div><div class="line">    &lt;route.component &#123;...props&#125; routes=&#123;route.routes&#125; /&gt;</div><div class="line">  )&#125;/&gt;</div><div class="line">)</div><div class="line"></div><div class="line">const RouteConfigExample = () =&gt; (</div><div class="line">  &lt;Router&gt;</div><div class="line">    &lt;div&gt;</div><div class="line">      &lt;ul&gt;</div><div class="line">        &lt;li&gt;&lt;Link to='/tacos'&gt;Tacos&lt;/Link&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;&lt;Link to='/sandwiches'&gt;Sandwiches&lt;/Link&gt;&lt;/li&gt;</div><div class="line">      &lt;/ul&gt;</div><div class="line">      &#123;routes.map((route, index) =&gt; (</div><div class="line">        &lt;RouteWithSubRoutes key=&#123;index&#125; &#123;...route&#125; /&gt;</div><div class="line">      ))&#125;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/Router&gt;</div><div class="line">)</div><div class="line"></div><div class="line">export default RouteConfigExample</div></pre></td></tr></table></figure>
<h1 id="Redux-Integration"><a href="#Redux-Integration" class="headerlink" title="Redux Integration"></a>Redux Integration</h1><p>Generally, React Router and Redux work just fine together. Occasionally though, an app have a component that doesn’t update when the location changes (child route or active nav links don’t update)</p>
<p>This happens if:</p>
<blockquote>
<p>The component is connected to redux via <code>connect()(Comp)</code> The component is <em>not</em> a “route component”, meaning it is not rendered like so: <code>&lt;Route component={SomeConnectedThing}/&gt;</code></p>
</blockquote>
<p>The problem is that Redux implements <code>shouldComponentUpdate</code> and there’s no indication that anything has changed if it isn’t receiving props from the router. This is straightforward to fix. Find where you connect your component and wrap it in <code>withRouter</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; withRouter &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(connect(mapStateToProps)(Comp))</div></pre></td></tr></table></figure>
<h1 id="Code-Splitting"><a href="#Code-Splitting" class="headerlink" title="Code Splitting"></a>Code Splitting</h1><p>One great feature of the web is that we don’t have to make our visitors download the entire app before they can use it. You can think of code spliting as incrementally downloading the app. While there are other tools for the job, react-router use <code>webpack</code> and the <code>bundle loader</code>.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">import loadSomething from 'bundle-loader?lazy!./Something'</div><div class="line"></div><div class="line">&lt;Bundle load=&#123;loadSomething&#125;&gt;</div><div class="line">  &#123;(mod) =&gt; (</div><div class="line">    // do something w/ the module</div><div class="line">  )&#125;</div><div class="line">&lt;/Bundle&gt;</div><div class="line"></div><div class="line">&lt;Bundle load=&#123;loadSomething&#125;&gt;</div><div class="line">  &#123;</div><div class="line">    (Comp) =&gt; Comp</div><div class="line">    ? &lt;Comp/&gt;</div><div class="line">    : &lt;Loading/&gt;</div><div class="line">  &#125;</div><div class="line">&lt;/Bundle&gt;</div><div class="line"></div><div class="line">import React, &#123; Component &#125; from 'react'</div><div class="line"></div><div class="line">class Bundle extends Component &#123;</div><div class="line">  state = &#123;</div><div class="line">    // short for 'module' but that's a keyword in js. so 'mod'</div><div class="line">    mod: null,</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillMount () &#123;</div><div class="line">    this.load(this.props)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillReceiveProps (nextProps) &#123;</div><div class="line">    if (nextProps.load !== this.props.load) &#123;</div><div class="line">      this.load(nextProps)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  load (props) &#123;</div><div class="line">    this.setState(&#123;</div><div class="line">      mod: null,</div><div class="line">    &#125;)</div><div class="line">    props.load((mod) =&gt; &#123;</div><div class="line">      this.setState(&#123;</div><div class="line">        // handle both es imports and cjs</div><div class="line">        mod: mod.default ? mod.default : mod</div><div class="line">      &#125;)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render () &#123;</div><div class="line">    return this.props.children(this.state.mod)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default Bundle</div><div class="line"></div><div class="line"></div><div class="line">&lt;Bundle load=&#123;() =&gt; import('./something')&#125;&gt;</div><div class="line">  &#123;(mod) =&gt; ()&#125;</div><div class="line">&lt;/Bundle&gt;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> loadAbout <span class="keyword">from</span> <span class="string">'bundle-load?lazy!./loadAbout'</span></div><div class="line"><span class="keyword">import</span> loadDashboard <span class="keyword">from</span> <span class="string">'bundle-loader?lazy!./loadDashboard'</span></div><div class="line"></div><div class="line"><span class="comment">// components load their module for initial visit</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> About = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Bundle</span> <span class="attr">load</span>=<span class="string">&#123;loadAbout&#125;</span>&gt;</span></span></div><div class="line">    &#123;(About) =&gt; <span class="tag">&lt;<span class="name">About</span> /&gt;</span>&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">Bundle</span>&gt;</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">const</span> Dashboard = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Bundle</span> <span class="attr">load</span>=<span class="string">&#123;loadDashboard&#125;</span>&gt;</span></span></div><div class="line">    &#123;(Dashboard) =&gt; <span class="tag">&lt;<span class="name">Dashboard</span> /&gt;</span>&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">Bundle</span>&gt;</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  componentDidMount () &#123;</div><div class="line">    <span class="comment">// preload the rest</span></div><div class="line">    loadAbout( <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125; )</div><div class="line">    loadDashboard( <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125; )</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render () &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;h1&gt;Welcome&lt;/h1&gt;</div><div class="line">        &lt;Route path='/about' component=&#123;About&#125; /&gt;</div><div class="line">        &lt;Route path='/dashbaord' component=&#123;Dashboard&#125; /&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ReactDOM.render(&lt;App /&gt;, document.preloadTheRestOfTheApp)</div></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[learning d3]]></title>
      <url>/2017/04/25/learning-d3/</url>
      <content type="html"><![CDATA[<h1 id="d3-array"><a href="#d3-array" class="headerlink" title="d3-array"></a>d3-array</h1><h2 id="array-methods-built-in-to-JavaScript"><a href="#array-methods-built-in-to-JavaScript" class="headerlink" title="array methods built-in to JavaScript"></a>array methods built-in to JavaScript</h2><ul>
<li>array.pop =&gt; popped element</li>
<li>array.push =&gt; array.length</li>
<li>array.reverse =&gt; change the array</li>
<li>array.shift =&gt; shifted element</li>
<li>array.unshift =&gt; array.length</li>
<li>array.sort =&gt; change the array</li>
<li><p>array.splice =&gt; change the array</p>
</li>
<li><p>array.concat =&gt; new Array</p>
</li>
<li><p>array.join =&gt; new String</p>
</li>
<li><p>array.slice =&gt; new Array</p>
</li>
<li><p>array.indexOf =&gt; number</p>
</li>
<li><p>array.lastIndexOf =&gt; number</p>
</li>
<li><p>array.fitler =&gt; new Array</p>
</li>
<li><p>array.forEach =&gt; undefined</p>
</li>
<li><p>array.every =&gt; boolean</p>
</li>
<li><p>array.map =&gt; new Array</p>
</li>
<li><p>array.some =&gt; boolean</p>
</li>
<li><p>array.reduce =&gt;</p>
</li>
<li>array.reduceRight =&gt;</li>
</ul>
<blockquote>
<p>yarn add d3-array</p>
</blockquote>
<h2 id="Statistics"><a href="#Statistics" class="headerlink" title="Statistics"></a>Statistics</h2><ul>
<li><p><code>d3.min(array[, accessor])</code></p>
<ul>
<li>Mininum value using natural order</li>
<li>Return undefined if the array is empty</li>
<li>An optional <em>accessor</em> function may be specified, which is equivalent to calling <em>array.map(accessor)</em> before computing the minumum value.</li>
</ul>
</li>
<li><p><code>d3.max(array[, accessor])</code></p>
<ul>
<li>Return maximum value</li>
<li>Return undefined. if the array is empty</li>
</ul>
</li>
<li><p><code>d3.extent(array[, accessor])</code></p>
<ul>
<li>Return <em>minumum</em> and <em>maximum</em> value in the given array.</li>
<li>Return <code>[undefined, undefined]</code> if the array is empty</li>
</ul>
</li>
<li><p><code>d3.sum(array[, accessor])</code></p>
<ul>
<li>Return the sum of the given array of numbers.</li>
<li>Return 0 if the array is empty.</li>
<li>ignores <em>undefined</em> and <em>NaN</em> values.</li>
</ul>
</li>
<li><p><code>d3.mean(array[, accessor])</code></p>
<ul>
<li>Return the mean of the given array of numbers.</li>
<li>Return undefined if the array is empty.</li>
<li>Ignore <em>undefined</em> and <em>NaN</em>.</li>
</ul>
</li>
<li><p><code>d3.median(array[, accessor])</code> -</p>
</li>
</ul>
<p>-</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[node-inspector's crash]]></title>
      <url>/2017/04/25/node-inspector-s-crash/</url>
      <content type="html"><![CDATA[<p>I had encountered a problem using <code>node-inspector</code> with info</p>
<blockquote>
<p>cb(error, NM[0].ref); Cannot read property ‘ref’ of undefined</p>
</blockquote>
<p>And one method to resolve it is to modify the packagge</p>
<blockquote>
<p>Same issue with node v6.5.0 can be solved like this :</p>
<p>Edit …\node_modules\node-inspector\lib\InjectorClient.js file at line 111 if(NM.length &gt; 0) cb(error, NM[0].ref);</p>
<p>It works</p>
</blockquote>
<p>which is hack, and another method is without side-effect</p>
<blockquote>
<p>use the local node-inspector</p>
</blockquote>
<p>hope it helps</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Usage of Chai]]></title>
      <url>/2017/04/21/Usage-of-Chai/</url>
      <content type="html"><![CDATA[<h1 id="Chains"><a href="#Chains" class="headerlink" title="Chains"></a>Chains</h1><ul>
<li>to</li>
<li>be</li>
<li>been</li>
<li>is</li>
<li>that</li>
<li>which</li>
<li>and</li>
<li>has</li>
<li>have</li>
<li>with</li>
<li>at</li>
<li>of</li>
<li>same</li>
</ul>
<h1 id="not"><a href="#not" class="headerlink" title="not"></a>not</h1><blockquote>
<p>negative any of assertions following in the Chains</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(foo).to.not.equal(<span class="string">'bar'</span>)</div></pre></td></tr></table></figure>
<h1 id="deep"><a href="#deep" class="headerlink" title="deep"></a>deep</h1><blockquote>
<p>set the <code>deep</code> flag, later used by the <code>equal</code> and <code>property</code> assertions</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(foo).to.deep.equal(&#123;<span class="attr">bar</span>: <span class="string">'bar'</span>&#125;)</div></pre></td></tr></table></figure>
<h1 id="any"><a href="#any" class="headerlink" title="any"></a>any</h1><blockquote>
<p>set the <code>any</code> flag, (opposite of the <code>all</code> flag), later used in the <code>keys</code> assertion</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(foo).to.have.any.keys(<span class="string">'bar'</span>, <span class="string">'foo'</span>)</div></pre></td></tr></table></figure>
<h1 id="all"><a href="#all" class="headerlink" title="all"></a>all</h1><blockquote>
<p>set the <code>all</code> flag, (opposite of the <code>any</code> flag), later used by the <code>keys</code> assertions</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(foo).to.have.all.keys(<span class="string">'bar'</span>, <span class="string">'foo'</span>)</div></pre></td></tr></table></figure>
<h1 id="a-type"><a href="#a-type" class="headerlink" title="a(type)"></a>a(type)</h1><ul>
<li>@param {String} type</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>The <code>a</code> and <code>an</code> assertion are aliases that can be used either as language chains or to assert a value’s type</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// typeof</span></div><div class="line">expect(<span class="string">'test'</span>).to.be.a(<span class="string">'string'</span>)</div><div class="line"><span class="comment">// language chain</span></div><div class="line">expect(foo).to.be.an.instanceof(Foo)</div></pre></td></tr></table></figure>
<h1 id="include-value"><a href="#include-value" class="headerlink" title="include(value)"></a>include(value)</h1><ul>
<li>@param {Object | String | Number} obj</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>The <code>include</code> and <code>contain</code> assertion can be used as either property based language chains or methods to assert the inclusion of an object in an array or a substring in a string.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">expect([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).to.include(<span class="number">2</span>)</div><div class="line">expect(<span class="string">'foobar'</span>).to.contain(<span class="string">'foo'</span>)</div><div class="line">expect(&#123; <span class="attr">foo</span>: <span class="string">'foo'</span>, <span class="attr">bar</span>: <span class="string">'bar'</span> &#125;).to.include.keys(<span class="string">'foo'</span>)</div></pre></td></tr></table></figure>
<h1 id="ok"><a href="#ok" class="headerlink" title="ok"></a>ok</h1><blockquote>
<p>Assert that the target is truthy</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">expect(<span class="string">'everything'</span>).to.be.ok</div><div class="line">expect(<span class="literal">undefined</span>).to.not.be.ok</div></pre></td></tr></table></figure>
<h1 id="true"><a href="#true" class="headerlink" title="true"></a>true</h1><blockquote>
<p>Assert that the target is <code>true</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">expect(<span class="literal">true</span>).to.be.true</div><div class="line">expect(<span class="number">1</span>).to.be.true</div></pre></td></tr></table></figure>
<h1 id="false"><a href="#false" class="headerlink" title="false"></a>false</h1><blockquote>
<p>Assert that the target is <code>false</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">expect(<span class="literal">false</span>).to.be.false</div><div class="line">expect(<span class="number">0</span>).to.be.false</div></pre></td></tr></table></figure>
<h1 id="null"><a href="#null" class="headerlink" title="null"></a>null</h1><blockquote>
<p>Assert that the target to be <code>null</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="literal">null</span>).to.be.null</div></pre></td></tr></table></figure>
<h1 id="undefined"><a href="#undefined" class="headerlink" title="undefined"></a>undefined</h1><blockquote>
<p>Assert that the target is <code>undefined</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="literal">undefined</span>).to.be.undefined</div></pre></td></tr></table></figure>
<h1 id="NaN"><a href="#NaN" class="headerlink" title="NaN"></a>NaN</h1><blockquote>
<p>Assert that the target is <code>NaN</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="string">'foo'</span>).to.be.NaN</div></pre></td></tr></table></figure>
<h1 id="exist"><a href="#exist" class="headerlink" title="exist"></a>exist</h1><blockquote>
<p>Assert that the target is neither <code>null</code> nor <code>undefined</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="string">'foo'</span>).to.be.exist</div></pre></td></tr></table></figure>
<h1 id="empty"><a href="#empty" class="headerlink" title="empty"></a>empty</h1><blockquote>
<p>Assert that the target’s length is 0. For Array and String, it will check the length of propertes. For Object, it will check the length of enumerable keys</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect([]).to.be.empty</div></pre></td></tr></table></figure>
<h1 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h1><blockquote>
<p>Assert that the target is an arguments object</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  expect(<span class="built_in">arguments</span>).to.be.arguments</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="equal-value"><a href="#equal-value" class="headerlink" title="equal(value)"></a>equal(value)</h1><ul>
<li>@param {Mixed} value</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>Assert that the target is strictly equal(===) to <code>value</code>. Alternately, if the <code>.deep</code> flag is set, assert that the target is deeply equal to <code>value</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">expect(<span class="string">'hello'</span>).to.equal(<span class="string">'hello'</span>)</div><div class="line">expect(&#123;<span class="attr">foo</span>: <span class="string">'foo'</span>&#125;).to.deep.equal(&#123;<span class="attr">foo</span>: <span class="string">'foo'</span>&#125;)</div></pre></td></tr></table></figure>
<h1 id="eql-value"><a href="#eql-value" class="headerlink" title="eql(value)"></a>eql(value)</h1><ul>
<li>@param {Mixed} value</li>
<li>@param {String} message [optional]</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(&#123;<span class="attr">foo</span>: <span class="string">'foo'</span>&#125;).to.eql(&#123;<span class="attr">foo</span>: <span class="string">'foo'</span>&#125;)</div></pre></td></tr></table></figure>
<h1 id="above-value"><a href="#above-value" class="headerlink" title="above(value)"></a>above(value)</h1><ul>
<li>@param {Number} value</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>Assert that the target is greater than <code>value</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="number">10</span>).to.be.above(<span class="number">5</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>Can also be used in conjunction with <code>length</code> to assert a minimum length.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="string">'foo'</span>).to.have.length.above(<span class="number">2</span>)</div></pre></td></tr></table></figure>
<h1 id="least-value"><a href="#least-value" class="headerlink" title="least(value)"></a>least(value)</h1><ul>
<li>@param {Number} value</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>Assert that the target is greater than or equal to <code>value</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="number">10</span>).to.be.at.least(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>used for length too</p>
</blockquote>
<h1 id="below-value"><a href="#below-value" class="headerlink" title="below(value)"></a>below(value)</h1><ul>
<li>@param {Number} value</li>
<li>@param {String} message [optinal]</li>
</ul>
<blockquote>
<p>Assert that the target is less than <code>value</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="number">5</span>).to.be.below(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>used for length too</p>
</blockquote>
<h1 id="most-value"><a href="#most-value" class="headerlink" title="most(value)"></a>most(value)</h1><ul>
<li>@param {Number} value</li>
<li>@param {String} message [optinal]</li>
</ul>
<blockquote>
<p>Assert that the target is less than or equal to <code>value</code></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="number">5</span>).to.be.at.most(<span class="number">5</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>used for length o</p>
</blockquote>
<h1 id="within-start-finish"><a href="#within-start-finish" class="headerlink" title="within(start, finish)"></a>within(start, finish)</h1><ul>
<li>@param {Number} start lowerbound inclusive</li>
<li>@param {Number} finish upperbound inclusive</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>Assert that the target is within a range</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">expect(<span class="number">28</span>).to.be.within(<span class="number">2</span>, <span class="number">30</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>used for length too</p>
</blockquote>
<h1 id="instanceof-constructor"><a href="#instanceof-constructor" class="headerlink" title="instanceof(constructor)"></a>instanceof(constructor)</h1><ul>
<li>@param {Constructor} constructor</li>
<li>@param {String} message [optional]</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Tea = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name,</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> Chai = <span class="keyword">new</span> Tea(<span class="string">'chai'</span>)</div><div class="line"></div><div class="line">expect(Chai).to.be.an.instanceof(Tea)</div><div class="line">expect([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).to.be.an.instanceof(<span class="built_in">Array</span>)</div></pre></td></tr></table></figure>
<h1 id="property-name-value"><a href="#property-name-value" class="headerlink" title="property(name[, value])"></a>property(name[, value])</h1><ul>
<li>@param {String} name</li>
<li>@param {Mixed} value [optional]</li>
<li>@param {String} message [optional]</li>
</ul>
<blockquote>
<p>Assert that the target has a property <code>name</code>, optionally asserting that the value of that property is strictly equal to <code>value</code>. If the <code>deep</code> flag is set, you can use dot- and bracket-notation for deep reference into objects and arrays.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">expect(obj).to.have.property(<span class="string">'foo'</span>)</div><div class="line">expect(obj).to.have.property(<span class="string">'foo'</span>, <span class="string">'bar'</span>)</div></pre></td></tr></table></figure>
<h2 id="to-be-continued"><a href="#to-be-continued" class="headerlink" title="to be continued"></a>to be continued</h2>]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[AVA Usage]]></title>
      <url>/2017/04/20/AVA-Usage/</url>
      <content type="html"><![CDATA[<h1 id="测试语法"><a href="#测试语法" class="headerlink" title="测试语法"></a>测试语法</h1><p>``` import test from ‘ava’</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Usage]]></title>
      <url>/2017/04/20/Usage/</url>
      <content type="html"></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[用 javascript 实现选中粘贴]]></title>
      <url>/2017/04/17/%E7%94%A8-javascript-%E5%AE%9E%E7%8E%B0%E9%80%89%E4%B8%AD%E7%B2%98%E8%B4%B4/</url>
      <content type="html"><![CDATA[<p>为了对付单位愚蠢的每日工作总结的要求, 写了一个小脚本来导出任务管理器里的内容到剪贴板, 于是接触了一下纯 javascript 实现复制到剪贴板功能</p>
<p>代码先行贴出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">    'use strict'</span>;</div><div class="line">    <span class="keyword">if</span> (<span class="string">'your_url'</span>)&#123;</div><div class="line">        <span class="keyword">var</span> issueList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.issue-list li'</span>);</div><div class="line">        <span class="keyword">var</span> taskList = [];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = issueList.length; i &lt; len; i++)&#123;</div><div class="line">            <span class="keyword">var</span> key = issueList[i].getAttribute(<span class="string">'data-key'</span>);</div><div class="line">            <span class="keyword">var</span> title = issueList[i].getAttribute(<span class="string">'title'</span>);</div><div class="line">            <span class="keyword">var</span> task = <span class="string">'已完成: '</span>+key+<span class="string">'-'</span>+title;</div><div class="line">            taskList.push(task);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">var</span> text = taskList.join(<span class="string">'\n'</span>);</div><div class="line">        <span class="keyword">var</span> clipboard = <span class="built_in">document</span>.createElement(<span class="string">'textarea'</span>);</div><div class="line">        clipboard.style.width = <span class="string">'100%'</span>;</div><div class="line">        clipboard.style.height = <span class="string">'300px'</span>;</div><div class="line">        clipboard.value = text;</div><div class="line">        <span class="keyword">var</span> listPanel = <span class="built_in">document</span>.getElementsByClassName(<span class="string">'list-panel'</span>)[<span class="number">0</span>];</div><div class="line">        listPanel.appendChild(clipboard);</div><div class="line">        <span class="keyword">var</span> today = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</div><div class="line">        today.style.width = <span class="string">'100%'</span>;</div><div class="line">        today.innerText = <span class="string">'Today'</span>;</div><div class="line">        listPanel.appendChild(today);</div><div class="line">        today.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="built_in">window</span>.location.href = <span class="string">'url_to_today'</span>;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">var</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</div><div class="line">        button.style.width = <span class="string">'100%'</span>;</div><div class="line">        button.innerText = <span class="string">'copy to clipboard'</span>;</div><div class="line">        listPanel.appendChild(button);</div><div class="line">        button.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">          clipboard.select();</div><div class="line">          <span class="built_in">document</span>.execCommand(<span class="string">'copy'</span>);</div><div class="line">          clipboard.blur();</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;)()</div></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Baisc Usage of Redux-Observable]]></title>
      <url>/2017/03/20/baisc-usage-of-redux-observable/</url>
      <content type="html"><![CDATA[<h2 id="First-of-All"><a href="#First-of-All" class="headerlink" title="First of All"></a>First of All</h2><h3 id="createEpicMiddleware-rootEpic"><a href="#createEpicMiddleware-rootEpic" class="headerlink" title="createEpicMiddleware(rootEpic)"></a><code>createEpicMiddleware(rootEpic)</code></h3><p><code>createEpicMiddleware</code> is used to create an instance of the actual redux-observable middleware, and you should provide a single, root Epic</p>
<h4 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h4><ol>
<li><code>rootEpic: Epic</code>: The root Epic<p></p></li>
<li><code>[options: Object]</code>: The optional configuration.</li>
</ol>
<ul>
<li><p><code>dependencies</code>: If given, it will be injected as the 3rd argument to all Epics,</p>
</li>
<li><p><code>adapter</code>: An adapter object which can transform the input/output streams provided to your epics, Usually used to adapt a stream library other than RxJS v5, like adapter-rxjs-v4 or adapter-most Options:</p>
<pre><code>*   `input: ActionsObservable =&amp;gt; Any`: Transforms the input stream of actions, `ActionsObservable` that is passed to your root Epic(transformation takes place before it is passed to the root Epix)

*   `output: any =&amp;gt; Observable`: Transforms the return value of root Epic(transform takes place after the root epic returned it)
</code></pre></li>
</ul>
<h4 id="Returns"><a href="#Returns" class="headerlink" title="Returns"></a>Returns</h4><p></p><p><code>MiddlewareAPI</code>: An instance of the redux-observable middleware</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><pre><code>import { createStore, applyMiddleware, compose } from &apos;redux&apos;
import { createEpicMiddleware } from &apos;redux-observable&apos;
import { rootEpic, rootRotuer } from &apos;./modules/root&apos;

const epicMiddleware = createEpicMiddleware(rootEpic)

export default function configureStore () {
  const store = createStore(
    rootRotuer,
    applyMiddleware(epicMiddleware)
  )
  return store
}
`&lt;/pre&gt;

### `combineEpics(...epic)`

`combineEpics` allows you to take multiple epics and combine them into a single one

#### Arguments

`...epics: Epic[]`: The epics to combine

#### Return

`(Epic)`: An Epic that merges the output of every Epic provided and passes along the `ActionObservable` and redux store as arguments

### Example

&lt;pre&gt;`import { combineEpics } from &apos;redux-observable&apos;
import pingEpic from &apos;./ping&apos;
import fetchUserEpic from &apos;./fetchUser&apos;

export default combineEpics(
  pingEpic,
  fetchUser
)
`&lt;/pre&gt;

### `EpicMiddleware`

An instance of the redux-observable middleware

To create it, pass your root Epic to `createEpicMiddleware`

`replaceEpic(nextEpic)`: Replaces the epic currently by the middleware, it is an advanced API. You might need this if your app implement code splitting and you want to load some of the epics dynamically or you&apos;re using hot reloading.

### Create Epic

&lt;pre&gt;`const pingEpic = action$ =&amp;gt; action$.ofType(&apos;PING&apos;).mapTo({type: &apos;PONG&apos;})
`&lt;/pre&gt;

### Cancellation

&lt;pre&gt;`import { ajax } from &apos;rxjs/observable/dom/ajax&apos;

const fetchUserEpic = action$ =&amp;gt; action$.ofType(&apos;FETCH_USER&apos;).mergeMap(
  action =&amp;gt; ajax.getJSON(`/api/user/${action.payload}`)
    .map(res =&amp;gt; fetchUserFulfilled(res))
    .takeUntil(action$.ofType(&apos;FETCH_USER_CANCELLED&apos;))
)
`&lt;/pre&gt;

### Handling Error

&lt;pre&gt;`import { ajax } from &apos;rxjs/observable/dom/ajax&apos;

const fetchUserEpic = action$ =&amp;gt; action.ofType(&apos;FETCH_USER&apos;).mergeMap(
  action =&amp;gt; ajax.getJSON(`/api/users/${action.payload}`)
  .map(res =&amp;gt; fetchUserFulfilled(res))
  .catch(err =&amp;gt; Observable.of({
    type: &apos;FETCH_USER_REJECTED&apos;,
    payload: err.xhr.response,
    error: true,
  }))
)
`&lt;/pre&gt;

### dependencies Injecting

&lt;pre&gt;`import { createEpicMiddleware, combineEpics } from &apos;redux-observable&apos;
import { ajax } from &apos;rxjs/observable/dom/ajax&apos;
import rootEpic from &apos;./somewhere&apos;

const epicMiddleware = createEpicMiddleware(rootEpic, {
  dependencies: { getJSON: ajax.getJSON }
})

const fetchUserEpic= (action$, store, { getJSON }) =&amp;gt; action$.ofType(&apos;FETCH_USER&apos;).mergeMap(
  (action) =&amp;gt; getJSON(`/api/users/${action.payload}`)
    .map(res =&amp;gt; ({
      type: &apos;FETCH_USER_REJECTED&apos;,
      payload: res
    }))
)
`&lt;/pre&gt;

### Adding New Epics Asynchronously/Lazily

&lt;pre&gt;`import { BehaviorSubject } from &apos;rxjs/BehaviorSubject&apos;
import { combineEpics } from &apos;redux-observable&apos;

const epic$ = new BehaviorSubject(combineEpics(epic1, epic2))
const rootEpic = (action$, store) =&amp;gt; epic$.mergeMap(epic =&amp;gt; epic(action$, store))

// sometime later ... add another Epic, keeping the state of the old ones...
epic$.next(asyncEpic1)
// and again later add another
epic$.next(asyncEpic2)
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> RxJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Functor 函子]]></title>
      <url>/2017/02/27/functor-e5-87-bd-e5-ad-90/</url>
      <content type="html"><![CDATA[<pre><code>class Functor {
  constructor (val) {
    this.__val = val
  }

  map (fn) {
    return new Functor(fn(__this.value))
  }
}
</code></pre><p>即将范畴 <code>Functor@val</code> 通过 fn 映射为范畴 <code>Function@fn(val)</code></p>
<p>Functor 本身具有 map 方法, 通过各种函数作为运算符, 映射成新的Functor</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> FP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Throttle 函数]]></title>
      <url>/2017/02/22/throttle-e5-87-bd-e6-95-b0/</url>
      <content type="html"><![CDATA[<pre><code>function throttle (fn, threshold, scope) {
  threshold || threshold = 250
  var last, timer
  return function () {
    var ctx = scope || this
    var now = +new Date()
    var args = arguments
    if (last &amp;amp;&amp;amp; now - last - threshold &amp;lt; 0) {
      // hold on it
      clearTimeout(timer)
      timer = setTimeout(function () {
        last = now
        fn.apply(ctx, args)
      }, threshold)
    } else {
      last = now
      fn.apply(ctx, args)
    }
  }
}
`&lt;/pre&gt;

&lt;pre&gt;`Elm.addEventListener(&apos;click&apos;, throttle(function(event){
  // ...
}, 1000))
</code></pre><p>假设第一次执行 throttle(fn0), fn0会立即执行, 并记录 throttle 开启的时间last</p>
<p>第二次执行, 假设为 throttle(fn1), 如果距离 now 未超出时限 threshold, 则开启定时器, threshold 后执行 fn1, 并设置 last</p>
<p>如果在开启定时器后, threshold 时限内执行 throttle(fn2) 则用于执行 fn1 的定时器会被清空, 开启 fn2 的定时器, 并设置 last</p>
<p>简而言之, 执行 throttle 的时候, 如果上一次的定时器未被执行, 则会被清除, 并重新开始计时</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Debounce 函数]]></title>
      <url>/2017/02/22/debounce-e5-87-bd-e6-95-b0/</url>
      <content type="html"><![CDATA[<pre><code>function debounce (fn, delay) {
  var timer = null
  return function () {
    var context = this, args = arguments
    clearTimeout(timer)
    timer = setTimeout(function () {
      fn.apply(context, args)
    }, delay)
  }
}
`&lt;/pre&gt;

Example:

&lt;pre&gt;`Elm.addEventListener(&apos;click&apos;, debounce(function(event){
  ...
}, 250))
</code></pre><p>可以看出, 传入 debounce 的所有函数共享计时器 timer, 因此如果在 delay 时间内再次调用 debounce(fn), 即上一次 fn 为执行而新的 fn 传入时, 上一次的 fn 的 timer 会清空, 对新传入的 fn 进行计时</p>
<p>其结果即是,</p>
<p>在 delay 时限内复数次调用 debounce 会刷新计时器</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[React-Router 中 props 的传递]]></title>
      <url>/2017/02/07/react-router-e4-b8-ad-props-e7-9a-84-e4-bc-a0-e9-80-92/</url>
      <content type="html"><![CDATA[<p>原本写</p>
<pre><code>{children}
`&lt;/pre&gt;

的地方改写为

&lt;pre&gt;`{children &amp;amp;&amp;amp; React.cloneElement(children, {
  prop, // 需要传入的 props
})}
</code></pre><p>即可</p>
<p><a href="https://github.com/ReactTraining/react-router/blob/master/examples/passing-props-to-children/app.js" target="_blank" rel="external">官方案例</a></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React-Router </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[babel-polyfill 入门]]></title>
      <url>/2017/02/04/babel-polyfill-e5-85-a5-e9-97-a8/</url>
      <content type="html"><![CDATA[<pre><code>yarn add babel-polyfill

import &apos;babel-polyfill&apos;
`&lt;/pre&gt;

babel-polyfill 提供了全局访问 API, 如 Promise, Set 以及 Map, 但是 polyfill 提供的 api 可能会污染到全局作用域, 特别在你把代码导报为第三方库给其他人用时, 或者你无法控制代码运行环境时, 都可能存在问题

`babel` 提供了 `transform-runtime` 插件来解决此问题, `transform-runtime` 提供一个沙盒机制来组织全局变量的污染

&gt; 需要注意, transform-runtime 依赖于 babel-runtime

&lt;pre&gt;`# transform-runtime 只应用于开发环境
yarn add --dev babel-plugin-transform-runtime 

# 其依赖包 babel-runtime 需要打包到生产环境
yarn add babel-runtime
`&lt;/pre&gt;

&lt;pre&gt;`// .babelrc
{
  &quot;plugins&quot;: [&quot;transform-runtime&quot;]
}

or

{
  &quot;plugins&quot;: [
    [&quot;transform&quot;, {
      &quot;helpers&quot;: false,
      &quot;polyfill&quot;: false,
      &quot;regenerator&quot;: true,
      &quot;moduleName&quot;: &quot;babel-runtime&quot;,
      }]
  ]
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> babel </tag>
            
            <tag> babel-polyfill </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[解决 CommonsChunkPlugin 的 hash 变化问题]]></title>
      <url>/2017/02/01/e8-a7-a3-e5-86-b3-commonschunkplugin-e7-9a-84-hash-e5-8f-98-e5-8c-96-e9-97-ae-e9-a2-98/</url>
      <content type="html"><![CDATA[<h3 id="原文"><a href="#原文" class="headerlink" title="原文:"></a>原文:</h3><blockquote>
<p>Manifest File<br>  But, if we change application code and run webpack again, we see that the hash for the vendor file changes. Even though we achieved separate bundles for vendor and main bundles, we see that the vendor bundle changes when the application code changes. This means that we still don’t reap the benefits of browser caching because the hash for vendor file changes on every build and the browser will have to reload the file.</p>
<p>  The issue here is that on every build, webpack generates some webpack runtime code, which helps webpack do it’s job. When there is a single bundle, the runtime code resides in it. But when multiple bundles are generated, the runtime code is extracted into the common module, here the vendor file.</p>
</blockquote>
<p>To prevent this, we need extract out the runtime into a separate manifest file. Even though we are creating another bundle, the overhead is offset by the long term caching benefits that we obtain on the vendor file.</p>
<h3 id="非翻译"><a href="#非翻译" class="headerlink" title="非翻译:"></a>非翻译:</h3><p>每次打包时 vendor 文件的 hash 也会变化的原因在于, webpack 打包时必定会产生 runtime code.</p>
<p>当我们需要打包出 vendor.js 的时候, 尽管公共代码没有变化, 但是 webpack 会生成新的 runtime code 并注入 vendor.js, 导致其 hash 变化.</p>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法:"></a>解决方法:</h3><p>将 vendor.js 中的 runtime code 单独打包出来, 这样只有 bundle.js 和 runtime code 的 hash 会变化, vendor.js 的代码不会变化.</p>
<h3 id="具体做法"><a href="#具体做法" class="headerlink" title="具体做法:"></a>具体做法:</h3><pre><code>new webpack.optimize.CommonsChunkPlugin({
  name: [&apos;vendor&apos;, &apos;manifest&apos;],
}
</code></pre><p>这样就可以把 runtime code 打包进 manifest.js, 此后该类操作不会改变 vendor.js 的 hash 了</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
            <tag> webpack2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack 2 config 文件入门]]></title>
      <url>/2017/01/29/webpack-2-config-e6-96-87-e4-bb-b6-e5-85-a5-e9-97-a8/</url>
      <content type="html"><![CDATA[<p>webpack 2 config 文件入门</p>
<h3 id="webpack-config-js-的基本结构"><a href="#webpack-config-js-的基本结构" class="headerlink" title="webpack.config.js 的基本结构"></a>webpack.config.js 的基本结构</h3><pre><code>var path = require(&apos;path&apos;)

module.exports = {
  entry:  {
    home: &apos;./home.js&apos;,
    about: &apos;./about.js&apos;,
    contact: &apos;./contact.js&apos;,
  }, // 入口文件
  // string | [string] | object {&amp;lt;key&amp;gt;: string | [string] }
  // 一个页面搭配一个入口文件
  output: {
    // output 包含一系列关于打包后文件的配置
    // output.chunkFilename: string, 这个参数确定了加载 chunk 的名称
    // output.crossOriginLoading: boolean | string, 只在 target 参数指定为 web 的时候使用, 因为此时通过 jsonp 加载模块
    // crossOriginLoading: false(default) , 禁止跨域加载
    // crossOriginLoading: &apos;anonymous&apos;, 允许无 credential 的跨域加载
    // crossOriginLoading: &apos;use-credentials&apos;, 允许有 credential 的跨域加载
    // 
    // output.devtoolFallbackModuleFilenameTemplate: string | function(info)
    // output.hotUpdateChunkFilename: string, 指定热刷新的 chunk 的名称, 仅支持 id 和 hash 占位符
    // hotUpdateChunkFilename: &apos;[id].[hash].hot-update.js&apos;
    // output.sourceMapFilename: string, 仅当 devtool 使用 source map 时生效, 默认为[ file].map, 可选占位符有[name], [id], [hash], [chunkhash]

    path: path.resolve(__dirname, &apos;dist&apos;), // 打包后文件存储路径, 必须是绝对路径, 可以用 path 模块生成

    publicPath: /assert/, // 解析文件中相对路径时依赖的根目录
    // 该字段设定了输出文件的 public Url
    // 
    // 默认的, 相对路径会基于 html 文件位置或&amp;lt;base&amp;gt;标签进行解析, 添加 publicPath 后, 各个 loaders 会在每个相对路径前添加 publicPath, 即相对路径基于 publicPath 进行解析
    // 该值一般以&apos;/&apos;结尾
    // 默认值为&apos;&apos;
    // simple rule: 该参数的值为html 页面到 output.path 的相对值
    // path: path.resolve(__dirname, &apos;public/assets&apos;),
    // publicPath: &apos;https://cdn.example.com/assets/&apos;,
    // publicPath 也会对 webpack-dev-server 生效
    // publicPath: &apos;https://cdn.example.com/assets/&apos; cdn, 并且应该使用 https
    // publicPath: &apos;//cdn.example.com/assets/&apos;, cdn, 使用相同协议
    // publicPath: &apos;/assets/&apos;, 相对于服务器根路径
    // publicPath: &apos;assets/&apos;, 相对于 html 页面
    // publicPath: &apos;../assets/&apos;, 相对于 html 页面
    // publicPath: &apos;&apos;, 相对于 html 页面(同一路径)

    filename: &apos;bundle.js&apos;, // 打包后的文件名称
    // 对于单一入口文件, filename 可以为静态名称&apos;bundle.js&apos;
    // 对于多入口文件, 可以使用参数生成特定名称
    // [name], [id], [hash], [chunkhash]
    // 可以为文件添加路径: &apos;js/[name]/bundle.js&apos;

    library: &apos;MyLibrary&apos;, // 输出库的名称

    libraryTarget: &apos;umd&apos;, // 输出库的类型
  },
  module: {
    // module.noParse: RegExp | [RegExp], 符合正则的字段被 import, require, define 后不会被处理, 可以提高打包速度
    // noParse: /jquery|lodash/
    //
    rules: [
      // 模块应用规则(loaders, parser 的设定等)
      // module.rules: array
      // 一条 Rule 可以分为三部分, Conditions, Results, Nested Rules

      // Conditions, 有两个输入值, 
      // 1\. The resource: 文件引用的绝对路径经过 resolve 规则解析后的结果
      // 2\. The issuer: 引用 resource 的模块到文件的绝对路径
      // 比如, &apos;app.js&apos; 中 &apos;import ./style.css&apos;, resource 是 &apos;/path/to/style.css&apos;, issuer 是 &apos;/path/to/app.js&apos;
      // 在 rule 中, test, include, exclude 和 resource 作用于resource, 而 issuer 族谱用于 issuer

      // Results
      // Rule Results 仅在 Rule Conditions 满足时起作用
      // Rule Results 有二种输出值
      // Applied Loaders: 一个数组, 其元素是应用于 resource 的 loaders
      // Parser options: 一个 options 对象, 作为当前 module 的 parser
      // loader, options, use 用于 loaders,
      // query, loaders 用于提高兼容性
      // enforce 属性指定 loader 类型, 可选值有: normal, pre, post
      // parser 属性影响 parser options

      // Nested Rules
      // 在 rules 和 oneOf 属性中可以指定 nested rules

      // Rule.enforce: &apos;pre&apos; | &apos;post&apos;, 指定 loader 的类型, 默认为 normal
      // 还有一种 inline loader 应用于 inline import/require, 
      // 所有 loaders 按照 post, inline, normal, pre 排序并依次执行
      // 所有 normal loaders 可以通过在 request 中添加前缀 &apos;!&apos; 进行忽略
      // 所有 normal 和 pre loaders 可以通过在 request 中添加前缀 &apos;-!&apos; 进行忽略
      // 所有 normal, post 和 pre loaders 可以通过在 request 前添加 &apos;!!&apos; 进行忽略

      // Rule.exclude
      // Rule.exclude 是 Rule.resource.exclude 的缩写
      // 
      // Rule.include
      // Rule.include 是 Rule.resource.include 的缩写
      //
      // Rule.issuer
      //
      // Rule.loader
      // Rule.loader 是 Rule.use: [{loader}] 的别名
      // 
      // Rule.loaders
      // Rule.loaders 是 Rule.use 的别名, 他的存在仅为了兼容 webpack1, 应使用 Rule.use
      // 
      // Rule.oneOf
      // 一个数组, 其元素为一系列 rules, 仅第一个符合条件的 rule 会起作用
      // 
      // Rule.options/ Rule.query
      // Rule.options 和 Rule.query 都是 Rule.use: [{options}] 的缩写
      // Rule.query 的存在仅为了兼容 webpack1, 应使用 Rule.options
      // 
      // Rule.parser
      // 一个 parser options 的对象, 所有要使用的 parser options 都集中在此
      // 每个不同的 parser options 都会创建对应 parser, 并且 plugins 可以根据 parser options 应用.  当 parser options 中没有设置或设置为 true 时, 大部分 plugins 默认只应用他们自己的 parser plugins
      // parser: {
      // amd: false, // disable AMD
      // commonjs: false, // disable CommonJS
      // harmony: false, // disable ES6 Harmony import/exports
      // requireInclude: false, // disable require.include
      // requreEnsure: false, // disable require.ensure
      // }

      // Rule.resource
      // Rule.rules, 一个 Rules 组成 的数组
      // Rule.test, Rule.resource.test 的缩写
      // Rule.use, 一系列应用于 modules 的 UseEntries, 每一个 entry 指定一个 loader
      // use: [&apos;style-loader&apos;] 是 use: [{loader: &apos;style-loader&apos;}] 的缩写
      // 可以链式传入多个 loaders, 从右向左依次执行
      // use: [
      //   {loader: &apos;style-loader&apos;},
      //   {loader: &apos;css-loader&apos;, options: { importLoader: 1}},
      //   {loader: &apos;less-loader&apos;, options: { noIeCompat: true}},
      // ]

      // Condition
      // Condition 可以为以下之一:
      // String: 比如 exclude: &apos;node_modules&apos;
      // RegExp: 比如 test: /\.js$/, exclude: /node_modules/
      // function: 返回 true 或 false
      // Condition Array: 至少有一个满足时刻认为满足 condition
      // Object: 所有属性都满足时可认为满足
      // 
      // {test: Condition}, {include: Condition}, {exclude: Condition}, {and: [Condition]}, {or: [Condition]}, {not: Condition}
      // 
      // UseEntry: object
      // 该属性必须有一个字符串 loader.
      // 该属性相对 context 的值解析 loader
      // 该属性拥有 options 属性, 该属性为 string 或 object, 该属性会作为 loader options 被传给 loader
      // 考虑到兼容性, 目前仍支持 query 作为 options 的别名
      // 

      {
        test: /\.jsx?$/, // 通过正则表达式选择要处理的文件
        include: [ // 限定文件范围
          path.resolve(__dirname, &apos;app&apos;)
        ],
        exclude: [ // 排除文件范围
          path.resolve(__dirname, &apos;demo&apos;)
        ]
        // 最佳实践
        // test 中使用正则表达式
        // include 和 exclude 中使用绝对路径
        // 优先使用 include 而不是 exclude
        issuer: { test, include, exclude },
        // issuer 的应用范围
        enforce: &apos;pre&apos;,
        enforce: &apos;post&apos;,
        loader: &apos;babel-loader&apos;,
        // 使用 babel-loader 处理符合条件的文件
        // webpack2 中 -loader 不再可以省略
        options: {
          presets: [&apos;es2015&apos;]
        }
        // babel-loader 的配置
      },
      {
        test: /\.html$/,
        use: [
          // 应用多个 loader 及相关配置
          &apos;htmllint-loader&apos;,
          {
            loader: &apos;html-loader&apos;,
            options: {
              // ...
            }
          }
        ]
      },

      {
         oneOf: [ /* rules */ ],
         // 仅应用 rules 数组中的一条规则
      },

      {
        rules: [ /* rules */ ],
        // 应用所有 rules
      },

      {
        resource: { and: [ /* conditions */ ]}
        // 当所有 conditions 都满足时才认为符合条件
      },

      { resource: { or: [ /* conditions */ ]}, },
      { resource: [ /* conditions */] },
      // 当某一 condition 满足时即可认为符合条件

      {
        resource: { not: /* condition */ }
        // 当某一 condition 不满足时可认为符合条件
      }
    ],
    // rules 结束
  },
  resolve: {
    // 解析模块 request 时的配置
    // (不会应用于解析 loader )
    modules: [
      &apos;node_modules&apos;,
      path.resolve(__dirname, &apos;app&apos;)
    ],
    // 解析 modules 时的路径
    extensions: [&apos;.js&apos;, &apos;.json&apos;, &apos;.jsx&apos;, &apos;.css&apos;],
    // 可以省略的扩展名
    alias: {
      // 模块别名
      // 为 import 或 require 创建别名
      // Utilities: path.resolve(__dirname, &apos;src/utilities&apos;)
      // import Utility from &apos;../../utilities/utility&apos; 可以缩写为 
      // import Utility from &apos;Utilities/utility&apos;
      // 末尾添加$可以进行精确匹配, 类似正则
      // 
      &apos;module&apos;: &apos;new-module&apos;,
      // 别名 module 可以表示 new-module, 包括文件与路径, 比如 module/path/file 会被解析为 new-module/path/file
      &apos;only-module$&apos;: &apos;new-module&apos;,
      // 别名 only-module(处于尾部) 会被解析成 new-module, 因此 module/path/file 不会被解析
    },
    // aliasFields: string
    // 指定一个 field, 比如 browser, 来执行特定的 alias
    // aliasFields: [&apos;browser&apos;]
    // 
    // resolve.descriptionFiles: array
    // 用于描述的 JSON 文件, 默认为
    // descriptionFiles: [&apos;package.json&apos;]
    // 
    // resolve.enforceExtension: boolean
    // 如果为 true, webpack 不会处理没有扩展名的文件, 默认为 false, 及允许 require(&apos;./foo&apos;) 这种写法
    //
    //resolve.enforceModuleExtension: boolean
    //默认为 false, 是否允许 modules(loaders) 省略扩展名
    //
    //resolve.extensions: array, 自动解析指定的扩展名
    //默认为
    // extensions: [&apos;.js&apos;, &apos;.json&apos;]
    // 因此可以使用 import File from (&apos;../path/to/file&apos;) 这种写法
    // 
    // resolve.mainFields: array
    // 当 import 一个包时, 比如 import * as D3 from &apos;d3&apos;, 这个设置决定package.json中的哪个 field 对应的包的会被检索, 默认值基于 target 的值
    // 当 target 指定为 webworker, web 或不指定
    // mainFields: [&apos;browser&apos;, &apos;module&apos;, &apos;main&apos;]
    // 对于其他 target, 
    // mainFields [&apos;module&apos;, &apos;main&apos;]
    // 例如, D3的 package 包括这些 fields
    // {
    // ...
    // main: &apos;build/d3.Node.js&apos;,
    // browser: &apos;build/d3.js&apos;,
    // module: &apos;index&apos;
    // ...
    // }
    // 
    // resolve.mainFiles: array
    // 这里的 filename 会在解析路径的时候用到, 默认为
    // mainFiles: [&apos;index&apos;]
    // 
    // resolve.modules: array
    // 限定 webpack 搜索与解析的范围
    // 可以使用绝对路径偶相对路径, 但是他们的行为有少许不同.
    // 相对路径的检索方式与 Node 检索 module 相近, 首先检索当前路径及父路径
    // 绝对路径则只会检索给定路径
    // 默认值为 modules: [&apos;node_modules&apos;]
    //
    // 如果要添加路径, 应当添加在 node_modules 前面
    // modules: [path.resolve(__dirname, &apos;src&apos;), &apos;node_modules&apos;]
    // 
    // resolve.unsafeCache: regex | array | boolean
    // 默认为 true, 即允许模块缓存, 即使这种行为是不安全的
    // 
  },

  performance: {
    // 此配置决定 webpack 的通知功能
    // 主要用于对文件尺寸的控制
    hints: &apos;warning&apos;, // enum
    // hints: boolean | &apos;error&apos; | &apos;warning&apos;
    // 设定 webpack 何时显示通知
    // 默认为 warning

    maxAssetSize: 200000, // int (in bytes)
    // maxAssetSize: int, 这个选项限制了单个 asset 的尺寸, 默认为250000

    maxEntrypointSize: 400000, // int (in bytes)
    // maxEntrypointSize: int, 限制初始加载时单个 entry 的最大请求数, 默认为250000

    assetFilter: function (assetFilename) {
      return assetFilename.endsWith(&apos;.css&apos;) || assetFilename.endsWith(&apos;.js&apos;)
    }
    // assetFilter: function, 这个属性允许 webpack 控制使用哪些文件来计算 performance hint, 默认为
    // function (assertFilename) {
    //   return !(/\.map$/.test(assetFilename))
    // }
    //
    // 可以自己设定 filter function
    // assetFilter: function(assetFilename) {
    //   return assetFilename.endsWith(&apos;.js&apos;)
    // }
  },

  devtool: &apos;source-map&apos;, // enum, string | false
  // 可以提高 debug 的便利性, 但是会影响打包速度
  // 面向开发有: eval, inline-source-map, eval-source-map, cheap-module-eval-source-map
  // 面向生产有: source-map, hidden-source-map, cheap-source-map, nosources-source-map

  context: __dirname, // 使用绝对路径
  // webpack 的根路径, loaders 的配置文件(.babelrc, postcss.config.js)和 entry 都是基于 context 来解析的
  // 该属性值默认为当前目录, 但是强烈建议书写这一字段, 可以使你的配置文件独立于当前工作目录

  target: &apos;web&apos;, // enum
  // 打包文件运行环境
  // webpack 可以针对多个 environment 或 target 编译
  // target: string, (async-node|electron|electron-renderer|node|node-webkit|web|webworker)

  externals: [&apos;react&apos;, /^@angular\//],
  // 不必打包的内容
  // externals: string| RegExp | function | array | object
  // 例如要使用 jquery 的 cdn, 则可以这样配置
  // externals: {
  //   jquery: &apos;jQuery&apos;
  // }
  // import $ from &apos;jquery&apos;
  // 
  // externals: {
  //   substract: [&apos;./math&apos;, &apos;substract&apos;]
  // }
  // 会形成一个负责结构, ./math 是父模块, 而你的 bundle 仅请求其子模块 substract
  // 
  // externals: {
  //   react: &apos;react&apos;,
  //   lodash: {
  //     commonjs: &apos;lodash&apos;,
  //     amd: &apos;lodash&apos;,
  //     root: &apos;_&apos;
  //   }
  // }
  // 

  watch: boolean
  // webpack 可以监控文件并在他们变化时进行重新编译
  // 默认为 false

  watchOptions: object, 
  // 配置 watch 的模式
  // {
  //   aggregateTimeout: number, 从第一次检测到文件变化到进行重新编译的延迟时间, 这个段时间内的其他变化会被整合进此次编译
  //   ignored: string | RegExp, 忽视某些文件的变化, 减轻 CPU 负担
  //   poll: boolean | number, 每隔1000ms 进行一次检测
  // }

  stats: {
    // 待补充
  },

  devServer: {
    // 这一部分的设置会被 webpack-dev-server 采用
    contentBase: path.resolve(__dirname, &apos;dist&apos;), // 指定 serve 目录为 dist
    compress: true, // 开启 gzip 压缩
    port: 9000, // 指定端口
    // 当 devServer 启动时, 控制台会打印
    // http://localhost:9000
    // webpack result is served from /build/
    // content is served from dist/
    // 这几行指出了 server 的位置和 served 内容
    // 如果你使用了 Node.js API, 那么这部分会被忽略
    // 
    // devServer.filename: string, 这个选项可以减少 lazy mode 下的编译次数
    // 默认的, 在 lazy mode 下, 每一个请求会进行一次新的编译 
    // 添加 filename 后, devServer 仅在请求 filename 时进行编译, 比如
    // lazy: true,
    // filename: bundle.js
    // 此时, devServer 仅在请求/ bundle.js 时进行编译
    // filename 仅在 lazy mode 中起作用
    // devServer.headers: object, 在所有 request 中添加请求头
    // headers: {
    //   &apos;X-Custom-Foo&apos;: &apos;bar&apos;
    // }
    // 
    // devServer.historyApiFallback: boolean, object
    // 当使用 Html5 History Api 时, index.html 可能得到404响应
    // 
    // devServer.hot: boolean, 开启 webpack 模块热替换
    // 
    // devServer.host - CLI only
    // 指定 host
    // 
    // devServer.https: boolean | object, devServer 默认false, 即使用 http
    // 
    // devServer.inline - CLI only
    // 切换 devServer 的模式, 默认使用 inline 模式, 即脚本会直接注入到你的 bundle 以实现重载, 设置 devServer.inline: false 可以启用 iframe 模式
    // 
    // 
  },

  plugins: [
    // 待补充
  ]
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
            <tag> webpack2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack 2 起步]]></title>
      <url>/2017/01/29/webpack-2-e8-b5-b7-e6-ad-a5/</url>
      <content type="html"><![CDATA[<p>虽然和 webpack1 一样, 还是过一遍</p>
<h3 id="创建一个-bundle"><a href="#创建一个-bundle" class="headerlink" title="创建一个 bundle"></a>创建一个 bundle</h3><pre><code>mkdir webpack-demo &amp;amp;&amp;amp; webpack-demo

npm init -y

yarn add --dev webpack@beta

yarn add lodash
`&lt;/pre&gt;

#### 创建 app/index.js

&lt;pre&gt;`// app/index.js
import _ from &apos;lodash&apos;
function component () {
  let element = document.createElement(&apos;div&apos;);

// use lodash
  element.innerHtml = _.join([&apos;Hello&apos;, &apos;webpack&apos;], &apos; &apos;)

  return element
}

document.body.appendChild(component())
`&lt;/pre&gt;

#### 创建 index.html

&lt;pre&gt;`&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;webpack 2 demo&amp;lt;/title&amp;gt;
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    &amp;lt;script src=&quot;public/bundle.js&quot;&amp;gt;&amp;gt;/script&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
`&lt;/pre&gt;

#### 创建打包后文件

&lt;pre&gt;`./node_modules/.bin/webpack app/index.js public/bundle.js
`&lt;/pre&gt;

webpack 会自动处理包的依赖关系

### 添加配置文件

&lt;pre&gt;`var path = require(&apos;path&apos;)

module.exports = {
  entry: &apos;./app/index.js&apos;,
  output: {
    path: path.resolve(__dirname, &apos;public&apos;),
    filename: &apos;bundle.js&apos;
  }
}
`&lt;/pre&gt;

通过 webpack 命令行进行打包

&lt;pre&gt;`webpack --config webpack.config.js
`&lt;/pre&gt;

`webpack` 会默认执行名为 `webpack.config.js` 的配置文件, 因此仅输入`webpack` 即可进行打包

### 通过 yarn 执行打包

在 `yarn init` 生成的 `package.json` 中添加

&lt;pre&gt;`{
  ...
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;webpack&quot;
  }
  ...
}
</code></pre><p>即可将<code>webpack</code>指令添加进 yarn 的快捷方式, 此时执行 <code>yarn build</code> 即可打包</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
            <tag> webpack2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Stacking Context 成因及特性]]></title>
      <url>/2017/01/18/stacking-context-e6-88-90-e5-9b-a0-e5-8f-8a-e7-89-b9-e6-80-a7/</url>
      <content type="html"><![CDATA[<h3 id="会形成Stacking-Context-的元素"><a href="#会形成Stacking-Context-的元素" class="headerlink" title="会形成Stacking Context 的元素"></a>会形成Stacking Context 的元素</h3><ul>
<li>root 元素( html )<p></p></li>
<li><p>position 不是 static 且 z-index 不是 auto 的元素</p>
</li>
<li><p>flex item 且 z-index 不是 auto 的元素</p>
</li>
<li><p>opacity 小于 1 的元素</p>
</li>
<li><p>transform 不是 none 的元素</p>
</li>
<li><p>mix-blend-mode 不是 normal 的元素</p>
</li>
<li><p>filter 不是 none 的元素</p>
</li>
<li><p>isolation 为 isolate 的元素</p>
</li>
<li><p>mobile webkit 和 chrome 22+ 上的 fixed 元素</p>
</li>
<li><p>在 will-change 属性上指定值为上述任意属性的元素</p>
</li>
<li><p>指定 -webkit-overflow-scrolling 为 touch 的元素</p>
</li>
</ul>
<h3 id="Stacking-Context-的特性"><a href="#Stacking-Context-的特性" class="headerlink" title="Stacking Context 的特性"></a>Stacking Context 的特性</h3><ul>
<li><p>stacking context 可以嵌套</p>
</li>
<li><p>每个 Stacking context 相对于兄弟元素都是完全独立的, 其内部规则不会影响到外部</p>
</li>
<li><p>每个 stacking context 元素都会被父级 stacking context 视为一个 stacking 规则</p>
</li>
</ul>
<p></p><p>为已经定位的元素( absolute 或 relative) 指定 z-index 可以改变其 parent stacking context 中 z 的偏移量</p>
<p>一个值得注意的坑: 如果一个元素不是通过absolute 或 relative 实现 stacking context, 那么他的 z-index 为 0 , 仅高于 auto, 且无法改变.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Web 坐标整理]]></title>
      <url>/2016/12/08/web-e5-9d-90-e6-a0-87-e6-95-b4-e7-90-86/</url>
      <content type="html"><![CDATA[<h3 id="坐标分类"><a href="#坐标分类" class="headerlink" title="坐标分类"></a>坐标分类</h3><ol>
<li>文档坐标<p></p></li>
<li>窗口坐标</li>
</ol>
<h3 id="scroll"><a href="#scroll" class="headerlink" title="scroll"></a>scroll</h3><p>Element.scrollTop: 设置或获得一个元素距离他容器顶部的像素距离, 当一个元素的容器没有产生垂直方向的滚动条, 则他的 scrollTop 的值默认为0</p>
<p>获得滚动距离<br>var intElementScrollTop = someElement.scrollTop;</p>
<p>scrollTop可以被设置为任何整数, 但是一下情况会报错:<br>1. 如果一个元素不能被滚动(没有溢出容器或本身不可滚动)的时候设置其 scrollTop 为 0;</p>
<ol>
<li><p>设置 scrollTop 的值小于 0, scrollTop 被设为 0</p>
</li>
<li><p>如果设置了超出这个容器可以滚动的值, scrollTop 会被设为最大值</p>
</li>
</ol>
<blockquote>
<p></p><p>其实就是溢出距离</p>
</blockquote>
<p><img src="https://developer.mozilla.org/@api/deki/files/842/=ScrollTop.png" alt=""></p>
<p>Element.scrollHeight: 计量元素内容高度的只读属性, 包括 overflow 样式属性导致的视图中不可见内容</p>
<p>没有垂直滚动条的情况下, scrollHeight 值与元素视图填充所有内容所需要的最小值 clientHeight 相同, 包括元素的 padding, 但不包括 margin</p>
<blockquote>
<p>其实就是溢出元素的本身高度</p>
</blockquote>
<p>!()[<a href="https://developer.mozilla.org/@api/deki/files/840/=ScrollHeight.png" target="_blank" rel="external">https://developer.mozilla.org/@api/deki/files/840/=ScrollHeight.png</a>]</p>
<h4 id="判断元素是否滚动到底部"><a href="#判断元素是否滚动到底部" class="headerlink" title="判断元素是否滚动到底部"></a>判断元素是否滚动到底部</h4><p><code>element.scrollHeight - element.scrollTop === element.clientHeight</code></p>
<h3 id="clientTop"><a href="#clientTop" class="headerlink" title="clientTop"></a>clientTop</h3><p>Element.clientTop: 一个元素顶部边框的宽度, 不包括顶部外边距或内边距, 只读属性</p>
<p>clientHeight 可以通过 CSS height + CSS padding - 水平滚动条高度 来计算</p>
<blockquote>
<p>其实就是可视区域高度</p>
</blockquote>
<p>mouseEvent.clientX: 只读属性, 事件发生时应用客户端区域的水平坐标, 与页面无关</p>
<p>mouseEvent.x 是 mouseEvent.clientX 的别名</p>
<h3 id="window"><a href="#window" class="headerlink" title="window"></a>window</h3><p>window.innerHeight: 浏览器窗口的视口( viewport ) 高度, 如果存在滚动条, 则要包括在内, 只读属性</p>
<p>window.outerHeight: 整个浏览器窗口的高度</p>
<p><img src="https://developer.mozilla.org/@api/deki/files/213/=FirefoxInnerVsOuterHeight2.png" alt=""></p>
<h3 id="offset"><a href="#offset" class="headerlink" title="offset"></a>offset</h3><p>mouseEvent.offsetX: read-only property provides the offset in the X coordinate of the mouse pointer between that event and the padding edge of the target node</p>
<h3 id="page"><a href="#page" class="headerlink" title="page"></a>page</h3><p>event.PageX: read-only property returns the horizontal coordinate of the event relative to the whole document</p>
<blockquote>
<p>文档坐标</p>
</blockquote>
<h3 id="screen"><a href="#screen" class="headerlink" title="screen"></a>screen</h3><p>mouseEvent.screenX: read-only property provides the horizontal coordinate of the mouse pointer in the global(screen) coordinate.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> Javascript </tag>
            
            <tag> HTML5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Simple CheetSheet of Flex]]></title>
      <url>/2016/12/07/simple-cheetsheet-of-flex/</url>
      <content type="html"><![CDATA[<h3 id="Flex"><a href="#Flex" class="headerlink" title="Flex"></a>Flex</h3><h5 id="Parent"><a href="#Parent" class="headerlink" title="Parent"></a>Parent</h5><ol>
<li>display: flex<p></p></li>
<li><p>flex-direction: row | row-reverse | column | column-reverse</p>
</li>
<li><p>flex-wrap: nowrap | wrap | wrap-reverse</p>
</li>
<li><p>flex-flow: &lt;flex-direction&gt; || &lt;flex-wrap&gt;</p>
</li>
<li><p>justify-content: flex-start | flex-end | center | space-between | space-around</p>
</li>
<li><p>align-items: flex-start | flex-end | center | stretch | baseline (single row)</p>
</li>
<li><p>align-content: flex-start | flex-end | center | stretch | space-between | space-around (multi-row)</p>
</li>
</ol>
<h5 id="Children-flex-item"><a href="#Children-flex-item" class="headerlink" title="Children(flex-item)"></a>Children(flex-item)</h5><ol>
<li><p>order: &lt;integer&gt;</p>
</li>
<li><p>flex-grow: &lt;number&gt;(0 default)</p>
</li>
<li><p>flex-shrink: &lt;number&gt;(0 default)</p>
</li>
<li><p>flex-basis: &lt;length&gt; | auto (auto default)</p>
</li>
</ol>
<p><img src="http://cdn2.w3cplus.com/cdn/farfuture/PKTu2Zlf4mWNkTFEVF0N7Qn1WFDXbKwRVp0Fv5w5jjI/mtime:1431011912/sites/default/files/blogs/2015/1505/rel-vs-abs-flex.svg" alt=""></p>
<ol>
<li><p>flex: none || &lt;flex-grow&gt;&lt;flex-shrink&gt;&lt;flex-basis&gt;</p>
</li>
<li><p>align-self: auto | flex-start | flex-end | center | stretch | baseline</p>
</li>
</ol>
<p></p><p><strong>notice:</strong> <code>float</code>, <code>clear</code>, <code>vertical-align</code> are unavailable in flex item</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Usage of Redux-Action]]></title>
      <url>/2016/11/06/usage-of-redux-action-2/</url>
      <content type="html"><![CDATA[<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><p><code>createAction(type, payloadCreator = Identity, ?metaCreator)</code></p>
<pre><code>import { createAction } from &apos;redux-action&apos;
`&lt;/pre&gt;

Wraps an action creator so that its return value is the payload of a Flux Standard Action. If no payload creator is passed, or if it&apos;s not a function, the identity function is used.

### Example

&lt;pre&gt;`let increment = createAction(&apos;INCREMENT&apos;, amount =&amp;gt; amount);
// same as 
increment = createAction(&apos;INCREMENT&apos;);

expect(increment(42)).to.deep.equal({
  type:&apos;INCREMENT&apos;,
  payload: 42,
});
`&lt;/pre&gt;

If the payload is an instance of an Error Object, redux-actions will automatically set `action.error` to true.

### Example

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;);

const error = new TypeError(&apos;not a number&apos;);
expect(increment(error)).to.deep.equal({
  type: &apos;INCREMENT&apos;,
  payload: error,
  error: true,
})
`&lt;/pre&gt;

`createAction` also return its `type` when used as type in `handleAction` or `handleActions`

### Example

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;)

// as parameter in handleAction:

handleAction(increment, {
  next(state, action){...},
  throw(state, action) {...},
});

const reducer = handleActions({
  [increment]: (state, action) =&amp;gt; ({
    counter: state.counter + action.payload
  })
})
`&lt;/pre&gt;

### createActions(?actionsMap, ?...identityActions)

&lt;pre&gt;`import { createActions } from from &apos;redux-actions&apos;
`&lt;/pre&gt;

Returns an object mapping action types to action creator. The keys of this object are camel-cased from the keys in `actionsMap` and the string literals of `identityActions` the values are the action creators.

### combineActions(...actionTypes)

Combine any number of action types or action creators, `actionTypes` is a list of positional arguments which can be action type strings, symbols, or action creators.

This allows you to reduce multiple distinct actions with the same reducers.

&lt;pre&gt;`const { increment, decrement } = createActions({
  INCREMENT: amount =&amp;gt; ({amount}),
  DECREMENT: amount =&amp;gt; ({amount: -amount}),
}) 

const reducer = handleAction(combineActions(increment, decrement), {
  next: (state, { payload: { amount }}) =&amp;gt; ({ ...state, counter: state.counter + amount}),
  throw: state =&amp;gt; ({ ...state, counter: 0}),
}, { counter: 10 })

expect(reducer(undefined, increment(1)).to.deep.equal({ counter: 11 }))
expect(reducer(undefined, decrement(1)).to.deep.equal({ counter: 9 }))
expect(reducer(undefined, increment(new Error)).to.deep.equal({ counter: 0 }))
expect(reducer(undefined, decrement(new Error)).to.deep.equal({ counter: 0 }))
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Flux Standard Action]]></title>
      <url>/2016/11/06/flux-standard-action/</url>
      <content type="html"><![CDATA[<h3 id="Example"><a href="#Example" class="headerlink" title="Example:"></a>Example:</h3><ol>
<li><p>A basic Flux Standard Action</p>
<p>{<br>  type: ‘ADD_TODO’,<br>  payload: {</p>
<pre><code>text: &apos;Do something&apos;,
</code></pre><p>  }<br>}<br>`</p>
<p>An FSA that represents an error, analogous to a rejected Promise:</p>
<p><pre>`{<br>  type: ‘ADD_TODO’,<br>  payload: new Error(),<br>  error: true,<br>}</pre></p>
</li>
</ol>
<p>Notice:<br>1. An action MUST</p>
<ul>
<li>be a plain JavaScript Object</li>
<li>have a <code>type</code> property</li>
</ul>
<ol>
<li>An action MAY:</li>
</ol>
<ul>
<li>have a <code>error</code> property</li>
<li>have a <code>payload</code> property</li>
<li>have a <code>meta</code> property</li>
</ul>
<ol>
<li>An action MUST NOT include properties other than <code>type</code>, <code>payload</code>, <code>error</code>, <code>meta</code></li>
</ol>
<h3 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h3><p>The <code>type</code> of an action identifies to the consumer the nature of the action that has occurred. Two actions with same <code>type</code> MUST be strictly equivalent (using ===). By convention, <code>type</code> is usually string constant or a Symbol.</p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>The optional <code>payload</code> property MAY be any type of value. It represents the payload of the action. Any information about the action that is not the <code>type</code> or status of the action should be part of the <code>payload</code> filed.</p>
<p>By convention, if <code>error</code> is <code>true</code>, the <code>payload</code> SHOULD be an error object. This is akin to rejecting a promise with an error object.</p>
<h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><p>The optional <code>error</code> property MAY be set to <code>true</code> if the action represents an error.</p>
<p>An action whose <code>error</code> is true is analogous to a rejected Promise. By convention the <code>payload</code> SHOULD be an error object.</p>
<p>If <code>error</code> has any other value besides <code>true</code>, including <code>undefined</code> and <code>null</code>, the action MUST NOT be interpreted as an error.</p>
<h3 id="meta"><a href="#meta" class="headerlink" title="meta"></a>meta</h3><p>The optional <code>meta</code> property MAY be any type of value. It is intended for any extra information that is not part of the payload.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Promise 基本点]]></title>
      <url>/2016/10/09/promise-e5-9f-ba-e6-9c-ac-e7-82-b9/</url>
      <content type="html"><![CDATA[<h3 id="Promise-基本用法"><a href="#Promise-基本用法" class="headerlink" title="Promise 基本用法"></a>Promise 基本用法</h3><p>创建 Promise</p>
<pre><code>var promise = new Promise(function(resolve, reject){
  // do something async
  if(/* everything ok */){
    resolve(&quot;OK&quot;); // it will return Promise.resolve(&quot;OK&quot;), and the downstream will get &quot;OK&quot; as params
  } else {
    reject(Error(&quot;Error&quot;)); // it will return Error(&quot;Error&quot;) and the downstream will get Error(&quot;Error&quot;) as params
  }
})
`&lt;/pre&gt;

Promise 构造器接受一个函数作为参数, 传入两个回调函数resolve 和 reject, 在这个函数参数中做一些一步操作, 成功后调用 resolve 将 Promise 对象的状态设置为 resolved 并返回一个 Promise 对象用于链式调用, 失败后调用 reject 将 Promise 对象的状态设置为 rejected 并返回一个 Promise 对象用于链式调用

使用时:

&lt;pre&gt;`promise.then(function(result){}).catch(function(err){})
</code></pre><h3 id="Promise-API-Reference"><a href="#Promise-API-Reference" class="headerlink" title="Promise API Reference"></a>Promise API Reference</h3><p>静态方法:</p>
<ul>
<li><p><code>Promise.resolve(promise)</code>, 返回一个 Promise</p>
</li>
<li><p><code>Promise.resolve(thenable)</code>, 从 thenable 对象创建一个新的 Promise, 一个 thenable (类 Promise) 对象是一个带有” then” 方法的对象.</p>
</li>
<li><p><code>Promise.resolve(obj)</code>, 创建一个以 obj 为肯定结果的 Promise</p>
</li>
<li><p><code>Promise.reject(obj)</code>, 创建一个以 obj 为否定结果的 Promise, 为了一致性和调试方便, obj 应该是一个 Error 实例对象.</p>
</li>
<li><p><code>Promise.all(array)</code>, 创建一个 Promise, 当且仅当数组中的所有 Promise 都 resolved 之后才设为 resolved, 若其中存在 rejected, 则设置状态为rejected</p>
</li>
<li><p><code>Promise.race(array)</code>, 创建一个 Promise, 当数组首先出现 resovled 或 rejected 的时候设置为同状态</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Promise </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript 事件与性能]]></title>
      <url>/2016/09/27/javascript-e4-ba-8b-e4-bb-b6-e4-b8-8e-e6-80-a7-e8-83-bd/</url>
      <content type="html"><![CDATA[<p>事件处理程序本质上是一种函数, 是一种对象, 存放在内存中, 设置大量的事件处理程序会使内存中的对象变多, Web 程序的性能会变得越来越差.</p>
<p>为了更好利用事件处理程序, 出现了<strong>事件委托</strong>, 用来提升性能</p>
<h3 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h3><p>Event Delegate: 把若干个子节点上的相同事件的处理函数绑定到父节点, 从父节点统一处理子节点冒泡上来的事件, 这种技术叫做事件委托.</p>
<p>举例:</p>
<pre><code>&amp;lt;ul id=&apos;parent-list&apos;&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
`&lt;/pre&gt;

通过父节点监听冒泡事件可以处理子节点上的对应事件

&lt;pre&gt;`var parentList = document.getElementById(&apos;parent-list&apos;);
parentList.addEventListener(&apos;click&apos;, function(){
  var target = event.target; // li
  if(target.nodeName.toLowerCase() === &apos;li&apos;){
    alert(target.firstChild.nodeValue);
  }
}, false)
</code></pre><p>因为事件委托依赖事件冒泡机制, 所以并不是所有事件都可以委托</p>
<p>最适合的事件: click, mousedown, mouseup, keydown, keyup, keypress</p>
<h3 id="移除事件处理程序"><a href="#移除事件处理程序" class="headerlink" title="移除事件处理程序"></a>移除事件处理程序</h3><p>每当将事件处理程序制定给元素时, 运行中的浏览器代码与支持页面交互的 Js 代码之间就会建立一个连接, 这种连接越多, 页面执行越慢</p>
<p>如果使用完后不再使用的事件处理程序, 应当释放掉<br>```</p>
<p><button id="button">Submit</button><br>var button = document.getElementById(‘button’);<br>button.onclick = function(){<br>  button.onclick = null;<br>  event.target.firstChild.nodeValue = “Submitting”<br>}</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript 停止冒泡和阻止浏览器默认行为]]></title>
      <url>/2016/09/27/javascript-e5-81-9c-e6-ad-a2-e5-86-92-e6-b3-a1-e5-92-8c-e9-98-bb-e6-ad-a2-e6-b5-8f-e8-a7-88-e5-99-a8-e9-bb-98-e8-ae-a4-e8-a1-8c-e4-b8-ba/</url>
      <content type="html"><![CDATA[<h3 id="事件兼容"><a href="#事件兼容" class="headerlink" title="事件兼容"></a>事件兼容</h3><pre><code>function myFn(e){
  var evt = e ? e:window.event
}
`&lt;/pre&gt;

### JS 停止冒泡

&lt;pre&gt;`function myFn(e){
  window.event ? window.event.cancelBubble = true : e.stopPropagation();
}
`&lt;/pre&gt;

### JS 阻止默认行为

&lt;pre&gt;`function myFn(e){
  window.event ? window.event.returnValue = false : e.preventDefault();
}
</code></pre><h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><p>event 表示事件的状态, 例如, event.target 是触发事件的对象</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[koa-router]]></title>
      <url>/2016/09/19/koa-router/</url>
      <content type="html"><![CDATA[<ul>
<li>Express 式路由使用<code>app.get</code>, <code>app.put</code>, <code>app.post</code> 等</li>
<li>Named URL parameters and regexp captures</li>
<li>String or regular expression route matching</li>
<li>Named Routes with URL generation</li>
<li>Responds to <code>OPTIONS</code> request with allowed methods</li>
<li>Support for <code>405 Method Not Allowed</code> and <code>501 Not Implemented</code></li>
<li>Multiple route middleware</li>
<li>Multiple routers</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>npm install koa-router
`&lt;/pre&gt;

### 使用

&lt;pre&gt;`var koa = require(&quot;koa&quot;),
    router = require(&quot;koa-router&quot;),
    app = koa();

app.use(router(app))
`&lt;/pre&gt;

After the router has been initialized you can register routes:

&lt;pre&gt;`app.get(&quot;/users/:id&quot;, function*(next){
  var user = yield User.findOne(this.params.id);
  this.body = user;
});
`&lt;/pre&gt;

### 多路由

You can use multiple routers and sets of routes by omitting the `app` argument. For example, separate routes for two versions of an API:

&lt;pre&gt;`var koa = require(&quot;koa&quot;),
    mount = require(&quot;mount&quot;),
    Router = require(&quot;koa-router&quot;);

var app = koa();

var APIv1 = new Router();
var APIv2 = new Router();

APIv1.get(&quot;/sign-in&quot;, function*(){
  // ...
})
APIv2.get(&quot;/sign-in&quot;, function*(){
  // ...
})

app.use(mount(&quot;/v1&quot;, APIv1.middleware())).use(mount(&quot;/v2&quot;, APIv2.middleware()));
`&lt;/pre&gt;

### 链

The http methods(get, post, etc) return their `Router` instance, so routes can be chained as you&apos;re used to with express:

&lt;pre&gt;`var api = new Router();

api.get(&quot;/foo&quot;, showFoo).get(&quot;/bar&quot;, showBar).post(&quot;/foo&quot;, createFoo)
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Koa </tag>
            
            <tag> NODE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[编写 Koa 中间件]]></title>
      <url>/2016/09/19/e7-bc-96-e5-86-99-koa-e4-b8-ad-e9-97-b4-e4-bb-b6/</url>
      <content type="html"><![CDATA[<p>Koa middlewares are simple function which return a <code>GeneratorFunction</code>, and accept another (middleware). When the middleware is run by an “upstream” middleware, it must manually <code>yield</code> to the “downstream” middleware.</p>
<p>For example if you wanted to track how long it takes for a request to propagate through Koa by adding an <code>x-Response-Time</code> header field the middleware would look like the following:</p>
<pre><code>function *responseTime(next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  this.set(&quot;X-Response-Time&quot;, ms+&quot;ms&quot;);
}
app.use(responseTime);
`&lt;/pre&gt;

Here is another way to write the same thing, inline:

&lt;pre&gt;`app.use(function *(next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  this.set(&quot;X-Response-Time&quot;, ms+&quot;ms&quot;);
});
`&lt;/pre&gt;

### 中间件最佳实践

Imcluding Middleware accepting options, named middleware for debugging, among others

#### 中间件选项

When creating public middleware it&apos;s useful to conform to the convention of wrapping the middleware in a function that accepts options, allowing users to extend functionality. Even if your middleware accepts no options, this is still a good idea to keep things uniform.

Here our contrived `logger` middleware accepts a `format` string for customization, and returns the middleware itself:

&lt;pre&gt;`function logger(format){
  format = format || &quot;:method\&quot;:url\&quot;&quot;;
  return function*(next){
    var str = format.replace(&quot;:method&quot;, this.method).replace(&quot;:url&quot;, this.url);
    console.log(str);
    yield next;
  }
}
`&lt;/pre&gt;

app.use(logger());
app.use(logger(&quot;:method:url&quot;))

&lt;pre&gt;`
### 命名中间件
Naming middlewares is optional, however it&apos;s useful for debugging purpose to assign a name
`&lt;/pre&gt;

function logger(format){
  return function *logger(next){
    // ...
  }
}

&lt;pre&gt;`### 结合多个中间件
Sometimes you want to &quot;compose&quot; multiple middleware into a single middleware for easy re-use or exporting. To do so, you may chain them together with `.call(this, next)`, then return another function that yields the chain
</code></pre><p>function _random(next) {<br>  if (‘/random’ == this.path) {<br>    this.body = Math.floor(Math.random()_10);<br>  } else {<br>    yield next;<br>  }<br>};</p>
<p>function *backwards(next) {<br>  if (‘/backwards’ == this.path) {<br>    this.body = ‘sdrawkcab’;<br>  } else {<br>    yield next;<br>  }<br>}</p>
<p>function *pi(next) {<br>  if (‘/pi’ == this.path) {<br>    this.body = String(Math.PI);<br>  } else {<br>    yield next;<br>  }<br>}</p>
<p>function *all(next) {<br>  yield random.call(this, backwards.call(this, pi.call(this, next)));<br>}</p>
<p>app.use(all);<br>```</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Koa </tag>
            
            <tag> NODE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[koa 使用]]></title>
      <url>/2016/09/19/koa-e4-bd-bf-e7-94-a8/</url>
      <content type="html"><![CDATA[<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Koa 当前需要 node 0.11.x 并开启 –harmony(或– harmony-generators), 因为他依赖于 ES6的 generator 特性<br><code>node --harmony my-koa-app.js</code></p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>Koa 应用是一个包含中间件 generator 方法数组的对象. 当请求到来时, 这些方法会以 stack-slice 的顺序执行.</p>
<p>Koa 的一大设计理念是, 通过其他底层中间件层提供高级”语法糖”, 而不是 Koa, 大大提高了框架的互操作性和健壮性, 并让中间件开发变得有趣.</p>
<p>简单例子</p>
<pre><code>var koa = require(&quot;koa&quot;);
var app = koa();
app.use(function*(){
  this.body = &quot;Hello World&quot;;
});
app.listen(3000);
`&lt;/pre&gt;

**注**: 与普通 function 不同, generator function 以 function* 的形式声明.

### 编写级联代码

koa 中间件以一种更加传统的方式级联.

以往的 Node 开发中, 级联是通过回调实现的, 用户友好度上有欠缺

Koa 借助 generator 实现了中间件架构

Koa 的执行代码的形式不再是简单的将控制权依次移交给一个又一个方法直到结束, 而是像一个回形针, 用户请求中间件, 遇到 yield next 关键字的时候, 会被传递给下游中间件(downstream), 在 yield next 捕获不到 downstream 的时候, 逆序返回执行代码(upstream)(yield next 后面的代码)

&lt;pre&gt;`var koa = require(&quot;koa&quot;);
var app = koa();

// x-response-time

app.use(function* (next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  this.set(&quot;X-Response-Time&quot;, ms+&quot;ms&quot;);
})

// logger
app.use(function* (next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  console.log(&quot;%s %s - %s&quot;, this.method, this.url, ms)
});

// response
app.use(function* (){
  this.body = &quot;Hello World&quot;;
});

app.listen(3000);
`&lt;/pre&gt;

### 应用配置

应用配置是 app 实例的属性, 目前支持以下配置:
- app.name 应用名
- app.env 执行环境, 默认是`NODE_ENV`或者`development`字符串
- app.proxy, 当该属性为 true 时, `proxy header` 参数会被添加到信任列表中

### app.listen(...)

一个 Koa 应用跟 HTTP Server 不是1-to-1关系, 一个或多个 Koa应用可以被加载到一块, 组成一个更大的包含一个 HTTP server 的应用

该方法创建并返回一个 http server, 并支持传递固定参数

&lt;pre&gt;`var koa = require(&quot;koa&quot;)
var app = koa()
app.listen(3000)
`&lt;/pre&gt;

方法 app.listen(...)是一个语法糖, 等价于

&lt;pre&gt;`var http = require(&quot;http&quot;)
var koa = require(&quot;koa&quot;)
var app = koa()
http.createServer(app.callback()).listen(3000)
`&lt;/pre&gt;

这意味着可以在多个端口使用同一个 app

&lt;pre&gt;`http.createServer(app.callback()).listen(3000)
http.createServer(app.callback()).listen(3001)
`&lt;/pre&gt;

### app.callback()

返回一个回调方法能用于 http.createServer()来处理请求, 也可以将这个回调函数挂载到 Connect/Express 应用上

### app.use(function)

将给定的 function 当做中间件加载到应用中

### app.keys=

设置 Cookie 签名密钥

### 错误处理

除非应用执行环境(NODE_ENV)被配置为&quot;test&quot;, Koa 都会将所有错误信息输出到 stderr, 如果想自定义错误处理逻辑, 可以定义一个&quot;错误事件&quot;来坚挺 Koa App 中的错误:

&lt;pre&gt;`app.on(&quot;error&quot;,function(err){
  log.error(&quot;server error&quot;, err);
})
`&lt;/pre&gt;

当 req/res 周期中出现任何错误且无法响应客户端时, koa 会把 Context(上下文)实例作为第二个参数传递给 error 事件:

&lt;pre&gt;`app.on(&quot;error&quot;, function(err, ctx){
  log.error(&quot;server error&quot;, err, ctx)
})
`&lt;/pre&gt;

### 上下文

Koa 的 Context 把 node 的 request 和 response 对象封装在一个单独对象, 并提供许多开发 web 应用和 APIs 有用的方法. 那些 HTTP Server 开发中使用非常频繁操作, 直接在 Koa 里实现, 而不是放在更高层次的框架, 这样中间件就不需要重复实现这些通用的功能.

每个请求会创建自己的 Context 实例, 在中间件中作为 receiver 引用, 或通过 this 标示引用:

&lt;pre&gt;`app.use(function* (){
  this; // is the Context
  this.request; // is a koa Request
  this.response; // is a koa Response
})
</code></pre><p>Context 的许多访问器和方法直接委托为他们的 ctx.request 或 ctx.response 的等价方法, 用于访问方便, 是完全相同的, 比如 ctx.type 和 ctx.length 委托与 response 对象, ctx.path 和 ctx.method 委托与 request.</p>
<h3 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h3><p>Koa Request 对象是 node 普通 request 对象之上的抽象, 提供了日常 Http Server 中更多有用的功能</p>
<h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><ul>
<li>request.header</li>
<li>request.headers: req.header 的别名</li>
<li>request.method: 请求方法</li>
<li>request.method=: 设置请求方法, 实现中间件的时候非常有用</li>
<li>request.length: 将请求的 Content-length 返回为数字, 或 undefined</li>
<li>request.url: 获取请求 URL</li>
<li>request.url=: 设置请求 URL<br>…</li>
</ul>
<h3 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h3><p>Koa Response 对象是 node 普通 response 对象之上的抽象, 提供了日常 Http Server 中有用的功能</p>
<h4 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h4><p>….</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NODE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[XTemplate 模板语法]]></title>
      <url>/2016/09/18/xtemplate-e6-a8-a1-e6-9d-bf-e8-af-ad-e6-b3-95/</url>
      <content type="html"><![CDATA[<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>变量会从当前模板的上下文查找值, 如果要输出一个变量的值, 可以使用</p>
<pre><code>{{ variable }}
`&lt;/pre&gt;

这样模板引擎会从上下文寻找变量`variable`并打印出来. 变量可以使用`.`访问其属性, 和 js 一样也可以通过`[]`访问属性

&lt;pre&gt;`{{ user.name }}
{{ user['name'] }}
`&lt;/pre&gt;

如果一个变量的值是`undefined`或`null`, 那么什么也不会输出, 也不会报错.

### 支持的数据类型

XTemplate 支持 js 中所有基本数据类型
- Boolean
- Number
- String
- Null
- Undefined
- Object
- Array

### 输出

使用`{{ foo }}`来输出`escape`之后的数据, `{{{ foo }}}`来输出`unescape`的原始数据

&lt;pre&gt;`escaped: {{ foo }}
unescaped: {{{ foo }}}
`&lt;/pre&gt;

如果希望输出最原始数据(包括`{{}}`), 那么需要使用`{{% %}}`语法

&lt;pre&gt;`{{% 
      {{ x }}
    %}}
`&lt;/pre&gt;

渲染这个模板, 会输出

&lt;pre&gt;`{{ x }}
`&lt;/pre&gt;

#### 添加注释

&lt;pre&gt;`{{! comment }}
`&lt;/pre&gt;

#### 添加空格

`{{~`删除空格前缀
    `~}}`删除空格后缀

### 作用域

每一个模板都有一个独立的作用于, 在字幕版中可以访问父模板的上下文, 但是字幕版中定义或者修改变量不会影响到父模板的变量

&lt;pre&gt;`// parent.xtpl
{{ set (a=1,b=2) }}
{{ include ('sub.xtpl') }}
in parent:
a = {{ a }}
b = {{ b }}
`&lt;/pre&gt;

&lt;pre&gt;`// sub.xtpl
in sub:
{{ set b = 3 }}
a = {{ a }}
b = {{ b }}
`&lt;/pre&gt;

渲染 parent.xtpl 得到

&lt;pre&gt;`in sub: 
a: 1
b: 3
in parent:
a: 1
b: 2
`&lt;/pre&gt;

### 根数据

通过`root.foo` 可以访问到渲染的根数据, 即调用`render`方法时传入的数据

用数据`{ name: &apos;foo&apos;, array: [{name:&apos;bar&apos;}] }`渲染下面模板:

&lt;pre&gt;`{{ #each(arr) }}
{{root.name}} {{name}}
{{/each}}
`&lt;/pre&gt;

得到

&lt;pre&gt;`foo bar
`&lt;/pre&gt;

## 方法和逻辑

可以使用变量上 js 提供的方法:

&lt;pre&gt;`var x = [1,2,3]
`&lt;/pre&gt;

&lt;pre&gt;`{{#each(x.slice(1))}}{{this}} {{/each}} // =&amp;gt; 2 3
`&lt;/pre&gt;

### 操作符

XTemplate 支持在数据上使用一些操作符:

&lt;pre&gt;`+, -, *, /, %
`&lt;/pre&gt;

&lt;pre&gt;`===, !==, &amp;gt;, &amp;gt;=, &amp;lt;, &amp;lt;=
`&lt;/pre&gt;

&lt;pre&gt;`||, &amp;amp;&amp;amp;, !
`&lt;/pre&gt;

&lt;pre&gt;`?:
`&lt;/pre&gt;

### 函数调用

如果你传递 js 的方法到模板中, 那么可以使用它

&lt;pre&gt;`{{foo(1,2,3)}}
`&lt;/pre&gt;

### 内置函数

&lt;pre&gt;`range(start, end, [step])
`&lt;/pre&gt;

不包括 end

&lt;pre&gt;`set(key = value, [key = value])
`&lt;/pre&gt;

`set` 用于定义或修改一个变量

&lt;pre&gt;`{{ set(x=1) }}
{{ set(y=3,z=2) }}
{{x}}
{{y+z}}
`&lt;/pre&gt;

渲染得到

&lt;pre&gt;`1
5
`&lt;/pre&gt;

`void`, 允许忽略模板渲染

&lt;pre&gt;`{{ set(x=1) }}
{{ void(x) }}
`&lt;/pre&gt;

将渲染空

## 命令

命令是一些特殊的区块, 对于这些特殊的区块, XTemplate 会做特殊处理. XTemplate 自带了一些内置的命令, 也可以自定义命令

`if`

&lt;pre&gt;`{{# if(variable) }}
  It is true
{{/ if}}
`&lt;/pre&gt;

如果 vairable 为 true, 则渲染命令块

&lt;pre&gt;`{{# if(variable) }}
{{ elseif (vairable)}}
{{ else }}
{{/ if }}

`with`
和 js 中的`with`类似
`&lt;/pre&gt;

var a = {
  b:1
}
```

&lt;pre&gt;`{{{#with(a)}}}
{{b}} // 1
{{/with}}
`&lt;/pre&gt;

`each`
`each`可以对 array 和 dictionary 进行迭代

&lt;pre&gt;`// array
{{ set (array = [{
      name: 'foo'
    }, {
      name: 'bar'
    }])}}

{{#each(array)}}
  {{xindex}} {{this.name}}
{{/each}}
`&lt;/pre&gt;

渲染得到

&lt;pre&gt;`0 foo
1 bar
`&lt;/pre&gt;

&lt;pre&gt;`// dictionary
{{ set (dictionary = {
      foo:'bar',
      hello:'world'
    })}}

{{#each(dictionary,'value','key')}}
  {{key}}{{value}}
{{/each}}
`&lt;/pre&gt;

渲染得到

&lt;pre&gt;`foo bar
hello world
`&lt;/pre&gt;

### 访问上层变量

在`with`和`each`中, 可以通过`../`访问外层的同名变量

&lt;pre&gt;`// {a: 1, b:[{a:2}]}
{{#with(x)}}
  {{#each(b)}}
    {{../a}}{{a}} // 12
  {{/with}}
{{/with}}
`&lt;/pre&gt;

### 宏

宏允许你定义一个可复用的代码片段

&lt;pre&gt;`{{#macro("test","param",default=1)}}
  param is {{param}} {{default}}
{{/macro}}
`&lt;/pre&gt;

现在可以调用该宏

&lt;pre&gt;`{{macro("test", "2")}}
{{macro("test","2",default=2)}}
`&lt;/pre&gt;

渲染结果

&lt;pre&gt;`param is 2 1
param is 2 2
`&lt;/pre&gt;

### include

`include` 引入其他的模板, 在共享组件的时候十分有效

&lt;pre&gt;`{{ include ('item.html') }}
`&lt;/pre&gt;

如果下网引入子模板的时候可以在子模板的上下文设置其他值, 可以通过`include`后面的参数传入

&lt;pre&gt;`// parent.html
{{ set(x='x',y='y') }}
{{ include ('sub.html', xx=x,yy=x) }}
`&lt;/pre&gt;

&lt;pre&gt;`// sub.html
x:{{x}}
y:{{y}}
xx:{{xx}}
yy:{{yy}}
`&lt;/pre&gt;

parent.html渲染结果

&lt;pre&gt;`x: x // from parent.html
y: y // from parent.html
xx: x // from sub.html
yy: x // from sub.html
`&lt;/pre&gt;

### includeOnce

功能和`include`一样, 区别在于对于同一个模板, 只在第一次调用的时候起作用.

### parse

如果希望能够让子模板拥有一个完全独立的上下文, 不需要父级作用于, 则可以使用`parse`

&lt;pre&gt;`// parent.html
{{ set(x = 'x', y = 'y') }}
{{ parse('sub.html', xx = x, yy = x) }}
`&lt;/pre&gt;

&lt;pre&gt;`// sub.html
x: {{x}}
y: {{y}}
xx: {{xx}}
yy: {{yy}}
`&lt;/pre&gt;

parent.html渲染结果

&lt;pre&gt;`x:
y:
xx:x
yy:x
`&lt;/pre&gt;

## 模板继承

当编写一个 template 的时候, 可以定义`blocks`, 这样在字幕版中可以重写这些 block

&lt;pre&gt;`// parent.xtpl
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;....&amp;gt;
    {{{block ('head')}}}
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    {{{block ('body')}}}
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
`&lt;/pre&gt;

&lt;pre&gt;`// child.xtpl
{{ extend ('./parent.xtpl')}}

{{#block ('head')}} // overwrite head block
  &amp;lt;....&amp;gt;
{{/block}}

{{#block ('body')}} // overwrite body block
  &amp;lt;...&amp;gt;
{{/block}}
</code></pre><p>渲染 child.xtpl 可以获得新的模板下的实例</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Flex 属性详解]]></title>
      <url>/2016/09/17/flex-e5-b1-9e-e6-80-a7-e8-af-a6-e8-a7-a3/</url>
      <content type="html"><![CDATA[<ol>
<li>display: flex|inline-flex; (修饰Flex Container, 也就是 Flex Item的父级元素)<br>该属性修饰的元素, 其子元素将变成 flex 文档流, 称为 Flex Item</li>
</ol>
<p><strong>注意</strong>: CSS 的 columns 在 FlexContainer 上没有作用; float, clear, vertical-align 在 FlexItem 上没有作用</p>
<ol>
<li>flex-direction: row|row-reverse|column|column-reverse(修饰 Flex Container)<br>用于定义main-axis, 从而定义 flex 文档流方向<p></p></li>
<li><p>flex-wrap: nowrap|wrap|wrap-reverse; (修饰 Flex Container)<br>nowrap: 单行显示; wrap: 多行显示; wrap-reverse: 逆向多行显示</p>
</li>
<li><p>flex-flow: &lt;’flex-direction’&gt;||&lt;’flex-wrap’&gt;; (修饰 Flex Container)<br>这个是 flex-direction 和 flex-wrap 的缩写, 同时定义主轴和侧轴的文档流向</p>
</li>
<li><p>justify-content:flex-start|flex-end|center|space-between|space-around; (修饰 Flex Container)<br>定义主轴线上 Flex Item 的对齐方式</p>
</li>
</ol>
<p>flex-start: 向起始位置对齐; flex-end: 向结束位置对齐; center: 向中间靠拢; space-between: 首位 item 位于边界, 所有 items 均匀分布; space-around: 首位 item 距离边界1space, 所有 item 之间距离2space</p>
<p><img src="http://cdn.w3cplus.com/cdn/farfuture/gnLmjiUDLu3L9INIb8KPA5vE6xsQaRuSMU_UfamwmDM/mtime:1421035122/sites/default/files/styles/print_image/public/blogs/2013/flexbox-guide-2.jpg" alt=""></p>
<ol>
<li>align-item: flex-start|flex-end|center|baseline|stretch; (修饰 Flex Container)<br>定义 item 在侧轴方向的对齐方式</li>
</ol>
<p><img src="http://cdn2.w3cplus.com/cdn/farfuture/DTYyNpRoVAWKoI-BNSJ06avE6tVTibwXa3VXqoEhWbs/mtime:1421035123/sites/default/files/styles/print_image/public/blogs/2013/flexbox-guide-3.jpg" alt=""></p>
<ol>
<li>align-content: flex-start|flex-end|center|space-between|space-around|stretch(default); (修饰 Flex Container)<br>校准 item 在 container 中的对齐方式, 类似于 justify-content, 本属性在单行的容器中没有效果</li>
</ol>
<p><img src="http://cdn1.w3cplus.com/cdn/farfuture/P-M8WSERtYlnjKq2QRb-TXGdIOtTs7EIinejAJd0V0I/mtime:1421035123/sites/default/files/styles/print_image/public/blogs/2013/flexbox-guide-4.jpg" alt=""></p>
<ol>
<li><p></p><p>order: <integer>; (修饰 Flex Item)<br>手动指定显示顺序</integer></p>
</li>
<li><p>flex-grow: <number>; (修饰 Flex Item)<br>定义 Item 的扩张能力, 接受一个不带单位的值作为一个比例, 主要用来决 Item 对 Container 剩余空间的利用</number></p>
</li>
<li><p>flex-shrink: <number>; (修饰 Flex Item)<br>定义 Item 的收缩能力</number></p>
</li>
<li><p>flex-basis: <length>|auto(default); (修饰 Flex Item)<br>设置伸缩基准, 剩余的空间按照比例伸缩</length></p>
</li>
<li><p>flex: none|[&lt;’flex-grow’&gt;&lt;’flex-shrink’&gt;? || &lt;’flex-basis’&gt;]; (修饰 Flex Item)<br>flex-grow, flex-shrink, flex-basis 的缩写; 其中, 第二个和第三个参数是可选参数. 默认值是<code>0 1 auto</code></p>
</li>
<li><p>align-self: auto|flex-start|flex-end|center|baseline|stretch; (修饰 Flex Item)<br>用于覆盖单个 Item 的对齐方式.</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React-Native Basic Component]]></title>
      <url>/2016/09/16/react-native-basic-component/</url>
      <content type="html"><![CDATA[<h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h3><pre><code>import React, { Component } from &apos;react&apos;
import { AppRegistry, Text } from &apos;react-native&apos;
 const App = () =&amp;gt; &amp;lt;Text&amp;gt;Hello World&amp;lt;/Text&amp;gt;

 AppRegistry.registerComponent(&quot;Project&quot;, () =&amp;gt; App)
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">### Image</div></pre></td></tr></table></figure>

import React, { Component } from &apos;react&apos;
import { AppRegistry, Image } from &apos;react-native&apos;

const App = () =&amp;gt; &amp;lt;Image source = {require(&apos;./img/sample.png&apos;)} /&amp;gt;

AppRegistry.registerComponent(&quot;Project&quot;, () =&amp;gt; App)
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">### View</div></pre></td></tr></table></figure>

import React, { Component } from &apos;react&apos;
import { AppRegistry, Text, View } from &apos;react-native&apos;

const App = () =&amp;gt; (
  &amp;lt;View style={{alignItems: 'center'}} &amp;gt;
    &amp;lt;Text&amp;gt;Hello World&amp;lt;/Text&amp;gt;
  &amp;lt;/View&amp;gt;
)

AppRegistry.registerComponent(&quot;Project&quot;, () =&amp;gt; App)
`&lt;/pre&gt;

### TextInput

&lt;pre&gt;`import React from &apos;react&apos;
import { AppRegistry, TextInput, View } from &apos;react-native&apos;

const App = () =&amp;gt; (
  &amp;lt;View&amp;gt;
    &amp;lt;TextInput placeholder = &quot;Hello&quot; /&amp;gt;
  &amp;lt;/View&amp;gt;
)

AppRegistry.registerComponent(&apos;Project&apos;, () =&amp;gt; App)
`&lt;/pre&gt;

### ListView

&lt;pre&gt;`import React, { Component } from &apos;react&apos;
import { AppRegistry, Text, View, ListView } from &apos;react-native&apos;

class SimpleList extends Component {
  constructor(){
    super(props)
    var ds = new ListView.DataSource({
      rowHasChanged: (r1,r2) =&amp;gt; r1!==r2
    })

    this.state = {
      dataSource: ds.cloneWithRows([&apos;john&apos;, &apos;joel&apos;,&apos;james&apos;,&apos;jimmy&apos;,&apos;jackson&apos;])
    }

  }

  render(){
    return (
      &amp;lt;View&amp;gt;
        &amp;lt;ListView dataSource={this.state.dataSource} renderRow={(rowData) =&amp;gt; &amp;lt;Text&amp;gt;{rowData}&amp;lt;/Text&amp;gt;}
      &amp;lt;/View&amp;gt;
    )
  }
}

AppRegistry.registerComponent(&quot;Project&quot;, () =&amp;gt; SimpleList)
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React-Native </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[理解 RESTFul 架构]]></title>
      <url>/2016/09/16/e7-90-86-e8-a7-a3-restful-e6-9e-b6-e6-9e-84/</url>
      <content type="html"><![CDATA[<p>REST 全称 Representational State Transfer(表述性状态转移), 十一组架构约束条件和原则. 如果一个架构符合 REST 的约束条件, 那么可以称为 RESTFul 架构</p>
<p>要理解 REST 原则, 就要从资源的定义, 获取, 表述, 关联, 状态变迁等角度入手</p>
<ul>
<li>资源与 URI</li>
<li>统一资源接口</li>
<li>资源的表述</li>
<li>资源的链接</li>
<li>状态的转移</li>
</ul>
<h3 id="资源与-URI"><a href="#资源与-URI" class="headerlink" title="资源与 URI"></a>资源与 URI</h3><p>任何事物, 只要有被引用到的必要, 他就是一个资源.</p>
<p>要让一个资源可以被识别, 需要添加一个唯一标识, 在 Web 中这个唯一标识就是 URI(Uniform Resource Identifier).</p>
<p>URI 既可以看成资源的地址, 也可以看成资源的名称.</p>
<p>如果一些信息没有使用 URI 来标识, 说明他不是一个资源</p>
<p>URI 的设计应该遵循可寻址原则, 具有自描述性, 需要在形式上给人以直觉上的关联</p>
<h4 id="URI-设计上的一些技巧"><a href="#URI-设计上的一些技巧" class="headerlink" title="URI 设计上的一些技巧"></a>URI 设计上的一些技巧</h4><ol>
<li>使用 <code>_</code> 或 <code>-</code> 提高 URI 的可读性</li>
<li>使用 <code>/</code> 表示资源的层级关系</li>
<li>使用 <code>?</code> 过滤资源</li>
</ol>
<h4 id="统一资源接口"><a href="#统一资源接口" class="headerlink" title="统一资源接口"></a>统一资源接口</h4><p>RESTFul 结构应该遵循统一接口原则, 统一接口包含了一组受限的预定义操作, 不论什么样的资源, 都是通过使用相同接口进行资源访问. 接口应该使用标准 HTTP 方法如 GET, PUT, POST, 并遵循这些方法的语义</p>
<ul>
<li>POST 和 PUT 用于创建资源时的区别: 所创建的资源的 URI 是否由客户端决定.</li>
</ul>
<h3 id="资源的表述"><a href="#资源的表述" class="headerlink" title="资源的表述"></a>资源的表述</h3><p>客户端通过 HTTP 方法获取资源的表述, 而不是资源本身.</p>
<p>所谓资源的表述, 即是资源的展现, 而非其本质. 以文本为例, 可以通过 JSON, STRING 等形式表述出来, 而通过客户端获取的即是 JSON 形式的表述, 或 STRING 形式的表述.</p>
<p>客户端通过 HTTP 内容协商, 即 Accept 头请求一种特定个事的表述, 服务器则通过 Content-Type 通知客户端资源的表述形式</p>
<h3 id="资源的连接"><a href="#资源的连接" class="headerlink" title="资源的连接"></a>资源的连接</h3><p>REST 使用 HTTP 方法操作资源, 在表述格式中添加链接来引导客户端, 这种具有连接的特性称为连通</p>
<h3 id="状态的转移"><a href="#状态的转移" class="headerlink" title="状态的转移"></a>状态的转移</h3><p>无状态通信原则: 服务端不应该保存客户端的状态</p>
<h4 id="应用状态与资源状态"><a href="#应用状态与资源状态" class="headerlink" title="应用状态与资源状态"></a>应用状态与资源状态</h4><p>应该区分应用状态和资源状态, 客户端负责维护应用状态, 服务端维护资源状态. 客户端与服务端的交互应当是无状态的, 并且在每一次请求中包含处理该请求所需要的一切信息. 服务端不需要在请求间保留应用状态, 只有在接收到实际请求的时候, 服务端才会关注应用状态. 这种无状态通信原则, 使得服务端和中介能够理解独立的请求和相应. 多次请求中, 同一客户端也不再需要依赖同一服务器, 方便实现高可扩展和高可用性的服务端.</p>
<h4 id="应用状态的转移"><a href="#应用状态的转移" class="headerlink" title="应用状态的转移"></a>应用状态的转移</h4><p>“会话状态”不是作为资源状态被保存在服务端, 而是被客户端做为应用状态进行跟踪. 客户端应用状态在服务端提供的超媒体的指引下发生变迁, 服务端通过超媒体告诉客户端当前状态有哪些后续状态可以进入. 类似于网页中的’下一些’的连接.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[移动端 Border-radius 溢出处理]]></title>
      <url>/2016/09/08/e7-a7-bb-e5-8a-a8-e7-ab-af-border-radius-e6-ba-a2-e5-87-ba-e5-a4-84-e7-90-86/</url>
      <content type="html"><![CDATA[<p>问题1: 部分机型下, 设置 border-radius 以及 overflow:hidden 会造成背景颜色溢出</p>
<p>解决: background-clip: padding-box</p>
<p>原理: background-clip 是颜色颜色显示区域, 设置为 padding-box</p>
<p>问题2: transform 的子元素在父元素 overflow:hidden 之后还是会溢出</p>
<p>解决办法: 在父元素加上一段 css</p>
<pre><code>-webkit-mask-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==&apos;);
</code></pre><p>这是一张1px 的纯黑色图片</p>
<p>原理: -webkit-mask-image:url(‘’), 会在图片上添加蒙版(黑色表示将内容透明, 白色表示将内容显示, 介于中间表示半透明)</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[测试小技巧]]></title>
      <url>/2016/09/08/e6-b5-8b-e8-af-95-e5-b0-8f-e6-8a-80-e5-b7-a7/</url>
      <content type="html"><![CDATA[<p>每一个测试都要引入 expect, 可以创建一个<code>test_helper.js</code><br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> import &#123; expect &#125; from &apos;expect&apos;</div><div class="line"> import sinon from &apos;sinon&apos;</div><div class="line"></div><div class="line">global.expect = expect</div><div class="line"> global.sinon = sinon</div><div class="line"> `然后在`mocha.opt`中添加`</div><div class="line"> --require ./test/test_helper.js</div></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Command Line Cheat Sheet]]></title>
      <url>/2016/09/07/command-line-cheat-sheet/</url>
      <content type="html"><![CDATA[<h3 id="Directories"><a href="#Directories" class="headerlink" title="Directories"></a>Directories</h3><p>pwd: print working directory</p>
<p>cd &lt;directory&gt;: change directory to &lt;directory&gt;</p>
<p>cd ..: change directory to parent one</p>
<p>ls: list directory  contents</p>
<p>ls -la: list detailed directory contents, including hidden files</p>
<p>mkdir &lt;directory&gt;: create new directory named &lt;directory&gt;</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>cat &lt;file&gt;: output the contents of &lt;file&gt;</p>
<p>less &lt;file&gt;: output the contents of &lt;file&gt; using the less command(which supports paginations etc.)</p>
<p>head &lt;file&gt;: output the first 10 lines of &lt;file&gt;</p>
<p>&lt;cmd&gt; &lt;file&gt;: impose &lt;cmd&gt; on &lt;file&gt;</p>
<p>clear: clear the command line window</p>
<h3 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h3><p>rm &lt;file&gt;: delete &lt;file&gt;</p>
<p>rm -r &lt;directory&gt;: clear contents of &lt;directory&gt;</p>
<p>rm -f &lt;file&gt;: force-delete &lt;file&gt;</p>
<p>rm -rf &lt;directory&gt;: force clear &lt;directory&gt;</p>
<p>mv &lt;file-old&gt; &lt;file-new&gt;: rename &lt;file-old&gt;</p>
<p>mv &lt;file&gt; &lt;directory&gt;: move file to &lt;directory&gt;</p>
<p>cp &lt;file&gt; &lt;directory&gt;: copy &lt;file&gt; to &lt;directory&gt;</p>
<p>cp -r &lt;directory1&gt; &lt;directory2&gt;:  copy whole &lt;directory1&gt; to &lt;directory2&gt;(overwrit)</p>
<p>touch &lt;file&gt;: Update file or create file</p>
<h3 id="Permissions"><a href="#Permissions" class="headerlink" title="Permissions"></a>Permissions</h3><p>chmod 755 &lt;file&gt;: change permission of &lt;file&gt; to 755</p>
<p>chmod -R 600 &lt;directory&gt;: change permission of &lt;directory&gt; and its content to 600</p>
<p>chown &lt;user&gt;:&lt;group&gt; &lt;file&gt;: Change ownership of &lt;file&gt; to &lt;user&gt; and &lt;group&gt;</p>
<h3 id="Search"><a href="#Search" class="headerlink" title="Search"></a>Search</h3><p>find &lt;dir&gt; -name ‘&lt;file&gt;’: find all files named &lt;file&gt; inside &lt;dir&gt;(support regex)</p>
<p>grep ‘&lt;text&gt;’ &lt;file&gt;: output all occurrence of &lt;text&gt; inside &lt;file&gt;(add -i for case-insensitivity)</p>
<p>grep -rl ‘text’ &lt;dir&gt;: search for all files container &lt;text&gt; inside &lt;dir&gt;</p>
<h3 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h3><p>ping &lt;host&gt;: ping &lt;host&gt; and display status</p>
<p>whois &lt;domain&gt;: output whois information for &lt;domain&gt;</p>
<p>curl -O &lt;url/to/file&gt;: download &lt;file&gt;(via HTTP[S] or FTP)</p>
<p>ssh &lt;username&gt;@&lt;host&gt;: establish an SSH connection to &lt;host&gt; with user &lt;username&gt;</p>
<p>scp &lt;file&gt; &lt;user&gt;@&lt;host&gt;:/remote/path: Copy &lt;file&gt; to a remote &lt;host&gt;</p>
<h3 id="Processes"><a href="#Processes" class="headerlink" title="Processes"></a>Processes</h3><p>ps ax: output currently running process</p>
<p>top: display live information about currently running processes</p>
<p>kill &lt;pid&gt;: Quit process with ID</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Bash </tag>
            
            <tag> commandline </tag>
            
            <tag> shell </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Redux-Form 的深坑...慢慢积累]]></title>
      <url>/2016/09/06/redux-form-e7-9a-84-e6-b7-b1-e5-9d-91-e6-85-a2-e6-85-a2-e7-a7-af-e7-b4-af/</url>
      <content type="html"><![CDATA[<p>如果 Field 无法输入, 注意 state 是否是 immutable 的, 如果是, 则需要</p>
<pre><code>import { Field, reduxForm } from &apos;redux-form/immutable&apos;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[编写测试]]></title>
      <url>/2016/09/05/e7-bc-96-e5-86-99-e6-b5-8b-e8-af-95/</url>
      <content type="html"><![CDATA[<h3 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h3><p>使用 Mocha 作为测试引擎<br>注意因为是在 node 环境下运行, 所以不能访问 DOM</p>
<pre><code>npm install --save-dev mocha
`&lt;/pre&gt;

若想要结合 Babel 使用, 需要在 package.json 的 script 中加入一段

&lt;pre&gt;`{
  &quot;scripts&quot;: {
    ...
    &quot;test&quot;: &quot;mocha --compilers js:babel/register --recursive&quot;,
    &quot;test:watch&quot;: &quot;npm test -- --watch&quot;
  }
}
`&lt;/pre&gt;

### Action Creators

Redux 里的 action creators 会返回普通对象, 在测试 action creators 的时候我们要测试的不仅是调用了正确的action creators, 还有是否返回了正确的 action

实例

&lt;pre&gt;`export function addTodo(text){
  return {
    type: &apos;ADD_TODO&apos;,
    text
  };
}
`&lt;/pre&gt;

可以这样测试

&lt;pre&gt;`import expect form &apos;expect&apos;
import * as actions from &apos;../../actions/TodoActions&apos;;
import * as types from &apos;../../constants/ActionTypes&apos;;

describe(&apos;actions&apos;, () =&amp;gt; {
  it(&apos;should create an action to add a todo&apos;, () =&amp;gt; {
    const text = &apos;Finish docs&apos;;
    const expectedAction = {
      type: &apos;ADD_TODO&apos;,
      text
    };

    expect(actions.addTodo(text)).toEqual(&apos;expectedAction&apos;);
  })
})
`&lt;/pre&gt;

### 异步 Action Creators

对于使用Redux Thunk 或其他 middleware 的异步 Action Creator, 最好完全模拟 Redux Store 来测试.

可以使用 applyMiddleware() 和一个 mock store, 与可以用 nock 来模拟 HTTP 请求

实例:

&lt;pre&gt;`function fetchTodosRequest () {
  return {
    type: FETCH_TODOS_REQUEST
  }
}

function fetchTodosSuccess(body) {
  return {
    type: FETCH_TODOS_SUCCESS,
    body
  }
}

function fetchTodosFailure(ex) {
  return {
    type: FETCH_TODOS_FAILURE,
    ex
  }
}

export function fetchTodo () {
  return dispatch =&amp;gt; {
    dispatch(fetchTodosRequest())
    return fetch(&apos;http://example.com/todos&apos;)
      .then(res =&amp;gt; res.json())
      .then(json =&amp;gt; dispatch(fetchTodosSuccess(json.body)))
      .catch(ex =&amp;gt; dispatch(fetchTodosFailure(ex)))
  }
}
`&lt;/pre&gt;

可以这样测试

&lt;pre&gt;`import expect from &apos;expect&apos;
import { applyMiddleware } from &apos;redux&apos;
import thunk from &apos;redux-thunk&apos;
import * as actions from &apos;../../actions/counter&apos;
import * as types from &apos;../../constants/ActionTypes&apos;
import nock from &apos;nock&apos;

const middleware = [thunk]

/**
 * 使用中间件模拟 Redux Store
 */

function mockStore = (getState, expectedActions, done){
  if(!Array.isArray(expectedActions)){
    throw new Error(&apos;expectedActions should be an array of expected actions.&apos;)
  }
  if( typeof done !== &apos;undefined&apos; &amp;amp;&amp;amp; typeof done !== &apos;function&apos;){
    throw new Error(&apos;done should either be undefined or function&apos;)
  }

  function mockStoreWithoutmiddleware(){
    return {
      getState(){
        return typeof getState === &apos;function&apos; ? 
        getState():
        getState
      },

      dispatch(action){
        const expectedAction = expectedActions.shift()

        try {
          expect(action).toEqual(expectedAction)
          if(done&amp;amp;&amp;amp;!expectedActions.length){
            done()
          }
          return action
        } catch (e) {
          done(e)
        }
      }
    }
  }

  const mockStoreWithMiddleware = applyMiddleware(
    ...middlewares
  )(mockStoreWithoutMiddleware)

  return mockStoreWithMiddleware()
}

describe(&apos;async actions&apos;, () =&amp;gt; {
  afterEach(() =&amp;gt; {
    nock.clearAll()
  }) 

  it(&apos;creates FETCH_TODOS_SUCCESS when fetching todos has been done&apos;, (done) =&amp;gt; {
    nock(&apos;http://example.com&apos;)
      .get(&apos;./todos&apos;)
      .reply(200, {todos: [&apos;do something&apos;]})

    const expectedActions = [
      {type: types.FETCH_TODOS_REQUEST},
      {type: types.FETCH_TODOS_SUCCESS, body: { todos: [&apos;do something&apos;]}}
    ]
    const store = mockStore({todos: []}, expectedActions, done) 
    store.dispatch(actions.fetchTodos())
  })
})
`&lt;/pre&gt;

### Reducers 测试

Reducer 把 action 应用到当前 state, 并返回新的 state

&lt;pre&gt;`import { ADD_TODO } from &apos;../constants/ActionTypes&apos;;

const initialState = [
  {
    text: &apos;Use Redux&apos;,
    completed: false,
    id: 0
  }
]

export default function todos(state = initialState, action) {
  switch(action.type) {
    case ADD_TODO: return [
      {
        id: state.reduce((maxID, todo) =&amp;gt; Math.max(todo.id, maxId), -1) + 1, 
        completed: false,
        text: action.text
      },
      ...state
    ]
    default: return state
  }
}
`&lt;/pre&gt;

可以这样测试:

&lt;pre&gt;`import expect from &apos;expect&apos;
import reducer from &apos;../../reducers/todos&apos;
import * as types from &apos;../../constants/ActionTypes&apos;

describe(&apos;todos reducer&apos;, () =&amp;gt; {
  it(&apos;should return the initial state&apos;, () =&amp;gt; {
    expect(reducer(undefined, {})).toEqual([
      {
        text: &apos;Use Redux&apos;,
        completed: false,
        id: 0
      }
    ])
  })

  it(&apos;should handle ADD_TODO&apos;, () =&amp;gt; {
    expect(
      reducer([],{
        type: types.ADD_TODO,
        text: &apos;Run the test&apos;
      })
    ).toEqual(
      [
        {
          text: &apos;Run the test&apos;,
          completed: false,
          id: 0
        }
      ]
    )

    expect(
      reducer([
        {
          text: &apos;Use Redux&apos;,
          completed: false,
          id:0
        }
      ], {
        type: types.ADD_TODO,
        text: &apos;Run the test&apos;
      })
    ).toEqual([
      {
        text: &apos;Run the test&apos;,
        completed: false, 
        id: 1
      },
      {
        text: &apos;Use Redux&apos;,
        completed: false,
        id: 0
      }
    ])
  })
})
`&lt;/pre&gt;

### 测试 Components

React Components 的优点是, 一般都很小, 并且依赖于 props, 因此测试起来很容易.

首先安装 React Test Utilities

&lt;pre&gt;`npm install --save-dev react-addons-test-utils
`&lt;/pre&gt;

要测试 components 我们要创建一个叫`setup()` 的辅助方法, 用来把模拟过的( stubbed ) 回调函数当做 props 传入, 然后使用 React 浅渲染来渲染组建, 这样可以依据`是否调用了回调函数`的断言来写独立的测试

&lt;pre&gt;`import React, { PropTypes, Component } from &apos;react&apos;
import TodoTextInput from &apos;./TodoTextInput&apos;

class Header extends Component {
  handleSave(text){
    if(text.length !==0){
      this.props.addTodo(text)
    }
  }
  render(){
    return(
      &amp;lt;header&amp;gt;
        &amp;lt;h1&amp;gt;todos&amp;lt;/h1&amp;gt;
        &amp;lt;TodoTextInput newTodo = {true} onSave ={this.handleSave.bind(this)} placeholder = &apos;what needs to be done?&apos; /&amp;gt;
      &amp;lt;/header&amp;gt;
    )
  }
}

Header.propTypes = {
  addTodo: PropTypes.func.isRequired
}

export default Header
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Redux-Promise]]></title>
      <url>/2016/09/04/redux-promise/</url>
      <content type="html"><![CDATA[<pre><code>npm install --save redux-promise
`&lt;/pre&gt;

&lt;pre&gt;`import promiseMiddleWare from &apos;redux-promise&apos;
`&lt;/pre&gt;

The default export is a middleware function. If it receives a promise, it will dispatch the resolved value of the promise.

It will not dispatch anything if the promise rejects.

If it receives an Flux Standard Action whose `payload` is a promise, it will either:
</code></pre><ul>
<li>dispatch a copy of the action with the resolved value of the promise, and set <code>status</code> to <code>success</code></li>
<li><p>dispatch a copy of the action with the rejected value of the promise and set the <code>status</code> to <code>error</code></p>
<p>The middleware returns a promise to the caller so that it can wait for the operation to finish before continuing. This is especially useful for server-side rendering. If you find that a promise is not being returned, ensure that all middleware before it in the chain is also returning its <code>next()</code> call to the caller.</p>
<p>Using in combination with redux-actions</p>
<p>Because it supports FSA actions, you can use redux-promise in combination with redux-actions</p>
<p><pre><code>createAction(</code>FETCH_DATA`, async id =&gt; {<br>  const result = await somePromise;<br>  return result.someValue<br>});</pre></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Promise </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Usage of Redux-Action]]></title>
      <url>/2016/09/04/usage-of-redux-action/</url>
      <content type="html"><![CDATA[<ol>
<li>createAction(type, payloadCreator = Identity, ?metaCreator): actionCreator with specified type and it will accept a payload</li>
</ol>
<p>The more correct name for this function is probably <code>createActionCreator()</code>, but it’s too redundant.</p>
<pre><code>createAction(&apos;ADD_TODO&apos;)(&apos;Use the Reudx&apos;);
`&lt;/pre&gt;

&lt;pre&gt;`import { createAction } from &apos;redux-action&apos;
`&lt;/pre&gt;

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;);
expect(increment(42)).to.deep.equal({
  type: &apos;INCREMENT&apos;,
  payload: 42
});
`&lt;/pre&gt;

Wraps an action creator so that its return value is the payload of a Flux Standard Action. If no payload creator is passed, or if it&apos;s not a function, the identity function is used.

**If the payload is an instance of an Error Object, redux-actions will automatically set `action.error` to true.**

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;);

const error = new TypeError(&apos;not a number&apos;);
expect(increment(error)).to.deep.equal({
  type: &apos;INCREMENT&apos;,
  payload: error,
  error: true
})
`&lt;/pre&gt;

`createAction` also return its `type` when used as type in `handleAction` or `handleActions`

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;)

// as param in handleAction
handleAction(increment, {
  next(state, action) {...},
  throw(state, action) {...}
});

// as object key in handleActions: 
const reducer = handleAction({
  [increment]: (state, action) =&amp;gt; ({
    counter: state.counter + action.payload
  })
}, {counter: 0})
`&lt;/pre&gt;

**increment 是 createActions() 创建的一个 actionCreator, 接受 payload 作为参数, 返回一个 action 对象, 该对象传递到 store 中, 并由 store 直接 dispatch 给 handleAction 返回的 reducer**
</code></pre><ol>
<li><p>handleAction(type, reducer | reduceMap, ?defaultState)</p>
<pre>`import { handleAction } from 'redux-action'
`</pre>

<p>Wraps a reducer so that it only handles Flux Standard Actions of a certain type.</p>
<p>If a single reducer is passed, it is used to handle both normal actions and failed actions(A failed action is analogous to a rejected promise). You can use this form if you know a certain type of action will never fail, like the increment example.</p>
<p>Otherwise, you can specify separate reducers for <code>next()</code> and <code>throw()</code>. This API is inspired by the ES6 generator interface.</p>
<pre>`handleAction('FETCH_DATA', {
  next(state, action) {...},
  throw(state, action) {...}
});
`</pre>

<p><strong>handleAction返回的是指定action类型的reducer, 该 reducer 接收到的 action 如果 error=null, 则执行 next 方法, 如果接收到的 action.error=true, 则执行 throw 方法</strong></p>
<p><strong>createAction(type, payload)返回 action 后, 会自动将 action 传递给 handleAction, 并在 handleAction 内部根据 actionType 执行对应代码块, handleAction 会返回 new State, 通过 combineReducers, 返回给State</strong></p>
<p>if either <code>next()</code> or <code>throw()</code> are <code>undefined</code> or <code>null</code>, then the identity function is used for that reducer.</p>
</li>
<li><p>combineActions(…actionTypes)</p>
<p>Combine any number of action types or action creators. <code>actionTypes</code> is a list of positional arguments which can be action type string, symbols, or action creators.</p>
<p>This allows you to reduce multiple distinct actions with the same reducer.</p>
<pre>`const {increment, decrement} = createAction({
  INCREMENT: amount =&gt; ({ amount }),
  DECREMENT: amount =&gt; ({ amount: -amount})
})

const reducer = handleAction(combineActions(increment, decrement), {
  next:(state, {payload: { amount }}) =&gt; ({...state, counter: state.counter + amount}),
  throw: state =&gt; ({...state, counter: 0}),
},{counter: 10})

expect(reducer(undefined, increment(1)).to.deep.equal({counter: 1}))
expect(reducer(undefined, decrement(1)).to.deep.equal({counter: 0}))
expect(reducer(undefined, increment(new Error)).to.deep.equal({counter: 0}))
expect(reducer(undefined, decrement(new Error)).to.deep.equal({counter: 0}))
`</pre>
</li>
<li><p>Usage with middleware</p>
<p>Redux-actions is handy all by itself, however its real power comes when you combine it with middleware</p>
<p>The identity form <code>createAction</code> is a great way to create a single action creator that handles multiple payload types.</p>
<p>For example, using redux-promise and redux-rx</p>
<p><pre>`const addTodo = createAction(‘ADD_TODO’) </pre></p>
<p>// a single reducer<br>handleAction(‘ADD_TODO’, (state = {todos: []}, action) =&gt; ({<br>  …state,<br>  todos: […state.todos, action.payload]<br>}));</p>
<p>// …that works with all of these forms:<br>// (Don’t forget to use <code>bindActionCreators()</code> or equivalent.<br>// I’ve left that bit out)<br>addTodo(‘Use Redux’)<br>addTodo(Promise.resolve(‘Weep with joy’))<br>addTodo(Observable.of(<br>  ‘Learn about middleware’,<br>  ‘Learn about higher-order stores’<br>)).subscribe()</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Usage of nock]]></title>
      <url>/2016/08/29/usage-of-nock/</url>
      <content type="html"><![CDATA[<h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h3><pre><code>npm install ncck
`&lt;/pre&gt;

### Use

Setup Mocking Obejct like this:

&lt;pre&gt;`var nock = require(&apos;nock&apos;)

var couchdb = nock(&apos;http://myapp.iriscouch.com&apos;)
             .get(&apos;/user/1&apos;)
             .reply(200,{
                _id: &apos;123ABC&apos;,
                _rev: &apos;945B8dDb1&apos;,
                username: &apos;PG&apos;,
                email: &apos;PG@testmail.com&apos;
              });
`&lt;/pre&gt;

This setup says that we will intercept every HTTP call to `http://myapp.iriscouch.com`

It will intercept an HTTP GET request to `&apos;users/1&apos;` and reply with a status 200 and the body will contain a user representation in JSON

Then the test can call the module, and the module will do the HTTP requests.

#### Specifying hostname

The request hostname can be a string or a RegExp

&lt;pre&gt;`var scope = nock(&apos;http://www.example.com&apos;)
           .get(&apos;/resource&apos;)
           .reply(200, &apos;domain matched&apos;);

var scope = nock(/example\.com/)
           .get(&apos;/resource&apos;)
           .reply(200, &apos;domain regex matched&apos;);
`&lt;/pre&gt;

#### Specifying path

The request path can be a string, a RegExp or a filter function and you can use any HTTP verb

&lt;pre&gt;`var scope = nock(&apos;http://www.example.com&apos;)
            .get(&apos;/resource&apos;)
            .replay(200, &apos;path matched&apos;);

var scope = nock(&apos;http://www.example.com&apos;)
            .get(/resource$/)
            .reply(200, &apos;path using regex matched&apos;);

var scope = nock(&apos;http://www.example.com&apos;)
            .get(function(uri){
              return uri.indexOf(&apos;cats&apos;) &amp;gt;= 0;
             })
             .reply(200, &apos;path using function matched&apos;);
`&lt;/pre&gt;

#### Specifying Request Body

argument to the `get`, `post`, `put` or `delete` specifications like this:

&lt;pre&gt;`var scope = nock(&apos;http://www.example.com&apos;)
            .post(&apos;/users&apos;, {
              username: &apos;PG&apos;,
              email: &apos;example@mail.com&apos;
             })
             .reply(201, {
              ok: true,
              id: &apos;123ABC&apos;,
              rev: &apos;946B7D1C&apos;
             });
`&lt;/pre&gt;

The request body can be a string, a regexp, a jSON object or a function

&lt;pre&gt;`var scope = nock(&apos;http://www.example.com&apos;)
            .post(&apos;/users&apos;, /email=.?@gmail.com/gi)
            .reply(201, {
              ok: true, 
              id: &apos;123ABC&apos;,
              rev: &apos;946B7D1C&apos;
             });

var scope = nock(&apos;http://www.example.com&apos;)
            .post(&apos;/users&apos;, {
              username: &apos;PG&apos;,
              password: &apos;/a.+&apos;/,
              email: &apos;preasfd@gmail.com&apos;
             })
             .reply(201, {
                ok: true, 
                id: &apos;123ABC&apos;,
                rev: &apos;946B7D1C&apos;
              })
`&lt;/pre&gt;

#### Specifying Replies

You can specify the return status code for a path on the first argument of reply like this:

&lt;pre&gt;`.reply(404)
`&lt;/pre&gt;

Or specify the reply body as a string:

&lt;pre&gt;`.reply(200, &apos;Hello from google&apos;)
`&lt;/pre&gt;

or as a JSON-encoded object:

&lt;pre&gt;`.reply(200, {
  username: &apos;PG&apos;,
  email: &apos;asdf@gmail.com&apos;,
  _id: &apos;awefrf&apos;
})
`&lt;/pre&gt;

or even as a file:

&lt;pre&gt;`.replyWithFile(200, __dirname+&apos;/replies/user.json&apos;)
`&lt;/pre&gt;

An asynchronous function that gets an error-first callback as last argument also works:

&lt;pre&gt;`.reply(201, function(uri, requestBody, cb){
  fs.readFile(&apos;cat-poem.txt&apos;, cb); // Error-first callback
});
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 测试 </tag>
            
            <tag> Nock </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[测试环境搭建(Mocha + Chai + Sinon)]]></title>
      <url>/2016/08/28/e6-b5-8b-e8-af-95-e7-8e-af-e5-a2-83-e6-90-ad-e5-bb-bamocha-chai-sinon/</url>
      <content type="html"><![CDATA[<ul>
<li>Mocha: 用于运行测试用例</li>
<li>Chai: Mocha 用的断言库</li>
<li>Sinon: 用于创建一些 mocks/stubs/spys</li>
</ul>
<p>AriBnB 创建了一个专门针对 React 代码测试的开源程序: Enzyme</p>
<h3 id="Mocha-安装及环境配置"><a href="#Mocha-安装及环境配置" class="headerlink" title="Mocha 安装及环境配置"></a>Mocha 安装及环境配置</h3><pre><code>npm install --save-dev mocha chai sinon
`&lt;/pre&gt;

安装支持 ES6 语法的插件

&lt;pre&gt;`npm install --save-dev babel-register
`&lt;/pre&gt;

### 简单测试用例

Mocha 默认会去当前目录下寻找 test 目录, 然后在其中去找后缀为 js 的文件.
如果需要修改这个目录, 可以用 Mocha 的参数设置.

&lt;pre&gt;`// index.spec.js

import { expect } from &apos;chai&apos;;
describe(&apos;hello react spac&apos;, () =&amp;gt; {
  it(&apos;works!&apos;, ()=&amp;gt;{
    expect(true).to.be.true;
  });
});
`&lt;/pre&gt;

命令行

&lt;pre&gt;`mocha --compilers js:babel-register
`&lt;/pre&gt;

如果不添加`--compilers js:babel-register`, 那么 mocha 会按照默认的方式执行, 也就是`读取 spec 文件 -&amp;gt; 运行测试用例`. 使用了`--compilers js:babel-register` 之后, 执行顺序为`读取 spec 文件 -&amp;gt; 将 ES6 代码替换 ES5 代码 -&amp;gt; 运行测试用例`

#### 创建测试工具库 test_helper.js

注意每个测试文件中都要引入 expect, 最好用一个库来进行管理. 创建一个新的文件
`/test/test_helper.js`

&lt;pre&gt;`// test/test_helper.js

import { expect } from &apos;chai&apos;
import sinon from &apos;sinon&apos;

global.expect = expect;
global.sinon = sinon;
`&lt;/pre&gt;

这里只添加了 chai 的 expect 以及引入了 sinon

现在可以将`index.spec.js` 的第一行删除, 并运行

&lt;pre&gt;`mocha --compilers js:babel-register --require ./test/test_helper.js --recursive
`&lt;/pre&gt;

或者在 package.json 中创建 scripts

&lt;pre&gt;`&quot;test&quot;::&quot;mocha --compilers js:babel-register --requrie ./test/test_helper.js --recursive&quot;,
&quot;test:watch&quot;: &quot;npm test -- --watch&quot;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Git Cheat Sheet]]></title>
      <url>/2016/08/27/git-cheat-sheet/</url>
      <content type="html"><![CDATA[<ul>
<li>列出当前配置: <code>git config --list</code></li>
<li>列出 repository 配置: <code>git config --local --list</code></li>
<li>列出全局配置: <code>git config --global --list</code></li>
<li><p>设置 git 输出彩色: <code>git config --global color.ui auto</code></p>
</li>
<li><p>显示与上次提交版本的不同: <code>git diff</code></p>
</li>
<li><p>提交历史: <code>git log</code></p>
</li>
<li><p>显示所有提交历史: <code>git log --oneline</code></p>
</li>
<li><p>列出所有分支: <code>git branch</code></p>
</li>
<li><p>列出远程分支: <code>git branch -r</code></p>
</li>
<li><p>切换分支: <code>git checkout &amp;lt;branch&amp;gt;</code></p>
</li>
<li><p>给当前版本添加 tag: <code>git tag &amp;lt;tag-name&amp;gt;</code></p>
</li>
<li><p>列出当前配置的远程端: <code>git remote -v</code></p>
</li>
<li><p>添加远程端: <code>git remote add &amp;lt;remote-name&amp;gt; &amp;lt;url&amp;gt;</code></p>
</li>
<li>下载远程端但不 merge: <code>git fetch &amp;lt;remote&amp;gt;</code></li>
<li><p>下载远程端并自动 merge: <code>git pull</code></p>
</li>
<li><p>删除远程端分支: <code>git push &amp;lt;remote&amp;gt; --delete &amp;lt;branch&amp;gt;</code></p>
</li>
<li><p>发布标签: <code>git push --tags</code></p>
</li>
<li><p>回滚到上个 commit: <code>git reset --hard HEAD</code></p>
</li>
<li><p>回滚到某个版本: <code>git reset --hard &amp;lt;commit&amp;gt;</code></p>
</li>
<li>清除 staged: <code>git reset HEAD</code></li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JS 的 Date]]></title>
      <url>/2016/08/27/js-e7-9a-84-date/</url>
      <content type="html"><![CDATA[<pre><code>&amp;gt; var myDate = new Date()
undefined
&amp;gt; myDate.getYear()
116
&amp;gt; myDate.getFullYear()
2016
&amp;gt; myDate.getMonth() // 0 - 11
7
&amp;gt; myDate.getDate() // 1 - 31
28
&amp;gt; myDate.getDay() // 0 - 6, 西方以周日为一周开始, 所以0是周日
0
&amp;gt; myDate.getTime() // 从1970.1.1开始的毫秒数
1472313859531
&amp;gt; myDate.getHours()
0
&amp;gt; myDate.getMinutes()
4
&amp;gt; myDate.getSeconds()
19
&amp;gt; myDate.getMilliseconds()
531
&amp;gt; myDate.toLocaleDateString()
&apos;2016-08-28&apos;
&amp;gt; myDate.toLocaleString()
&apos;2016-08-28 00:04:19&apos;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[增强页面渲染性能]]></title>
      <url>/2016/08/26/e5-a2-9e-e5-bc-ba-e9-a1-b5-e9-9d-a2-e6-b8-b2-e6-9f-93-e6-80-a7-e8-83-bd/</url>
      <content type="html"><![CDATA[<h3 id="3D-transform-启用-GPU-加速"><a href="#3D-transform-启用-GPU-加速" class="headerlink" title="3D transform 启用 GPU 加速"></a>3D transform 启用 GPU 加速</h3><p>例如 transform3D, scaleZ 等可以开启浏览器硬件加速</p>
<p>实际上并不需要 Z 轴的动画</p>
<h3 id="will-change"><a href="#will-change" class="headerlink" title="will-change"></a>will-change</h3><p>当我们的某些行为触发页面进行大面积绘制的时候, 浏览器往往是没有准备的, 只能被动使用 CPU 去计算与重绘. 而<code>will-change</code>会在真正行为触发之前通知浏览器, 以开启 GPU 准备重绘.</p>
<p>该属性语法:</p>
<pre><code>will-change: auto;
will-change: scroll-position;
will-change: contents;
will-change: trasnform; // or some
will-change: opacity; // or some
will-change: left,top; // or some

will-change:inherit;
will-change:initial;
will-change: unset;
`&lt;/pre&gt;

其中 auto 是用来重置的

scroll-position 是通知滚动

contents 是通知内容动画

### 注意事项

`will-change` 虽然可以加速, 但一定要适度使用. 频繁使用 GPU 显然会导致性能(电量)消耗

不要直接写在默认状态中, 因为`will-change`会一直挂着:

&lt;pre&gt;`.will-change{
  will-change: transform;
  transition: transform .3s;
}
.will-change:hover{
  transform: scale(1.5);
}
`&lt;/pre&gt;

可以让父元素 hover 的时候声明`will-change`, 这样, 移出的时候回自动`remove`, 触发返回基本上是有效元素范围

&lt;pre&gt;`.will-change-parent:hover .will-change{
  will-change:transform;
}
.will-change{
  transition:transform .3s
}
.will-change:hover{
  transform:scale(1.5)
}
</code></pre><p>如果使用 JS 添加<code>will-change</code>一定要及时 remove</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[clip-path, polygon 图形构建]]></title>
      <url>/2016/08/26/clip-path-polygon-e5-9b-be-e5-bd-a2-e6-9e-84-e5-bb-ba/</url>
      <content type="html"><![CDATA[<p>clip-path 的前身是 SVG, 支持二维坐标</p>
<p>polygon 的作用是根据二维点坐标, 依次连线, 最后闭合形成遮罩区域</p>
<p>clip-path:polygon 生成三角形的过程非常简单</p>
<pre><code>.path{
  clip-path: polygon(5px, 10px, 16px, 3px, 16px, 17px);
}
</code></pre><p>polygon 对点的数目没有限制, 所以可以生成各种几何图案</p>
<p>clip-path 还可以用 transition 过渡或者 animation 动画, 很好的弥补了 CSS3 的 transform 变换的不足</p>
<p>polygon 动画有一个重要前提, 那就是坐标的数目在变化前后必须一样. 这样就浏览器就能实现连续动画.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Node.js 之 path 模块]]></title>
      <url>/2016/08/26/node-js-e4-b9-8b-path-e6-a8-a1-e5-9d-97/</url>
      <content type="html"><![CDATA[<p>path模块用于规范化路径连接和解析路径.</p>
<p>path的功能包括不仅限于:</p>
<ul>
<li>规范化路径</li>
<li>连接路径</li>
<li>路径解析</li>
<li>查找两个绝对路径的相对关系</li>
<li>提取路径的组成部分</li>
</ul>
<h3 id="规范化路径-path-normalize-p"><a href="#规范化路径-path-normalize-p" class="headerlink" title="规范化路径 path.normalize(p)"></a>规范化路径 path.normalize(p)</h3><p>path 模块中的 normalize(p) 用来规范化路径, 可用于处理路径中的 <code>//</code>, <code>..</code>, <code>.</code>等.</p>
<pre><code>var path = require(&apos;path&apos;);
path.normalize(&apos;./foo/bar//baz/asfd/que/..&apos;);
// 处理后
&apos;foo/bar/baz/asfd&apos;
`&lt;/pre&gt;

### 连接路径 path.join([path1][, path2][, ...])

将任意个路径字符串连接, 同时也会对路径进行规范化

&lt;pre&gt;`var path = require(&apos;path&apos;);
//合法的字符串连接
path.join(&apos;./foo&apos;, &apos;bar&apos;, &apos;baz/asdf&apos;, &apos;quux&apos;, &apos;..&apos;)
// 连接后
&apos;foo/bar/baz/asfd&apos;

// 不合法的字符串将抛出异常
path.join(&apos;foo&apos;,{}, bar) =&amp;gt; TypeError: Arguments to path.join must be strings
`&lt;/pre&gt;

### 路径解析 path.resolve([from...], to)

path.resolve 方法可以将多个路径解析为一个规范化的绝对路径, 其处理方法类似于对这些路径逐一进行 cd 操作, 与 cd 操作不同的是, 这引起路径可以是文件, 而且可不必实际存在, 仅是字符串操作

&lt;pre&gt;`path.resolve(&apos;foo/bar&apos;,&apos;/tmp/file/&apos;,&apos;..&apos;,&apos;a/../subfile&apos;)
`&lt;/pre&gt;

相当于

&lt;pre&gt;`cd foo/bar
cd /temp/file/
cd ..
cd a/../subfile
`&lt;/pre&gt;

如果解析的不是绝对路径, path.resolve() 会将当前工作目录加到解析结果前

&lt;pre&gt;`path.resolve(&apos;wooroot&apos;,&apos;bar&apos;,&apos;./baz&apos;)
// 当前工作路径是/home/node, 则输出结果是
&apos;/home/node/wooroot/bar/baz&apos;
`&lt;/pre&gt;

### 查找两个绝对路径之间的相对关系 path.relative(from, to)

&lt;pre&gt;`path.relative(&apos;/Users/node/demo&apos;, &apos;/Users/node&apos;) =&amp;gt; &apos;..&apos;
</code></pre><h3 id="提取路径的组成部分-path-dirname-p-path-basename-p-ext-path-extname-p"><a href="#提取路径的组成部分-path-dirname-p-path-basename-p-ext-path-extname-p" class="headerlink" title="提取路径的组成部分 path.dirname(p), path.basename(p[,ext]), path.extname(p)"></a>提取路径的组成部分 path.dirname(p), path.basename(p[,ext]), path.extname(p)</h3><p>path.dirname =&gt; 文件路径中的目录部分<br>path.basename =&gt; 文件路径中的文件部分<br>path.extname =&gt; 文件路径中的文件扩展名</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NODE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React-router Documents]]></title>
      <url>/2016/08/26/react-router-documents/</url>
      <content type="html"><![CDATA[<p>安装</p>
<pre><code>npm install history react-router@latest
`&lt;/pre&gt;

react-router 依赖 history 模块

&lt;pre&gt;`import {Router, Route, Link} from &apos;react-router&apos;

可以从 lib 目录 require 需要的部分
`&lt;/pre&gt;

import { Router } from &apos;react-router/lib/Router&apos;

&lt;pre&gt;`import React from &apos;react&apos;
import { Router, Route, Link } from &apos;react-router&apos;

const App = React.createClass({/*..*/})
const About = React.createClass({/*...*/})

const Users = React.createClass({
  render(){
    return(
      &amp;lt;div&amp;gt;
        &amp;lt;h1&amp;gt;Users&amp;lt;/h1&amp;gt;
        &amp;lt;div className = &quot;master&quot;&amp;gt;
          &amp;lt;ul&amp;gt;
            {/* 在本应用中用 Link 去链接路由*/}
            {this.state.users.map(user =&amp;gt; (
              &amp;lt;li key={user.id}&amp;gt;&amp;lt;Link to={`/user/${user.id}`}&amp;gt;{user.name}&amp;lt;/Link&amp;gt;&amp;lt;/li&amp;gt;
            ))}
          &amp;lt;/ul&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;div className =&quot;detail&quot;&amp;gt;
          {this.props.children}
        &amp;lt;/div&amp;gt;
      &amp;lt;/div&amp;gt;
    )
  }
})

const User = React.createClass({
  componentDidMount(){
    this.setState({
      // 路由应该通过有用的信息来呈现, 比如 URL 的参数
      user: findUserById(this.props.params.userId)
    })
  },

  render(){
    return(
      &amp;lt;div&amp;gt;
        &amp;lt;h2&amp;gt;{this.state.user.name}&amp;lt;/h2&amp;gt;
        {/* 等等 */}
      &amp;lt;/div&amp;gt;
    )
  }
})

/**
 * 路由配置说明(不用加载整个配置, 只需要加载一个想要的跟路由, 也可以延迟加载这个配置)
 */

React.render(
  (&amp;lt;Router&amp;gt;
    &amp;lt;Route path = &quot;/&quot; component = {App}&amp;gt;
      &amp;lt;Route path = &quot;about&quot; component = {About}/&amp;gt;
        &amp;lt;Route path = &quot;users&quot; component = {Users}&amp;gt;
          &amp;lt;Route path = &quot;/user/:userId&quot; component = {User}/&amp;gt;
        &amp;lt;/Route&amp;gt;
        &amp;lt;Route path = &quot;*&quot; component = {NoMatch}/&amp;gt;
    &amp;lt;/Route&amp;gt;
  &amp;lt;/Router&amp;gt;),
  document.body
)
`&lt;/pre&gt;

&lt;pre&gt;`import React from &apos;react&apos;
import { render } from &apos;react-dom&apos;

import { Router, Route, Link } from &apos;react-router&apos;

const App = React.createClass({
  render(){
    return (
      &amp;lt;div&amp;gt;
        &amp;lt;h1&amp;gt;App&amp;lt;/h1&amp;gt;
        {/* 把 &amp;lt;a&amp;gt; 变成 &amp;lt;Link&amp;gt; */}
        &amp;lt;ul&amp;gt;
          &amp;lt;li&amp;gt;&amp;lt;Link to=&quot;/about&quot;&amp;gt;&amp;lt;/Link&amp;gt;&amp;lt;/li&amp;gt;
          &amp;lt;li&amp;gt;&amp;lt;Link to=&quot;/inbox&quot;&amp;gt;&amp;lt;/Link&amp;gt;&amp;lt;/li&amp;gt;
        &amp;lt;/ul&amp;gt;
        {/*
          接着用` this.props.children` 替换`&amp;lt;Child&amp;gt;`, this.props.children 就是 App 的子组件 Inbox 和 About
        */}

       {this.props.children}
      &amp;lt;/div&amp;gt;
    )
  }
})

React.render((
  &amp;lt;Router&amp;gt;
    &amp;lt;Route path = &quot;/&quot; component = {App}&amp;gt;
      &amp;lt;Route path=&quot;about&quot; component = {About}
      &amp;lt;Route path=&quot;inbox&quot; component = {Inbox}
    &amp;lt;/Route&amp;gt;
  &amp;lt;/Router&amp;gt;
))
`&lt;/pre&gt;

&lt;pre&gt;`const Message = React.createClass({
  render(){
    return(
      &amp;lt;h3&amp;gt;Message&amp;lt;/h3&amp;gt;
    )
  }
})

const Inbox = React.createClass({
  render(){
    return(
      &amp;lt;div&amp;gt;
        &amp;lt;h2&amp;gt;Inbox&amp;lt;/h2&amp;gt;
        {this.props.children||&apos;Welcome to your inbox&apos;}
      &amp;lt;/div&amp;gt;
    )
  }
})

React.render((
  &amp;lt;Router&amp;gt;
    &amp;lt;Route path=&quot;/&quot; component = {App}&amp;gt;
      &amp;lt;Route path =&quot;about&quot; component = {About} /&amp;gt;
      &amp;lt;Route path =&quot;inbox&quot; component = {Inbox}&amp;gt;
        &amp;lt;Route path=&quot;message/:id&quot; component={Message}/&amp;gt;
      &amp;lt;/Route&amp;gt;    
    &amp;lt;/Route&amp;gt;
  &amp;lt;/Router&amp;gt;
),document.body)
`&lt;/pre&gt;

访问 URL = inbox/message/Jkei 会匹配一个新路由, 其指向 App =&gt; Inbox =&gt; Message

&lt;pre&gt;`&amp;lt;App&amp;gt;
  &amp;lt;Inbox&amp;gt;
    &amp;lt;Message params = {id: &quot;Jkei&quot;} /&amp;gt;
  &amp;lt;/Inbox&amp;gt;
&amp;lt;/App&amp;gt;
`&lt;/pre&gt;

### 获取 URL 参数

为了从服务器获取 message 数据, 我们首先需要知道他的信息, 当渲染组件的时候, React Router 自动向 Route 组件注入一些有用的信息, 尤其是路径中动态部分的参数, 比如上例中的`:id`

&lt;pre&gt;`const Message = React.createClass({
  componentDidMount(){
    const id = this.props.params.id

    fetchMessgae(id,function(err,message){
      this.setState({message:message})
    })
  }
})
`&lt;/pre&gt;

### 路由配置

路由配置是一组指令, 用来告诉 router 如何匹配 URL, 以及匹配后的动作.

&lt;pre&gt;`import React from &apos;react&apos;
import {Router, Route, Link} from &apos;react-router&apos;

const App = React.createClass({
  render(){
    return(
      &amp;lt;div&amp;gt;
        &amp;lt;h1&amp;gt;App&amp;lt;/h1&amp;gt;
        &amp;lt;ul&amp;gt;
          &amp;lt;li&amp;gt;&amp;lt;Link to=&quot;/about&quot;&amp;gt;About&amp;lt;/Link&amp;gt;&amp;lt;/li&amp;gt;
          &amp;lt;li&amp;gt;&amp;lt;Link to=&quot;/inbox&quot;&amp;gt;Inbox&amp;lt;/Link&amp;gt;&amp;lt;/li&amp;gt;
        &amp;lt;/ul&amp;gt;
        {this.props.children}
      &amp;lt;/div&amp;gt;
    )
  }
})

const About = React.createClass({
  render(){
    return &amp;lt;h3&amp;gt;About&amp;lt;/h3&amp;gt;
  }
})

const Inbox = React.createClass({
  render(){
    return(
      &amp;lt;div&amp;gt;
        &amp;lt;h2&amp;gt;Inbox&amp;lt;/h2&amp;gt;
        {this.props.children || &apos;Welcome to your Inbox&apos;}
      &amp;lt;/div&amp;gt;
    )
  }
})

const Message = React.createClass({
  render(){
    return &amp;lt;h3&amp;gt;Message {this.props.params.id}&amp;lt;/h3&amp;gt;
  }
})

React.render((
  &amp;lt;Router&amp;gt;
    &amp;lt;Route path = &quot;/&quot; component = {App}&amp;gt;
      &amp;lt;Route path = &quot;about&quot; component = {About} /&amp;gt;
      &amp;lt;Route path = &quot;inbox&quot; component = {Inbox}&amp;gt;
        &amp;lt;Route path = &quot;message/:id&quot; component = {Message} /&amp;gt;
      &amp;lt;/Route&amp;gt;
    &amp;lt;/Route&amp;gt;
  &amp;lt;/Router&amp;gt;
),document.body)
`&lt;/pre&gt;

### 添加首页

当 URL 为 &quot;/&quot; 的时候, 渲染的 App 组件的 render 中的 this.props.children 还是 undefined, 这种情况我们可以使用`IndexRoute`来设置一个默认页

&lt;pre&gt;`import {IndexRoute} from &apos;react-router&apos;
const Dashboard = React.createClass({
  render(){
    return &amp;lt;div&amp;gt;Welcome to the App!&amp;lt;/div&amp;gt;
  }
})

React.render((
  &amp;lt;Router&amp;gt;
    {/* 当 URL 为 / 的时候渲染 Dashboard*/}
    &amp;lt;IndexRoute component = {Dashboard} /&amp;gt;
    &amp;lt;Route path=&quot;about&quot; component = {About} /&amp;gt;
  &amp;lt;/Router&amp;gt;
),document.body)
`&lt;/pre&gt;

现在的 Sitemap 如下:

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
  &lt;th&gt;URL&lt;/th&gt;
  &lt;th&gt;Component&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
  &lt;td&gt;/&lt;/td&gt;
  &lt;td&gt;App =&gt; Dashboard&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;/about&lt;/td&gt;
  &lt;td&gt;App =&gt; About&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

### 将 UI 于 URL 解耦

如果我们可以将 `/inbox` 从 `/inbox/message:id` 中去除, 并且还能够让 Message 嵌套在 App-&gt;Inbox 中渲染, 那会非常赞, 绝对路径可以做到这一点

&lt;pre&gt;`React.render((
  &amp;lt;Router&amp;gt;
    &amp;lt;Route path = &quot;/&quot; component = {App}&amp;gt;
      &amp;lt;IndexRoute component = {Dashboard} /&amp;gt;
      &amp;lt;Route path = &quot;inbox&quot; component = {Inbox} &amp;gt;
        &amp;lt;Route path = &quot;/message:id&quot; component = {Message} /&amp;gt;
      &amp;lt;/Route&amp;gt;
    &amp;lt;/Route&amp;gt;
  &amp;lt;/Router&amp;gt;
),document.body)
`&lt;/pre&gt;

在多层嵌套路由中使用感觉对路径可以提高逻辑性.

Simtemap 如下:

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
  &lt;th&gt;URL&lt;/th&gt;
  &lt;th&gt;Component&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
  &lt;td&gt;/&lt;/td&gt;
  &lt;td&gt;App =&gt; Dashboard&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;/message/:id&lt;/td&gt;
  &lt;td&gt;App =&gt; Inbox =&gt; Message&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

提醒, 绝对路径可能在动态路由中无法使用

同时, 上述配置存在一个问题, 当用户访问/inbox/message/6的时候回无法访问

使用&amp;lt;Redirect&gt;修正

&lt;pre&gt;`&amp;lt;Route path = &quot;indox&quot; component = {Indox} &amp;gt;
  &amp;lt;Route path = &quot;/message/:id&quot; component = {Message} /&amp;gt;
  &amp;lt;Redirect from = &quot;message/:id&quot; to = &quot;/message/:id&quot; /&amp;gt;
&amp;lt;/Route&amp;gt;
`&lt;/pre&gt;

### 进入和离开的 Hook

Route 可以定义 `onEnter` 和 `onLeave` 两个 Hook, 这些 hook 会在页面跳转确认时触发一次,

在路由跳转过程中, `onLeave` hook 会在爱所有将离开的路由中触发, 从最下层的自路由开始直到最外层的父路由结束, 而`onEnter` hook 则从自外层的父路由开始直到最下层的子路由结束

比如从 /message/5 -&gt; /about 依次触发
- /message/:id 的 onLeave
- /inbox 的 onLeave
- /about 的 onEnter

### 路由匹配原理

路由拥有三个属性来决定是否匹配一个 URL
- 嵌套关系
- 路径语法
- 优先级

#### 嵌套关系

当一个给定的 URL 被调用时, 整个集合(命中的部分)都会被渲染, 嵌套路由被描述成一种树形结构, React Router 会深度优化遍历整个路由配置来寻找一个与给定的 URL 匹配的路由

#### 路径语法

路由路径是匹配一个(或一部分) URL 的一个字符串模式, 大部分的路由路径都可以按照字面量理解, 除了一下几个特殊字符:
- `:paramName` - 匹配一段位于`/`,`?`, `#`之后的 URL, 命中的部分作为一个参数
- `()` - 内部的内容被认为是可选的
- `*` - 匹配任意字符(非贪婪)直到命中下一个字符或整个 URL 的末尾, 并创建一个 splat 参数

&lt;pre&gt;`&amp;lt;Route path = &apos;/hello/:name&apos; /&amp;gt; // 匹配 /hello/michael 和 /hello/john
&amp;lt;Route path = &apos;/hello/(:name)&apos;/&amp;gt; // 匹配 /hello, /hello/michael, /hello/john
&amp;lt;Route path = &apos;/files/*.*&apos; /&amp;gt; // 匹配 files/hello.js, files/hello.jpg
`&lt;/pre&gt;

使用绝对路径可以使路由忽略嵌套关系

#### 优先级

兄弟路由的前一个优先级高

### Histories

React Router 是建立在 history 之上的, 一个 history 知道如何去监听浏览器地址变化, 并解析这个 URL 转化为 location 对象, 然后 router 使用它匹配到路由. 最后正确渲染组件

常用的 history 有三种形式
- createHashHistory
- createBrowserHistory
- createMemoryHistory

从 history 库中获取他们

&lt;pre&gt;`import createBrowserHistory from &apos;history/lib/createBrowserHistory&apos;
`&lt;/pre&gt;

#### createHashHistory

这是一个你会获得的默认 history, 如果不指定某个 history (即&amp;lt;Router&gt;{...}&amp;lt;/Router&gt;) 他用到的是 URL 中的 hash(#) 部分去创建形如 example.com/#/some/path 的路由

HashHistory 是默认的, 可以在服务器中不作任何配置就可以运行, 并且在全部浏览器中都可以使用, 但是不推荐实际生产中使用它, 因为每一个 web 应用都应该有目的地去使用 createBrowserHistory

#### 像`?_k=ckuvup` 没用的在 URL 中是什么?

当一个 history 通过应用程序的`pushState`或`replaceState`跳转时, 他可以在新的 location 中存储&quot;lcoation state&quot; 而不现实在 URL 中, 就像在一个 HTML 中 post 的表单数据

在 DOM API 中, 这些 hash history 通过 window.location.hash = newHash 很简单地被用于, 且不用存储他们的 location state, 但是我们希望全部的 history 都能够使用 location state, 因此要为每个 location 添加一个唯一的 key, 并把他们的状态存储在 session storage 中, 当访客点击前进或后退的时候, 可以恢复这些 location state.

#### createBrowserHistory

这是 react-router 创建浏览器应用推荐的 History, 使用 History API 在浏览器中被创建用于处理 URL, 新建一个像这样真实的 URL: example.com/some/path

##### 服务器配置

首先服务器应该能够处理 URL 请求, 处理应用启动最初的`/`这样的请求应该没问题,但是当用户来回跳转并在`/ accounts/23`刷新时, 服务器会受到来自`/account/23`的请求, 这时你就需要处理这个 URL 并在响应中包含 JS 程序代码

一个 express 的应用看起来可能是这样的:

&lt;pre&gt;`const express = require(&apos;express&apos;)
const path = require(&apos;path&apos;)
const port = process.env.PORT || 8080
const app = express()

// 通常用于加载静态资源
app.use(express.static(__dirname + &apos;/public&apos;))

// 在你应用 JS 文件中包含一个 script 标签的 index.html 中处理任何一个 route

app.get(&apos;*&apos;,function(request, response){
  response.sendFile(path.resolve(__dirname, &apos;public&apos;, &apos;index.html&apos;)
})

app.listen(port)
console.log(&apos;server started on port&apos; + port)
`&lt;/pre&gt;

当服务器找不到其他文件的时候, 服务器生成静态文件和操作 index.html 文件.

### 实例展示

&lt;pre&gt;`import React from &apos;react&apos;
import createBrowserHistory from &apos;history/createBrowserHistory&apos;
import { Router, Route, IndexRoute } from &apos;react-router&apos;
import App from &apos;../componnents/App&apos;
import Home from &apos;../componnents/Home&apos;
import About from &apos;../componnents/About&apos;
import Features from &apos;../componnents/Features&apos;

React.render(
  &amp;lt;Router history = {createBrowserHistory()} &amp;gt;
    &amp;lt;Route path = &apos;/&apos; component = {App} &amp;gt;
      &amp;lt;IndexRoute component = {Home} /&amp;gt;
      &amp;lt;Route path = &apos;about&apos; component = {About} /&amp;gt;
      &amp;lt;Route path = &apos;features&apos; component = {Features} /&amp;gt;
    &amp;lt;/Route&amp;gt;
  &amp;lt;/Router&amp;gt;, document.body
)
`&lt;/pre&gt;

### 默认路由(IndexRoute)与 IndexLink

如果设置了 IndexRoute =&gt; Home, 就要设置跳转到 Home 的路由&apos;/&apos;, 即`&amp;lt;Link to=&apos;/&apos;&amp;gt;Home&amp;lt;/Link&amp;gt;`, 他会一直处于激活状态(因为所有子路由都经过&apos;/&apos;), 我们仅希望在 Home 被渲染后激活并连接到他, 即需要在 Home 路由被渲染后才激活指向&apos;/&apos; 的链接, 请使用`&amp;lt;IndexLink to=&apos;/&apos;&amp;gt;Home&amp;lt;/IndexLink&amp;gt;`

### 动态路由

React Router 适用于小型网站, 也可以支持大型网站

对于大型应用而言, 一个首当其冲的问题就是所需要加载的 JS 的大小, 程序应当只加载当前渲染页需要的的 JS, 有些开发者称之为&quot;代码拆分&quot;, 在用户浏览过程中按需加载

对于底层细节的修改不应该需要他上面每一层级都进行修改, 举个例子, 为一个照片浏览页添加一个路径不应该影响到首页加载的 JS 大小, 也不能因为多个团队共用一个大型路由配置文件二造成合并时的冲突.

路由是个非常适合做代码拆分的地方: 他的责任就是配置好每个 view

React Routerzhogn 的路径匹配及组件加载都是异步完成的, 不仅允许你延迟加载组件, **并且可以延迟加载路由配置**. 在首次加载包中你只需要有一个路径定义, 路由会自动解析剩下的路径

Route 可以定义`getChildRoutes`, `getIndexRoute`, 和`getComponents` 这几个函数, 他们都是异步执行的, 并且只有需要时被调用, 这种方式成为&quot;逐渐匹配&quot;

React Router 会逐渐地匹配 URL 并且只加载该 URL 对应页面所需要路径配置和组件

如果配合 webpack 代码拆分工具使用的话, 一个原本繁琐的架构就会变得简明

&lt;pre&gt;`const CourseRoute = {
  path: &apos;course/:courseId&apos;,
  /* 当 get routes/indexRoute/Component 的时候 require 相应的资源
  getChildRoutes(location, callback){
    require.ensure([],function(require){
      callback(null, [
        require(&apos;./routes/Announcements&apos;),
        require(&apos;./routes/Assignments&apos;),
        require(&apos;./routes/Grades&apos;)
      ])
    })
  },

  getIndexRoute(location, callback){
    require.ensure([], function(require){
      callback(null, require(&apos;./components/Index&apos;))
    })
  },

  getComponents(location, callback){
    require.ensure([],function(require){
      callback(null, requrie(&apos;./components/Course&apos;))
    })
  }
}
`&lt;/pre&gt;

### 跳转前确认

React Router 提供一个`routerWillLeave` 生命周期钩子, 这使得 React 可以拦截正在发生的跳转, 或者在离开 Route 前提示用户

`routerWillLeave` 返回值有一下两种:
1\. `return false` 取消此次跳转
2\. `return` 返回提示信息, 在离开 route 前提示用户进行确认

在 Route 组件中引入`Lifecycle` mixin 来安装这个钩子

&lt;pre&gt;`import { Lifecycle } from &apos;react-router&apos;

const Home = React.createClass({
  mixins: [Lifecycle],
  routerWillLeave(nextLocation){
    if(!this.state.isSaved){
      return &apos;Your work is not saved!&apos;
    }
  }
})
`&lt;/pre&gt;

### 服务端渲染

服务端渲染与客户端渲染有些许不同, 需要
- 发生错误的时候发送一个`500`响应
- 需要重定向时发送一个`30x`响应
- 需要在渲染之前获得数据(用 router 完成)

### 组件生命周期

路由配置如下:

&lt;pre&gt;`&amp;lt;Route path = &apos;/&apos; component = {App} &amp;gt;
  &amp;lt;IndexRoute component = {Home} /&amp;gt;
  &amp;lt;Route path = &apos;invoices/:invoiceId&apos; component = {Invoice}/&amp;gt;
  &amp;lt;Route path = &apos;accounts/:accountId&apos; component = {Account}/&amp;gt;
&amp;lt;/Route&amp;gt;
`&lt;/pre&gt;

#### 路由切换时, 组件生命周期的变化
</code></pre><ol>
<li>当用户打开’/‘ 页面<br><table><br><thead><br><tr><br>  <th>Component</th><br>  <th>LifeCycle</th><br></tr><br></thead><br><tbody><br><tr><br>  <td>App</td><br>  <td>componentDidMount</td><br></tr><br><tr><br>  <td>Home</td><br>  <td>componentDidMount</td><br></tr><br><tr><br>  <td>Invoice</td><br>  <td>N/A</td><br></tr><br><tr><br>  <td>Account</td><br>  <td>N/A</td><br></tr><br></tbody><br></table><p></p></li>
<li><p>当用户从’/‘ 跳转到 ‘/invoices/123’</p>
<table><br><thead><br><tr><br>  <th>Component</th><br>  <th>LifeCycle</th><br></tr><br></thead><br><tbody><br><tr><br>  <td>App</td><br>  <td>componentWillReceiveProps, componentDidUpdate</td><br></tr><br><tr><br>  <td>Home</td><br>  <td>componentWillUnmount</td><br></tr><br><tr><br>  <td>Invoice</td><br>  <td>componentDidMount</td><br></tr><br><tr><br>  <td>Account</td><br>  <td>N/A</td><br></tr><br></tbody><br></table>

<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><p></p><p>最简单的通过 router 获取数据的方法是通过组件生命周期 Hook 来实现.</p>
<p>在 Invoice 中添加一个简单的数据获取功能</p>
<p><pre>`let Invoice = React.createClass({<br>  getInitialState(){</pre></p>
<pre><code>return{
  invoice: null
}
</code></pre><p>  },</p>
<p>  componentDidMount(){</p>
<pre><code>this.setState({
  this.fetchInvoice()
})
</code></pre><p>  },</p>
<p>  componentDidUpdate(prevProps){</p>
<pre><code>let oldId = prevProps.params.invoiceId
let newId= this.props.params.invoiceId
if(newId !== oldId){
  this.fetchInvoice()
}
</code></pre><p>  },</p>
<p>  componentWillUnmount(){</p>
<pre><code>this.ignorelastFetch = true
</code></pre><p>  },</p>
<p>  fetchInvoice(){</p>
<pre><code>let url = `/api/invoices/${this.props.params.invoiceId}`
this.request = fetch(url, (err, data) =&amp;gt; {
  if(!this.ingoreFetch){
    this.setState({invoice: data.invoice})
  }
})
</code></pre><p>  },</p>
<p>  render(){</p>
<pre><code>return &amp;lt;InvoiceView invoice = {this.state.invoice} /&amp;gt;
</code></pre><p>  }<br>})</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
            <tag> React-Router </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[H5 移动端注意点]]></title>
      <url>/2016/08/25/h5-e7-a7-bb-e5-8a-a8-e7-ab-af-e6-b3-a8-e6-84-8f-e7-82-b9/</url>
      <content type="html"><![CDATA[<ol>
<li>使用 rem 作为单位</li>
</ol>
<p>给手机这是 100px 的字体大小, 对于320px 的手机匹配是100px, 其他手机都是按比例分配, 因此设计稿上多少像素的话, rem = 设计稿像素/100</p>
<ol>
<li>禁用 a, button, input, opigroup, select, textare 等标签背景变暗</li>
</ol>
<p>在移动端使用 a 标签作为按钮或文字链接的时候, 点击按钮会出现一个暗色背景, 需要在 css 中加入</p>
<pre><code>a, button, input, textarea, optgroud, select{
  -webkit-tap-highlight-color: rgba(0,0,0,0)
}
`&lt;/pre&gt;
</code></pre><ol>
<li><p>meta 基础知识</p>
<p>页面窗口自动调整到设别宽度, 并禁止用户缩放页面</p>
<pre>`&lt;meta name="viewport" content="width=device-width,initial-width:1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0"/&gt;
`</pre>

<p>忽略页面中的数字识别为手机号</p>
<pre>`&lt;meta name="format-detection" content="telephone=no"/&gt;
`</pre>

<p>忽略 Android 平台对邮箱地址的识别</p>
<pre>`&lt;meta name="format-detection" content="email=no"/&gt;
`</pre>

<p>当网站添加到主屏时可隐藏地址栏, 仅针对 ios 的 safari</p>
<pre>`&lt;meta name="apple-mobile-web-app-capable" content="yes"/&gt;
`</pre>
</li>
<li><p>移动端定义字体</p>
<pre>`body{
  font-family:"Helvetica Neue", Helvetica, sans-serif;
}
`</pre>
</li>
<li><p>设置拨打电话</p>
<pre>`&lt;a href="tel:1242432423"&gt;1242432423&lt;/a&gt;
`</pre>
</li>
<li><p>设置发送短信</p>
<pre>`&lt;a href="sms:123124325434"&gt;123124325434&lt;/a&gt;
`</pre>
</li>
<li><p>设置发送邮箱</p>
<p><pre>`&lt;a href=”mailto:131321@21312.com”&gt;发送邮件&lt;/a&gt;</pre></p>
</li>
</ol>
<p>8, calc 语法, 兼容 IE9+, FF4.0, Chrome19+, Safari6+</p>
]]></content>
      
        <categories>
            
            <category> Uncategorized </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React 性能优化 Tip]]></title>
      <url>/2016/08/25/react-e6-80-a7-e8-83-bd-e4-bc-98-e5-8c-96-tip/</url>
      <content type="html"><![CDATA[<ol>
<li>慎用 setState, 因为他容易导致重复渲染, 请将数据都交给 redux 管理, 再通过 props 传入. 记得使用 shouldComponentUpdate 比较以确定是否需要重新渲染<p></p></li>
<li><p>请将方法的 bind 一律置于 constructor 中, 可以避免重复绑定, 多个实例的构造函数是共享的.</p>
</li>
<li><p>只传递 component 需要的 props, 传递的太多, 或者传递的太深, 都会加重 shouldComponentUpdate 里面的数据复旦</p>
</li>
<li><p>路由控制与拆包, 当项目变得更大规模与复杂的时候, 我们需要设计成 SPA, 这时路由管理就变得非常重要, 这使得特定 url 参数可以对应特定页面</p>
</li>
</ol>
<p></p><p>其他常见:<br>1. 使用 immutable 处理 props, state, store<br>2. 使用 pure-render-decorator 与 immutablejs 搭配使用<br>3. 慎用 setState<br>4. 仅传必要的 props<br>5. 将方法的 bind 置于 constructor</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[applyMiddleware 与 Enhancer]]></title>
      <url>/2016/08/25/applymiddleware-e4-b8-8e-enhancer/</url>
      <content type="html"><![CDATA[<pre><code>import { createStore, applyMiddleware, compose } from &apos;redux&apos;

const store = createStore(
  reducer,
  preloadedState, // &amp;lt;----- 可选，前后端同构的数据同步
  compose( // &amp;lt;------------ 还记得吗？compose 是从右到左的哦！
    applyMiddleware( // &amp;lt;-- 这货也是 Store Enhancer 哦！但这是关乎中间件的增强器，必须置于 compose 执行链的最后
      middleware1,
      middleware2,
      middleware3
    ),
    enhancer3,
    enhancer2,
    enhancer1
  )
)
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Redux APIs]]></title>
      <url>/2016/08/24/redux-apis/</url>
      <content type="html"><![CDATA[<h3 id="Compose-…funcs"><a href="#Compose-…funcs" class="headerlink" title="Compose(…funcs)"></a>Compose(…funcs)</h3><pre><code>/**
 * compose(f,h,g)(...args) =&amp;gt; f(g(h(...args)))
 * 使用了 reduceRight, 从右开始执行
 * @param {多个函数, 逗号隔开}
 * @return {函数}
 */

export default function compose(...funcs){
  if(funcs.length === 0){
    return arg =&amp;gt; arg
  }

  if(funcs.length === 1){
    return funcs[0]
  }

  const last = funcs[funcs.length - 1]
  const rest = funcs.slice(0,-1)
  return (...args) =&amp;gt; rest.reduceRight((composed, f) =&amp;gt; f(composed), last(...args))
}
`&lt;/pre&gt;

关键在于 reduceRight 可以传入初值

### createStore(reducer, [initialState])

&lt;pre&gt;`import isPlainObject from &apos;lodash/isPlainObject&apos;
import $$observable from &apos;symbol-observable&apos;

export var ActionTypes = {
  INIT: &apos;@@redux/INIT&apos;
}

export default function createStore(reducer, preloadState, enhancer){
  var currentReducer = reducer
  var currentState = preloadState
  var currentListeners = []
  var nextListeners = currentListeners
  var isDispatching = false
}

function ensureCanMutateNextListeners(){
  if(nextListeners === currentListeners){
    nextListeners = currentListeners.slice()
  }
}

function getState(){
  return currentState
}

function subscribe(listener){
  if(typeof listener !== &apos;function&apos;){
    throw new Error(&apos;Expected listener to be a function&apos;)
  }

  var isSubscribed = true

  ensureCanmutateNextListener()
  nextListeners.push(listener)

  return function ubsubscribe(){
    if(!isSubscribe){
      return
    }
    isSubscribe = false

    ensureCanMutateNextListeners()
    var index = nextListeners.indexOf(listener)
    nextListeners.splice(index,1)
  }
}

function dispatch(action){
  if(isPlainObecjt(action)){
    throw new Error(&apos;Action must be plain objects &apos; + &apos;Use custom middleware for async action&apos;)
  }

  if(typeof action.type === &apos;undefined&apos;){
    throw new Error(&apos;Actions may not have an undefined &quot;type&quot; property. &apos; + &apos;Have you misspelled a constant?&apos;)
  }

  if(isDispatching){
    throw new Error(&apos;Reducers may not dispatch actions.&apos;)
  }

  try{
    isDispatching = true
    currentState = currentReducer(currentState, action)
  } finally {
    isDispatching = false
  }

  var listeners = currentListeners = nextListeners

  for(var i = 0; i&amp;lt; listeners.length, i++){
    listeners[i]()
  }

  return action
}

function replaceReducer(nextReducer){
  if(typeof nextReducer !== &apos;function&apos;){
    throw new Error(&apos;Expected the nextReducer to be a function&apos;)
  }

  currentReducer = nextReducer
  dispatch({type:ActionTYpes.INIT})
}

### combineReudcers(reducers)

`&lt;/pre&gt;

import { combineReducers } from &apos;redux&apos;
import counterReducer from &apos;./counterReducer&apos;
import todosReducer from &apos;./todosReducer&apos;

const rootReducer = combineReducers({
  counter: counterReducer,   // &amp;lt;--- 键名是 state 中的属性, 键值是对应 reducer 函数名

  todos: todosReducer
})
export default rootReducer

&lt;pre&gt;`
如果提高需求
`&lt;/pre&gt;

state
  ├── counter: 0
  ├── todo
        ├── optTime: []
        ├── todoList: [] # 这其实就是原来的 todos！

&lt;pre&gt;`
对应的 reducers 是:
`&lt;/pre&gt;

reducers/
   ├── index.js &amp;lt;-------------- combineReducers (生成 rootReducer)
   ├── counterReducer.js
   ├── todoReducers/ &amp;lt;--------- combineReducers
           ├── index.js
           ├── optTimeReducer.js
           ├── todoListReducer.js

&lt;pre&gt;`
`&lt;/pre&gt;

/*  reducers/index.js */
import { combineReducers } from &apos;redux&apos;
import counterReducer from &apos;./counterReducer&apos;
import todosReducers from &apos;./todosReducer&apos;

const rootReducer = combineReducers({
  counter: counterReducer,
  todos: todosReducers
})

export default rootReducer

=================================================

/* reducers/todosReducers/index.js */

import { combineReducers } from &apos;redux&apos;
import optTimeReducer from &apos;./optTimeReducer&apos;
import todoListReducer from &apos;./todoListReducer&apos;

const todosReducers = combineReducers({
  optTime: optTimeReducer,
  todoList: todoListReducer
})

export default todosReducers

&lt;pre&gt;`
无论 dispatch 哪个 action 都会流通**所有** reducer, 但是由于 reducer 是纯函数, 效率还是会提高.

### BindActionCreator

### applyMiddlware(...middlewares)

先要理解 Middleware, enhancer

Redux 引入中间件机制是为了在 dispatch 前后进行处理

`&lt;/pre&gt;

const printStateMiddleware = ({getState}) =&gt; next =&gt; action =&gt; {
  console.log(&apos;...&apos;)
  let returnValue = next(action)
  console.log(&apos;...&apos;)
  return returnValue
}

&lt;pre&gt;`
实际上最内层
`&lt;/pre&gt;

function printStateMiddleware(middlewareAPI){ //中间件内可以使用的 API, 如 getState 与 dispatch
   return function(dispatch){ // 传入原 dispatch 的引用
    return function(action){
      console.log(...)
      var returnValue = dispatch(action)  //  执行 dispatch 行为, dispatch(action) 返回的还是 action
      console.log(...)
      return returnValue // 传给下一个中间件的 action
    }
   }
}

&lt;pre&gt;`
### Store Enhancer

说白了 Store Enhancer 是对生成 store 的 API 的改造, 与 middleware 的最大区别是 middlewere 不修改 store 的 API

改造 store 的 API 就要从 createStore 入口

Redux 的 applyMiddleware 就是一个 Enhancer

`&lt;/pre&gt;

import compose from &apos;./compose&apos; // 作用就是层层包裹

// 传入中间件
export default function applyMiddleware(...middlewares){
  // 传入 createStore
  return function(createStore){
    // 返回一个函数签名和 createStore 一样的函数, 即返回一个增强版的 createStore
    return function(reducer, preloadState, enhancer){
      // 用原 createStore 先生成一个 store, 包含 getState, dispatch, subscribe, replaceReducer 四个 API
      var store = creataStore(reducer, preloadState, enhancer)

&lt;pre&gt;`  var dispatch = store.dispatch //  生成指向原 dispatch的引用
  var chain = [] // 存储中间件的数组

  //提供给中间件的 API 其实就是 store 的 API
  var middlewareAPI = {
    getState: store.getStore,
    dispatch: (action) =&amp;gt; dispatch(action)
  }

  // 给中间件添加 API
  chain = middlewares.map(middleware =&amp;gt; middleware(middlewareAPI))

  // 串联中间件, 添加中间件的起点 store.dispatch, 返回经过修饰的 dispatch
  dispatch = compose(...middlewares)(store.dispatch)

  return{
    ...store, // store 中保留的原 API
     dispatch  // 用新的 dispatch 覆盖原 dispatch   
  }
}
</code></pre><p>}<br>}<br>```<br><a href="https://cnodejs.org/topic/57bd23ee1d27b9113348a546" target="_blank" rel="external">参考</a></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Middleware]]></title>
      <url>/2016/08/23/middleware/</url>
      <content type="html"><![CDATA[<p>You can include custom middleware functions to the dispatch method of your store.</p>
<p>The dispatch function is responsible for sending actions to one or more reducer functions for state changes. The composed specialized functions around the original dispatch method creates the new middleware capable dispatch method.</p>
<p>Source code for applyMiddleware(from Redux 1.0.1)</p>
<pre><code>export default function applyMiddleware(...middlewares) {
  return (next) =&amp;gt; 
    (reducer, initialState) =&amp;gt; {
      var store = next(reducer, initialState);
      var dispatch = store.dispatch;
      var chain = [];

      var middlewareAPI = {
        getState: store.getState,
        dispatch: (action) =&amp;gt; dispatch(action)
      };

      chain = middlewares.map(middleware =&amp;gt; middleware(middlewareAPI));

      return {
        ...store,
        dispatch
      }
    }
}
`&lt;/pre&gt;

Composing Functions

Functional programming is very literal and very mathematical. In the case of composing functions with math you can express two or more functions like this:

&lt;pre&gt;`given:

f(x) = x^2 + 3x + 1
g(x) = 2x

then:
(f · g)(x) = f(g(x)) = f(2x) = 4x^2 + 6x + 1
`&lt;/pre&gt;

It is no coincidence that you can compose two or more functions in a similar fashion. Here is a very simple example of a function that composes two functions to return a new specialized function:

&lt;pre&gt;`var greet = function(x) { return `Hello, ${x}`}
var emote = function(x) { return `${x} :)`}

var compose = function(f,g){
  return function(x){
    return f(g(x))
  }
}
`&lt;/pre&gt;

This was just to illustrate the basic concept. We will look at a more generic way to solve that issue by examining the Redux Code.

### Currying

Another powerful functional programming concepts is the idea of currying or partially applying argument values to a function. By currying we can create a new specialized function that has partial information supplied to it. Here is the canonical example of currying where we have an add function that curries the first operand parameter to create a specialized add function

&lt;pre&gt;`var curriedAdd = function(a){
  return function(b){
    return a + b;
  }
}

var addTen = curriedAdd(10);
addTen(10); // 20
`&lt;/pre&gt;

By currying and composing your functions you can create powerful new functions that create a pipeline for data processing.

### Redux Dispatch Function

A Store in Redux have a dispatch method which is only concerned with the main execution task you are interested in. You dispatch actions to your reducer functions to update state of the application. Redux reducers function takes a state and action parameter and return a new resultant state.

&lt;pre&gt;`reducer:: state -&amp;gt; action -&amp;gt; state
`&lt;/pre&gt;

You might dispatch an action that simply sends a message to remove an item in a list which could look like this:

&lt;pre&gt;`{type: types.DELETE_ITEM, id: 10}
`&lt;/pre&gt;

The store will dispatch this action object to all of it&apos;s reducer functions which could affect state. However the reducer functions are only concerned with executing logic around this deletion. They typically don&apos;t care who did it, how long it took, or logging the before and after effects of the state changes. This is where middleware can help us to address non-core concerns.

### Redux middleware

Redux middleware is designed by creating functions that can be composed together before the main dispatch method is invoked.

Let&apos;s creating a very simple logger middleware function that can echo the state of your application before and after running your main dispatch function. Redux middleware functions have this signiture:

&lt;pre&gt;`middleware:: next -&amp;gt; action -&amp;gt; retVal
`&lt;/pre&gt;

It might look something like this:

&lt;pre&gt;`export default function createLogger({getState}){
  return (next) =&amp;gt; 
    (action) =&amp;gt; {
      const console = window.console;
      const prevState = getState();
      const returnValue = next(action);
      const nextState = getState();
      const actionType = String(action.type);
      const message = `action ${actionType}`;

      console.log(`%c prev state`, `color: #9e9e9e`, prevState);
      console.log(`%c action`, `color: #03A9F4`, action);
      console.log(`%c next state`, `color:#4CAF50`, nextState)
    };
}
`&lt;/pre&gt;

Notice that createLogger accepts the getState method which is injected by applyMiddleware.js and used inside closure to read the current state. This will return a new function with the `next` parameter which is used to compose the next chained middleware function or the main dispatch function.

This function returns a curried function that accepts the action object which can be read or modified before sending it to the next middleware function in the chain. Finally the main dispatch function is invoked with the action object.
</code></pre><ul>
<li>First it captures the previous state</li>
<li>The action is dispatched to the next middleware function</li>
<li>All downstream middleware functions in the chain are invoked</li>
<li>The reducer functions in the store are called with the action payload</li>
<li><p>The logger middleware the gets the resulting next state</p>
<h3 id="Dissecting-applyMiddleware-js"><a href="#Dissecting-applyMiddleware-js" class="headerlink" title="Dissecting applyMiddleware.js"></a>Dissecting applyMiddleware.js</h3><pre>`export default function applyMiddleware(...middlewares){
  return (next) =&gt; 
    (reducer, initialState) =&gt; {
      var store = next(reducer, initialState);
      var dispatch = store.dispatch;
      var chain = [];

      var middlewareAPI = {
        getState: store.getState,
        dispatch: (action) =&gt; dispatch(action)
      };

      chain = middlewares.map(middleware =&gt; middleware(middlewareAPI));

      dispatch = compose(...chain, store.dispatch);

      return{
        ...store,
        dispatch
      };
    };
}
`</pre>

<p>The applyMiddleware function probably could have been named a little better, such as applyMiddlewareToStore.</p>
<p>The applyMiddleware function returns a function that takes a mysterious next argument:</p>
<pre>`return (next) =&gt; (reducer, initialState) =&gt; {...}
`</pre>

<p>The next argument will be a function that is used to create a store. By default you should look at the implementation for createStore. The final returned function will be like createStore and replace the dispatch function with it’s associated middlewares.</p>
<p>Next we assign the store implementation to the function responsible for creating the new store. Then we create a variable to the store’s original dispatch function. Finally we setup an array to hold the middleware chain we will be creating.</p>
<pre>`var store = next(reducer, initialState)
var dispatch = store.dispatch
var chain = [];
`</pre>

<p>This next bit of code injects the getState function and the original dispatch function from the store into each middleware function which you can optionally use in your middleware(the applyMiddleware function pass getState and dispatch to middlewares in it).</p>
<p>The resultant middleware is stored in the chain array</p>
<pre>`var middlewareAPI = {
  getState: store.getState,
  dispatch: (action) =&gt; dispatch(action)
}

chain = middlewares.map(middleware =&gt; middleware({middlewareAPI}))
`</pre>

<p>Now we create our replacement dispatch function with the information about hte middleware chain:</p>
<pre>`dispatch = compose(...chain, store.dispatch);
`</pre>

<p>The magic to composing our middleware chain lies in this utility function supplied by Redux. Here is the implementation</p>
<pre>`export default function compose(...funcs){
  return funcs.reduceRight((compsed,f) =&gt; f(composed))
}
`</pre>

<p>The composing function will literally express your functions as a composition injecting each middleware as an argument to the next middleware in the chain. Order is important here when assembling your middleware function. Finally, the original store dispatch method is composed. This new looks like:</p>
<pre>`middlewareI(middlewareJ(middlewareK(store.dispatch)))(action)
`</pre>

<p>The final thing to do is return the new store object with the overriden function:</p>
<pre>`return {
  ...store,
  dispatch
}
`</pre>

<p>Let’s add our logger middleware we started above into a custom store with the enhanced dispatch function.</p>
<pre>`import { createStore, applyMiddlware } from 'redux'
import loggerMiddleware from 'logger'
import rootReducer from './reducers'

const createStoreWithMiddleware = applyMiddleware(loggerMiddleware)(createStore)

export default function configureStore(initialState){
  return createStoreWithMiddleware(rootReducer, initialState);
}

const store = configureStore()
`</pre>

<h3 id="Asynchronous-Middleware"><a href="#Asynchronous-Middleware" class="headerlink" title="Asynchronous Middleware"></a>Asynchronous Middleware</h3><p>Once you get comfortable with the basics of Redux middleware you will likely want to work with asynchronous actions that involve some sort of asynchronous execution. In particular look at ‘redux-thunk’ for more details. Let’s say you have an action creator that has some async functionality to get stock quote information:</p>
<pre>`function fetchQuote(symbol){
  requestQuote(symbol);
  return fetch('......')
         .then(req =&gt; req.json())
         .then(json =&gt; showCurrentQuote(symbol, json));
}
`</pre>

<p>There is no obvious way here to dispatch an action that would be returned from the fetch which is Promise based. Plus we do not have a handle to the dispatch function. Therefore we can use the redux-thunk middleware to defer execution of these operations. By wrapping the execution in a function you can delay this execution:</p>
<pre>`function fetchQuote(symbol){
  return dispatch =&gt; {
    dispatch(requestQuote(symbol));
    return fetch('......').then(req=&gt;req.json).then(json =&gt; dispatch(showCurrentQuote(symbol,json))
  }
}
`</pre>

<p>Remember that the applyMiddleware function will inject the <code>dispatch</code> and the <code>getStat</code> function as parameters int o the redux-thunk middleware. Now you can dispatch the resultant action objects to your store which conatains reducers. Here is the middleware function for redux-thunk that does this for you.</p>
<p><pre>`export default function thunkMiddleware({dispatch,getState}){<br>  return (next) =&gt; </pre></p>
<pre><code>action =&amp;gt; {
  typeof action === &apos;function&apos;? action(dispatch, getState):next(action)
}
</code></pre><p>}</p>
</li>
</ul>
<p>If the action is a function it will be called with the dispatch and getState function..</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Connect 相关]]></title>
      <url>/2016/08/22/connect-e7-9b-b8-e5-85-b3/</url>
      <content type="html"><![CDATA[<h1 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h1><p>回顾一下 Redux 基本用法</p>
<pre><code>const reducer = (state = {count: 0}, action ) =&amp;gt; {
  switch(action.type){
  case &quot;INCRESE&quot;: return {count: state.count + 1}
  case &quot;DECRESE&quot;: return {count: state.count - 1}
  default: return state;
  }
}

const actions = {
  increase: () =&amp;gt; { type: &apos;INCREASE&apos;},
  decrease: () =&amp;gt; { type: &apos;DECREASE&apos;}
}

const store = createStore(reducer);

store.subscribe(()=&amp;gt;{
  console.log(store.getState())
});

store.dispatch(action.increase());
`&lt;/pre&gt;

通过 reducer 创建一个 store, 每当我们在 store 上 dispatch 一个 action, store 内的数据就会通过 reducer 变化.

我们当然可以直接在 React 中使用 Redux, 在最外层容器中初始化 store, 然后将 state 上的属性作为 props 层层传下去

&lt;pre&gt;`class App extends Component{
  componentWillMount(){
    store.subscribe((state) =&amp;gt; this.setState(state))
  }
  render(){
    return &amp;lt;Comp state={this.state} onIncrease = {()=&amp;gt;store.dispatch(actions.increase())} onDecrease = {()=&amp;gt; store.dispatch(actions.decrease())}
  } /&amp;gt;
}
`&lt;/pre&gt;

但这不是最佳方式, 最佳方式是使用 react-redux 提供的 Provider 和 connect 方法

### 使用 React-redux

首先在最外层容器中, 把所有内容包裹在 Provider 组件中, 将之前创建的 store 作为 prop 传递给 Provider

&lt;pre&gt;`const App = () =&amp;gt; {
  return(
    &amp;lt;Provider store = {store}&amp;gt;
      &amp;lt;Comp /&amp;gt;
    &amp;lt;/Provider&amp;gt;
  )
}
`&lt;/pre&gt;

Provider 中的任何一个组件(比如这里的 Comp) 如果需要使用 state 中的数据, 就必须是 `被 connect 过的`组件, 使用 connect 方法对你编写的组件(MyComp)进行包装后的产物.

&lt;pre&gt;`class MyComp extends Component {
  // content...
}

const Comp = connect(...args)(MyComp);
`&lt;/pre&gt;

可见 connect 是重中之重

### connect 详解

究竟 connect 做了什么

首先看一下函数的签名:

&lt;pre&gt;`connect([mapStatToProps], [mapDispatchToProps], [mergeProps], [options])
`&lt;/pre&gt;

connect() 函数接受四个参数, 分别是

&lt;pre&gt;`mapStatToProps, mapDispatchToProps, mergeProps, options
`&lt;/pre&gt;

&lt;pre&gt;`mapStatToProps(state, ownProps): stateProps
`&lt;/pre&gt;

这个函数允许我们将 store 中的数据作为 props 绑定到组件上

&lt;pre&gt;`const mapStatToProps = (state) =&amp;gt; {
  return {
    count: state.count
  }
}
`&lt;/pre&gt;

这个函数的第一个参数就是 Redux 的 store, 我们从中摘取 count 属性, 因为返回了具有 count 属性的对象, 所以 MyComp 会有名为 count 的 props 字段

&lt;pre&gt;`class MyComp extends Component{
  render(){
    return &amp;lt;div&amp;gt;Count: {this.props.count}&amp;lt;/div&amp;gt;
  }
}

const Comp = connect(...args)(MyComp);
`&lt;/pre&gt;

当然你不必将 state 原封不动传递给组件, 可以根据 state 中的数据, 动态的输出组件需要的(最小)属性

&lt;pre&gt;`const mapStateToProps = (state) =&amp;gt; {
  return {
    greaterThanFive: state.count &amp;gt; 5
  }
}
`&lt;/pre&gt;

第二个参数 ownProps, 是 MyComp 自己的 props, 有时候 ownProps 也会对其产生影响, 比如当你在 store 中维护一个用户列表, 而你的组件 MyComp 只关心一个用户(通过 props 中的 userId体现)

&lt;pre&gt;`const mapStateToProps = (state, ownProps) =&amp;gt; {
  // state 是{ userList:[{id:0,name;&apos;王二&apos;}]}
  return {
    user: _.find(state.userList, {id:ownProps.userId})
  }
}

class MyComp extends Component{
  static PropTypes = {
    userId: PropTypes.string.isRequired,
    user: PropTypes.object
  };
  render(){
    return &amp;lt;div&amp;gt;UserName: {this.props.user.name}&amp;lt;/div&amp;gt;
  }
}

const Comp = connect(mapStateToProps)(MyComp)
`&lt;/pre&gt;

当 state 变化, 或者 ownProps 变化时, mapStateToProps 都会被调用, 计算出一个新的 stateProps , 在与 ownProps merge 后, 更新给 MyComp

这就是将 Redux store 中的数据连接到组件的基本方法

mapDispatchToProps(dispatch, ownProps): dispatchProps

connect 的第二个参数是 mapDispatchToProps, 功能是将 action 作为 props 绑定到 MyComp 上

&lt;pre&gt;`const mapDispatchToProps = (dispatch, ownProps) =&amp;gt; {
  return {
    increase: (...args) =&amp;gt; dispatch(actions.increase(...args)),
    decrease: (...args) =&amp;gt; dispatch(actions.decrease(...args))
  }
}

class MyComp extends Component{
  render(){
    const {count, increase, decrease} = this.props
    return (
      &amp;lt;div&amp;gt;
        &amp;lt;div&amp;gt;Count:{count}&amp;lt;/div&amp;gt;
        &amp;lt;button onClick={increase}&amp;gt;+&amp;lt;/button&amp;gt;
        &amp;lt;button onClick={decrease}&amp;gt;-&amp;lt;/button&amp;gt;
      &amp;lt;/div&amp;gt;
    )
  }
}

const Comp = connect(mapStateToProps, mapDispatchToProps)(MyComp)
`&lt;/pre&gt;

由于 mapDispatchToProps 方法返回了具有 increase 属性和 decrease 属性的对象, 这两个属性也会成为 MyComp 的 props

如上所示, 调用 actions.increase()只能得到一个 action 对象{type:&apos;INCREASE&apos;}, 要触发这个 action 必须要通过 dispatch 调用, dispatch 正式 mapDispatchToProps 的第一个参数, 但是为了不让 MyComp 组件感知到 dispatch 的存在, 我们需要将 increase 和 decrease 方法包装一下, 使之成为直接可以被调用的函数(即触发该方法就会触发 dispatch)

Redux 本身提供了 bindActionCreator 函数, 来将 action 包装成可以直接被调用的函数

&lt;pre&gt;`import {bindActionCreator} from &apos;redux&apos;
const mapDispatchToProps = (dispatch,ownProps) =&amp;gt; {
  return bindActionCreator({
    increase: actions.increase,
    decrease: actions.decrease
  })
}
</code></pre><p>同样当 ownProps 变化时, 该函数也会被调用, 生成一个新的 dispatchProps( 在与 stateProps 和 ownPorps merge 后), 更新给 MyComp. 注意 action 的变化不会引起上述过程, 默认 action 在组件的生命周期中是固定的</p>
<p>[mergeProps(stateProps, dispatchProps, ownProps): props]</p>
<p>之前说过不管是 stateProps 还是 dispatchProps, 都需要和 ownProps merge 之后才会被赋给 MyComp, connect 的第三个参数就是来做这个事情的, 通常情况下不需要传这个参数, connect 会使用 Object.assign 方法代替该方法.</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>最后还有一个 options 参数, 比较简单, 一般也不会用到.</p>
<p><a href="http://taobaofed.org/blog/2016/08/18/react-redux-connect/" target="_blank" rel="external">参考</a></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
            <tag> React </tag>
            
            <tag> React-Redux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Configuring ESLint]]></title>
      <url>/2016/08/22/configuring-eslint/</url>
      <content type="html"><![CDATA[<ol>
<li>Configuration Comments - use JS comments to embed configuration information directly into a file.<p></p></li>
<li>Configuration Files - use a JS, JSON, or YAML file to specify configuration information for an entire directory and all of its subdirectories. This can be in the form of an <code>.eslintrc</code> file or an <code>eslintConfig</code> field in a <code>package.json</code> file, both of which ESLint will look for and reed automatically, or you can specify a configuration file on the command line.</li>
</ol>
<h3 id="Specifying-Parser-Options"><a href="#Specifying-Parser-Options" class="headerlink" title="Specifying Parser Options"></a>Specifying Parser Options</h3><p></p><p>ESLint allows you to specify the JS language options you want to support. By Default, ESLint support only ES5 syntax. You can override that setting to enable support for ES6 and 7 as well as JSX by using parser options.</p>
<p>Parser options are set in your <code>.eslintrc</code> file by using the <code>parserOptions</code> property. The available options are:</p>
<ul>
<li><code>ecmaVersion</code> - set to 3, 5(default), 6 or 7 to specify the version of ECMAScript you want to use.</li>
<li><code>sourceType</code> - set to <code>&quot;script&quot;</code> (default) or <code>&quot;module&quot;</code> if your code is in ECMAScript modules.</li>
<li><p><code>emcaFeatures</code> - an object indicating which additional language features you’d like to use:</p>
<pre><code>*   `globalReturn` - allow `return` statements in the global scope.
</code></pre><ul>
<li><code>impliedStrict</code> - enable global <code>strict mode</code> (if <code>ecmaVersion</code> is 5 or greater)</li>
<li><code>jsx</code>: enable <code>JSX</code></li>
<li><code>experimentalObjectRestSpread</code> - enable support for the experimental <code>object rest/spread properties</code></li>
</ul>
</li>
</ul>
<p>An example:</p>
<pre><code>{
  &quot;parserOptions&quot;:{
    &quot;emcaVersion&quot;: 6,
    &quot;sourceType&quot;: &quot;module&quot;,
    &quot;ecmaFeatures&quot;: {
      &quot;jsx&quot;: true
    }
  },
  &quot;rules&quot;:{
    &quot;semi&quot;: 2
  }
}
`&lt;/pre&gt;

### Specifying Parser

By Default, ESLint uses `Espree` as its parser. You can optionally specify that a different parser should be used in your configuration file so long as the parser meets the following requirements:
</code></pre><ul>
<li>It must be an npm module installled locally;</li>
<li>It must have an Esprima-compatible interface</li>
<li><p>It must produce Esprima-compatible AST and token objects.</p>
<h3 id="Specifying-ENV"><a href="#Specifying-ENV" class="headerlink" title="Specifying ENV"></a>Specifying ENV</h3></li>
<li><p>browser</p>
</li>
<li>node</li>
<li>commonjs</li>
<li>es6</li>
<li><p>mocha</p>
<pre>`{
  "env":{
    "browser": true,
    "node": true
  }
}

### Configuring Rules

ESLint comes with a large number of rules, you can modify which rules your project use either using configuration comments or configuration files. To change a rules setting, you must set the rule ID equal to one of these values: 

- `"off"` or `0` to turn rule off.
- `"warn"` or `1` to turn the rule as a warning(doesn't affect exit code)
- `"error"` or `2` to turn the rule on as an error(exit code is 1 when triggered)

### Demo

`</pre>

<p>npm install -g eslint</p>
<p><pre>`</pre></p>
</li>
</ul>
<p>eslint –init<br><code>``
生成</code>.eslintrc.js`</p>
<p>但是这个文件最好手动生成</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ESLint </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JS 开发工具]]></title>
      <url>/2016/08/21/js-e5-bc-80-e5-8f-91-e5-b7-a5-e5-85-b7/</url>
      <content type="html"><![CDATA[<p>开发工具是让开发人员工作更轻松的一些软件, 传统上包括集成开发环境, 代码检查工具, 编译器, 调试工具和性能测试工具</p>
<p>但是 JS 是一种动态语言, 伴随他动态本质而来的是对更多运行时开发者工具的需求.</p>
<h4 id="Quick-List"><a href="#Quick-List" class="headerlink" title="Quick List"></a>Quick List</h4><ul>
<li>Atom &amp; Atom-ternjs</li>
<li>Chrome DevTools</li>
<li>PageSpeed Insights</li>
<li>BrowserSycn</li>
<li>TraceGL</li>
<li>ironNode</li>
<li>ESLint</li>
<li>Babel</li>
<li>React</li>
<li>Webpack + Hot Module Replacement</li>
<li>Redux + Redux DevTools</li>
</ul>
<p>关于工具, 主要是编辑器和运行时环境(比如浏览器)</p>
<p>主要用 Atom, 需要 atom-ternjs 来开启 JavaScript 智能识别</p>
<p>很多很棒的 <a href="https://medium.com/@satya164/supercharged-javascript-development-in-atom-ea034e22eabc#.a2b8sthbw" target="_blank" rel="external">Atom 插件</a></p>
<p>调试器: Chrome DevTools, 注意其 flame charts 和 dominators view 功能</p>
<p>性能审查: <a href="https://www.youtube.com/watch?list=PLOU2XLYxmsILKwwASNS0xgfcmakbK_8JZ&amp;v=bDUDuQy3R7Y" target="_blank" rel="external">PageSpeed Insights</a></p>
<p>BrowserSync是一款测试响应式布局非常好用的工具, 可以一次模拟多种浏览器(电脑, 平板, 手机)<br>可以监视文件, 并在文件修改的时候自动重载同步刷新浏览器, 像滚动, 点击, 表单交互等动作也会跨设别同步.</p>
<p><a href="https://www.youtube.com/watch?v=heNWfzc7ufQ" target="_blank" rel="external">视频链接</a></p>
<p>TraceGL 是一种运行时调试工具, 可以让你在软件中的方法实时调用时观察他们, 而不是手动逐步跟踪代码</p>
<p><a href="https://www.youtube.com/watch?v=heNWfzc7ufQ" target="_blank" rel="external">视频链接</a></p>
<p>代码检查: ESLint 可配置性特别强, 每一个选项都可以设置开启或禁用, 甚至给他们添加参数. 可以创建自己的规则, 支持插件</p>
<p>Babel 是一种编译器, 可以让现在的 JS 代码使用 ES6+ 尚未支持的特性, JSX 等, 工作原理是讲代码转换为等价的 ES5.</p>
<p><a href="https://medium.com/javascript-scene/how-to-use-es6-for-isomorphic-javascript-apps-2a9c3abe5ea2" target="_blank" rel="external">文章链接</a></p>
<p>Webpack 会将模块和以来打包成针对浏览器的静态资源, 他支持大量有趣的特性, 比如模块热拔插, 可以让当前浏览器中的代码在你修改文件的时候自动更新, 而不用刷新页面. 模块热拔插</p>
<p><a href="https://github.com/cloverfield-tools/universal-react-boilerplate" target="_blank" rel="external">参考资料</a></p>
<p>React: 不算开发者工具</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> DevTools </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[部署React + Redux 的 Web 开发环境]]></title>
      <url>/2016/08/20/e9-83-a8-e7-bd-b2react-redux-e7-9a-84-web-e5-bc-80-e5-8f-91-e7-8e-af-e5-a2-83/</url>
      <content type="html"><![CDATA[<p>好的部署需要做到两点:<br>1. 性能优化: 包括代码执行速度, 页面载入速度<br>2. 自动化: 减少重复工作</p>
<p>使用 React+Redux 的时候往往会用到其调试工具 Redux DevTools, 在手动配置 DevTools 时需要针对 Store 和 Component 进行一些配置, 然而这些都是为了方便调试的, 生产环境下我们不希望加入这些东西, 所以建议从代码上隔离 development 和 production 环境:</p>
<pre><code>containers/
  Root.js
  Root.dev.js
  Root.prod.js
  ...

store/
  index.js
  store.dev.js
  store.prod.js
`&lt;/pre&gt;

同时采用单独的入口文件, 比如上面的 containers/Root.js, 按需要加载不同环境的代码

&lt;pre&gt;`if (process.env.NODE_ENV === &apos;production&apos;){
  module.exports = require(&apos;./Root.prod&apos;);
} else {
  module.exports = require(&apos;./Root.dev&apos;);
}
`&lt;/pre&gt;

有一个细节需要注意: ES6 语法不支持在 if 中书写 import 语句, 所以这里采用了 CommonJS 的模块引入方法 require.

另一个需要注意的地方是按需要 import, 否则可能在打包的时候引入不必要的代码

使用 webpack 进行打包工作

&lt;pre&gt;`webpack --config webpack.config.prod.js --progress
`&lt;/pre&gt;

注意要为不同的环境准备不同的 webpack 配置文件. 比如 `webpack.config.dev.js` 和 `webpack.config.prod.js` . 看一下比较关键的配置选项

### devtools

启用 source-map, 这样 webpack 会生成两个包
- bundle.js
- bundle.js.map
把用于定位源码的 source map 分离出去, 减少 bundle.js 的体积

source-map 只会在浏览器 devtools 激活时加载, 并不会影响正常页面的饿加载速度.

### plugins

&lt;pre&gt;`plugins:[
  new webpack.optimize.UglifyJsPlugin({
    compress:{
      warning: false
    }
  }),
  new webpack.optimize.DedupePlugin(),
  new webpack.optimize.OccurenceOrderPlugin()
]
`&lt;/pre&gt;

### 不要忽视 NODE_ENV

NODE_ENV 其实就是一个环境变量, 在 Node 中 可以通过`process.env.NODE_ENV`获取, 目前大家汪汪用这个变量区分当前是 development 还是 production.

通过 webpack 的 DefinePlugin 设置环境变量:

&lt;pre&gt;`plugins:[
  ...
  new webpack.DefinePlugin({
    &apos;process.env.NODE_ENV&apos;: JSON.stingify(&apos;production&apos;)
  })
]

### 添加 hash
前端公认的 Best Practice 就是给资源打上 hash 标签, 这对缓存静态资源很有用

1\. 给 bundle.js 添加 hash 标签
`&lt;/pre&gt;

output{
  path: ...
  filename: &apos;bundle.[hash].js&apos;
}

&lt;pre&gt;`使用 html-webpack-plugin 这个插件自动生成带有
`&lt;/pre&gt;

&amp;lt;script src=&apos;bundle.[hash].js&gt;&amp;lt;/script&gt;&apos;的 html 文件

&lt;pre&gt;`配置如下:
`&lt;/pre&gt;

plugins:[
  ...
  new HtmlWebpackPlugin({
    title:&apos;html title&apos;,
    template:&apos;./template.html&apos;,
    favicon: &apos;./static/images/logo.ico&apos;
  })
]

&lt;pre&gt;`配置 template.html
`&lt;/pre&gt;

&lt;!DOCTYPE html&gt;
&amp;lt;html&gt;
&amp;lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0&quot;&gt;
&amp;lt;/head&gt;
&amp;lt;body&gt;

&lt;div id=&quot;react-container&quot;&gt;&lt;/div&gt;

&amp;lt;/body&gt;
&amp;lt;/html&gt;

&lt;pre&gt;`
如果需要在 React Component 中添加图片, 建议采用
`&lt;/pre&gt;

import LOGO.png from &apos;./static/images/logo.png&apos;
&amp;lt;img src={LOGO.png} alt=&quot;&quot; /&gt;

&lt;pre&gt;`使用 import 或 require 可以让 webpack 对图片进行打包

使用 file-loader 可以对图片添加 hash 标签然后返回相应的 URL
</code></pre><p>module:{<br>  loaders:[<br>    {<br>      test: /&#46;(png|jpg),<br>      loader:”file?name=[hash].[ext]”<br>    }<br>  ]<br>}<br>```</p>
<h3 id="引入-CSS"><a href="#引入-CSS" class="headerlink" title="引入 CSS"></a>引入 CSS</h3><p>可以直接在 js 文件中 <code>require(&#39;./foo.css&#39;)</code>, 然后使用 style-loader 和 css-loader 进行处理, 最终效果是将 css 嵌入到 HTML 的 style 标签中, 这样就不需要使用 hash</p>
<p>CSS 较大的话, 可以考虑使用 extract-text-webpack-plugin 插件将 CSS 合并后独立为一个文件, 并自定在页面加载的时候添加 link 标签</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack 常用 plugin 和 loader]]></title>
      <url>/2016/08/19/webpack-e5-b8-b8-e7-94-a8-plugin-e5-92-8c-loader/</url>
      <content type="html"><![CDATA[<h3 id="常用Loader"><a href="#常用Loader" class="headerlink" title="常用Loader"></a>常用Loader</h3><p>html 相关</p>
<pre><code>html-loader
`&lt;/pre&gt;

css 相关

&lt;pre&gt;`style-loader
css-loader
autoprefixer-loader
sass-loader
`&lt;/pre&gt;

js 相关

&lt;pre&gt;`babel-loader
babel-core
babel-preset-es2015
babel-preset-react
babel-preset-stage3
eslint-loader
`&lt;/pre&gt;

### 常用插件Plugin

#### config 类

&lt;pre&gt;`NormalModuleReplacementPlugin
ContextReplacementPlugin
IgnorePlugin
PrefetchPlugin
`&lt;/pre&gt;

#### Optimize

&lt;pre&gt;`DedupePlugin
LimitChunkCountPlugin
OccurenceOrderPlugin
UglifyJsPlugin
CommonsChunkPlugin
`&lt;/pre&gt;

#### 其他

&lt;pre&gt;`HotModuleReplacementPlugin
NoErrorPlugin
ProgressPlugin
HtmlWebpackPlugin
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ImmutableJS Introduction]]></title>
      <url>/2016/08/19/immutablejs-introduction/</url>
      <content type="html"><![CDATA[<p>Immutable data cannot be changed once created, leading to much simpler application development, no defensive copying, and enabling advanced memoization and change detection techniques with simple logic. Persistent data presetns a mutative API which does not update the data in-place, but instead always yields new updated data.</p>
<p>Immutable.js provides many Persistent Immutable data structures including: <code>List</code>, <code>Stack</code>, <code>Map</code>, <code>OrderedMap</code>, <code>Set</code>, <code>OrderedSet</code> and <code>Record</code>.</p>
<p>These data structures are highly efficient on modern JavaScript VMs by using structural sharing via ‘hash maps tries’ and ‘vector tries’ as popularized by Clojure and Scala, minimizing the need to copy or cache data.</p>
<p>Immutable also provides a lazy <code>Seq</code>, allowing efficient chaining of collection methods like <code>map</code> and <code>filter</code> without creating intermediate representations. Create some <code>Seq</code> with <code>Range</code> and <code>Repeat</code>.</p>
<h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><p><code>npm install Immutable</code></p>
<p><code>var Immutable = require(&#39;immutable&#39;);
  var map1 = Immutable.Map({a:1,b:2,c:3});
  var map2 = map1.set(&#39;b&#39;,50);
  map1.get(&#39;b&#39;); //2
  map2.get(&#39;b&#39;); //50</code></p>
<h3 id="The-case-for-Immutability"><a href="#The-case-for-Immutability" class="headerlink" title="The case for Immutability"></a>The case for Immutability</h3><p>Much of what makes application development difficult is tracking mutation and maintaining state. Development with immutable data encourages you to think differently about how data flows through your application.</p>
<p>Subscribing to data event throughout your application.</p>
<p>Immutable data never change.</p>
<p>Immutable collections should be treated as <em>value</em> rather than <em>object</em>. While objects represents some thing which could change over time, a value represents the state of that thing at a particular instance of time. This principle is most important to understanding the appropriate use of immutable data. In order to treat Immutable.js collections as values, it’s important to use the <strong>Immutable.is()</strong> function or <strong>.equals()</strong> method to determine value equality instead of <code>===</code> operator which determines object reference identity.</p>
<p><code>var map1 = Immutable.Map({a:1,b:2,c:3});
  var map2 = map1.set(&#39;b&#39;,2);
  assert(map1.equals(map2) === true);
  var map3 = map1.set(&#39;b&#39;,50);
  assert(map1.equals(map3) === false);</code></p>
<p><strong>Note</strong>: As a performance optimization <strong>Immutable</strong> attempts to return the existing collection when an operation would result in an identical collection, allowing for using <code>===</code> reference equality to determine if something definitely has not changed. This can be extremely useful when used within memoization function which would prefer to re-run the function if a deeper equality check could potentially be more costly. The <code>===</code> equality check is also used internally by <strong>Immutable.js</strong> and <code>equals()</code> as a performance as a performance optimization.</p>
<p>If an object is immutable, it can <strong>be ‘copied’ simply by marking another reference</strong> to it instead of copying the entire object. Because a reference is much smaller than the object itself, this results in memory savings and a potential boost in execution speed for programs which rely on copies(such as an undo-stack).</p>
<p><code>var map1 = Immutable.Map({&#39;a&#39;:1,&#39;b&#39;:2,&#39;c&#39;:3});
  var clone = map1;</code></p>
<h3 id="JavaScript-first-API"><a href="#JavaScript-first-API" class="headerlink" title="JavaScript-first API"></a>JavaScript-first API</h3><p>While <code>immutable</code> is inspired by Clojure, Scala, Haskell and other functional programming environments, it’s designed to bring these powerful concepts to JavaScript, and therefore has an Object-Oriented API that closely mirrors that of <strong>ES6 Array, Map, and Set</strong>.</p>
<p>The difference for the immutable collections is that methods which would mutate the collection, like <code>push</code>, <code>set</code>, <code>unshift</code>, or <code>splice</code> instead of return a new immutable collection. Methods which return new array like <code>slice</code> or <code>concat</code> instead return new immutable collections.</p>
<p><code>var list1 = Immutable.List.of(1,2);
  var list2 = list1.push(3,4,5);
  var list3 = list2.unshift(0);
  var list4 = list1.concat(list2,list3);
  assert(list1.size === 2);
  assert(list2.size === 5);
  assert(list3.size === 6);
  assert(list4.size === 13);
  assert(list4.get(0) === 1);</code></p>
<p>Almost all of the methods on <strong>Array</strong> will be found in similar form on <strong>Immutable.List</strong>, those of <strong>Map</strong> found on <strong>Immutable.Map</strong> and those of <strong>Set</strong> found on<strong>Immutable.Set</strong>, including collection operation like <strong>forEach()</strong>, and <strong>map()</strong>.</p>
<p><code>var alpha = Immutable.Map({a:1,b:2,c:3,d:4});
  alpha.map((v,k) =&amp;gt; k.toUpperCase()).join();
  // &#39;A,B,C,D&#39;</code></p>
<h3 id="Accepts-raw-JavaScript-objects"><a href="#Accepts-raw-JavaScript-objects" class="headerlink" title="Accepts raw JavaScript objects"></a>Accepts raw JavaScript objects</h3><p>  ‘immutable’ accepts plain JavaScript Arrays and Objects anywhere a mehtod expects an <strong>Iterable</strong> with no performance penalty.</p>
<p><code>var map1 = Immutable.Map({a:1,b:2,c:3,d:4});
  var map2 = Immutable.Map({c:10,a:20,t:30});
  var obj = {d:100,o:200,g:300};
  var map3 = map1.merge(map2,obj);
  // Map {a:20,b2,c:10,d:100,t:30,o:200,g:300}</code></p>
<p><strong>Immutable</strong> can treat any JavaScript Array or Object as an Iterable. You can take advantage of this in order to get sophisticated collection methods on JavaScript Objects, which otherwise have a very sparse native API.</p>
<p><code>var myObject = {a:1,b:2,c:3};
  Immutable.Seq(myObject).map(x=&amp;gt;x*x).toObject();
  // {a:1,b:4,c:9};</code></p>
<p>Keep in Mind, when using JS objects to construct Immutable Maps, that JS Object properties are always <strong>strings</strong>, even if written in a quote-less shorthand, while Immutable Map accept keys of any type.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  var obj = &#123;1: &amp;#039;one&amp;#039;&#125;;</div><div class="line">  Object.keys(obj); // [&amp;#039;1&amp;#039;]</div><div class="line">  obj[1]; // &amp;#039;one&amp;#039;</div><div class="line">  obj[&amp;#039;1&amp;#039;]; // &amp;#039;one&amp;#039;</div><div class="line"></div><div class="line">var map = Immutable.fromJS(obj);</div><div class="line">  map.get(&amp;#039;1&amp;#039;); // &amp;#039;one&amp;#039;</div><div class="line">  map.get(1); // undefined</div></pre></td></tr></table></figure>
<p>Property access for JS Object first converts the key to a string, but since Immutable Map keys can be of any type the argument to <code>get()</code> is not altered.<br>  Namely Immutable Map will treat ‘1’ and 1 differently.</p>
<h3 id="Converts-Back-to-Raw-JS-Obejcts"><a href="#Converts-Back-to-Raw-JS-Obejcts" class="headerlink" title="Converts Back to Raw JS Obejcts"></a>Converts Back to Raw JS Obejcts</h3><p>  All <strong>Immutable</strong> Iterable can be converted to plain JS Arrays and Objects shallowly with <code>toArray()</code> and <code>toObject()</code> or deeply with <code>toJS()</code>. All Immutable Iterables also implement <code>toJSON()</code> allowing them to be passed to <code>JSON.stringify()</code> directly.</p>
<p><code>var deep = Immutable.Map({a:1,b:2,c:Immutable.List.of(3,4,5)});
  deep.toObject() // {a:1,b:2,c:List [3,4,5]}
  deep.toArray() // [1,2,List [3,4,5]]
  deep.toJS() // {a:1,b:2,c:[3,4,5]}
  JSON.stringify(deep) // &#39;{&quot;a&quot;:1,&quot;b&quot;,&quot;c&quot;:[3,4,5]}&#39;</code></p>
<h3 id="Embraces-ES6"><a href="#Embraces-ES6" class="headerlink" title="Embraces ES6"></a>Embraces ES6</h3><p>  <code>Immutable</code> takes advantage of features added to JS ES6, the latest standard version of ECMAScript, including <code>Interators</code>,<code>Arrow Function</code>, <code>Classes</code>, and <code>Modules</code>.</p>
<h3 id="Nested-Structures"><a href="#Nested-Structures" class="headerlink" title="Nested Structures"></a>Nested Structures</h3><p>The collections in <code>immutable</code> are intended to be nested, allowing for deep trees of data, similar to JSON</p>
<p><code>var nested = Immutable.fromJS({a:{b:{c:[3,4,5]}}})
  // Map{ a: Map { b: Map { c: List [3,4,5]}}}</code><br>  A few power-tool allow for reading and operating on nested data. The most useful are <code>mergeDeep</code>, <code>getIn</code>, <code>setIn</code> and <code>updateIn</code> found on <code>List</code>, <code>Map</code> and <code>OrderedMap</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  var nested2 = nested.mergeDeep(&#123;a:&#123;b:&#123;d:6&#125;&#125;&#125;)</div><div class="line">  // Map &#123;a: Map &#123; b: &#123; c: List [3,4,5], d: 6&#125;&#125;&#125;</div><div class="line"></div><div class="line">nested2.getIn([&amp;#039;a&amp;#039;,&amp;#039;b&amp;#039;,&amp;#039;d&amp;#039;]); //6</div><div class="line"></div><div class="line">var nested3 = nested2.updateIn([&amp;#039;a&amp;#039;,&amp;#039;b&amp;#039;,&amp;#039;d&amp;#039;], value =&amp;gt; value + 1); d =&amp;gt; 7</div><div class="line"></div><div class="line">var nest4 = nested3.updateIn([&amp;#039;a&amp;#039;,&amp;#039;b&amp;#039;,&amp;#039;c&amp;#039;], list =&amp;gt; list.push(6)); c =&amp;gt; List [3,4,5,6]</div></pre></td></tr></table></figure>
<h3 id="Lazy-Seq"><a href="#Lazy-Seq" class="headerlink" title="Lazy Seq"></a>Lazy Seq</h3><p>  <strong>Seq</strong> describes a lazy operation, allowing them to efficiently chain use all the Iterable methods.(such as map and filter)</p>
<p><strong>Seq is immutable</strong> – Once a Seq is created it cannot be changed, appended to, rerranged or otherwise modified. Instead, any mutative method called on a Seq will return a new Seq.</p>
<p><strong>Seq is lazy</strong> – Seq does as little work as necessary to respond to any method call.</p>
<p>Once the Seq is used, it performs only the work necessary.</p>
<p>Any collection can be converted to a lazy Seq with <code>toSeq()</code>.</p>
<p><code>var seq = Immutable.Map({a:1,b:2,c:3}).toSeq();</code></p>
<p>Seq allow for the efficient chaining of sequence operations, especially when converting to a different concrete type(such as to a JS Object)</p>
<p><code>seq.flip().map(k =&amp;gt; k.toUpperCase()).flip().toObject();
  // Map {A: 1, B:2, C:3}</code></p>
<h3 id="Equality-treats-Collection-as-Data"><a href="#Equality-treats-Collection-as-Data" class="headerlink" title="Equality treats Collection as Data"></a>Equality treats Collection as Data</h3><p><strong>Immutable</strong> provides equality which treats immutable data structures as pure data, performing a deep equality check if necessary.</p>
<p><code>var map1 = Immutable.Map({a:1,b:1,c:1});
  var map2 = Immutable.Map({a:1,b:1,c:1});
  assert(map1 !== map2) // two different instance, not same address
  assert(Immutable.is(map1,map2)); // have equivalent values
  assert(map1.equals(map2)); // alternatively use the equals methods.</code></p>
<p><strong>Immutable.is()</strong> uses the same measure of equality as <strong>Object.is</strong> including if both are immutable and all keys and values are equal using the same measure of equality.</p>
<h3 id="Batching-Mutations"><a href="#Batching-Mutations" class="headerlink" title="Batching Mutations"></a>Batching Mutations</h3><p>  Applying a mutation to create a new immutable object results in some overhead, which can add up to a minor performance penalty. If you need to apply a series of mutations locally before returning, <strong>Immutable</strong> gives you the ability to create a temporary mutable(transient) copy of a collection and apply a batch of mutations in a performance manner by using <code>withMutations</code>. In fact, this is exactly how <code>Immutable</code> applies complex mutations itself.</p>
<p>As an example, building <code>list2</code> results in the creation of 1 , not 3, new immutable Lists<br>  <code>var list1 = Immutable.List.of(1,2,3);
  var list2 = list1.withMutations(function(list){
    list.push(4).push(5).push(6)
  });
  assert(list1.size === 3);
  assert(list2.size === 6);</code></p>
<p><strong>Note</strong>: <strong>Immutable</strong> also provides <code>asMutable</code> and <code>asImmutable</code>, but only encourages their use when <code>withMutations</code> will not suffice. Use caution to not return a mutable copy could result in undesired behavior.</p>
<p><strong>important</strong>: Only a select few method can be used in <code>withMutations</code> including <code>set</code>, <code>push</code>, <code>pop</code>. These methods can be applied directly against a persistent data-structure where other methods like <code>map</code>,<code>filter</code>,<code>sort</code>and <code>splice</code> will always return new immutable data-structure and never mutate a mutable collection.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
            <tag> Immutable </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[redux 搭配 react]]></title>
      <url>/2016/08/16/redux-e6-90-ad-e9-85-8d-react/</url>
      <content type="html"><![CDATA[<p>第一步是初始化 react 组件</p>
<pre><code>getInitialState(){
  return{
    item: store.getState()
  }
}
`&lt;/pre&gt;

第二步是在组件 render 后调用 subscribe 函数, 每次 redux 发生 dispatch 的时候都要调用 react 的 setState

&lt;pre&gt;`componentDidMount(){
  var unsubscribe = store.subscribe(this.onChange)
}
onChange(){
  this.setState({
    item: store.getState()
  })
}
</code></pre><p>React 会根据 State 的变化重新 render 组件<br>this.state.item.todos.map()</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redux </tag>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CommonChunks 插件]]></title>
      <url>/2016/08/16/commonchunks-e6-8f-92-e4-bb-b6/</url>
      <content type="html"><![CDATA[<p>作用就是提取代码中的公共模块, 然后将公共模块打包到一个独立的文件中, 以便在其他的入口和模块中使用.</p>
<pre><code>// in main.js
var a = require(&apos;./a&apos;);
a.sayHello();

var b = require(&apos;./b&apos;);
b.sayHello();

var c = require(&apos;./c&apos;);
c.sayHello()
`&lt;/pre&gt;

&lt;pre&gt;`// in main2.js
var a = require(&apos;./a&apos;);
a.sayHello();

var b = require(&apos;./b&apos;);
b.sayHello();
`&lt;/pre&gt;

a, b, c 和之前一样, 只有一个 sayHello 方法.

打包后看到`bundle.main.js` 和`bundle.main2.js` 中分别包含了 a, b, c 三个模块, 其中 a, b 是要使用`CommonChunksLoader` 提取出来的公共模块.

### 配置 CommonChunksLoader

&lt;pre&gt;`var webpack = require(&apos;webpack&apos;);
module.exports = {
  entry:{
    main1: &apos;./main&apos;,
    main2: &apos;./main2&apos;
  },
  output:{
    filename: &apos;bundle.[name].js&apos;
  },
  plugins:[
    new webpack.optimize.CommonsChunkPlugin(&apos;common.js&apos;,[&apos;main1&apos;,&apos;main2&apos;])
  ]
} ;
`&lt;/pre&gt;

第一行中, 添加 webpack 引用, 然后添加`plugins` 选项, 引用`webpack.optimize.CommonsChunkPlugin` 来提取公共模块, 参数`common.js` 表示公共模块的文件名, 后面的数组表示依赖这个模块的入口文件.

重新打包后, 生成三个文件

&lt;pre&gt;`bundle.main1.js,
bundle.main2.js
common.js
</code></pre><p>其中 <code>bundle.main1.js</code> 只包含了<code>c</code>模块, <code>bundle.main2.js</code>则没包含任何模块.</p>
<p>当然, 生成了<code>common.js</code> 还需要在 html 中进行引用, 而且要先于 main1, main2</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack 发布配置]]></title>
      <url>/2016/08/16/webpack-e5-8f-91-e5-b8-83-e9-85-8d-e7-bd-ae/</url>
      <content type="html"><![CDATA[<h3 id="单文件模式"><a href="#单文件模式" class="headerlink" title="单文件模式"></a>单文件模式</h3><pre><code>// 新建 webpack.production.config.js
// in package.json
&quot;deploy&quot;:&quot;NODE_EVN=production webpack -p -config webpack.production.config.js&quot;
// in web.production.config.js
// 和开发环境不同之处在于入口和出口. 相应的在 HTML 和 JS 源也要进行修改

var path = require(&apos;path&apos;)
var node_modules_dir = path.resolve(__dirname, &apos;node_modules&apos;)

module.exports = {
  entry:[
    &apos;babel-polyfill&apos;,
    path.resolve(__dirname, &apos;app/main.js&apos;)
  ],
  output:{
    path: path.resolve(__dirname, &apos;build&apos;),
    filename: &apos;app.js&apos;
  },
  module:{
    loaders:[
      {
        ...
      }
    ]
  }
}
`&lt;/pre&gt;

### 多文件模式

库最好不要打包, 因为一般库都不会改动, 所以 load 一次就够了.

对库进行分离

&lt;pre&gt;`// in webpack.production.config.js
var path = require(&apos;path&apos;)
var webpack = require(&apos;webpack&apos;)
var node_modules_dir = path.resolve(__dirname, &apos;node_modules&apos;)

module.exports = {
  entry:{
    app: [path.resolve(__dirname, &apos;app/main.js&apos;)],
    react: [&apos;babel-polyfill&apos;,&apos;react&apos;,&apos;react-dom&apos;]
  },
  output:{
    path: path.resolve(__dirname, &apos;build&apos;),
    filename: &apos;app.js&apos;
  },
  module:{
    loaders:[
      ...
    ]
  },
  plugins:[
    new webpack.optimize.CommonsChunkPlugin(&apos;react&apos;,&apos;react.js&apos;)
  ]
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack 配置 react/babel]]></title>
      <url>/2016/08/16/webpack-e9-85-8d-e7-bd-ae-reactbabel/</url>
      <content type="html"><![CDATA[<h3 id="安装-react"><a href="#安装-react" class="headerlink" title="安装 react"></a>安装 react</h3><pre><code>npm install --save react react-dom
`&lt;/pre&gt;

### 安装 babel-loader

&lt;pre&gt;`npm install --save-dev babel-loader babel-core babel-preset-es2015 babel-preset-react babel-preset-stage-2 
// 支持 ES2015, JSX, ES7
`&lt;/pre&gt;

&lt;pre&gt;`npm install --save polyfill
`&lt;/pre&gt;

&lt;pre&gt;`npm install --save babel-runtime
npm install --save-dev babel-plugin-transform-runtime
// 减少打包时候的重复代码
`&lt;/pre&gt;

### 配置 babel

&lt;pre&gt;`// 在入口添加 polyfill
entry:[
  &apos;babel-polyfill&apos;,
  &apos;webpack/hot/dev-server&apos;,
  &apos;webpack-dev-server/client?http://localhost:8080&apos;
]
`&lt;/pre&gt;

添加`.babalrc`

&lt;pre&gt;`{
  &quot;presets&quot;:[
    &quot;es2015&quot;,
    &quot;react&quot;,
    &quot;stage-2&quot;
  ],
  &quot;plugins&quot;:[
    &quot;transform-runtime&quot;
  ]
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack Dev Server]]></title>
      <url>/2016/08/15/webpack-dev-server/</url>
      <content type="html"><![CDATA[<p>The webpack-dev-server is a little node.js Express server, which uses the <code>webpack-dev-middleware</code> to serve a webpack bundle. It also has a little runtime which is connected to the server via <code>Socket.IO</code>.</p>
<p>Let’s say you have the following config file(<code>webpack.config.js</code>)</p>
<pre><code>var path = require(&apos;path&apos;);
module.exports = {
  entry:{
    app:[&apos;./app/main.js&apos;]
  },
  output:{
    path: path.resolve(__dirname, &apos;build&apos;),
    publicPath:&apos;/assets/&apos;,
    filename: &apos;bundle.js&apos;
  },
}
`&lt;/pre&gt;

You have an `app` folder with your initial entry point that webpack will bundle into a `bundle.js` file in the `build` folder.

### Content Base

The webpack-dev-server will serve the files in the **current directory**, unless you configure a specific content base.

&lt;pre&gt;`webpack-dev-server --content-base build/
`&lt;/pre&gt;

it will serve you `build` folder.

This modified bundle is served from memory at the relative path specified in `publicPath`. Namely your bundle will be available as `localhost:8080/assets/bundle.js`

### Automatic Refresh

The webpack-dev-server supports multiple modes to automatic refresh pages:
</code></pre><ul>
<li>Iframe mode(page is embedded in an iframe and reload on change)</li>
<li><p>Inline mode(as a small webpack-dev-server client entry is added to the bundle which refresh the page on change)</p>
<h4 id="Inline-Mode"><a href="#Inline-Mode" class="headerlink" title="Inline Mode"></a>Inline Mode</h4><p>To use the inline mode, specify <code>--inline</code> on the command line(you cannot specify it in configuration).</p>
<h3 id="配置-webpack-dev-server-自动刷新"><a href="#配置-webpack-dev-server-自动刷新" class="headerlink" title="配置 webpack-dev-server 自动刷新"></a>配置 webpack-dev-server 自动刷新</h3><pre>`// webpack.config.js
entry: [
    'webpack/hot/dev-server',
    'webpack-dev-server/client?http://localhost:8080',
    path.resolve(__dirname, 'app/main.js')
  ],
  devServer:{
    historyApiFallback: true,
    hot:true,
    inline:true,
    progress: true
  }
`</pre>

<p><pre>`//package.json</pre></p>
</li>
</ul>
<p>“dev”: “webpack-dev-server –progress –colors –inline –hot –content-base build/“,<br>    “build”: “webpack”<br>```</p>
<p>此时访问 localhost:8080 相当于访问 build/, 所以可以省略 index.html</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React Ajax]]></title>
      <url>/2016/08/02/react-ajax/</url>
      <content type="html"><![CDATA[<p>组件的数据来源, 通常是通过 AJAX 请求从服务器获取, 可以使用 <code>componentDidMount</code> 方法设置 AJAX 请求, 等到请求成功, 再用<code>this.setState()</code>方法重新渲染 UI.</p>
<pre><code>var UserGist = React.createClass({
  getInitialState(){
    return {
      userName: &apos;&apos;,
      lastGistUrl: &apos;&apos;
    }
  },

  componentDidMounted(){
    $.get(this.props.source, function(result){
      var lastGist = result[0];
      if(this.isMouted()){
        this.setState({
          userName: lastGist.owner.login,
          lastGistUrl: lastGist.html_url
        });
      }
    }.bind(this));
  },

  render(){
    return (
      &amp;lt;div&amp;gt;
        {this.state.userName}&apos;s last Gist is 
        &amp;lt;a href={this.state.lastGistUrl}&amp;gt;here&amp;lt;/a&amp;gt;
      &amp;lt;/div&amp;gt;
    );
  }
});

React.render(
  &amp;lt;UserGist source= &apos;....&apos; /&amp;gt;, document.body
)
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React 表单]]></title>
      <url>/2016/08/02/react-e8-a1-a8-e5-8d-95/</url>
      <content type="html"><![CDATA[<p>用户在表单输入的内容, 属于用户与组件的互动, 要用<code>this.setState()</code>修改</p>
<pre><code>var Input = React.cr而奥特Class({
  getInitialState(){
    return {
      value: &apos;Hello&apos;
    };
  },

  handleChange(event){
    this.setState({
      value: event.target.value;
    })
  },

  render(){
    return(
      &amp;lt;div&amp;gt;&amp;lt;input type=&apos;text&apos; onChange={this.handleChange} value = {this.state.value} /&amp;gt;&amp;lt;p&amp;gt;{this.state.value}&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;
    );
  }
});

ReactDOM.render(
  &amp;lt;Input /&amp;gt;, document.body
);
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[PropTypes 与 getDefaultProps]]></title>
      <url>/2016/08/02/proptypes-e4-b8-8e-getdefaultprops/</url>
      <content type="html"><![CDATA[<p>组件的属性可以接受任意值. 有时候我们需要一种机制, 验证别人使用组件时, 提供的参数是否符合要求.</p>
<p>组件类的 PropTypes 属性, 就是用来验证组件实例的属性是否符合要求的.</p>
<pre><code>var MyTitle = React.createClass({
  propTypes: {
    title: React.PropTypes.string.isRequried,
  },

  render() {
    return &amp;lt;h1&amp;gt; {this.props.title} &amp;lt;/h1&amp;gt;;
  }
});
`&lt;/pre&gt;

上面的 `MyTitle` 组件有一个 `title` 属性, `PropTypes` 告诉 React, 这个 `title` 属性是必须的, 而且数据类型是字符串.

如果在实例化的时候设置 `title=123`, 控制台会显示一行错误信息

&lt;pre&gt;`Warning: Failed propType: Invalid prop `title` of type `number` supplied to `MyTitle`, expected `string`.
`&lt;/pre&gt;

此外, `getDefaultProps` 可以用来设置组件属性的默认值

&lt;pre&gt;`var MyTitle = React.createClass({
  getDefaultProps() {
    return {
      title: &apos;Hello World&apos;
    };
  },

  render(){
    return &amp;lt;h1&amp;gt;{this.props.title}&amp;lt;/h1&amp;gt;;
  }
})

ReactDOM.render(&amp;lt;MyTitle /&amp;gt;, document.body); // &apos;Hello World&apos;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[跨域资源共享 CORS]]></title>
      <url>/2016/08/02/e8-b7-a8-e5-9f-9f-e8-b5-84-e6-ba-90-e5-85-b1-e4-ba-ab-cors/</url>
      <content type="html"><![CDATA[<p>CORS 是一个 W3C 标准, 全称是”跨域资源共享”(cross-origin resource sharing)</p>
<p>他允许浏览器向跨域服务器发出 <code>XMLHttpRequest</code>, 从而克服了 AJAX 只能同源使用的限制</p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>CORS 需要浏览器和服务器同时支持. 目前所有浏览器都支持该功能, IE 浏览器不能低于 IE10.</p>
<p>整个 CORS 通信过程, 都是浏览器自动完成, 不需要用户参与, 对于开发者而言, CORS 通信与同源的 AJAX 通信没有差别, 代码完全一样. 浏览器一旦发现 AJAX 跨域请求, 就会自动添加一些附加的头信息. 有时还会多出一次附加的请求, 但是用户不会有感觉.</p>
<p>因此, 实现 CORS 的关键是服务器, 只要服务器实现了 CORS 接口, 就可以跨域通信</p>
<h3 id="两种请求"><a href="#两种请求" class="headerlink" title="两种请求"></a>两种请求</h3><p>CORS 请求分两类: 简单请求(simple request)和非简单请求(not-so-simple request)</p>
<p>只要同时满足以下两大条件, 就属于简单请求:</p>
<ol>
<li>请求方法是: HEAD, GET 或者 POST</li>
<li>HTTP 头信息不超出以下几种字段: Accept, Accept-Language, Content-Language, Last-Event-ID, Content-Type(只限于三个值: application/x-www-form-urlencoded, multipart/form-data, text/plain)</li>
</ol>
<p>凡是不能同时满足上面两个条件的, 就属于非简单请求.</p>
<h3 id="简单请求"><a href="#简单请求" class="headerlink" title="简单请求"></a>简单请求</h3><h4 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h4><p>对于简单请求, 浏览器直接发出 CORS 请求, 具体来说, 就是在头信息中增加一个<code>Origin</code>字段</p>
<pre><code>GET /cors HTTP/1.1
Origin: http://api.bob.com
Host: api.alice.com
Accept-Language: en-US
Connection: keep-alive
User-Agent: Mozilla/5.0...
`&lt;/pre&gt;

上面的头信息中, `Origin`字段用来说明, 本次请求来此哪个源(协议+域名+端口), 服务器根据这个值, 决定是否同意此次请求.

如果`Origin`指定的源, 不在许可范围内, 服务器会返回一个正常的 HTTP 响应. **浏览器**发现这个回应的头信息中没有包含`Access-Control-Allow-Origin`字段, 就知道出错了, 从而抛出一个错误, 被`XMLHttpRequest`的`onerror`回调函数捕获. 注意, 这种错误无法通过状态码识别, 因为 HTTP 回应的状态码可能是200.

如果`Origin`指定的域名在许可范围内, 服务器返回的相应, 会多出几个头信息字段

&lt;pre&gt;`Access-Control-Allow-Origin: http://api.bob.com
Access-Control-Allow-Credentials: true
Access-Control-Expose-Headers: FooBar
Content-Type: text/html; charset=utf-8
`&lt;/pre&gt;

上面的头信息中, 有三个与 CORS 请求相关的字段, 都以 `Access-Control-` 开头

##### Access-Control-Allow-Origin

这个字段是必须的, 他的值要么是请求时 `Origin` 的值, 要么是一个 `*`, 表示接收任意域名的请求

##### Access-Control-Allow-Credentials

该字段是可选的, 是一个布尔值, 表示是否允许发送 Cookie. 默认情况下, Cookie 不包括在 CORS 请求之中.

设为 `true` 表示服务器明确许可, Cookie 可以包括在请求之中, 一起发给服务器

这个值也只能设为`true`, 如果服务器不需要浏览器发送 Cookie, 删除字段即可

##### Access-Control-Expose-Headers

该字段可选, CORS 请求时, `XMLHttpRequest` 对象的 `getResponseHeader()` 方法只能拿到6个基本字段
- Cache-Control
- Content-Language
- Content-Type
- Expires
- Last-Modified
-Pragma

如果想要拿到其他字段, 必须在 `Access-Control-Expose-Headers` 里面指定

上面的例子中, `getResponseHeader(&apos;FooBar&apos;)` 可以返回 `FooBar` 字段的值

#### withCredentials 属性

CORS 请求默认不发送 Cookie 和 HTTP 认证信息, 如果要把 Cookie 发送给服务器, 一方面要服务器同意, 指定 `Access-Control-Allow-Credentials` 字段

&lt;pre&gt;`Access-Control-Allow-Credientials: true
`&lt;/pre&gt;

另一方面, 开发者需要在 AJAX 请求中打开`withCredientials`属性

&lt;pre&gt;`var xhr = new XMLHttpRequest();
xhr.withCredientials = true;
`&lt;/pre&gt;

否则即使服务器同意发送 Cookie, 浏览器也不会发送

要注意, 如果要发送 Cookie, `Access-Control-Allow-Origin` 不能设置为 `*`, 必须指定明确的, 与请求网页一致的域名. 同时 Cookie 依然遵循同源政策, 只有用服务器域名设置的 Cookie 才会上传, 其他域名的 Cookie 不会上传.

### 非简单请求

#### 预检请求

非简单请求是那种对服务器有特殊要求的请求, 比如请求方法是 `PUT`, 或 `DELETE`, 或者 `Content-Type` 字段类型是 `application/json`

非简单请求的 CORS 请求, 会在正是通信钱, 增加一次 HTTP 查询请求, 称为 &quot;预检请求&quot; (preflight)

浏览器先询问服务器, 当前网页所在的域名是否在服务器的许可名单中, 以及可以使用哪些 HTTP 动词和头信息字段, 只有得到肯定的答复, 浏览器才会发出正式的 `XMLHttpRequest` 请求, 否则就报错

下面是一段浏览器的 JavaScript 脚本

&lt;pre&gt;`var url = &apos;http://api.alice.com/cors&apos;
var xhr = new XMLHttpRequest();
xhr.open(&apos;PUT&apos;, url, true);
xhr.setRequestHeader(&apos;X-Custom-Header&apos;, &apos;value&apos;);
xhr.send()
`&lt;/pre&gt;

上面代码中, HTTP 请求的方法是 `PUT`, 并且发送一个自定义头信息 `X-Custom-Header`

浏览器发现这是一个非简单请求, 就自动发出一个 &quot;预检&quot; 请求, 要求服务器确认可以这样请求. 下面是这个 &quot;预检&quot; 请求的 HTTP 头信息

&lt;pre&gt;`OPTIONS /cors HTTP/1.1
Origin: http://api.bob.com
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: X-Custom-Header
Host: api.alice.com
Connection: keep-alive
User-Agent: Molliza/5.0...
`&lt;/pre&gt;

&quot;预检&quot; 请求用的请求方法是 `OPTIONS`, 表示这个请求是用来询问的, 头信息里面, 关键字段是 `Origin`, &quot;预检&quot; 秦秋的头信息包括两个特殊字段
- Access-Control-Request-Method
  这个字段是必须的, 用来列出请求方法
</code></pre><ul>
<li><p>Access-Control-Request-Headers<br>该字段是一个逗号分隔的字符串, 永安里指定浏览器 CORS 请求会格外发送的头信息字段</p>
<h5 id="预检请求的响应"><a href="#预检请求的响应" class="headerlink" title="预检请求的响应"></a>预检请求的响应</h5><p>服务器取得”预检”请求后, 检查<code>Origin</code>, <code>Access-Control-Request-Method</code> 和 <code>Access-Control-Request-Header</code> 子弹后, 确认允许跨源请求, 就可以做出回应</p>
<pre>`HTTP/1.1 200 OK
Date: Mon, 01 Dec 2008 01:15:39 GMT
Server: Apache/2.0.61 (Unix)
Access-Control-Allow-Origin: http://api.bob.com
Access-Control-Allow-Methods: GET, POST, PUT
Access-Control-Allow-Headers: X-Custom-Header
Content-Type: text/html; charset=utf-8
Content-Encoding: gzip
Content-Length: 0
Keep-Alive: timeout=2, max=100
Connection: Keep-Alive
Content-Type: text/plain
`</pre>

<p>上面 HTTP 响应中, 关键的是 <code>Access-Control-Allow-Origin</code> 字段, 表示 <code>http://api.bob.com</code> 可以请求数据, 该字段也可以设置为<code>*</code>, 表示同意跨源请求.</p>
<p>如果浏览器否定了”预检”请求, 返回一个正常的 HTTP 响应, 但是没有任何 CORS 相关的头信息字段, 这时候浏览器会认为服务器不同意预检请求, 从而触发一个错误, 被 <code>XMLHttpRequest</code> 对象的 <code>onerror</code> 回调函数捕获, 控制台会打印如下报错信息</p>
<pre>`XMLHttpRequest cannot load http://api.alice.com.
Origin http://api.bob.com is not allowed by Access-Control-Allow-Origin.
`</pre>

<p>服务器回应其他 CORES 相关字段如下:</p>
<pre>`Access-Control-Allow-Methods: GET, POST, PUT
Access-Control-Allow-Headers: X-Custom-Header
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 1728000
`</pre>

<h5 id="Access-Control-Allow-Method"><a href="#Access-Control-Allow-Method" class="headerlink" title="Access-Control-Allow-Method"></a>Access-Control-Allow-Method</h5><p>该字段是必须的, 他的值是逗号分隔的一个字符串, 表明服务器支持的跨域请求方式</p>
<h5 id="Access-Control-Allow-Headers"><a href="#Access-Control-Allow-Headers" class="headerlink" title="Access-Control-Allow-Headers"></a>Access-Control-Allow-Headers</h5><p>如果浏览器包含<code>Access-Control-Request-Headers</code>, 则 <code>Access-Control-Allow-Headers</code> 也是必须的, 其值也是一个逗号分隔的字符串</p>
<h5 id="Access-Control-Allow-Credentials"><a href="#Access-Control-Allow-Credentials" class="headerlink" title="Access-Control-Allow-Credentials"></a>Access-Control-Allow-Credentials</h5><p>该字段与简单请求时的含义相同</p>
<h5 id="Access-Control-Max-Age"><a href="#Access-Control-Max-Age" class="headerlink" title="Access-Control-Max-Age"></a>Access-Control-Max-Age</h5><p>该字段可选, 永安里指定本次预检请求的有效期(s), 有效期内发起跨域请求不需要预检请求.</p>
<h4 id="浏览器的正常请求与回应"><a href="#浏览器的正常请求与回应" class="headerlink" title="浏览器的正常请求与回应"></a>浏览器的正常请求与回应</h4><p>一旦服务器通过”预检”请求, 以后每次浏览器正常的 CORS 请求, 都会和简单请求一样, 有一个<code>Origin</code> 头信息字段, 服务器的回应也会有一个<code>Access-Control-Allow-Origin</code>头信息字段</p>
<p>“预检”请求之后, 浏览器的正常 CORS 请求</p>
<pre>`PUT /cors HTTP/1.1
Origin: http://api.bob.com
Host: api.alice.com
X-Custom-Header: value
Access-Language: en-US
Connection: keep-alive
User-Agent: Mozilla/5.0...
`</pre>

<p>其中<code>Origin</code>字段是浏览器自动添加的</p>
<p>服务器的正常回应</p>
<p><pre>`Access-Control-Allow-Origin: <a href="http://api.bob.com" target="_blank" rel="external">http://api.bob.com</a><br>Content-Type: text/html; charset=utf-8</pre></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> AJAX </tag>
            
            <tag> CORS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[浏览器同源政策及其规避方法]]></title>
      <url>/2016/08/02/e6-b5-8f-e8-a7-88-e5-99-a8-e5-90-8c-e6-ba-90-e6-94-bf-e7-ad-96-e5-8f-8a-e5-85-b6-e8-a7-84-e9-81-bf-e6-96-b9-e6-b3-95/</url>
      <content type="html"><![CDATA[<p>浏览器安全的基石是”同源政策”(same-origin policy).</p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>所谓”同源”, 是指三个”相同”.</p>
<ul>
<li>协议相同: <code>http:\\</code></li>
<li>域名相同: <code>www.example.com</code> 与 <code>example.com</code> 不同</li>
<li>端口相同</li>
</ul>
<h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><p>同源政策的目的是为了保证用户信息安全, 防止恶意的网络窃取数据</p>
<h3 id="限制范围"><a href="#限制范围" class="headerlink" title="限制范围"></a>限制范围</h3><p>如果非同源, 共有三种行为受到限制</p>
<ul>
<li>Cookie, LocalStorage 和 IndexDB 无法读取</li>
<li>DOM 无法获得</li>
<li>AJAX 请求无法发送</li>
</ul>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>Cookie 是服务器写入浏览器的一小段信息, 只有同源的网站才能共享. 但是两个网页一级域名相同, 只有二级域名不同, 浏览器允许通过设置 <code>document.domain</code> 共享 Cookie.</p>
<p>举例来说, A 网页是 <code>http://w1.example.com/a.html</code>, B 网页是 <code>http://w2.example.com/b.html</code>, 那么只要设置相同的 <code>document.domain</code>, 这两个网页可以共享 Cookie.</p>
<pre><code>document.domain = &apos;example.com&apos;;
`&lt;/pre&gt;

现在 A 网页通过脚本设置一个 Cookie

&lt;pre&gt;`document.cookie = &apos;test1=hello&apos;;
`&lt;/pre&gt;

B 网页就可以读取这个 Cookie

&lt;pre&gt;`var allCookie = document.cookie;
`&lt;/pre&gt;

注意, 这种方法只适用于 Cookie 和 iframe 窗口, LocalStorage 和 IndexDB 无法通过这种方法, 规避同源政策.

另外, 服务器也可以在设置 Cookie 的时候指定 Cookie 所属域名为一级域名, 比如 `.example.com`

&lt;pre&gt;`Set-Cookie: key=value; domain=.example.com; path=/
`&lt;/pre&gt;

这样的话, 二级域名和三级域名不用做任何设置就可以读取这个 Cookie

### iframe

如果两个网页不同源, 就无法拿到对方的 DOM, 典型的例子就是`iframe`窗口和`window.open` 方法打开的窗口, 他们与父窗口无法通信.

如果两个窗口一级域名相同, 只是二级域名不同, 那么设置`document.domain`也可以规避同源政策, 实现 DOM 获取.

### 完全不同源的网站

#### 片段识别符(fragment identifier)

片段识别符值得是 URL 中`#` 后的部分, 也就是 hash.

如果只是改变片段识别符, 页面不会重新刷新

父窗口可以把信息写入子窗口的片段识别符

&lt;pre&gt;`var src = originURL + &apos;#&apos; + data;
document.getElementById(&apos;myFrame&apos;).src = src;
`&lt;/pre&gt;

子窗口通过监听 `hashchange` 事件得到通知

&lt;pre&gt;`window.onhashchange = checkMessage;

function checkMessage(){
  var message = window.location.hash;
  // ...
}
`&lt;/pre&gt;

同样子窗口也可以改变父窗口的片段识别符

&lt;pre&gt;`parent.location.href = target + &quot;#&quot; + hash;
`&lt;/pre&gt;

#### window.name

浏览器窗口有 `window.name` 属性, 这个属性的最大特点是, 无论是否同源, 只要在同一个窗口里, 前一个网页设置这个属性后, 后一个网页可以读取他

父窗口先打开一个子窗口, 载入一个不同源的网站, 该网页将写入 `widnow.name` 属性

&lt;pre&gt;`window.name = data;
`&lt;/pre&gt;

接着, 子窗口跳回一个与主窗口同域的网址

&lt;pre&gt;`location = &apos;http:parent.url.com/xxx.html&apos;
`&lt;/pre&gt;

然后主窗口就可以读取子窗口的 `window.name` 属性了

&lt;pre&gt;`var data = document.getElementById(&apos;myFrame&apos;).contentWindow.name;
`&lt;/pre&gt;

这种方法的优点是 `window.name` 容量大, 缺点是必须监听子窗口的 `window.name` 属性的变化, 影响性能.

#### window.postMessage

以上信息都属于破解, HTML5 为了解决这个问题, 引入一个全新的 API: 跨文档通信 API(Cross-document messaging)

这个 API 为 `window` 对象新增一个 `window.postMessage` 方法, 允许跨窗口通信, 不论两个窗口是否同源.

举例来说, 父窗口 `http://aaa.com` 向子窗口 `http://bbb.com` 发消息, 调用 `postMessage` 方法就可以了

&lt;pre&gt;`var popup = window.open(&apos;http://bbb.com&apos;, &apos;title&apos;);
popup.postMessage(&apos;Hello World&apos;, &apos;http://bbb.com&apos;);
`&lt;/pre&gt;

`postMessage` 方法的第一个参数是要传递的 Message, 第二个参数是接受信息的窗口的源(origin), 即`协议+域名+端口`, 也可以设置为`*`, 表示不限制域名, 向所有窗口发送.

子窗口向父窗口发送消息的写法类似

&lt;pre&gt;`window.opener.postMessage(&apos;Hello World&apos;, &apos;http://aaa.com&apos;);
`&lt;/pre&gt;

通过`message`事件监听对象消息

&lt;pre&gt;`window.addEventListener(&apos;message&apos;, function(e){
console.log(e.data);
}, false);
`&lt;/pre&gt;

`message` 事件的事件对象 `event` , 提供一下三个属性
</code></pre><ul>
<li><code>event.source</code>: 发送信息的窗口, 子窗口通过 <code>event.source</code> 引用父窗口然后发送消息<pre>`window.addEventListener('message', receiveMessage);
function receiveMessage(event){
event.source.postMessage('Hello Opener', '*');
}
`</pre></li>
<li>‘event.origin’: 发送信息的网址(‘<a href="http://aaa.com" target="_blank" rel="external">http://aaa.com</a>‘), 可以过滤不是指定来源的信息<pre>`window.addEventListener('message', receiveMessage);
function receiveMessage(event){
if (event.origin != 'http://aaa.com') return;
if (event.data === 'Hello World') {
  event.source.postMessage('Hello', event.origin);
} else {
  console.log(event.data);
}
}
`</pre></li>
<li><p>‘event.data’: 信息内容</p><p></p>
<h4 id="LocalStorage"><a href="#LocalStorage" class="headerlink" title="LocalStorage"></a>LocalStorage</h4><p></p><p>通过 <code>window.postMessage</code> 读写其他窗口的 <code>LocalStorage</code> 也是可能的</p>
<p>例: 主窗口写入 <code>iframe</code> 子窗口的 <code>localStorage</code></p>
<pre>`window.onmessage = function(event){
  if(event.origin !== 'http://bbb.com') return;
  var payload = JSON.parse(event.data);
  localStorage.setItem(payload.key, JSON.stringify(payload.data));
};
`</pre>

<p>上面代码中, 子窗口将父窗口发送的消息写入自己的 <code>localStorage</code></p>
<p>父窗口发送消息的代码如下:</p>
<pre>`var win = document.getElementByTagName('iframe')[0].contentWindow;
var obj = { name: 'Jack' };
win.postMessage(JSON.stringify({key: 'storage', data: obj}), 'http://bbb.com');
`</pre>

<p>加强版子窗口接收消息的代码</p>
<pre>`window.onmessage = function(e) {
  if (e.origin !== 'http://bbb.com') return;
  var payload = JSON.parse(e.data);
  switch(payload.method) {
    case 'set': localStorage.setItem(payload.key, JSON.stringify(parload.data));
                break;
    case 'get': var parent = window.parent;
                var data = localStorage.getItem(payload.key);
                parent.postMessage(data, 'http://aaa.com');
                break;
    case 'remove': localStorage.removeItem(payload.key);
                   break;
  }
};
`</pre>

<p>加强版的父窗口消息发送代码</p>
<pre>`var win = document.getElementByTagName('iframe')[0].contentWindow;
var obj = { name: 'Jack' };
// 存入对象
win.postMessage(JSON.stringify(key: 'storage', method: 'set', data: obj), 'http://bbb.com');
// 读取对象
win.postMessage(JSON.stringify(key: 'storage', method: 'get',), '*');
window.onmessage = function(e){
  if(e.origin !== 'http://bbb.com') return;
  // 'Jack'
  console.log(JSON.parse(e.data).name);
};
`</pre>

<h3 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h3><p>同源政策规定, AJAX 请求只能发给同源的网址, 否则会报错</p>
<p>除了假设服务器代理, 有三中方法规避这个限制</p>
<h4 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h4><p>JSONP 是服务器与客户端跨源通信的常用方法, 最大特点是简单实用, 老式浏览器全部支持, 服务器改造非常小.</p>
<p>基本思想是, 网页通过添加一个<code>&amp;lt;script&amp;gt;</code>元素, 向服务器请求 JSON 数据,在何种做法不受同源政策限制. 服务器接收请求后, 将数据放在一个指定名字的回调函数里传回来.</p>
<p>首先, 网页动态插入<code>&amp;lt;script&amp;gt;</code>元素, 由它向跨源网址发出请求.</p>
<pre>`function addScriptTag(src) {
  var script = document.createElement('script');
  script.setAttribute('type', 'text/javascript');
  script.src = src;
  document.body.appendChild(script);
}
window.onload = function(){
  addScritpTag('http://example.com/ip?callback=foo');
}

function foo(data){
  console.log("Your public IP address is: " + data.ip);
};
`</pre>

<p>上面的代码通过动态添加<code>&amp;lt;script&amp;gt;</code>元素, 向服务器<code>example.com</code>发出请求. 注意, 该请求的查询字符串有一个<code>callback</code> 参数, 用来指定回调函数的名字, 这对 JSONP 是必须的.</p>
<p>服务器接收到这个请求后, 会将数据放在回调函数的参数位置返回.</p>
<pre>`foo({
  'ip': '8.8.8.8'
});
`</pre>

<p>由于<code>&amp;lt;script&amp;gt;</code>元素请求的脚本, 直接作为代码运行, 这时只要浏览器定义了<code>foo</code>函数, 该函数就会立即调用. 作为参数的 JSON 数据会被视为 JavaScript 对象, 而不是字符串, 因此避免了使用<code>JSON.parse</code>的步骤</p>
<h4 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h4><p>WebSocket 是一种通信协议, 使用<code>ws://</code>(非加密)和<code>wss://</code>(加密)作为协议前缀.</p>
<p>该协议不实行同源政策, 只要服务器支持, 就可以与他进行夸源通信.</p>
<p>下面是一个例子, 浏览器发出的 WebSocket 请求的头信息:</p>
<p><pre>`GET /chat HTTP/1.1<br>Host: server.example.com<br>Upgrade: websocket<br>Connection: Upgrade<br>Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==<br>Sec-WebSocket-Protocol: chat, superchat<br>Sec-WebSocket-Version: 13<br>Origin: <a href="http://example.com" target="_blank" rel="external">http://example.com</a></pre></p>
</li>
</ul>
<p>上面代码中, 有一个字段是<code>Origin</code>, 表示该请求的请求源(origin)</p>
<p>正式因为有了<code>Origin</code>这个字段, 所以 WebSocket 才没有实行同源政策, 因为服务器可以根据这个字段判断是否许可此次通信</p>
<h4 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h4><p>CORS 是跨源资源分享(Corss-Origin Resource Sharing) 的缩写, 是 W3C 标准, 是跨源 AJAX 请求的根本解决办法. 相比 JSONP 只能发<code>GET</code>请求, CORS 允许任何类型的请求.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> AJAX </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Node.js URL 模块的使用]]></title>
      <url>/2016/08/01/node-js-url-e6-a8-a1-e5-9d-97-e7-9a-84-e4-bd-bf-e7-94-a8/</url>
      <content type="html"><![CDATA[<p>Node.js 中的 URL 模块, 用于将 URL 字符串解析为对象或将对象格式化为 URL 字符串, 该模块比较简单, 共包括3个方法:</p>
<h3 id="URL-各部分说明"><a href="#URL-各部分说明" class="headerlink" title="URL 各部分说明"></a>URL 各部分说明</h3><p>对于一个 URL 字符串, 其组成部分会有所不同. 其中有些部分只有在 URL 字符串中存在时, 对应字段还才会出现在解析后的对象中. 以下是一个 URL 例子</p>
<pre><code>http://user:pass@host.com:8080/path/to/file?query=string#hash
`&lt;/pre&gt;

解析后的字段如下:
- `href`: 解析前的完整原始 URL, 协议名和主机名已经转为小写
- `protocol`: 请求协议, 小写, 例如`http:`
- `slashes`: 协议的`:`后面是否有`\`, 返回`true`或`false`
- `host`: URL 主机名, 包括端口信息, 小写, 例如`host.com:8080`
- `auth`: URL 中的认证信息, 例如`user:pass`
- `hostname`: 主机名, 小写, 例如`host.com`
- `port`: 主机的端口号, 例如`8080`
- `pathname`: URL 中的路径, 例如`/path/to/file`
- `search`: 查询对象, 即: `queryString`, 包括之前的`?`, 例如`?query=string`; 如果 `parseQueryString = true`, 则返回`{&apos;query&apos;:&apos;string&apos;}`
- `query`: 例如`query=string`
- `hash`: 锚点部分, 即`#`之后的部分, 例如`#hash`

### 将 URL 字符串转换为对象: url.parse(urlStr[, parseQueryString[, slashesDenoteHost]])

`url.parse()`方法用于解析 URL 对象, 解析后范湖第一个 JSON 对象. 例如:

&lt;pre&gt;`&amp;gt; var url = &apos;http://user:pass@host.com:8080/path/to/file?query=string#hash&apos;
undefined
&amp;gt; url
&apos;http://user:pass@host.com:8080/path/to/file?query=string#hash&apos;
&amp;gt; var urlModule = require(&apos;url&apos;);
undefined
&amp;gt; urlModule.parse(url)
Url {
  protocol: &apos;http:&apos;,
  slashes: true,
  auth: &apos;user:pass&apos;,
  host: &apos;host.com:8080&apos;,
  port: &apos;8080&apos;,
  hostname: &apos;host.com&apos;,
  hash: &apos;#hash&apos;,
  search: &apos;?query=string&apos;,
  query: &apos;query=string&apos;,
  pathname: &apos;/path/to/file&apos;,
  path: &apos;/path/to/file?query=string&apos;,
  href: &apos;http://user:pass@host.com:8080/path/to/file?query=string#hash&apos; }
`&lt;/pre&gt;

第二个可选参数设置为`true`的时候, 会使用`queryString`模块来解析 URL 中的`query` 部分, 默认为`false`.

第三个参数为`true`的时候, 会把诸如`//foo/bar`这样的 URL 解析为 `{host: &apos;foo&apos;, pathname: &apos;/bar&apos;}`, 而不是 `{pathname: &apos;//foo/bar&apos;}`. 默认为`false`

### 将对象格式化为 URL 字符串: url.format(urlObj)

`url.resolve()`用于格式化URL对象, 输入一个 URL 对象, 返回格式化后的 URL 字符串, 例如:

&lt;pre&gt;`&amp;gt; var url = require(&apos;url&apos;);
undefined
&amp;gt; var urlObj = {
... protocol: &apos;http:&apos;,
... slashes: true,
... hostname: &apos;host.com&apos;,
... port: 8080,
... hash: &apos;#hash&apos;,
... search: &apos;?query=string&apos;,
... pathname: &apos;/path/to/file&apos;
... }
undefined
&amp;gt; var result = url.format(urlObj)
undefined
&amp;gt; result
&apos;http://host.com:8080/path/to/file?query=string#hash&apos;
`&lt;/pre&gt;

### URL 路径处理

`url.resolve()`方法用于处理 URL 路径, 也可以用于处理锚点. 例如

&lt;pre&gt;`url.resolve(&apos;/one/two/three&apos;, &apos;four&apos;)         // &apos;/one/two/four&apos;
url.resolve(&apos;http://example.com/&apos;, &apos;/one&apos;)    // &apos;http://example.com/one&apos;
url.resolve(&apos;http://example.com/one&apos;, &apos;/two&apos;) // &apos;http://example.com/two&apos;
</code></pre><p>参数拼接, 如果之间没有<code>/</code>, 则参数二替换参数一末尾的文件名.</p>
<p>注意区分路径和文件名.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Node.js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Promise in ES6]]></title>
      <url>/2016/07/31/promise-in-es6/</url>
      <content type="html"><![CDATA[<p>在 JavaScript 世界中, 所有代码都是单线程执行的</p>
<p>异步执行可以可以用回调函数实现</p>
<pre><code>function callback() {
  console.log(&apos;Done&apos;);
}
console.log(&apos;before setTimeout()&apos;);
setTimeout(callback, 1000);
console.log(&apos;after setTimeout()&apos;);
`&lt;/pre&gt;

先看一个简单的 Promise 例子: 生成0-2之间的随机数, 如果小于1, 则等待一段时间后返回成功, 否则返回失败

&lt;pre&gt;`function test(resolve, reject){
  var timeOut = Math.random() * 2;
  log(&apos;set timeout to: &apos; + timeOut + &apos; seconds.&apos;);
  setTimeout(function(){
    if(timeOut &amp;lt; 1) {
      log(&apos;call resolve()...&apos;);
      resolve(&apos;200 ok&apos;);
    } else {
      log(&apos;call reject()...&apos;);
      reject(&apos;timeout in &apos; + timeOut + &apos; seconds&apos;);
    }
  }, timeOut * 1000)
}
`&lt;/pre&gt;

这个`test()`函数有两个参数, 这两个参数都是函数, 如果执行成功, 我们将调用`resolve(&apos;200 ok)&apos;`, 如果执行失败, 我们将调用`reject(&apos;timeout in &apos; + timeOut + &apos; seconds.&apos;)`. 可以看出, `test()`函数只关心自己的逻辑, 并不关心具体的`resolve` 和`reject` 将如何处理.

有了执行函数, 我们就可以用一个 Promise 对象来执行他, 并在将来某个时刻获得成功或失败的结果

&lt;pre&gt;`var p1 = new Promsie(test);
var p2 = p1.then(function(result){
  console.log(&apos;成功: &apos; + result);
});
var p3 = p2.catch(function(err){
  console.log(&apos;失败: &apos; + err);
});
`&lt;/pre&gt;

变量`p1`是一个 Promise 对象, 他负责执行执行`test`函数, 由于`test`函数在内部是异步执行的, 当`test`函数执行到`resolve(&apos;ok 200&apos;)`时, 告诉 Promsie 对象执行

&lt;pre&gt;`.then(function(result){ // result 是通过 test 传递给 resolve 的参数
  console.log(&apos;成功: &apos; + result);
});
`&lt;/pre&gt;

当`test`执行到`reject`的时候, 告诉 Promise 对象执行

&lt;pre&gt;`.catch(function(err){ // err 是 test 传递给 reject 的参数
  console.log(&apos;失败: &apos;+ err);
});
`&lt;/pre&gt;

Promise 对象可以串联起来(因为都返回一个 Promise 对象)

&lt;pre&gt;`new Promise(test).then(function(result){console.log(result)}).catch(function(err){console.log(err)});
`&lt;/pre&gt;

可见, Promise 最大的好处, 是在异步执行的流程中, 把执行代码和处理结果代码清晰地分离了.

Promise 还可以做更多的事情, 比如有若干个异步任务, 需要先做任务1, 如果成功后再做任务2, 任何任务失败则不再继续并执行错误处理函数

要串行执行这样的异步任务, 只需要链式调用

&lt;pre&gt;`job1.then(job2).then(job3).catch(handleError);
`&lt;/pre&gt;

其中 job1, job2, job3 都是(或返回) Promise 对象

&lt;pre&gt;`function job2(input){
  return new Promise(function(resolve, reject){
      ....
    })
}
`&lt;/pre&gt;

### 并行执行异步任务

试想一个页面聊天任务, 我们需要从两个不同的 URL 分别获取用户的个人信息和好友列表, 这两个任务是可以并行执行的, 用`Promise.all()`实现如下:

&lt;pre&gt;`var p1 = new Promise(function(resolve, reject){
  setTimeout(resolve, 500, &apos;P1&apos;);
});

var p2 = new Promise(function(resolve, reject) {
  setTimeout(resolve, 600, &apos;P2&apos;);
});

// 同时执行p1 和 p2, 并在他们都执行完毕后执行 then
Promise.all([p1,p2]).then(function(results){
  console.log(results); // 获得一个 Array: [&apos;P1&apos;, &apos;P2&apos;]
});
`&lt;/pre&gt;

有时多个异步任务是为了容错, 比如同时向两个 URL 读取, 只需要获得先返回的结果, 这种情况下用`Promise.race()`实现:

&lt;pre&gt;`var p1 = new Promise(function(resolve, reject){
  setTimeout(resolve, 500, &apos;P1&apos;);
});
var p2 = new Promise(function(resolve, reject){
  setTimeout(resolve, 600, &apos;P2&apos;);
});

Promise.race([p1,p2]).then(function(result){
  console.log(result); // &apos;P1&apos;
});
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> ES6 </tag>
            
            <tag> Promise </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CO Module]]></title>
      <url>/2016/07/31/co-module/</url>
      <content type="html"><![CDATA[<h3 id="Co-v4"><a href="#Co-v4" class="headerlink" title="Co v4"></a>Co v4</h3><p><code>co@4.0.0</code> has been released, which now relies on promises. It is a stepping stone towards the <a href="https://github.com/lukehoban/ecmascript-asyncawait" target="_blank" rel="external">aysnc/await proposal</a>. The primary API change is how <code>co()</code> is invoked. Before, <code>co</code> returned a “thunk”, which you then called with a callback and optional arguments. Now, <code>co()</code> return s a promise.</p>
<pre><code>co(function* (){
  var result = yield Promise.resolve(true);
  return result;
}).then(function (value) {
  console.log(value);
}, function(err) {
  console.error(err.stack);
});
`&lt;/pre&gt;

If you want to convert a `co`-generator-function into a regular function that returns a promise, you now use `co.wrap(fn*)`.

&lt;pre&gt;`var fn = co.wrap(function*(val) {
  return yield Promise.resolve(val);
});

fn(true).then(function(val){
})
`&lt;/pre&gt;

### Platform Compatibility

`co@4+` requires a `Promise` implementation. For version of node `&amp;lt; 0.11` and for many older browsers, you should/must include your own `Promise` polyfill.

Node v4+ is supported out of the box, you can use `co` without flags or polyfills.

### Installation

&lt;pre&gt;`$ npm install co
`&lt;/pre&gt;

### Examples

&lt;pre&gt;`var co = require(&apos;co&apos;);

co(function*(){
  // yield any promise
  var result = yield Promise.resolve(true);
}).catch(onerror);

co(function*(){
  // resolve multiple promises in parallel
  var a = Promise.resolve(1);
  var b = Promise.resolve(2);
  var c = Promise.resolve(3);
  var res = yield[a, b, c];
  console.log(res);
  // =&amp;gt; [1,2,3]
}).catch(onerror);

// errors can be try/catched
co(function*() {
  try{
    yield Promise.reject(new Error(&apos;boom&apos;));
  } catch (err) {
    console.error(err.message); // &apos;boom&apos;
  }
});

function onerror(err){
  // log any uncaught errors
  // co will not throw any errors you do not handle
  // HANDLE ALL YOUR ERRORS
  console.error(err.stack);
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript Generator]]></title>
      <url>/2016/07/31/javascript-generator/</url>
      <content type="html"><![CDATA[<p>作用迭代器</p>
<pre><code>function* argumentsGenerator() {
  for (let i = 0; i &amp;lt; arguments.length; i++) {
    yield arguments[i];
  }
}
`&lt;/pre&gt;

我们希望迭代传入的每个实参

&lt;pre&gt;`var argumentsIterator = argumentsGenerator(&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;);

// Prints &quot;a,b,c,d&quot;
console.log(
  argumentsIterator.next().value,
  argumentsIterator.next().value,
  argumentsIterator.next().value,
  argumentsIterator.next().value
)
`&lt;/pre&gt;

我们可以简单的理解
- Generator 其实是生成 Iterator 的方法, argumentsGenerator 被称为 GeneratorFunction, 也有一些人把 GeneratorFunction 的返回值称为一个 Generator
- yield 可以中断 GeneratorFunction 的运行, 而在 next() 时恢复运行
- 返回的 Iterator 上, 有 next 成员方法, 能够返回迭代值. 其中 value 属性包含了实际返回值, done 属性为布尔值, 标记迭代器是否完成迭代, 要注意的是, 在 done: true 后继续运行 next 方法会产生异常.

完整的 ES 实现中, for-of 循环正式为了快速迭代一个 Iterator

&lt;pre&gt;`for (let value of argumetnsIterator) {
  console.log(value);
}
`&lt;/pre&gt;

可以利用 yield* 语法, 将 yield 操作代理到另一个 Generator

&lt;pre&gt;`let delegatedIterator = (function*() {
  yield &apos;Hello!&apos;;
  yield &apos;Bye!&apos;;
})();

let delegatingIterator = (function*() {
  yield &apos;Greetings!&apos;;
  yield* delegatedIterator;
  yield &apos;Ok, bye!&apos;;
})();

// Prints &quot;Greetings!&quot;, &quot;Hello&quot;, &quot;Bye!&quot;, &quot;Ok, bye!&quot;
for (let value of delegatingIterator) {
  console.log(value);
}
</code></pre><h3 id="用作流程控制"><a href="#用作流程控制" class="headerlink" title="用作流程控制"></a>用作流程控制</h3><p>co 已经将此特性封装的非常完美</p>
<p>Generator 之所以可以用来控制代码流程, 就是通过 yield 来将两个或多个 Generator 的执行路径相互切换, 这种切换是语句级别的, 而不是函数级调用. 其本质是 CPS 变换.</p>
<p>这里补充 yield 的若干行为:</p>
<ul>
<li>next 方法接收一个参数, 传入的参数是 yield 表达式的返回值: 即 yield 既可以产生数值,  也可以接收数值</li>
<li>throw 方法会抛出一个异常, 并终止迭代</li>
<li>GeneratorFunction 的 return 语句相当于一个 yield</li>
</ul>
<h4 id="将异步”变为”同步"><a href="#将异步”变为”同步" class="headerlink" title="将异步”变为”同步"></a>将异步”变为”同步</h4><p>假设我们希望有如下语法:</p>
<ul>
<li>suspend 传入一个 GeneratorFunction</li>
<li>suspend 返回一个简单函数, 接收一个 node 风格的回调函数</li>
<li>所有的异步调用都通过 yield, 看起来像同步调用</li>
<li>给定一个特殊的回调, 让保证异步调用的返回值作为 yield 的返回值, 并让脚本继续</li>
<li>GeneratorFunction 的返回值和执行过程的错误都会传入全局的回调函数</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Generator 101]]></title>
      <url>/2016/07/30/generator-101/</url>
      <content type="html"><![CDATA[<pre><code>function * HelloGen(){
  yield 100;
  yield 400;
}

var gen = HelloGen();

console.log(gen.next()); // {value: 100, done: false}
console.log(gen.next()); // {value: 400, done: false}
console.log(gen.next()); // {value: undefined, done: true}
`&lt;/pre&gt;

&lt;pre&gt;`function * HelloGen2() {
  var a = yield 100;
  var b = yield a + 100;

  console.log(b);
}

var gen2 = HelloGen2();

console.log(gen2.next()); // {value: 100, done: false}
console.log(gen2.nect(500)); // {value: 600, done: false}
console.log(gen2.next(1000)); // {value: undefined, done: done}
// prints 1000
`&lt;/pre&gt;

### Preventing Callback Hell

So, how can generators be used to avoid callback hell? First, you need to understand a simple technique that we will be using heavily with generators to write code without callbacks.

#### Understanding Thunks

A thunk is a partially evaluated function which accepts a single callback as the argument. Within generators, we&apos;ll be yielding thunks to write without callbacks. A simple thunk is shown below.

&lt;pre&gt;`function(callback) {
  fs.readFile(&apos;myfile.md&apos;, &apos;utf8&apos;, callback)
}
`&lt;/pre&gt;

Thunks can also be created dynamically as shown below:

&lt;pre&gt;`function readFile(filename) {
  return function(callback) {
    fs.readFile(filename, &apos;utf8&apos;, callback);
  };
}
`&lt;/pre&gt;

#### Using `co`

`co` is a nice module which helps to use thunks and generators together to create Node.js applications without callbacks.

A simple application which uses `co` and the `readFile()` thunk.

&lt;pre&gt;`var co = require(&apos;co&apos;);

co(function* (){
  var file1 = yield readFile(&apos;file1.md&apos;);
  var file2 = yield readFile(&apos;file2.md&apos;);

  console.log(file1);
  console.log(file2);
})();
`&lt;/pre&gt;

As you can see, we are no longer using callbacks. This gives us a simple way to write large modular Node apps easily.

###### How `co` Works Internally
</code></pre><ol>
<li>First, it calls <code>next(null)</code> and gets a thunk.</li>
<li>Then, it evaluate the thunk and saves the result.</li>
<li>Then, it calls <code>next(savedResult)</code>(in this case, saveResult == readFile(‘file1.md’), and next(savedResult) pass the content to var file1)</li>
<li><p>Repeat these steps until <code>next()</code> return <code>{done: true}</code></p>
<p>A minimal version of <code>co</code> written to show how it works internally.</p>
<p>```<br>function co(generator){<br>  var gen = generator();</p>
<p>function nextItem(err, result) {</p>
<pre><code>var item = gen.next(result);
</code></pre><p><pre>`if (!item.done) {<br>  item.value(nextItem); // item.value is a thunk, because yield a thunk<br>}</pre></p>
</li>
</ol>
<p>}</p>
<p>nextItem();<br>}</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> Thunk </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[__proto__与 prototype]]></title>
      <url>/2016/07/30/proto-e4-b8-8e-prototype/</url>
      <content type="html"><![CDATA[<p>简而言之,</p>
<pre><code>x.__proto__ === x.constructor.prototype
`&lt;/pre&gt;

在 JS 世界里, 万物皆对象

Function 是对象, Function.prototype 也是对象, 因此他们具有对象的共性: **proto**属性

&lt;pre&gt;`Function.__proto__ === Function.prototype; // Function 的构造函数还是 Function

Function.prototype.__proto__ === Object.prototye; Function.prototype 的构造函数是 Object()
`&lt;/pre&gt;

而 Object 的构造函数也是 Function, 所以

&lt;pre&gt;`Object.__proto__ === Function.prototype
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[彻底理解 Thunk 函数]]></title>
      <url>/2016/07/30/e5-bd-bb-e5-ba-95-e7-90-86-e8-a7-a3-thunk-e5-87-bd-e6-95-b0/</url>
      <content type="html"><![CDATA[<h3 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h3><p>生成器(Generator)函数写成:</p>
<pre><code>function* func () {}
`&lt;/pre&gt;

其本质也是一个函数, 所以他具备普通函数所具有的所有特性, 除此以外, 他还具有以下特性
</code></pre><ol>
<li>执行生成器函数后返回一个迭代器(Iterator)</li>
<li>生成器函数内部可以使用 yield 或 yield*, 函数执行到 yield 的时候会暂停执行, 并返回 yield 后面表达式的值, 通过迭代器的 next() 方法返回一个对象, 该对象由 value 和 done 属性组成, 其中, value 属性值为 yield 后面表达式的值, done 属性表示生成器的执行状态</li>
<li>迭代器 next() 方法的参数是yield 表达式的值</li>
<li><p>当 next 指向最后一个 yield 的时候, 再次执行 next() 方法, 返回的对象中 done: true, 而 value 的值为 return 后面的表达式(默认为 undefined)</p>
<h4 id="例一"><a href="#例一" class="headerlink" title="例一"></a>例一</h4><pre>`function test() {
  return 'b';
}
function* func() {
  var a = yield 'a';

  console.log('gen', a); // 'gen: undefined' - (如果 next 方法不带参数, yield 表达式返回 undefined)
  var b = yield test();
  console.log('gen': b); // 'gen: undefined'
}

var func1 = func();
var a = func1.next();
console.log('next: ' a); // 'next: {value: 'a', done: false}'
var b = func1.next();
console.log('next: ' b); // 'next: {value: 'b', done: false}'
var c = func1.next();
console.log('next: ' c); // 'next: {value: undefined, done: true}'
`</pre>

<h3 id="关于-yield"><a href="#关于-yield" class="headerlink" title="关于 yield*"></a>关于 yield*</h3><p>yield 暂停执行并返回后面表达式的值, 而 yield* 则将函数委托到另一个迭代器或可迭代对象</p>
<h4 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h4><pre>`&gt; function* genFunc(){
... yield arguments;
... yield* arguments;
... }
undefined
&gt; var gen = genFunc(1,2);
undefined
&gt; gen.next()
{ value: { '0': 1, '1': 2 }, done: false }
&gt; gen.next()
{ value: 1, done: false }
&gt; gen.next()
{ value: 2, done: false }
&gt; gen.next()
{ value: undefined, done: true }
`</pre>

<h4 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h4><pre>`&gt; function * gen1(){
... yield 2;
... yield 3;
... }
undefined
&gt; function * gen2(){
... yield 1;
... yield* gen1();
... yield 4;
... }
undefined
&gt; var g2 = gen2();
undefined
&gt; g2.next()
{ value: 1, done: false }
&gt; g2.next()
{ value: 2, done: false }
&gt; g2.next()
{ value: 3, done: false }
&gt; g2.next()
{ value: 4, done: false }
&gt; g2.next()
{ value: undefined, done: true }
`</pre>

<h3 id="Thunk-函数"><a href="#Thunk-函数" class="headerlink" title="Thunk 函数"></a>Thunk 函数</h3><p>在 co 的应用中, 为了能像同步代码那样书写异步代码, 比较多的使用方式是使用 thunk 函数(但不是唯一方式, 还可以是 Promise), 比如读取文件内容的异步函数 fs.readFile() 方法, 转化为 thunk 函数的方式如下</p>
<pre>`function readFile(path, encoding){
  return function(cb){
    fs.readFile(path, encoding, cb);
  }
}
`</pre>

<p>Thunk函数具备以下两个要素<br>1. 有且只有一个参数是 callback 的函数<br>2. callback 的第一个参数是 error</p>
<p>使用 thunk 函数, 同时结合 co 我们就可以像书写同步代码一样书写异步代码</p>
<pre>`var co = require('co');
var fs = require('fs');
var Promise = require('es6-promise').Promise;

function readFile(path, encoding){
  return function(cb) { // thunk function
    fs.readFile(path, encoding, cd);
  };
}

co(function* () { // 外部不可见, 但在 co 内部其实已经转化成promise.then().catch()...链式调用的行驶
  var a = yield readFile('a.txt', {encoding: 'utf-8'});
  console.log(a); // a
  var b = yield readFile('b.txt', {encoding: 'utf-8'});
  console.log(b); // b
  return yield Promise.resolve(a+b);
}).then(function(val){
  console.log(val) // ab
}).catch(function(error){
  console.log(error);
})
`</pre>

<p>有一个框架 thunkify 可以帮我们轻松实现以上步骤</p>
<pre>`var co = require('co');
var thunkify = require('thunkify');
var fs = requrie('fs');
var Promise = require('es6-promise').Promise;

var readFile = thunkify(fs.readFile);

co(function* () { // 外部不可见， 但在 co 内部已经转化为 promise 的链式调用
  var a = yield readFile('a.txt', {encoding: 'utf-8'});
  console.log(a); // a
  var b = yield readFile('b.txt', {encoding: 'utf-8'});
  console.log(b); // b
  return yield Promise.resolve(a+b);
}).then(function(val){
  console.log(val); // ab
}).catch(function(err){
  console.log(err);
})
`</pre>

<p>对于 thunkify 框架的理解注释如下：</p>
<p><pre>`/**</pre></p>
<ul>
<li>Module dependencies<br>*/<br>var assert = require(‘assert’);</li>
</ul>
<p>/**</p>
<ul>
<li>Expose <code>thunkify()</code>.<br>*/</li>
</ul>
<p>module.exports = thunkify;</p>
<p>function thunkify(fn) {<br>  assert(‘function’ == typeof fn, ‘function required’);</p>
<p>  // 返回一个包含 thunk 函数的函数, 返回的 thunk 函数用于执行yield, 而外层的这个函数用于给 thunk 函数传递其他参数<br>  return function() {</p>
<pre><code>var args = new Array(arguments.length);
// 缓存上下文环境, 给 fn 提供执行环境
var ctx = this;

// 将参数类数组对象转为数组(实现方式略臃肿, 可以直接用Array.from)
for (var i = 0; i &amp;lt; args.length; ++i){
  args[i] = argumetns[i];
}

// 真正的 thunk 函数(有且只有一个参数, 并且参数是第一个参数为 err 的 callback)
return function(done) { // 返回 thunk 函数
  var called;

  // 将回调函数再包裹一层, 避免重复调用, 同时, 将包裹了的真正的回调函数 push 进参数数组(即将回调函数 done 作为最后一个参数传递给 fn)
  args.push(function(){  // 将回调函数 done 加到参数列表尾部, 形成 fn 需要的 [arg1, ..., done]
    if (called) return;
    called = true;
    done.apply(null, arguments); // 执行回调函数
  });

  try {
    // 在 ctx 环境执行 fn
    // 并将执行 thunkify 之后返回的函数的参数(含 done 回调) 传入, 类似于执行:
    // fs.readFile(path, {encoding: &apos;utf-8&apos;}, done)
    fn.apply(ctx,args); // 类似 fn(arg1, .., done)
  } catch(err) {
    done(err);
  }
}
</code></pre><p>  }<br>}</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> ES6 </tag>
            
            <tag> Thunk </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS 动画之硬件加速]]></title>
      <url>/2016/07/27/css-e5-8a-a8-e7-94-bb-e4-b9-8b-e7-a1-ac-e4-bb-b6-e5-8a-a0-e9-80-9f/</url>
      <content type="html"><![CDATA[<h3 id="触发硬件加速的-CSS-属性"><a href="#触发硬件加速的-CSS-属性" class="headerlink" title="触发硬件加速的 CSS 属性"></a>触发硬件加速的 CSS 属性</h3><ul>
<li>transform</li>
<li>opacity</li>
<li>filter</li>
</ul>
<h3 id="硬件加速的工作原理"><a href="#硬件加速的工作原理" class="headerlink" title="硬件加速的工作原理"></a>硬件加速的工作原理</h3><p>浏览器解析得到 DOM 树后, 与 CSS 形成渲染树, 渲染树上有大量的渲染元素, 每一个渲染元素都被分到一个图层中, 每个图层被加载到 GPU 形成渲染文理.</p>
<p>然而, transform 等 CSS 属性不会触发 GPU 的 repaint, 这些使用 transform 属性的图层都会有独立合成器进行处理.</p>
<p>比如某个元素具有 transform 属性, 那么会为他创建一个新的复合图层, 可以被 GPU 直接用来执行 transform 操作.</p>
<p>一般浏览器会在以下几种情况下创建一个独立的复合图层: </p>
<ul>
<li>3D 或 transform</li>
<li><code>&amp;lt;video</code> 和<code>&amp;lt;canvas&amp;gt;</code>标签</li>
<li>CSS Filters</li>
<li>元素覆盖时(比如 z-index)</li>
</ul>
<p>3D 和 2D 的transform 区别在于, 浏览器在页面渲染前为 3D 动画创建独立的复合图层, 而在<strong>运行期间</strong>为 2D 动画创建独立复合图层. 2D transform 在动画开始和结束的时候依旧出现了初始化和删除的 repaint.</p>
<h3 id="强制使用-GPU-渲染"><a href="#强制使用-GPU-渲染" class="headerlink" title="强制使用 GPU 渲染"></a>强制使用 GPU 渲染</h3><p>为了避免 2D transform 动画的两次 repaint, 我们可以硬编码一些样式来解决这个问题</p>
<pre><code>.solution1{
  transform: translateZ(0);
}

.solution2{
  transform: rotateZ(360deg)
}
</code></pre><p>这段代码让浏览器执行3Dtransform, 进而创建一个独立的复合涂层</p>
<h3 id="硬件加速缺点"><a href="#硬件加速缺点" class="headerlink" title="硬件加速缺点"></a>硬件加速缺点</h3><ol>
<li>内存, 如果 GPU 加载了大量文理, 容易发生内存问题</li>
<li>使用 GUP 渲染会影响字体的抗锯齿效果, 因为 GPU 和 CPU 渲染机制不同. 即使最终硬件加速停止了, 文本还是会在动画期间显得模糊.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[生成器 function*]]></title>
      <url>/2016/07/26/e7-94-9f-e6-88-90-e5-99-a8-function/</url>
      <content type="html"><![CDATA[<p>function* 声明定义一个 generator( 生成器), 返回一个 Generator 对象</p>
<p>语法</p>
<pre><code>function* name([param[, param[, ...param]]]){ statements }
`&lt;/pre&gt;

### 描述

Generator 是一种可以从中退出并在之后重新进入的函数, 其环境(绑定的变量)会在每次执行后被保存, 下次进入时可以继续使用

调用一个 Generator 并不马上执行它的主体, 而是返回一个 迭代器对象, 这个迭代器的 next() 方法被调用的时候, Generator 的主体会被执行至下一个 yield 表达式, 该表达式定义了迭代器的返回值

### 示例

&lt;pre&gt;`function* idMaker(){
  var index = 0;
  while(index &amp;lt; 3){
    yield index++;
  }
}

var gen = idMaker(); //返回一个迭代器对象

console.log(gen().next().value); // 0
console.log(gen().next().value); // 1
console.log(gen().next().value); // 2
console.log(gen().next().value); // undefined
</code></pre><p>谨慎使用, 因为其内部变量保持变化, 要每次输出的相互影响</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack 杂]]></title>
      <url>/2016/07/25/webpack-e6-9d-82/</url>
      <content type="html"><![CDATA[<h3 id="loaders"><a href="#loaders" class="headerlink" title="loaders"></a>loaders</h3><p>在 React 里会用到 JSX, ES6, js, 统一使用 .js 作为后缀, 便于 babel 配置</p>
<pre><code>npm install --save babel-loader

//
{
  test: /\.js?$/,
  exclude: /node_modules/,
  loader: &apos;babel&apos;,
  query:{
    presets: [&apos;es2015&apos;, &apos;react&apos;]
  }
}
`&lt;/pre&gt;

CSS, SCSS, ICONFONT 字体文件

&lt;pre&gt;`npm install --save style-loader css-loader sass-loader node-sass url-loader, file-loader
//
{
  test: /\.scss$/,
  loader: &apos;style!css!sass&apos;
},
{
  test: /\.(png|jpg)$/,
  loader: &apos;url?limit-8192&apos;
}
</code></pre><h3 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h3><h4 id="html-webpack-plugin-会由-entry-得配置将入口文件所属的-html-文件作为模板-重新生成一个-html-文件-其中的静态资源都已经根据配置打包好"><a href="#html-webpack-plugin-会由-entry-得配置将入口文件所属的-html-文件作为模板-重新生成一个-html-文件-其中的静态资源都已经根据配置打包好" class="headerlink" title="html-webpack-plugin 会由 entry 得配置将入口文件所属的 html 文件作为模板, 重新生成一个 html 文件, 其中的静态资源都已经根据配置打包好"></a>html-webpack-plugin 会由 entry 得配置将入口文件所属的 html 文件作为模板, 重新生成一个 html 文件, 其中的静态资源都已经根据配置打包好</h4><p>使用 webpack 后, 对文件的版本 hash 会变得非常简单, 在出口文件 filename 中添加[hash]即可; 就目前而言, 清楚资源缓存的最好方法是文件名 hash, 由于每次改动后生成的文件名都不一样, 上线并不会覆盖之前的版本, 只是多了一个版本的文件, 页面即使同步有时间差, 要么访问旧版页面, 要么访问新版页面, 不会存在冲突. 这样服务器就可以放心的对静态资源开启永久强缓存, 并且有利于回滚, 至于静态资源产生的积压, 可以交由运维处理.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript 提高性能]]></title>
      <url>/2016/07/25/javascript-e6-8f-90-e9-ab-98-e6-80-a7-e8-83-bd/</url>
      <content type="html"><![CDATA[<h3 id="针对-js-文件的加载位置"><a href="#针对-js-文件的加载位置" class="headerlink" title="针对 js 文件的加载位置"></a>针对 js 文件的加载位置</h3><p>在 HTML 文件中, &lt;script&gt;标签是可以加载&lt;head&gt;或&lt;body&gt;区域的, 由于 JavaScript 执行和 UI 渲染的是单线程的, 如果加载不顺畅可能导致堵塞, 造成页面空白或卡顿.<br>1. 如果 js 文件没有特殊要求致命需要在页面渲染之前加载, 那么应当将 &lt;script&gt;放在&lt;/body&gt;之前<br>2. 如果这些 js 文件有明确需求先于 body 执行, 那么就在第一个 js 或者页面上先放一个载入动画</p>
<h3 id="针对-js-文件的合并"><a href="#针对-js-文件的合并" class="headerlink" title="针对 js 文件的合并"></a>针对 js 文件的合并</h3><h3 id="更快速的数据访问"><a href="#更快速的数据访问" class="headerlink" title="更快速的数据访问"></a>更快速的数据访问</h3><p>对于浏览器而言, 一个标识符所处的位置约深, 去读写他的速度也越慢.</p>
<p>如果我们需要在当前函数内多次用到某一个值, 应当用一个局部变量将其保存</p>
<h3 id="DOM-操作的优化"><a href="#DOM-操作的优化" class="headerlink" title="DOM 操作的优化"></a>DOM 操作的优化</h3><p>DOM 操作远比 JavaScript 的执行更耗性能, 应当尽量减少该操作对性能的消耗.</p>
<pre><code>function innerLi_s(){
  var i = 0;
  for(;i&amp;lt;20;i++){
    document.getElementById(&apos;Num&apos;).innerHTML += &apos;A&apos;; //进行20此循环, 每次循环都进行2次DOM 元素的访问, 一次读取 innerHTML, 一次写入 innerHTML
  }
}

// 改写为

function innerLi_s(){
  var content = &apos;&apos;;
  var i = 0;
  for(;i&amp;lt;20;i++){
    content += &apos;A&apos; //这里只对 js 的变量循环20次
  };
  document.getElementById(&apos;Num&apos;).innerHTML += content; //这里只进行2次 DOM 操作
}
</code></pre><h3 id="减少-DOM-的重绘重排版"><a href="#减少-DOM-的重绘重排版" class="headerlink" title="减少 DOM 的重绘重排版"></a>减少 DOM 的重绘重排版</h3><p>元素的布局的改变或内容的增删改或浏览器尺寸的变化都会导致重排, 而字体颜色或背景色的修改会导致重绘.</p>
<p>合并同一对象的操作, 比如 background 的各个属性的修改可以合并为一个</p>
<h3 id="循环的优化"><a href="#循环的优化" class="headerlink" title="循环的优化"></a>循环的优化</h3><p>保存 arr.length, 避免多次访问</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CommonJS 规范]]></title>
      <url>/2016/07/25/commonjs-e8-a7-84-e8-8c-83/</url>
      <content type="html"><![CDATA[<p>概述<br>CommonJS 是服务器端模块的规范, Node.js 采用了这个规范</p>
<p>根据 CommonJS 规范, 一个单独的文件就是一个模块</p>
<p>加载模块使用 require 方法, 该方法读取一个文件并执行, 最后返回文件内部的 exports 对象.</p>
<pre><code>// example.js

console.log(&apos;evaluating example.js&apos;);

var invisible = function(){
  console.log(&apos;invisible&apos;);
}

exports.message = &apos;h1&apos;;

exports.say = function(){
  console.log(message)
}
`&lt;/pre&gt;

使用 require 方法, 加载 example.js 模块

&lt;pre&gt;`var example = require(&apos;./example.js&apos;);
`&lt;/pre&gt;

这时变量 example 就对应模块中 exports 对象, 可以通过这个对象应用模块中提供的各种方法.

&lt;pre&gt;`{
  message: &apos;h1&apos;,
  say: [Function]
}
`&lt;/pre&gt;

require 方法默认读取 js 文件, 所以可以省略 .js 扩展名

&lt;pre&gt;`var example = require(&apos;./example&apos;)
`&lt;/pre&gt;

js 文件名前需要加上路径, 可以是相对路径, 也可以是绝对路径. 如果省略路径, node.js 会认为添加一个核心模块, 或者已经安装在本地 node_modules 目录中的模块. 如果加载的是一个目录, node.js 会首先寻找该目录中的 package.json 文件, 加载该文件 main 属性指定的模块, 否则就寻找该目录下的 index.js 文件

定义一个最简单的模块

&lt;pre&gt;`exports.add = function(a,b){return a+b};
`&lt;/pre&gt;

//add.js
为 exports 对象添加一个 add 方法,

&lt;pre&gt;`var addition = require(&apos;./add&apos;);
addition.add(1,2); //3
`&lt;/pre&gt;

稍复杂的例子

&lt;pre&gt;`//foobar.js
function foobar(){
  this.foo = function(){
    console.log(&apos;hello foo&apos;)
  };

  this.bar = function(){
    console.log(&apos;hello bar&apos;)
  };
}
exports.foobar = foobar;
`&lt;/pre&gt;

调用

&lt;pre&gt;`var foobar = require(&apos;./foobar&apos;).foobar, test = new foobar();
test.bar(); //&apos;hello bar&apos;
`&lt;/pre&gt;

有时不需要 exports 返回一个对象, 而仅需要返回一个函数, 就写成 module.exports

&lt;pre&gt;`module.exports = function(){
  console.log(&apos;hello world&apos;)
}
`&lt;/pre&gt;

### AMD 规范与 CommonJS 规范的兼容性

CommonJS 规范加载模块是同步的, 也就是说, 只有加载完成, 才能执行后面的操作. AMD 规范则是非同步加载模块, 允许指定回调函数. 由于 Node.js 主要用于服务器编程, 模块文件一般都已经存在于本地硬盘, 所以加载起来比较快, 不需要考虑非同步加载的方式, 所以 CommonJS 的规范比较适用. 但是, 如果是浏览器环境, 要从服务器端加载模块, 这时就必须采用非同步模式, 因此浏览器端一般采用 AMD 规范.

AMD 规范适用 define 方法定义模块

&lt;pre&gt;`define([&apos;package/lib&apos;, function(lib){
  function foo(){
    lib.log(&apos;hello world!&apos;);
  }

  return {
    foo:foo
  };
}])
`&lt;/pre&gt;

AMD 规范允许输出的模块兼容 CommonJS 规范,在这时 define 方法需要写成如下格式

&lt;pre&gt;`define(function(require, exports, module)
  var someModule = require(&apos;someModule&apos;);
  var anotherModule = require(&apos;anotherModule&apos;);

  someModule.doTheAwesoem();
  anotherModule.doMoreAwesome();

  exports.asplode = function(){
    someModule.doTheAwesoem();
    anotherModule.doMoreAwesome();
  };
);
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> CommonJS </tag>
            
            <tag> Node.js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack 开发和部署]]></title>
      <url>/2016/07/22/webpack-e5-bc-80-e5-8f-91-e5-92-8c-e9-83-a8-e7-bd-b2/</url>
      <content type="html"><![CDATA[<p>Thanks to <a href="https://github.com/vikingmute/webpack-for-fools/blob/master/entries/chapter-2.md" target="_blank" rel="external">Webpack 傻瓜指南</a></p>
<h3 id="启用-Source-Map"><a href="#启用-Source-Map" class="headerlink" title="启用 Source Map"></a>启用 Source Map</h3><p>在 webpack.config.js 中添加字段</p>
<pre><code>devtool: &apos;eval-source-map&apos;,
`&lt;/pre&gt;

这样出错后会采用 sourceMap 直接显示出错位置

### 配置 webpack-dev-server

在 webpack.config.js 中添加字段

&lt;pre&gt;`devServer: {
  historyApiFallback: true,
  hot: true,
  inline: true,
  progress: true,
}
`&lt;/pre&gt;

### 使用 preLoaders 和 postLoaders

preLoaders 在 loaders 之前执行, 总体顺序是 preLoader -&gt; loaders -&gt; postLoaders

#### 安装 jshint

&lt;pre&gt;`npm install --save-dev jshint-loader
`&lt;/pre&gt;

在 config 中配置

&lt;pre&gt;`module:{
  preloaders:[
    {
      test: /\.jsx$/,
      loader:&apos;jshint-loader&apos;
    }
  ]
}
jshint:{
  &apos;esnext&apos;:true
}
`&lt;/pre&gt;

### 部署上线

项目开发完成后需要部署上线, 此时应该创建一个新的 config, 因为部署上线使用的 webpack 不需要 dev-tools, dev-server, jshint 等

复制现有的 config 文件, 命名为 webpack.production.config.js, 将里面与开发有关的东西删除, 在 package.json 中添加

&lt;pre&gt;`&quot;scripts&quot;:{
  &quot;build&quot;: &quot;webpack --progress --profile  --colors --config webpack.production.config.js&quot;
},
`&lt;/pre&gt;

上线的时候运行

&lt;pre&gt;`npm run build
`&lt;/pre&gt;

### 分离第三方库

如果第三方库很多, 会导致最后 bundle 文件很大, 减慢加载速度, 因此需要把第三方库和 app 本身的代码分开

#### 修改 entry 入口文件

&lt;pre&gt;`entry:{
  app: path.resolve(APP_PATH, &apos;index.js&apos;),
  //添加要打包在 vendors 里面的库
  vendors: [&apos;jquery&apos;, [moment]]
},
`&lt;/pre&gt;

#### 添加 CommonsChunkPlugin

&lt;pre&gt;`plugins: [
  //使用 uglifyJs 压缩 js 代码
  new webpack.optimize.UglifyJsPlugin({minimize: true}),
  //把入口文件里的数组打包成 vendors.js
  new webpack.optimize.CommonsChunkPlugin(&apos;vendors&apos;,&apos;vendors.js&apos;),
  new HtmlWebpackPlugin({title: &apos;Welcome&apos;})
]
`&lt;/pre&gt;

运行 build 后会生成 vendor.js

### 生成多页面

假设需求是生成两个页面, 一个叫 index.html, 需要引用 app.js 和 vendors.js 两个文件; 另一个是 mobile.html, 需要应用 mobie.js 和 vendor.js 这两个文件

首先新建一个叫 mobile.js 的文件入口, 比 app.js 简单一些

&lt;pre&gt;`import &apos;./main.scss&apos;;
import $ from &apos;jquery&apos;;
import &apos;imports?jQuery=jQuery!./plugin.js&apos;;

$(document).ready(function(){
  let app = document.createElement(&apos;div&apos;);
  app.innerHTML = &apos;&amp;lt;h1&amp;gt;Hello World&amp;lt;/h1&amp;gt;&apos;;
  document.body.appendChild(app);
  $(&apos;h1&apos;).greenify();
});
`&lt;/pre&gt;

在 config 修改入口文件和输出配置

&lt;pre&gt;`entry:{
  // 三个入口文件: app, mobile, vendors
  app: path.resolve(APP_PATH, &apos;index.js&apos;),
  mobile: path.resolve(APP_PATH, &apos;mobile.js&apos;),
  vendors: [&apos;jquery&apos;,&apos;moment&apos;]
},
output:{
   path: DIST_PATH,
   filename: &apos;[name].js&apos;
},
`&lt;/pre&gt;

为 html-webpack-plugin 设置模板, 并保存于 templates

&lt;pre&gt;`// index.html
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;{%= o.htmlWebpackPlugin.options.title %}&amp;lt;/title&amp;gt;
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    &amp;lt;h3&amp;gt;Welcome to Index&amp;lt;/h3&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;

//mobile.html
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;{%= o.HtmlWebpackPlugin.options.title %}&amp;lt;/title&amp;gt;
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    &amp;lt;h3&amp;gt;Welcome to Mobile&amp;lt;/h3&amp;gt;
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
`&lt;/pre&gt;

继续配置 config.js, 让 HtmlWebpackPlugin 可以生成多个文件

&lt;pre&gt;`//Templates 的文件夹路径
var TEM_PATH = path.resolve(ROOT_PATE, &apos;templates&apos;);
...
plugins:[
  //创建两个 HtmlWebpackPlugin 的实例, 生成两个页面
  new HtmlWebpackPlugin({
    title: &apos;Hello World App&apos;,
    template: path.resolve(TEM_PATH, &apos;index.html&apos;),
    filename: &apos;index.html&apos;
    //chunks 这个参数告诉插件要引用 chunks 中的那几个入口
    chunks: [&apos;app&apos;,&apos;vendors&apos;],
    //scripts 要插入的位置
    inject: &apos;body&apos;
  }),
  new HtmlWebpackPlugin({
    title: &apos;Hello Mobile App&apos;,
    template: path.resolve(TEM_PATH, &apos;mobile.html&apos;),
    filename: &apos;mobile.html&apos;,
    chunks: [&apos;mobile&apos;,&apos;vendors&apos;],
    inject: &apos;body&apos;
  })
]
</code></pre><h3 id="生成-hash-名称的-script-来防止缓存"><a href="#生成-hash-名称的-script-来防止缓存" class="headerlink" title="生成 hash 名称的 script 来防止缓存"></a>生成 hash 名称的 script 来防止缓存</h3><p>webpack 基于 md5 可以生成 hash 名称<br>```<br>output:{<br>  path: DIST_Path,<br>  filename: ‘[name].[hash].js’<br>},</p>
]]></content>
      
        <categories>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[webpack简明指南]]></title>
      <url>/2016/07/21/webpack-e7-ae-80-e6-98-8e-e6-8c-87-e5-8d-97/</url>
      <content type="html"><![CDATA[<p>Thanks to <a href="https://github.com/vikingmute/webpack-for-fools/blob/master/entries/chapter-1.md" target="_blank" rel="external">Webpack 傻瓜式指南</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>npm install -g webpack
`&lt;/pre&gt;

### 建立项目

&lt;pre&gt;`mkdir webpack
cd webpack
npm init
touch .gitignore
`&lt;/pre&gt;

#### 项目结构

&lt;pre&gt;`project
|
|---app
|    |
|    |---index.js
|    |---sub.js
|
|---package.json
|
|---webpack.config.js
`&lt;/pre&gt;

&lt;pre&gt;`//sub.js
function generateText(){
  var element = document.createElement(&apos;h2&apos;);
  element.innerHTML = &quot;Hello, I&apos;m h2&quot;;
  return element;
}
module.exports = generateText;
`&lt;/pre&gt;

&lt;pre&gt;`//index.js
var sub = require(&apos;./sub&apos;);
var app = document.createElement(&apos;div&apos;);
app.innerHTML = &quot;&amp;lt;h1&amp;gt;Hello, I&apos;m h1&quot;;
app.appendChild(sub())
`&lt;/pre&gt;

### 配置 Webpack

目的是将两个 js 根据依赖关系合并, 然后在 dist 目录创建一个 index.html 并引用合并后的 js.

这里安装一个 plugin, 可以快速生成 HTML

&lt;pre&gt;`npm install --save-dev html-webpack-plugin
`&lt;/pre&gt;

修改 webpack.config.js

&lt;pre&gt;`var path = require(&apos;path&apos;);
var HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);
//定义文件夹路径
var ROOT_PATH = path.resolve(__dirname);
var APP_PATH = path.resolve(ROOT_PATH, &apos;app&apos;);
var DIST_PATH = path.resolve(ROOT_PATH, &apos;dist&apos;);

module.exports = {
  //项目文件夹, 可以直接用文件夹名, 默认寻找 index.js
  entry: APP_PATH,
  output: {
    path: DIST_PATH,
    filename: &apos;bundle.js&apos;
  },
  //添加插件, 自动生成 html
  plugins: [
    new HtmlWebpackPlugin({title: &apos;Hello World App&apos;})
  ]
};
`&lt;/pre&gt;

然后在项目目录运行

&lt;pre&gt;`webpack
`&lt;/pre&gt;

可以看到 html 已经引用了 bundle.js

### 配置 webpack-dev-server

用于自动刷新浏览器

安装webpack-dev-server

&lt;pre&gt;`npm install -g webpack-dev-server
`&lt;/pre&gt;

修改 webpack.config.js

&lt;pre&gt;`module.exports = {
  ...
  devServer: {
    historyApiFallback: true,
    hot: true,
        inline: true,
    progress: true,
  },
  ...
}

`&lt;/pre&gt;

修改 package.json

&lt;pre&gt;`...
&quot;scripts&quot;: {
  &quot;start&quot;: &quot;webpack-dev-server --hot --inline&quot;
},
...
`&lt;/pre&gt;

在项目目录执行

&lt;pre&gt;`npm start
`&lt;/pre&gt;

登录 http://localhost:8080

### 添加 CSS 样式

css-loader 会遍历 css 文件, style-loader 会把样式插入到&amp;lt;style&amp;gt;

&lt;pre&gt;`npm install -save-dev css-loader style-laoder
`&lt;/pre&gt;

修改 webpack.config.js

&lt;pre&gt;`...
module:{
  loaders: [
    {
      test: /\.css$/,
      loaders: [&apos;style&apos;,&apos;css&apos;],
      include: APP_PATH
    }
  ]
}
...
`&lt;/pre&gt;

注意 loaders 的书写方式, 从右向左执行

添加样式文件 app/main.css

&lt;pre&gt;`h1 {
  color: red;
}
`&lt;/pre&gt;

在入口文件&quot;index.js&quot; 中引用

&lt;pre&gt;`require(&apos;./main.css&apos;)
`&lt;/pre&gt;

### 使用 sass

这里需要 sass-loader 和 node-sass 一起解析文件

&lt;pre&gt;`npm install --save-dev sass-loader node-sass
`&lt;/pre&gt;

修改 webpack.config.js

&lt;pre&gt;`//先删除 css 规则
{
  test: /\.scss$/,
  loaders: [&apos;style&apos;,&apos;css&apos;,&apos;sass&apos;],
  include: APP_PATH
},
`&lt;/pre&gt;

添加两个 sass 文件 app/variables.scss 和 app/main.scss

&lt;pre&gt;`//variables.scss
$red: red;
`&lt;/pre&gt;

&lt;pre&gt;`//main.scss
@import &apos;./variables.scss&apos;;
h1{
  color: $red;
}
`&lt;/pre&gt;

在入口文件 index.js 中引用

&lt;pre&gt;`require(&apos;./main.scss&apos;);
`&lt;/pre&gt;

### 处理图片

&lt;pre&gt;`npm install --save-dev url-loader
`&lt;/pre&gt;

配置webpack.config.js

&lt;pre&gt;`{
  test: /\.(png|jpg)$/,
  loader: &apos;url?limit=8192&apos;
}
`&lt;/pre&gt;

注意, Limit参数制定了小于 8M 的图片会被转为 base64 编码, 可以减轻网络请求.

&lt;pre&gt;`@import &apos;./variabels.scss&apos;
h1 {
  color: $red;
  background-image: url(&apos;./imgs/avatar.jpg&apos;);
}
`&lt;/pre&gt;

### 添加第三方库

&lt;pre&gt;`npm install --save-dev jquery moment
`&lt;/pre&gt;

修改 index.js

&lt;pre&gt;`var sub = require(&apos;./sub&apos;);
require(&apos;./main.scss&apos;);
var $ = require(&apos;jquery&apos;);
var moment = require(&apos;moment&apos;);
var app = document.createElement(&apos;div&apos;);
app.innerHTML = &apos;&amp;lt;h1&amp;gt;Hello, h1&apos;;
document.body.append(app);
app.appendChild(sub());
$(&apos;body&apos;).append(&apos;&amp;lt;p&amp;gt;Inserted By Jquery. Now is &apos; + moment().format() + &apos;&amp;lt;/p&amp;gt;&apos;);
`&lt;/pre&gt;

### 添加 ES6 支持

安装 loader

&lt;pre&gt;`npm install -save-dev babel-loader babel-preset-es2015
`&lt;/pre&gt;

配置 webpack.config.js

&lt;pre&gt;`...
{
  test: /\.jsx$/,
  loaders: babel,
  include: APP_PATH,
  query:{
    presets: [&apos;es2015&apos;]
  }
}
...
`&lt;/pre&gt;

es2015 这个参数是 babel 的 plugin, 可以支持最新的 ES6 的特性

现在可以 js 文件改为 ES6 风格

&lt;pre&gt;`//sub.js
export default function(){
  var element = document.createElement(&apos;h2&apos;);
  element.innerHTML = &apos;This is h2&apos;;
  return element;
}
`&lt;/pre&gt;

&lt;pre&gt;`//index.js
import &apos;./main.scss&apos;;
import generateText from &apos;./sub&apos;;
import $ from &apos;jquery&apos;;
import moment from &apos;moment&apos;;

let app = document.createElement(&apos;div&apos;);
const myPromise = Promise.resolve(42);
myPromise.then((number) =&amp;gt; {
  $(&apos;body&apos;).append(&apos;&amp;lt;p&amp;gt;Promise result is &apos; + number + &apos;now is &apos; + moment().format() + &apos;&amp;lt;/p&amp;gt;&apos;);
});
app.innerHTML = &apos;&amp;lt;h1&amp;gt;This is h1&apos;;
document.body.appendChild(app);
app.appendChild(generateText());
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack.config.js]]></title>
      <url>/2016/07/21/webpack-config-js/</url>
      <content type="html"><![CDATA[<h3 id="entry"><a href="#entry" class="headerlink" title="entry"></a>entry</h3><p>The entry point for the bundle.</p>
<p>If you pass a string: The string is resolved to a module which is loaded upon startup.</p>
<p>If you pass an array: All modules are loaded upon startup. The last one is exported.</p>
<pre><code>entry:[&apos;./entry1&apos;,&apos;./entry2&apos;]
`&lt;/pre&gt;

If you pass an object: Multiple entry bundles are created. The key is the chunk name. The value can be a string or an array

&lt;pre&gt;`{
  entry:{
    page1: &apos;./pages1&apos;,
    page2: [&apos;./entry1&apos;,&apos;./entry2&apos;]
  },
  output: {
    // Make sure to use [name] or [id] in output.filename
    // when using multiple entry points
    filename: &apos;[name].bundle.js&apos;,
    chunkFilename: &apos;[id].bundle.js&apos;
  }
}
`&lt;/pre&gt;

### Output

`output` options tell webpack how to write the compiled files to disk.

Note, that while there can be multiple &apos;entry&apos; points, only &apos;output&apos; configuration is specified.

If you use hashing(`[hash]` or `[chunkhash]`) make sure to have a consistent ordering of modules. Use the `OccurenceOrderPlugin` or `recordsPath`

#### output.filename

Specifies the name of each output file on disk. You must **not** specify an absolute path here! The `output.path` option determines the location on disk the files are written to, `filename` is used solely for naming the individual files.

##### single entry

&lt;pre&gt;`{
  entry: &apos;./src/app.js&apos;,
  output: {
    filename: &apos;bundle.js&apos;,
    path: &apos;./build&apos;
  }
}
`&lt;/pre&gt;

##### multiple entries

If you configuration creates more than a single &quot;chunk&quot;(as with multiple entry points or when using plugins like CommonsChunkPlugin), you should use substitutions below to ensure that each file has a unique name.

`[name]` is replaced by the name of the chunk

`[hash]` is replaced by the hash of the compilation.

`[chunkhash]` is replaced by the hash of the chunk.

&lt;pre&gt;`{
  entry:{
    app: &apos;./src/app.js&apos;,
    search: &apos;./src/search.js&apos;
  },
  output:{
    filename: [name].js,
    path: __dirname + &apos;/built&apos;
  }
}
</code></pre><h4 id="output-path"><a href="#output-path" class="headerlink" title="output.path"></a>output.path</h4><p>The output directory as <strong>absolute path</strong>(required).</p>
<h3 id="Module-loaders"><a href="#Module-loaders" class="headerlink" title="Module.loaders"></a>Module.loaders</h3><p>An array of automatically applied loaders.</p>
<p>Each item can have there properties: </p>
<ul>
<li><code>test</code>: A condition that must be met</li>
<li><code>exclude</code>: A condition that must not be met</li>
<li><code>include</code>: A condition that must be met</li>
<li><code>loader</code>: A string of ‘!’ separated loaders</li>
<li>‘loaders’: An array of loaders as string</li>
</ul>
<h3 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h3>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack]]></title>
      <url>/2016/07/21/webpack-2/</url>
      <content type="html"><![CDATA[<h3 id="Use-webpack-in-a-project"><a href="#Use-webpack-in-a-project" class="headerlink" title="Use webpack in a project"></a>Use webpack in a project</h3><p>It’s best to have webpack <strong>as a dependency</strong> in your project, through this you can choose a local webpack version and will not be forced to use the single global one.<br>Add a <code>package.json</code> configuration file or <code>npm</code> with:</p>
<pre><code>$ npm init
`&lt;/pre&gt;

The answers to the question are not so important if you don&apos;t want to publish your project to npm.

Install and add `webpack` to the `package.json` with:

&lt;pre&gt;`$ npm install --save-dev webpack
`&lt;/pre&gt;

### Create a modular JavaScript Project

Let&apos;s create some modules in JavaScript, using the CommonJS syntax:

#### cat.js

&lt;pre&gt;`var cats = [&apos;dave&apos;,&apos;henry&apos;,&apos;martha&apos;];
module.exports = cats;
`&lt;/pre&gt;

#### app.js(Entry Point)

&lt;pre&gt;`var cats = require(&apos;cats.js&apos;);
console.log(cats);
`&lt;/pre&gt;

The **Entry Point** is where your application will start, and where webpack will start tracking dependencies between modules.

Give webpack the entry point(app.js) and specify an output file(app.bundle.js):

&lt;pre&gt;`webpack ./app.js app.bundle.js
`&lt;/pre&gt;

webpack will read and analyze the entry point and its dependencies(including transitive dependencies). Then it will bundle them into `app.bundle.js`.

Now your bundle is ready to run. Run `node app.bundle.js` and marvel in your abundance of cats.

To gain full access to webpack&apos;s flexibility, we need to create a &quot;configuration file&quot;

### Project Structure

We will put the source files in **src**, and bundled files in **dist**.
The final project structure will look like this:
![](https://raw.githubusercontent.com/dtinth/webpack-docs-images/2459637650502958669ea6b11bf49dc0b3b083ae/usage/project-structure.png)
</code></pre><ol>
<li><p>Create <code>webpack.config.js</code></p>
<pre>`module.exports = {
  entry: './src/app.js',
  output: {
    path: './dist',
    filename: '[name].bundle.js'
  }
};
`</pre>

<p>A webpack configuration file is a CommonJS-Style module. So you can run any kind of code here, as long as a configuration object is exported out of its module.</p>
</li>
<li><p>Using loaders<br>Webpack only supports JavaScript modules natively, but most people will be using a transpiler for ES2015, CoffeeScript, TypeScript, etc. They can be used in webpack by using <strong>loaders</strong>.<br>Loaders are special modules webpack uses to ‘load’ other modules(written in another language) into JavaScript(that webpack understands).</p>
<p>using <code>babel-loader</code><br>1. Install Babel and the presets:</p>
<pre>`npm install --save-dev babel-loader
`</pre>
</li>
<li><p>Configure Babel to use there presets by add <code>.babelrc</code></p>
<pre>`{'presets':['es2015']}
`</pre>
</li>
<li><p>Modify <code>webpack.config.js</code> to process all <code>.js</code> files using <code>babel-loader</code>.</p>
<pre>`module.exports = {
  entry: './src/app.js',
  output: {
    path: './dist',
    filename: '[name].bundle.js'
  },
  module: {
    loaders: [
      {test: /\.js$/,exclude: /node_modules/, loader: 'babel-loader',}
    ]
  }
}
`</pre>

<p>We are excluding <code>node_modules</code> here because otherwise all external libraries will also go through Babel, slowing down compilation.<br>4. Install the libraries you want to use</p>
<pre>`npm install --save jquery babel-polyfill
`</pre>

<p>We are using <code>--save</code> instead of <code>--save-dev</code> this time, as there libraries will be used in runtime. <code>-dev</code> means the libraries only used during development.</p>
</li>
<li><p>Edit <code>src/app.js</code></p>
<p><pre>`import ‘babel-polyfill’;<br> import cats from ‘./cats’;<br> import $ from ‘jquery’;</pre></p>
<p> $(‘&lt;h1&gt;Cats&lt;/h1&gt;’).appendTo(‘body’);<br> const ul = $(‘&lt;ul&gt;&lt;/ul&gt;’).appendTo(‘body’);<br> for (const cat of cats) {</p>
<pre><code>$(&apos;&amp;lt;li&amp;gt;&amp;lt;/li&amp;gt;&apos;).text(cat).appendTo(ul);
</code></pre><p> }</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">    6\. Using Plugins</div><div class="line">    An example would be minifying your file so that the client can load if faster. This can be done with **plugins**. We&apos;ll add the uglify plugin to our configuration:</div><div class="line"></div><div class="line">const webwebpack = require(&apos;webpack&apos;);</div><div class="line">module.exports = &#123;</div><div class="line">  entry: &apos;./src/app.js&apos;,</div><div class="line">  output: &#123;</div><div class="line">    path: &apos;./dist&apos;,</div><div class="line">    filename: &apos;[name].bundle.js&apos;</div><div class="line">  &#125;,</div><div class="line">  module: &#123;</div><div class="line">    loaders: [</div><div class="line">      &#123;test: /&amp;#46;jsx?$/, exclude: /node_modules/,loader: &apos;babel-loader&apos;&#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">plugins: [</div><div class="line">    new webpack.optimize.UglifyJsPlugin(&#123;</div><div class="line">      compress: &#123;</div><div class="line">        warning:false,</div><div class="line">      &#125;,</div><div class="line">      output: &#123;</div><div class="line">        comments: false,</div><div class="line">      &#125;,</div><div class="line">      &#125;),</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>The Uglify plugin is included with webpack so you don’t need to add additional modules, but this may not always be the case.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Refs to Components]]></title>
      <url>/2016/07/21/refs-to-components/</url>
      <content type="html"><![CDATA[<p>The DOM returned from render() is virtual, so called Virtual DOM, and we can get any factual input(value) from a virtual object, such as access to value from a <input> component.</p>
<h3 id="The-ref-returned-from-ReactDOM-render"><a href="#The-ref-returned-from-ReactDOM-render" class="headerlink" title="The ref returned from ReactDOM.render"></a>The ref returned from ReactDOM.render</h3><p>ReactDOM.render() will return a reference to your component’s <strong>backing instance</strong>(or null for stateless components)</p>
<p><code>var myComponent = ReactDOM.render(&amp;lt;MyComponent /&amp;gt;, myContainer)</code></p>
<p>However, that the JSX doesn’t return a component. It’s just a <strong>ReactElement</strong>: a lightweight representation that tells React what the mounted component should look like.</p>
<pre><code>var myComponentElement = &amp;lt;MyComponent title = &apos;title&apos;/&amp;gt;; //This is just a ReactElement
`&lt;/pre&gt;

&lt;pre&gt;`var myComponentInstance = ReactDOM.render(myComponent, myContainer); //a Virtual DOM
`&lt;/pre&gt;

### The ref Callback Attribute

React supports a special attribute that you can attach to any component. The &apos;ref&apos; attribute ca be a callback function, and this callback will be executed **immediately after the component is mounted**. The referenced component will be passed in as a parameter, and the callback function may use the component immediately, or save the reference for future use.

It&apos;s as simple as adding a `ref` attribute to anything returned from render:

&lt;pre&gt;`render: function(){
  return (
    &amp;lt;TextInput ref={function(input){
      if(input != nill){
        input.focus();
      }
    }} /&amp;gt;
  );
},
`&lt;/pre&gt;

or use ES6 arrow funciton:

&lt;pre&gt;`render: function(){
  return &amp;lt;TextInput ref={(c) =&amp;gt; this._input = c} /&amp;gt;;
},
componentDidMount: function{
  this._input.focus();
}
`&lt;/pre&gt;

### The ref String Attribute

React also supports using a string as a ref prop on any component.
Add `ref` attribute to component so you can access to them via `this.refs`
</code></pre><ol>
<li><p>Assign a <code>ref</code> attribute to anything returned from <code>render</code> such as:</p>
<pre>`&lt;input ref='myInput'&gt;
`</pre>
</li>
<li><p>In some other code, access the <strong>backing instance</strong> via <code>this.refs</code> as in</p>
<pre>`var input = this.refs.myInput;
var inputValue = input.value;
`</pre>

<h3 id="A-Complete-Example"><a href="#A-Complete-Example" class="headerlink" title="A Complete Example"></a>A Complete Example</h3><p><pre>`var MyComponent = React.createClass({<br>  handleClick: function(){</pre></p>
<pre><code>if(this.myTextInput != null){
  this.myTextInput.focus()
}
</code></pre><p>  },<br>  render: function(){</p>
<pre><code>return(
  &amp;lt;div&amp;gt;
    &amp;lt;input type=&apos;text&apos; ref={(ref) =&amp;gt; this.myTextInput = ref} /&amp;gt;
    &amp;lt;input type=&apos;button&apos; value=&apos;Focus the text input&apos; onClick = {this.handleClick} /&amp;gt;
  &amp;lt;/div&amp;gt;
);
</code></pre><p>  }<br>});</p>
<p>ReactDOM.render(&lt;MyComponent /&gt;, document.getElementById(‘example’));</p>
</li>
</ol>
<p>Note: <code>ref</code> will be destroyed as component unmounted.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Component API]]></title>
      <url>/2016/07/21/component-api/</url>
      <content type="html"><![CDATA[<h3 id="setState-nextState-obj-callback-function"><a href="#setState-nextState-obj-callback-function" class="headerlink" title="setState(nextState(obj)[, callback(function)])"></a>setState(nextState(obj)[, callback(function)])</h3><p>设置 nextState 的某个键值, 然后下一次 EventLoop 的时候 this.state 会被更新<br><strong>注意</strong>, setState 方法中的回调函数在组件重新渲染后才被调用</p>
<h3 id="replaceState-nextState-obj-callback-function"><a href="#replaceState-nextState-obj-callback-function" class="headerlink" title="replaceState(nextState(obj)[, callback(function)])"></a>replaceState(nextState(obj)[, callback(function)])</h3><p>类似于 setState(), 但是会删除已存在的 state 键, 相当于重新初始化State</p>
<h3 id="forceUpdate-callback-function"><a href="#forceUpdate-callback-function" class="headerlink" title="forceUpdate([callback(function)])"></a>forceUpdate([callback(function)])</h3><p>强制渲染组件<br><strong>注意</strong>该方法的回调函数也是在组件重新渲染完成后调用</p>
<h3 id="getDOMNode"><a href="#getDOMNode" class="headerlink" title="getDOMNode()"></a>getDOMNode()</h3><p>返回组件所处的 DOM 元素</p>
<h3 id="isMounted"><a href="#isMounted" class="headerlink" title="isMounted()"></a>isMounted()</h3><p>返回一个 Boolean 值, 如果组件加载到了 DOM, isMount() 返回 true.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React 顶层 API]]></title>
      <url>/2016/07/21/react-e9-a1-b6-e5-b1-82-api/</url>
      <content type="html"><![CDATA[<h3 id="React-createClass-obj"><a href="#React-createClass-obj" class="headerlink" title="React.createClass(obj)"></a>React.createClass(obj)</h3><p>创建一个 ReactClass(组件类), 参数是一个对象且必须有 render 属性. 该方法必须返回一个封闭的容器或 null/false(表示不渲染)</p>
<p>在该方法中, 所有的 this 都会在最终调用的时候绑定到创建的组件的构造器上.</p>
<h3 id="React-createElement-TYPE-string-ReactClass-PROPS-CHILDREN-ReactElement"><a href="#React-createElement-TYPE-string-ReactClass-PROPS-CHILDREN-ReactElement" class="headerlink" title="React.createElement(TYPE(string|ReactClass)[, PROPS[, CHILDREN(ReactElement)]])"></a>React.createElement(TYPE(string|ReactClass)[, PROPS[, CHILDREN(ReactElement)]])</h3><p>创建一个指定类型的 React 元素(要区分 ReactClass(通性) 和 ReactElement( 个性) 和 Virtual DOM(实例), 通过 ReactClass 创建 ReactElement, 然后实例化成 Virtual DOM: 比如 ButtonComponent 是 Class, 而&lt;ButtonCompoennt /&gt;则是 Element, 最后通过 ReactDOM.render() 生成Virtual DOM)<br>第三个参数 Children 可以是人一个书的 React 元素</p>
<pre><code>React.createElement(&apos;div&apos;, null, 
  React.createElement(&apos;p&apos;, null, 
    React.createElement(Component, {a:1})
  )
)
`&lt;/pre&gt;

### React.cloneElement(TYPE(ReactElement)[, PROPS(object)[, CHILDREN(ReactElement)]])

克隆并返回一个新的 ReactElement(内部子元素也会随之克隆), 新返回的元素会保留就元素的 props, ref, key, 也会集成新的 props( 如果第二个参数不为 null)

&lt;pre&gt;`var Hello = React.createClass({
  render: function(){
    var span = &amp;lt;span a = &apos;1&apos;&amp;gt;Span&amp;lt;/span&amp;gt;;
    var newSpan = React.cloneElement(span,{b:&apos;2&apos;}, &amp;lt;em&amp;gt;EM&amp;lt;/em&amp;gt;);
    console.log(newSpan.props);
    return &amp;lt;div&amp;gt;Hello {span},{newSpan}&amp;lt;/div&amp;gt;;
  }
});
`&lt;/pre&gt;

注意 createElement的第一个参数必须是字符串或者 ReactClass, 而 cloneElement 的第一个参数只能是 ReactClass

### React.createFactory(TYPE(string|ReactElement))

返回一个某种类型的 ReactElement 工厂函数, 可以利用返回的函数来创建一个 ReactElement( 配置 props 和 children)

&lt;pre&gt;`var Component = React.createClass({
  render:function(){
    return this.props.a == 1? &amp;lt;p&amp;gt;123&amp;lt;/p&amp;gt; : null;
  }
});

var p = React.createFactory(Component),
    ReactElementP = p{{a:1}},
    div = React.createFactory(&apos;div&apos;),
    ReactElementDiv = div(null, ReactElementP);

React.render(
  ReactElementDiv, document.body
);
`&lt;/pre&gt;

### React.render(REACTELEMENT(ReactElement), CONTAINER(DOMElement)[, CALLBACK(function)])

渲染一个 ReactElement 到 container 指定的 DOM 中, 并返回一个到该组件的引用. 如果提供了可选的回调函数, 则该函数会在组件渲染或更新之后调用

如果我们希望在组件外部可以获得组件内部(能通过 this 访问)的东西, 可以将 React.render 的返回值赋予一个变量, 在后续的调用中访问变量即可.

### React.unmountComponentAtNode(CONTAINER(DOMElement)

从 container 指定的 DOM 中移除已经加载的 ReactElement, 清楚相应的事件处理器和 state, 如果在 container 中没有存在的组件, 则不作处理
如果组件清除成功, 则返回 true

### React.renderToString(REACTELEMENT(ReactElement))

React 为服务端提供的一个方法, 可以直接输出 ReactElement 为 HTML 字符串, 将这些标记发送(比如 res.write(HTMLString))给客户端, 可以获得更快的页面加载速度, 并有利于搜索引擎的抓取

&lt;pre&gt;`var com = &amp;lt;Component /&amp;gt;
comHTML = React.renderToString(com) //HTMLString
`&lt;/pre&gt;

### React.renderToStaticMarkup

类似于 React.renderToString, 但只生成纯粹的 HTML 标记字符串, 不会包含类似 dta-reactid 之类的 React 属性, 从而节约字节数

### React.initializeTouchs(ShouldUserTouch(boolean))

开启或关闭 React 的触摸事件机制, 传入参数 true 使 React 响应 Touch 事件

### React.Chilren

#### React.Children.map(obj children, function[, object context])

遍历子元素, 映射为一个新的子元素集合

&lt;pre&gt;`var Component = React.createClass({
  render: function(){
    return (
      &amp;lt;ul&amp;gt;
        {React.Children.map{
          this.props.children, function(){
            return &amp;lt;li&amp;gt;{child}&amp;lt;/li&amp;gt;
            }
          }
        }
      &amp;lt;/ul&amp;gt;
    )
  }
})
</code></pre><h4 id="React-Children-forEach-obj-children-function-obj-context"><a href="#React-Children-forEach-obj-children-function-obj-context" class="headerlink" title="React.Children.forEach(obj children, function[, obj context])"></a>React.Children.forEach(obj children, function[, obj context])</h4><p>遍历子元素, 对每个子元素执行回调, 但不会返回一个新的集合</p>
<h4 id="React-Children-count-obj-children"><a href="#React-Children-count-obj-children" class="headerlink" title="React.Children.count(obj children)"></a>React.Children.count(obj children)</h4><p>返回子元素总个数</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Updating with React.render]]></title>
      <url>/2016/07/20/updating-with-react-render/</url>
      <content type="html"><![CDATA[<h3 id="What-does-React-render-do"><a href="#What-does-React-render-do" class="headerlink" title="What does React.render do"></a>What does React.render do</h3><ol>
<li>First, validate the inputs</li>
<li>If there was no previous component, render as a new component</li>
<li>Otherwise, compare the next component to the previous component using <strong>“shouldCUpdateComponent”</strong></li>
<li>If <strong>“shouldUpdateComponent”</strong> is true, update the component using ReactComponent.updateComponent. Otherwise, unmount and continue to render as a new component</li>
</ol>
<p><code>React.render</code> gives you a declarative way to use React’s update flow at the top level, similar to how re-rendering works inside a component. Many times, however, you can create a wrapper component so that you only have a single <code>React.render</code> call. This allows you to keep the logic inside components, which may be cleaner.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[React 组件生命周期]]></title>
      <url>/2016/07/20/react-e7-bb-84-e4-bb-b6-e7-94-9f-e5-91-bd-e5-91-a8-e6-9c-9f/</url>
      <content type="html"><![CDATA[<h3 id="Mounting-组件初始化相关"><a href="#Mounting-组件初始化相关" class="headerlink" title="Mounting/组件初始化相关"></a>Mounting/组件初始化相关</h3><p>componentWillMount<br>componentDidMount</p>
<h3 id="Updating-组件更新相关"><a href="#Updating-组件更新相关" class="headerlink" title="Updating/组件更新相关"></a>Updating/组件更新相关</h3><p>componentWillReceiveProps<br>shouldComponentUpdate<br>componentWillUpdate<br>componentDidUpdate</p>
<h3 id="Unmounting-组件移除相关"><a href="#Unmounting-组件移除相关" class="headerlink" title="Unmounting/组件移除相关"></a>Unmounting/组件移除相关</h3><p>componentWillUnmount</p>
<h3 id="Initial-相关"><a href="#Initial-相关" class="headerlink" title="Initial 相关"></a>Initial 相关</h3><p>getDefaultProps<br>getInitialState</p>
<h4 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount"></a>componentWillMount</h4><p>在组件初始化前执行, 但仅执行一次, 即使多次重复渲染该组件,或者改变组件的 state<br>如果希望该回调能执行多次, 可以使用 React.unmountComponentAtNode 移除已有的组件, 然后重新 render</p>
<h4 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h4><p>在组件初始化完成时触发, 同样只能触发一次</p>
<h4 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps"></a>componentWillReceiveProps</h4><p>在组件接收到新的 props 的时间点之前调用, 注意初始化的时候不会触发(此时初始化 props, 而不是获得新的 props), 但是如果组件重复渲染(没有移除), 则会触发此事件</p>
<h4 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h4><p>组件接收到新的 props 或 state 的时候(此时还没进行下一次 render) 会立即调用, 然后通过返回布尔值决定是否要重新渲染当前组件<br>该接口接收两个参数, 第一个参数表示新的props, 第二个表示新的 state</p>
<pre><code>shouldComponentUpdate:function(){return true} //重新渲染组件
</code></pre><h4 id="componentWillUpdate"><a href="#componentWillUpdate" class="headerlink" title="componentWillUpdate"></a>componentWillUpdate</h4><p>shouldComponentUpdate 返回 true 的时候调用, 此时 props 和 state 都是更新后的值, 而组件尚未重新渲染</p>
<h4 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate"></a>componentDidUpdate</h4><p>重新渲染后才会触发</p>
<h4 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h4><p>组件被移除之前触发, 用于做一些必要的清理, 比如无效的定时器等</p>
<h4 id="getDefaultProps"><a href="#getDefaultProps" class="headerlink" title="getDefaultProps"></a>getDefaultProps</h4><p>该方法是最先触发的, 可以在该方法中 return 一个对象作为组件的默认 Props(当然如果有从父组件传来的 props, 则以传进来的为主)<br>只在组件初始化的时候执行一次</p>
<h4 id="getInitialState"><a href="#getInitialState" class="headerlink" title="getInitialState"></a>getInitialState</h4>]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Webpack]]></title>
      <url>/2016/07/20/webpack/</url>
      <content type="html"><![CDATA[<p>Webpack 是一款模块加载兼打包工具, 能把各种资源, 例如 JS(X), coffee, css(sass/less), 图片等都作为模块来使用和处理</p>
<p>可以直接使用 require 的形式来引入各模块, 即时他们可能需要经过编译, webpack 上有各种健全的加载器(loader)会处理这些事情.</p>
<h3 id="Webpack-优势"><a href="#Webpack-优势" class="headerlink" title="Webpack 优势"></a>Webpack 优势</h3><ol>
<li>webpack 是一 commonJS 的形式来书写脚本的, 但对 AMD/CMD 的支持也很全面, 方便就项目进行代码迁移</li>
<li>能被模块化的不仅是 JS 了</li>
<li>开发便捷, 能替代部分 grunt/gulp 工作, 比如打包, 压缩混淆, 图片转 base64等</li>
<li>扩展性强, 插件机制完善, 特别支持 React 热拔插(react-hot-loader).</li>
</ol>
<h3 id="安装与配置"><a href="#安装与配置" class="headerlink" title="安装与配置"></a>安装与配置</h3><p>常规使用 npm 安装<br><code>$npm install -g webpack</code><br>如果是常规项目, 还是把依赖写入 package.json 更好</p>
<pre><code>$npm init
$npm install --save-dev webpack
`&lt;/pre&gt;

### 配置

每个项目下都必须配置一个 webpack.config.js, 他的作用如同常规的 gulpfile.js, 就是一个配置项, 告诉 webpack 需要做什么

比如:

&lt;pre&gt;`var webpack = require(&apos;webpack&apos;);
var commonsPlugin = new webpack.optimize.CommonsChunkPlugin(&apos;common.js&apos;);

module.exports = {
  //插件项
  plugins: [commonsPlugin],

  //页面入口文件配置
  entry:{
    index: &apos;./src/js/page/entry1.js&apos;
  },

  //文件输出配置
  output:{
    path: &apos;dist/js/page&apos;,
    filename: &apos;[name].js&apos;
  },

  module:{
    //加载器配置
    loaders:[
      {test: /\.css$/, loader: &apos;style-loader!css-loader&apos;},
      {test: /\.js$/, loader: &apos;jsx-loader?harmony&apos;},
      {test: /\.scss$/, loader: &apos;style!css!sass?sourceMap&apos;},
      {test: /\.(png|jpg)$/, loader: &apos;url-loader?limit-8192&apos;}
    ]
  },
};
`&lt;/pre&gt;

#### plugins 插件项

这里使用了一个 CommonsChunkPlugin 的插件, 用于提取多个入口文件的公共部分, 然后生成一个 common.js 来访方便多页面之间的复用

#### entry 是页面入口文件配置, output 是输出配置

决定入口文件要生成什么名字的文件, 存放到哪里

&lt;pre&gt;`{
  entry: {
    page1: &apos;./page1&apos;,
    //支持数组, 将加载数组中的所有模块, 但一最后一个模块为输出
    page2: [&apos;./entry1&apos;,&apos;./entry2&apos;]
  },
  output:{
    path:&apos;dist/js/page&apos;,
    filename: &apos;[name].bundle.js&apos;
  }
}
`&lt;/pre&gt;

这段代码最终会生成一个page1.bundle.js, 和一个page2.bundle.js, 并存放到./dist/page下

#### module.loaders 是最关键的配置

告诉 webpack 每一种文件都要用什么加载器来处理
多个 loader 之间用&apos;!&apos;连接
所有加载器都要通过 npm 来加载
配置信息的参数&apos;?limit=8192&apos;表示将所有小于8kb的图片都转为 base64格式, 超过8kb 的图片用 url-loader 来处理

### 运行 webpack

`$webpack --display-error-details`
后面的参数&apos;--display-error-details&apos; 是推荐加上的, 方便出错的时候能查阅更详细的信息
其他主要参数有

&lt;pre&gt;`$webpack --config XXX.js //使用另一份配置文件
$webpack --watch //监听变动并自动打包
$webpack -p //压缩混淆脚本, 这个很重要
$webpack -d //生成 map 隐射文件, 告知哪些模块被最终打包到哪里
`&lt;/pre&gt;

### 模块引入

#### HTML

直接在页面&amp;lt;body&amp;gt;中引入 webpack 最终生成的页面脚本即可

&lt;pre&gt;`&amp;lt;body&amp;gt;
  &amp;lt;script scr = &apos;dist/js/page/common.js&apos;&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;script scr = &apos;dist/js/page/index.js&apos;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
`&lt;/pre&gt;

可以看到连样式都不需要, 脚本执行的时候会动态生成&amp;lt;style&amp;gt;并注入 head

#### JS

各脚本模块可以直接用 commonJS 来书写, 并可以直接引入未经编译的模块, 比如 JSX, Sass, coffee 等(只要在 webpack.config.js 中配置好加载器)
看一下编译前的页面入口文件(index.js)

&lt;pre&gt;`require(&apos;../../css/reset.scss&apos;); //加载 Reset 模块
require(&apos;../../css/allComponent.scss&apos;); //加载组件模块
var React = require(&apos;react&apos;);
var AppWrap = require(&apos;redux&apos;).createRedux;
var Provider = require(&apos;redux/react&apos;).Provider;
var stores = require(&apos;AppStore&apos;);

var redux = createRedux(stores);
var App = React.createClass({
  render: function(){
    return (
      &amp;lt;Provider redux = {redux}&amp;gt;
        {function() {return &amp;lt;AppWrap /&amp;gt;;}}
      &amp;lt;/Provider&amp;gt;
    );
  }
});

ReactDOM.render(
  &amp;lt;App /&amp;gt;,document.body
);
</code></pre><p>后续的都由 webpack 处理</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Array.from()]]></title>
      <url>/2016/07/20/array-from/</url>
      <content type="html"><![CDATA[<p>Array.from() 方法可以将一个类数组对象或可遍历对象转化为真正的数组.<br>在 ES6 中, Class 语法允许我们为内置类型(比如 Array) 和自定义类新建子类(比如叫 subArray), 这些子类也会继承父类的静态方法, 比如 subArray.from(), 调用该方法后会返回子类 subArray 一个实例, 而不是 Array 的实例.</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><pre><code>Array.from(arrayLike[, mapFn[, thisArg]])
`&lt;/pre&gt;

### 参数

#### arrayLike

想要转换成真实数组的类数组对象或可遍历对象

#### manFn

可选参数, 如果制定了该参数, 则最后生成的数组会经过 map 操作

#### this.Arg

可选参数, 执行 mapFn 时的 this 的值

### 描述

可以使用 Array.from()将下面的两种对象转换成数组
- 类数组对象(拥有 length 属性和若干索引属性的任意对象)
- 可遍历对象(可以迭代出其他对象, 比如有 Map 和 Set)

Array.from(obj,mapFn,thisArg) 相当于 Array.from(obj).map(mapFn,thisArg)

### 应用

&lt;pre&gt;`var obj = {length:5}; // return {length:5}
var arr =Array.from(obj); // namely Array.from({length:5}), return [undefined * 5]
Array.isArray(arr); //return true
var arr1 = Array.from(obj,(v,k) =&amp;gt; k); //return [0,1,2,3,4]
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[package.json 属性]]></title>
      <url>/2016/07/20/package-json-e5-b1-9e-e6-80-a7/</url>
      <content type="html"><![CDATA[<h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p>package.json 中最重要的属性是 name 和 version. 这两个属性是必须要有的, 否则模块无法被安装. 这两个属性一起形成了一个 npm 模块的唯一标识符.<br>模块中内容变化的同时, 模块版本也应该一起变化.<br>name 属性就是你的模块名称, 下面是一些命名规则:</p>
<ul>
<li>name 必须小于等于214字节, 包括前缀名称在内(如../..module)</li>
<li>name 不能以’_’或’.’开头</li>
<li>不能有大写字母</li>
<li>name 会成为 url 的一部分, 不能有 url 非法字符</li>
<li>不要使用和 node 核心模块一样的名称</li>
<li>name 中不要有 ‘js’ 和 ‘node’</li>
</ul>
<h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><p>version 必须可以被 npm 依赖的一个 node-server 模块解析</p>
<h3 id="description"><a href="#description" class="headerlink" title="description"></a>description</h3><p>一个描述, 方便别人了解你的模块的作用, 搜索的时候也有用</p>
<h3 id="keywords"><a href="#keywords" class="headerlink" title="keywords"></a>keywords</h3><p>一个字符串数组, 方便别人搜到本模块</p>
<h3 id="homepage"><a href="#homepage" class="headerlink" title="homepage"></a>homepage</h3><p>项目主页 url<br>注意: 这个项目主页 url 和 url 属性不同, npm 注册工具会认为你把项目发布到其他地方了, 获取模块的时候不是从官方仓库后去, 而是去 url 配置的地址</p>
<h3 id="bugs"><a href="#bugs" class="headerlink" title="bugs"></a>bugs</h3><p>填写一个提交 bug 的地址或邮箱</p>
<pre><code>{
 &apos;url&apos;: &apos;https://www.ezcook.de/project/issue&apos;,
 &apos;email&apos;: &apos;project@ezcook.de&apos;
}
`&lt;/pre&gt;

如果只填写一个, 可以返回字符串而不是对象

### license

为模块制定一个协议, 通知用户可以使用的权限, 最常见的是 BSD-3-Clause 或 MIT

&lt;pre&gt;`{&apos;license&apos;: &apos;MIT&apos;}
`&lt;/pre&gt;

### author, contributors

### files

files 属性的值是一个数组, 内容是模块下文件名或文件夹名, 如果是文件夹名, 则文件夹下所有文件也会被包含.
可以在模块根目录下创建一个 &apos;.npmignore&apos; 文件, 写在这个文件里的文件会被排除在 file 属性

### main

main 属性指定程序的主入口文件, 比如这个模块(文件夹)命名为&apos;foo&apos;, package.json中&apos; main&apos; 属性指定为&apos;test.js&apos;, 则通过 require(foo)来使用模块的时候会滴啊用 test.js 脚本.
他应该指向模块根目录下得一个文件, 默认为 index.js

### bin

很多模块有一个或多个需要配置到 PATH 路径下的可执行模块...

### man

制定一个或通过数组指定一些文件夹让 linux 下的 man 指令查找文档地址

### directories

### repository

指定一个代码存放的地址

&lt;pre&gt;`&apos;repository&apos;:
{
  &apos;type&apos;:&apos;git&apos;,
  &apos;url&apos;:&apos;https://github.com/...&apos;
}
</code></pre><p>如果是 Github, 可以用缩写完成<br>‘repository’:’gist:…’`</p>
<h3 id="scripts"><a href="#scripts" class="headerlink" title="scripts"></a>scripts</h3><p>scripts 属性是一个对象, 里面制定了项目的生命周期各个环节需要执行的命令, key 是生命周期中的时间, value 是要执行的命令<br>具体内容有 install, start, stop 等, 详情见<a href="https://docs.npmjs.com/misc/scripts" target="_blank" rel="external">npm/scripts</a></p>
<h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>用来设置一些项目不怎么变化的项目配置, 如 port 等</p>
<h3 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h3><p>dependencies 属性是一个对象, 配置依赖模块的模块列表, key 是模块名称, vlaue 是版本范围, 版本范围是一个字符, 可以被一个或多个空格分隔.<br>比如<br>```<br>‘dependencies’:<br>{<br>  ‘foo’:’1.0.0 - 2.0.0’<br>  ‘foo1’:’&gt;=1.0.0’<br>}</p>
<h3 id="devDependencies"><a href="#devDependencies" class="headerlink" title="devDependencies"></a>devDependencies</h3><p>如果有人想下载并使用你的模块, 也许他们并不希望或需要下载一些你在开发过程中额外的测试或文档框架<br>这种情况下最好把这些依赖添加到 devDependencies 中, 这些模块会在 npm link 或者 npm install 的时候被安装, 也可以像其他 npm 配置一样被管理</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NPM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用 npm 创建新工程]]></title>
      <url>/2016/07/20/e4-bd-bf-e7-94-a8-npm-e5-88-9b-e5-bb-ba-e6-96-b0-e5-b7-a5-e7-a8-8b/</url>
      <content type="html"><![CDATA[<p>创建一个工程目录, 并 cd 到目录中, 运行<br><code>$npm init</code><br>这个工具将引导你创建一个 package.json 文件, 他只覆盖了大多数一般的项目, 并尽量让默认内容全面.<br>运行<code>npm help json</code> 获取 package.json 中的各个字段的文档及其定义<br>后面可以用<br><code>npm install &amp;lt;pkg&amp;gt; --save</code><br>来安装一个包并将其存储为 package.json 文件中的一个依赖模块<br>任何时间按下^C 退出.<br>简单来说:<br><code>npm init</code> 创建或修改一个项目中的 package.json 文件<br>默认名称(显示在括号中)是当前文件夹的名字, 如果对于提示不输入任何字符并按下 Enter 键, npm 会将默认名称当做项目名称.<br>在完成提示内容后, npm init 将会给你一个即将创建的 package.json 文件的预览, 对于我们来说, 他看起来是这样的</p>
<pre><code>{
&quot;name&quot;:&quot;project-name&quot;,
&quot;version&quot;:&quot;0.0.0&quot;,
&quot;description&quot;:&quot;...&quot;,
&quot;main&quot;:&quot;index.js&quot;,
&quot;scripts&quot;:{
  &quot;test&quot;:&quot;echo \&quot;Error:no test specified\&quot; &amp;amp;&amp;amp; exit 1&quot;
},
&quot;keywords&quot;:[&quot;npm&quot;,&quot;example&quot;],
&quot;author&quot;:&quot;YourName&quot;,&quot;license&quot;:&quot;MIT&quot;
}
`&lt;/pre&gt;

按下 Enter 进行确认, 你可以在后面随时修改, 通过编辑 package.json 或再次运行 npm init.
npm init 永远也不会移除你放在 package.json 中的信息, 仅仅根据需求进行调整.

### package.json

一个项目的 package.json 文件担任下列角色
- 他为 npm 提供一切信息
- 他告诉 Node 怎样处理一个包
- 他为人们查看项目提供一个进入点

### 创建一个包进入点

现在创建一个非常简单的脚本并将它存为 index.js

&lt;pre&gt;`//index.js
console.log(&quot;Hello, npm&quot;);
`&lt;/pre&gt;

我们可以直接运行脚本

&lt;pre&gt;`$node index.js
Hello, npm
`&lt;/pre&gt;

我们可以通过使用 require, 在其他的 Node 应用中应用这段脚本. 首先进入 Node REPL, 一个交互的命令行环境:

&lt;pre&gt;`$node
&amp;gt; require(&apos;./index.js&apos;)
Hello, npm
{}
`&lt;/pre&gt;

({}是 require 的返回值, 在这个例子中, 他是 index.js 的 exports 对象)
Node 允许我们省略.js 扩展名, 因此我们可以简写为 require(&apos;,/index&apos;).
如果我们在同一个 REPL 会话中再次运行 require, 我们将得到相同的返回值, 但是不会得到 console.log 输出, 因为 require 不会在同一个脚本中运行两次.
./在./index 中很重要, 因为他告诉 Node 这个路径是当前文件夹的相对路径. 如果我们不显示给出绝对路径或相对路径, 而是直接给 index, Node 会在一系列文件夹中寻找匹配的模块.

回顾一下, 在 package.json 文件夹中, &apos;main&apos;:&apos;index.js&apos; 的作用是什么?
当你 require 一个包含指向 main 脚本(&apos;main&apos;:&apos;index.js&apos;)的 package.json 文件的文件夹时, Node 会认为你是在 require 这个脚本(&apos;index.js&apos;), 所以前面的代码可以简写为

&lt;pre&gt;`require(./)
`&lt;/pre&gt;

现在我们可以使用 package.json 来完成上面的工作, 因为我们的脚本命名为 index.js, 他是一个文件夹的默认脚本

### 第一个依赖模块

使用下面的命令来快速搜索 npm registry
`$npm search color`
如果想要获得更多的信息, 可以跳转到 npmjs.org, 在&quot;最多依赖&quot;的列表中可以查看流行的库
安装依赖模块
`$npm install --save colors`
这条指令会在本地文件夹中创建一个名为 node_modules 的文件夹并将 colors 下载到其中. `--save`将依赖模块自动加入到 package.json 文件中.

&lt;pre&gt;`&quot;dependencies&quot;{
  &quot;colors&quot;:&quot;~0.6.0-1&quot;
}
`&lt;/pre&gt;

现在我们来重写 index.js 来使用我们的新库. colors 扩展了 String 的原型因此我们可以非常简洁的表达带有颜色的文本:

&lt;pre&gt;`var colors = require(&apos;colors&apos;);
console.log(&apos;Hello, &apos;.red,&apos;npm&apos;.green);
</code></pre><p>运行 index.js 文件, 你将在原来的输出中获得一个彩色字符串</p>
<h3 id="node-modules-的层级"><a href="#node-modules-的层级" class="headerlink" title="node_modules 的层级"></a>node_modules 的层级</h3><p>当不显示指定相对路径或绝对路径时, Node 首先查找本地的 ndoe_modules 文件夹, 当你使用 npm install 指令的时候这个文件夹被自动创建. 当 Node 发现 node_modules 下有一个叫做 colors 子目录时, Node 将他当做 require 的目标.<br><strong>查看 node_modules/colors/package.json, 可以找到’main’:’colors’ , 因此 require colors这个文件夹时 Node 会认为 require 了 colors.js 这个脚本</strong><br>然后从 require 函数中返回脚本中的 exports 对象.<br>如果找不到 colors 目录, 则会一直搜索到系统的根目录.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> NPM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[display:table-cell]]></title>
      <url>/2016/07/20/displaytable-cell/</url>
      <content type="html"><![CDATA[<h3 id="display-table-cell-属性简述"><a href="#display-table-cell-属性简述" class="headerlink" title="display:table-cell 属性简述"></a>display:table-cell 属性简述</h3><p><code>display:table-cell</code> 属性让标签元素鞥一表格单元格的形式呈现, 类似于 td 标签.<br><code>table-cell</code>与<code>float</code>, <code>position:absolute</code> 不兼容.<br><code>table-cell</code>元素可以设置 width, height, padding, 但是不能设置 margin, 和 td 标签一致.</p>
<h3 id="display-table-cell-与大小不固定元素的垂直居中"><a href="#display-table-cell-与大小不固定元素的垂直居中" class="headerlink" title="display:table-cell 与大小不固定元素的垂直居中"></a>display:table-cell 与大小不固定元素的垂直居中</h3><h3 id="display-table-cell-与两栏自适应布局"><a href="#display-table-cell-与两栏自适应布局" class="headerlink" title="display:table-cell 与两栏自适应布局"></a>display:table-cell 与两栏自适应布局</h3><h3 id="display-table-cell-等高布局"><a href="#display-table-cell-等高布局" class="headerlink" title="display:table-cell 等高布局"></a>display:table-cell 等高布局</h3><p>table 表格中的单元格最大的特点之一就是同一行列表元素都是登高的, 所以等高布局可以借助 table-cell 实现.<br><strong>匿名表格元素创建规则</strong>:CSS2中创建表格元素, 其依赖元素(比如 tr 之于 td, table 之于 tr) 会被模拟出来, 从而使得表格模型能够正常工作. 所有的表格元素都会自动在自身周围生成需要的匿名 table 对象, 使其符合 table/inline-table, table-row, table-cell 的三层嵌套关系.<br>要实现等高布局, 所有的 table-cell 元素一定要留一个用来包裹的标签, CSS 代码如下:<br>```<br>.list_row{display:table-row}<br>.list_cell{display:table-cell;width:30%,padding:1.6%; background-color:#F5F5F5;}<br>.list_center{background-color:#F0F3F9;}//用于和旁边的 cell 区分</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript 的闭包]]></title>
      <url>/2016/07/19/javascript-e7-9a-84-e9-97-ad-e5-8c-85/</url>
      <content type="html"><![CDATA[<p>通常情况下, 求和函数的定义是这样的</p>
<pre><code>function sum(arr){
  return arr.reduce(function(x,y){
    return x+y;
  });
}
sum([1,2,3,4,5]); //15
`&lt;/pre&gt;

但是, 如果不需要立刻求和, 而是在后面的代码中根据需要进行计算, 可以选择返回一个保存了参数的求和函数

&lt;pre&gt;`function lazy_sum(arr){
  var sum = function(){
    return arr.reduce(function(x,y){
      return x+y;
    });
  }
  return sum;
}
`&lt;/pre&gt;

当我们调用`f = lazy_sum()`时会返回保存了参数 arr 的 sum 函数, 直到通过 f()调用 sum 函数前都不会进行求和运算, 可以节约资源.

**需要注意的一点**是每一次调用 lazy_sum() 都会返回一个新的函数, 彼此相互独立, 各自占用内存空间
同时要注意, 尽管每次生成并返回的都是新的 sum 函数, 但是 lazy_sum() 的局部变量是通用的, 可参考**类方法**与**实例**的关系, 这是使用闭包的目的之一

**更要注意**:

&lt;pre&gt;`function count(){
  var arr = [];
  for(var i = 1; i&amp;lt;=3; i++){
    arr.push(function(){
        return i*i;
      });
  }
  return arr;
}

var results = count();
var f1 = results[0];
var f2 = results[1];
var f3 = results[2];
</code></pre><p>在这个例子中, f1(), f2(), f3()的返回值都是16, 原因在于:<br>每一次循环都向 arr 推入一个(function(){})(i), 但都没有计算, 三次循环后 i 变成了4, 所以f1, f2, f3的函数接受的局部变量的值都是4.<br>由此可知闭包保留的是变量, 而不是变量的值.<br>如果一定要引用循环变量, 记得创建一个变量用于保存现场</p>
<p><strong>闭包可以用于实现装饰器</strong></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> Closure </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[前端工作流]]></title>
      <url>/2016/07/19/e5-89-8d-e7-ab-af-e5-b7-a5-e4-bd-9c-e6-b5-81/</url>
      <content type="html"><![CDATA[<p>主要操作包含:</p>
<p>CSS 前缀补全, LESS/SASS 编译, CSS 压缩, JS 合并压缩 ,图片压缩, 部署发布</p>
<h3 id="流程分解"><a href="#流程分解" class="headerlink" title="流程分解"></a>流程分解</h3><p>主要分为</p>
<p>开发过程</p>
<p>和</p>
<p>部署过程</p>
<h4 id="开发过程"><a href="#开发过程" class="headerlink" title="开发过程"></a>开发过程</h4><p>要求每一次编辑都能在页面上即时相应</p>
<h4 id="部署过程"><a href="#部署过程" class="headerlink" title="部署过程"></a>部署过程</h4><ul>
<li>CSS Autoprefixer</li>
<li>Less/Sass =&gt; CSS</li>
<li>CSS 压缩合并</li>
<li>CSS Sprite</li>
<li>Retina @2x &amp; @3x 自动生成适配</li>
<li>imagemin 图片压缩</li>
<li>JS 合并压缩</li>
</ul>
<h3 id="项目目录结构"><a href="#项目目录结构" class="headerlink" title="项目目录结构"></a>项目目录结构</h3><p>project                  //项目目录<br>|<strong><strong>dev                 //开发目录<br>| |</strong></strong>html<br>| |<strong><strong>images<br>| |</strong></strong>scripts<br>| |<strong><strong>slice             //合成的雪碧图<br>| |</strong></strong>styles<br>|<strong><strong>dist                //生产目录<br>| |</strong></strong>html<br>| |<strong><strong>images<br>| |</strong></strong>scripts<br>| |<strong><strong>sprite            //仅从 src 复制<br>| |</strong></strong>styles<br>|<strong><strong>gulpfile.js<br>|</strong></strong>src                 //源文件目录<br>| |<strong><strong>html<br>| |</strong></strong>images<br>| |<strong><strong>scripts<br>| |</strong></strong>slice             //雪碧图素材<br>| |____styles</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Gulp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac OS 下 实现 tree 指令]]></title>
      <url>/2016/07/19/macos-e4-b8-8b-e5-ae-9e-e7-8e-b0tree-e6-8c-87-e4-bb-a4/</url>
      <content type="html"><![CDATA[<p>先安装 zsh<br>进入<code>~/.zshrc</code>, 添加<br><code>alias tree=&quot;find . -print | sed -e &#39;s;[^/]*/;|____;g;s;____|; |;g&#39;&quot;</code><br>回到目录, 执行<br><code>source .zshrc</code> 令修改立即生效<br>可以使用<code>tree</code>指令生成文档树</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Bash </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RegExp in JS]]></title>
      <url>/2016/07/19/regexp-in-js/</url>
      <content type="html"><![CDATA[<h3 id="Literal"><a href="#Literal" class="headerlink" title="Literal"></a>Literal</h3><p><code>/patter/attributes</code></p>
<h3 id="new-RegExp"><a href="#new-RegExp" class="headerlink" title="new RegExp"></a>new RegExp</h3><p><code>new RegExp(pattern, attribtues)</code></p>
<h3 id="pattern"><a href="#pattern" class="headerlink" title="pattern"></a>pattern</h3><h3 id="RegExp-Attribtues"><a href="#RegExp-Attribtues" class="headerlink" title="RegExp Attribtues"></a>RegExp Attribtues</h3><ul>
<li>g: global</li>
<li>i: ignoreCase</li>
<li>m: multi-lines</li>
<li>source: literal text</li>
<li>lastIndex: mark the index where to start next match</li>
</ul>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><pre><code>var re = new RegExp(&apos;^[0-9]+$&apos;,&apos;g&apos;);
console.log(re.source); //^[0-9]+$
`&lt;/pre&gt;

&lt;pre&gt;`var re = new RegExp(&apos;\\d{3}&apos;,&apos;g&apos;);
var str = &apos;123a456b&apos;;
console.log(re.lastIndex); // 0
re.exec(str); //return [&apos;123&apos;]
console.log(re.lastIndex); // 3
re.exec(str); // [&apos;456&apos;]
console.log(re.lastIndex); //7
re.exec(str);
console.log(re.lastIndex) // 0, reset to 0 if exceed.
re.lastIndex = 3; //Set Start Index
re.exec(str); // [&apos;456&apos;]
</code></pre><h3 id="RegExp-Methods"><a href="#RegExp-Methods" class="headerlink" title="RegExp Methods"></a>RegExp Methods</h3><p>re.compile(re) //execute RegExp in scripts<br>re.exec(str) //return an Array including String, or null.<br>re.test(str) =&gt; true/false</p>
<h3 id="String-Methods"><a href="#String-Methods" class="headerlink" title="String Methods"></a>String Methods</h3><p>str.search(re,subStr)<br>str.match(re) =&gt; Array including String<br>str.replace(re,str) =&gt; new String<br>str.split(re)</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
            <tag> RegExp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Shell 指令]]></title>
      <url>/2016/07/19/shell-e6-8c-87-e4-bb-a4/</url>
      <content type="html"><![CDATA[<p>Shell 在计算机科学中是指”提供用户使用界面”的软件, 通常指的是命令行界面的解析器, 一般来说, 这个词指的是操作系统中提供访问内核所提供服务的程序. Shell 也用于泛指为所有用户提供操作界面的程序, 也就是程序和用户交互的层面. 因此与之相对的是程序内核(Core), 内核不提供和用户的交互功能.</p>
<h3 id="bash-Bourne-Again-Shell-是-Linux-标准的默认-shell-支持-POSIX-标准-完全兼容-sh"><a href="#bash-Bourne-Again-Shell-是-Linux-标准的默认-shell-支持-POSIX-标准-完全兼容-sh" class="headerlink" title="bash (Bourne Again Shell) 是 Linux 标准的默认 shell, 支持 POSIX 标准, 完全兼容 sh."></a>bash (Bourne Again Shell) 是 Linux 标准的默认 shell, 支持 POSIX 标准, 完全兼容 sh.</h3><p>进入 shell: 一般 Linux 系统中, 桌面(GUI)状态下使用快捷键 Ctrl+Alt+T 能打开一个虚拟终端, 输入 shell 命令并执行.<br>退出 shell: 在 shell 中输入 exit 然后回车<br>默认提示符: 普通用户$, 根用户#<br>查看 shell 版本: <code>echo $SHELL</code><br>查看命令的辅助信息:<br><code>--help</code>, <code>--version</code></p>
<h3 id="目录文件指令"><a href="#目录文件指令" class="headerlink" title="目录文件指令"></a>目录文件指令</h3><p>pwd: 查看当前目录<br>echo $HOME 或者 echo ~: 查看主目录</p>
<p>ls: 列出文件或目录下的文件名</p>
<ul>
<li>-a(all): 显示所有文件, 包括隐藏文件</li>
<li>-l(long): 显示详细信息(long 表示长格式显示)</li>
<li>-d(detail): 显示目录属性</li>
<li>-h(human): 人性化显示文件大小</li>
<li>-i(inode): 显示 inode</li>
<li>-ll(ls -l): 显示目录下文件的长信息</li>
</ul>
<p>cd: 改变目录</p>
<ul>
<li>~ 进入当前用户的根目录</li>
<li>同上</li>
<li>-进入上次目录</li>
<li>.. 进入上一级目录</li>
<li>. 进入当前目录</li>
</ul>
<p>mkdir: 创建目录(文件夹)</p>
<ul>
<li>-p 递归创建<br>e.g. mkdir b/a =&gt;fail, mkdir不能创建多级目录<br>mkdir -p b/a 同时创建 b 和 a</li>
</ul>
<p>rmdir: 删除空目录</p>
<p>rm: 删除目录及文件</p>
<ul>
<li>-r强制删除目录</li>
<li>-f强制</li>
<li>一般用 rm -rf ..</li>
</ul>
<p>touch: 修改文件时间或者创建文件</p>
<p>chmod: 设置目录或文件的访问权限</p>
<ul>
<li>chmod[选项][操作对象][操作符][权限][文件名]</li>
<li>操作符号<ul>
<li><ul>
<li>添加某个权限</li>
</ul>
</li>
<li>-取消某个权限</li>
<li>=赋予给定权限并取消其他权限</li>
</ul>
</li>
<li>数字设定法<ul>
<li>chmod abc 文件名</li>
<li>其中 abc 各为一个数字, 分别表示 user, group, other 的权限</li>
<li>r为4, w为2, x为1, -为0(二进制位)</li>
<li>rwx = 7; rw- = 6; r-x = 5</li>
</ul>
</li>
<li>访问权限组(每一个文件或目录的访问权限都有三组)<br>在 Linux 中是按照用户和组来设定权限的<ul>
<li>所有者权限: 就是文件或者目录的创建者, 一般来说和 root 用户权限相当. 文件被创建时, 文件所有者自动拥有对该文件的读写和可执行权限.</li>
<li>同组权限: 就是所有者所在的用户组的其他成员的权限</li>
<li>其他用户权限</li>
</ul>
</li>
<li>访问权限(读取, 写入, 执行)<ul>
<li>r: 读取文件内容的权限, 或者浏览目录的权限</li>
<li>w: 新增,修改文件内容的权限, 或者删除, 移动目录内文件的权限</li>
<li>x: 执行文件的权限, 或者进入目录的权限</li>
</ul>
</li>
<li>用 -ll 也就是 -ls l显示文件或目录的详细信息, 最左的一列为文件的访问权限, 例如:<br><code>-rw-r--r-- 1 root root 483997 Jul 15 18:31 sobsrc.tgz</code><br>这里有10个位置, 第一个制定文件的类型, 通常意义上, 一个目录也是一个文件, 如果第一个字符是-, 表示是一个非目录文件, 如果是 d, 表示是一个目录</li>
</ul>
<table><br><thead><br><tr><br>  <th>-</th><br>  <th>rw-</th><br>  <th>r–</th><br>  <th>r–</th><br></tr><br></thead><br><tbody><br><tr><br>  <td>非目录的文件</td><br>  <td>所有者权限</td><br>  <td>组用户</td><br>  <td>其他用户</td><br></tr><br><tr><br>  <td>普通文件</td><br>  <td>可读写</td><br>  <td>只读</td><br>  <td>只读</td><br></tr><br></tbody><br></table>

<p>chown: 改变目录的所有者<br>cp: 复制目录或文件</p>
<ul>
<li>-r 复制目录</li>
<li>-p 连带文件属性复制</li>
<li>-d 若源文件是链接文件, 则复制链接属性</li>
<li>-a 相当于 -pdr</li>
<li>cp[现象][原文件或目录][目标目录]</li>
</ul>
<p>mv: 剪切或改名(move)</p>
<ul>
<li>mv a ../a 将当前目录下的 a 复制剪切到上一级的 a 目录中</li>
<li>mv abc.txt de.txt 如果原文件和目标文件在同一目录下, 则为改名, 否则是剪切</li>
</ul>
<h3 id="文件内容命令"><a href="#文件内容命令" class="headerlink" title="文件内容命令"></a>文件内容命令</h3><p>diff: 比较两个文件的差异<br>patch: 修补文件(给文件打补丁)<br>cat: 输出文件内容<br>more: 逐屏显示文件内容<br>less: 逐页显示文件内容<br>head: 显示文件开头若干行内容<br>tail: 显示文件最后若干行内容<br>od: 查看特殊格式的文件内容</p>
<h3 id="常见目录"><a href="#常见目录" class="headerlink" title="常见目录"></a>常见目录</h3><p>/ 根目录<br>/bin 存放必要的命令<br>/boot 存放内核以及启动所需要的文件<br>/dev 存放设备文件<br>/etc 存放系统的配置文件<br>/home 用户文件的主目录<br>/lib 存放必要的运行库<br>/mnt 存放临时的映射文件系统<br>/proc 存放存储进程和系统信息<br>/root 超级用户的主目录<br>/sbin 存放系统管理程序<br>/tmp 存放临时文件<br>/usr 包含了一般不需要修改的应用程序, 命令程序文件, 程序库,手册等<br>/usr/bin 系统命令(普通用户 home)<br>/usr/sbin 系统命令(超级用户 root)<br>/var 包含系统产生的经常变化的文件</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Bash </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac OS 下前端开发环境配置]]></title>
      <url>/2016/07/19/mac-os-e4-b8-8b-e5-89-8d-e7-ab-af-e5-bc-80-e5-8f-91-e7-8e-af-e5-a2-83-e9-85-8d-e7-bd-ae/</url>
      <content type="html"><![CDATA[<h3 id="安装-homebrew"><a href="#安装-homebrew" class="headerlink" title="安装 homebrew"></a>安装 homebrew</h3><p>终端下执行<br><code>ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></p>
<h3 id="配置-iterm2"><a href="#配置-iterm2" class="headerlink" title="配置 iterm2"></a>配置 iterm2</h3><p>下载后下载配色 solarized, 然后下载 zsh 和 oh-my-zsh, 添加插件 git, osx, ruby, autojump</p>
<h3 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h3><p>终端下执行<br><code>brew install nginx</code><br>安装完成后用浏览器打卡 <a href="http://localhost:8080" target="_blank" rel="external">http://localhost:8080</a>, 如果页面显示正常,则表示安装完成<br>nginx 有一下几个操作</p>
<pre><code>  #打开 nginx
  nginx
  #nginx -s 重新加载配置|重启|停止|退出
  nginx -s reload|reopen|stop|quit
  #测试配置是否有语法错误
  nginx -t
`&lt;/pre&gt;

Note: 如果执行不成功, 请使用 sudo 提权

默认访问目录是
`/usr/local/Cellar/nginx/1.10.0/html`

nginx 的配置文件位置为:
`/usr/local/etc/nginx/nginx.conf`

#### 配置 nginx

首先备份一下 nginx.conf ==&gt; nginx.conf.default
修改server 部分为:

&lt;pre&gt;`server
  {
    listen    8080;
    server_name localhost;

    location /{
      root /Users/YourId/Documents; //项目目录
      #index index.html index.htm;
    }
  }
`&lt;/pre&gt;

配置完成后启动 nginx 即可访问

### 安装 mySQL

终端执行
`brew install mysql`
 安装完成后默认没有密码, 修改密码
 ```
 mysql -uroot -p
 Enter password:
 mysql&gt;use mysql;
 mysql&gt; UPDATE user SET password=password(&quot;修改的密码&quot;) WHERE user=&apos;root&apos;;

mysql 的操作命令

&lt;pre&gt;`  #开启
  mysql.server start
  #结束
  mysql.server stop
</code></pre><p>配置文件位于<br><code>/usr/local/Cellar/mysql/5.6.28/my.cnf</code></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
            <tag> MySQL </tag>
            
            <tag> Nginx </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Component Children]]></title>
      <url>/2016/07/18/component-children/</url>
      <content type="html"><![CDATA[<p><code>this.props.children</code></p>
<p>Children allow you to pass components as data to other components, just like any other prop you use. The special thing about children is that React provides support through its <em>ReactElement API</em> and JSX. XML children translate perfectly to React children.</p>
<pre><code>var MyDiv = React.createClass({
  render: function(){
      return &amp;lt;div&amp;gt;{this.props.children}&amp;lt;/div&amp;gt;
}
});

ReactDOM.render(
  &amp;lt;MyDiv&amp;gt;
      &amp;lt;span&amp;gt;Hello&amp;lt;/span&amp;gt;
      &amp;lt;span&amp;gt;World&amp;lt;/span&amp;gt;
  &amp;lt;/MyDiv&amp;gt;,
  node  
);
`&lt;/pre&gt;

### this.props.children

If you look at the **JSX** transform, you&apos;ll find that XML children are appended as arguments to the _React.createElement_ call.
 Most often, your component will render content and include the children in the _render_ output. This is a great way to create UI components, like cards, headers, and buttons.

Occasionally, you may want to interact with the children, maybe mutating or separating them. Be careful here and remember to treat **this.props.children** as an **opaque data structure**. Instead of working with **this.props.children** directly, use the **React.Children** utilities to work with children.

&lt;pre&gt;`var ListComponent = React.createClasss({
  render: function(){
      var children = React.Children.map(
        this.props.children,
        function(child){
            return &amp;lt;li&amp;gt;{child}&amp;lt;li&amp;gt;
        }
    );
    return &amp;lt;ul&amp;gt;{children}&amp;lt;/ul&amp;gt;;
  }
  });

  var middleChildren = [
  &amp;lt;strong key=&apos;2&apos;&amp;gt;Child 2&amp;lt;/strong&amp;gt;,
  &amp;lt;a href=&apos;#&apos; key=&apos;3&apos;&amp;gt;Child 3&amp;lt;/a&amp;gt;
  ];

  ReactDOM.render(
  &amp;lt;ListComponent&amp;gt;
    &amp;lt;span&amp;gt;Child 1&amp;lt;/span&amp;gt;
    {middleChildren}
    &amp;lt;em&amp;gt;Child 4&amp;lt;/em&amp;gt;
  &amp;lt;/ListComponent&amp;gt;,
  document.body
);
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> React </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Node]]></title>
      <url>/2016/07/18/node/</url>
      <content type="html"><![CDATA[<p>A <strong>Node</strong> is an interface from which a number of DOM types, and allows these various types to be treated similarly.</p>
<h3 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h3><ul>
<li>Node.baseURI: return a DOMStirng representing the base URL</li>
<li>Node.childNodes: return a live NodeList containing all the children of this node. NodeList being live means that if the children of the Node change, the NodeList will update automatically.</li>
<li>Node.firstChild: return a Node representing the first direct child Node of this Node, or Null if the node has no child.</li>
<li>Node.lastChild: Return a Node representing the last direct child Node of this Node, or Null if the node has no child.</li>
<li>Node.nextSibling: return a Node representing the next Node in the tree, or null if there is no one.</li>
<li>Node.previousSibling</li>
<li>Node.nodeName: return a DOMString containing the name of the node. The structure of the name will differ with the name type. E.g. An HTMLElement will contain the name of the corresponding tag, like “audio”, for an HTMLAudioElement, a Text node will have the “#text” string, or a Document node will have the “#document” string.</li>
<li>Node.nodeType: return an unsigned short representing the type of the node. Possible values are:</li>
</ul>
<table><br><thead><br><tr><br>  <th align="left">Name</th><br>  <th align="left">Value</th><br></tr><br></thead><br><tbody><br><tr><br>  <td align="left">Element_Node</td><br>  <td align="left">1</td><br></tr><br><tr><br>  <td align="left">Attribute_Node</td><br>  <td align="left">2</td><br></tr><br><tr><br>  <td align="left">Text_Node</td><br>  <td align="left">3</td><br></tr><br><tr><br>  <td align="left">…</td><br>  <td align="left">…</td><br></tr><br><tr><br>  <td align="left">Document_Node</td><br>  <td align="left">9</td><br></tr><br><tr><br>  <td align="left">Document_Type_Node</td><br>  <td align="left">10</td><br></tr><br><tr><br>  <td align="left">Notation_Node</td><br>  <td align="left">12</td><br></tr><br></tbody><br></table>

<ul>
<li>Node.nodeValue: return a DOMString representing the value of an object. For most node types, this returns <strong>null</strong>, and any set operation is ignored.<br>For Nodes of type TEXT_NODE(Text objects), COMMENT_NODE(Comment objects), and PROGRESSING_INSTRUCTION_NODE(ProgressingInstruction objects), the value corresponds to the text data contained in the obejct.</li>
<li>Node.parentNode: return a Node that is the parent of this node, if there is no such node, like if this node is the top of the tree or if doesn’t participate in a tree, this property returns <strong>Null</strong>.</li>
<li>Node.parentElement: returns an Element that is the parent of this node. If the node has no parent, or if that parent is not an Element, this property returns <strong>Null</strong>.</li>
<li>Node.rootNode: return a Node representing the topmost Node in this tree or the current node if it’s the topmost node in the tree.</li>
<li>Node.textContent: is a DOMString representing the textual content of an element and all its descendants.</li>
</ul>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><ul>
<li>Node.appendChild()</li>
<li>Node.cloneNode(): Clone a Node and optionally all of its contents. By default, it clones the content of the node.</li>
<li>Node.hasChildNodes(): return a <strong>boolean</strong> indicating if the element has any child nodes, or not.</li>
<li>Node.insertBefore(newNode, beforeItsChild)</li>
<li>Node.isEqualNode(): return a <strong>boolean</strong> which indicating whether or not two nodes are of the <strong>same type</strong> and all their defining data points match.</li>
<li>Node.isSameNode(): return a <strong>boolean</strong> value indicating whether or not the two nodes are the same(that is they reference the same object).</li>
<li>Node.removeChild()</li>
<li><p>Node.replace(newNode, replaceItsChild)</p>
<pre><code>*   Note: replaceNode will not generate new one.&lt;/p&gt;
</code></pre><ul>
<li><p>E.g.</p>
<p><code>ul&amp;gt;li*3</code></p>
<p><code>ul.replace(li[2],li[0])</code></p>
<p>it will act as:<br>remove li[2], put it li[0], remove li[0], so the result looks like</p>
<p>ul<br>–li[2]<br>–li[1]<br>`</p>
</li>
</ul>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><h4 id="Browser-All-Child-Nodes"><a href="#Browser-All-Child-Nodes" class="headerlink" title="Browser All Child Nodes"></a>Browser All Child Nodes</h4><p></p><p>The following function recursively cycles all child nodes of a node and executes a callback function upon them(and upon the parent node itself).</p>
<pre>`function DOMComb(oParent, oCallBack){
  if(oParent.hasChildNodes()){
    for(var oNode = oParent.firstChild; oNode; oNode = oNode.nextSibling){
      DOMComb(oNode, oCallBack);
    }
  }
  oCallBack.call(oParent);
}
`</pre>

<h4 id="Remove-all-children-nested-within-a-node"><a href="#Remove-all-children-nested-within-a-node" class="headerlink" title="Remove all children nested within a node"></a>Remove all children nested within a node</h4><p><pre>`Element.prototype.removeAll = function(){<br>  while(this.firstChild){</pre></p>
<pre><code>this.removeAll(this.firstChild);
</code></pre><p>  }<br>  return this;<br>};</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
            <tag> DOM </tag>
            
            <tag> NODE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[innerHTML and textContext and NodeValue]]></title>
      <url>/2016/07/18/innerhtml-and-textcontext-and-nodevalue/</url>
      <content type="html"><![CDATA[<p>Summary: </p>
<ul>
<li><strong>nodeValue</strong> is a little more confusing to use, but faster than innerHTML</li>
<li><strong>innerHTML</strong> parses content as HTML and takes longer(output <code>text/html</code>)</li>
<li><strong>textContent</strong> uses straight text, does not parse HTML, and is faster(output <code>text/plain</code>)</li>
<li><strong>innerText</strong> takes styles into consideration. It won’t get hidden text for instance.</li>
</ul>
<h3 id="node-textContent"><a href="#node-textContent" class="headerlink" title="node.textContent"></a>node.textContent</h3><p>The <strong>Node.textContent</strong> property represents the text content of a node and it descendants.</p>
<h4 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h4><p><code>example.textContent =&quot;&amp;lt;a href=&#39;...&#39;&amp;gt;textContent&amp;lt;/a&amp;gt;&quot;</code><br>will output <code>&amp;lt;a href=&#39;...&#39;&amp;gt;textContent&amp;lt;/a&amp;gt;</code></p>
<h4 id="Differences-from-innerText"><a href="#Differences-from-innerText" class="headerlink" title="Differences from innerText"></a>Differences from innerText</h4><ul>
<li>textContent gets the content of all elements, including <script> and <style> elements, but innerText doesn’t.</li>
<li>innerText is aware of style and will not return the text of hidden elements, whereas textContent will.</li>
<li>As innerText is aware of CSS styling, it will trigger a reflow, whereas textContent will not.</li>
</ul>
<h4 id="Differences-from-innerHTML"><a href="#Differences-from-innerHTML" class="headerlink" title="Differences from innerHTML"></a>Differences from innerHTML</h4><p>innerHTML returns the HTML as its name indicates. Quite often, in order to retrieve or write text within an element, people use innerHTML. textContent should be used instead (to write or retrieve text). Because the text is not parsed as HTML, it’s likely to have better performance.</p>
<h3 id="node-nodeValue"><a href="#node-nodeValue" class="headerlink" title="node.nodeValue"></a>node.nodeValue</h3><p>The <strong>node.nodeValue</strong> property returns or sets the value of the current node.</p>
<h4 id="Syntax-1"><a href="#Syntax-1" class="headerlink" title="Syntax"></a>Syntax</h4><p><code>value = node.nodeValue</code></p>
<p>value is a string containing the value of the current node, if any.</p>
</script></li></ul>]]></content>
      
        <categories>
            
            <category> note </category>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
            <tag> DOM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[<script> 小知识]]></title>
      <url>/2016/07/18/script-e5-b0-8f-e7-9f-a5-e8-af-86/</url>
      <content type="html"><![CDATA[<h3 id="lt-script-gt-按照出现顺序被执行"><a href="#lt-script-gt-按照出现顺序被执行" class="headerlink" title="&lt;script&gt; 按照出现顺序被执行"></a>&lt;script&gt; 按照出现顺序被执行</h3><ul>
<li>后加载的脚本可以依赖先加载的脚本, 但是先加载的脚本堵塞, 整个网页的加载会堵塞.</li>
<li>当一个脚本被执行时, 可以访问前面的 HTML 元素, 但不能访问后面的元素.</li>
<li>页面元素在他之前的所有脚本都加载完之前是不会执行渲染的.</li>
</ul>
<h3 id="async-和-defer"><a href="#async-和-defer" class="headerlink" title="async 和 defer"></a><code>async</code> 和 <code>defer</code></h3><p>HTML5 添加了两个工具用于控制脚本的执行</p>
<ul>
<li><code>async</code> 表示”不用马上执行”. 定义一个页面需要的变量或函数在<code>async</code>中是不行的, 因为你没法知道什么时候<code>async</code>代码会执行</li>
<li><code>defer</code> 表示”等待页面解析完成之后执行”, 大致等价于把脚本绑定到<code>window.onload</code>事件. 当这个代码被执行, DOM 中的一切元素都可以访问, 不同于<code>async</code>, 所有加了<code>defer</code>的脚本会按照他们出现在 HTML 中的顺序执行, 只是推迟到页面解析后按顺序执行.</li>
</ul>
<h3 id="type-属性"><a href="#type-属性" class="headerlink" title="type 属性"></a>type 属性</h3><p>设定解释器<br>若要修改 type 的默认属性(默认为 javascript), 可以通过一个<meta>标记实现:<br><code>&amp;lt;meta http-equiv = &quot;Content-Script-Type&quot; content = &quot;text/vbscript&quot;</code></p>
<h3 id="integrity-属性"><a href="#integrity-属性" class="headerlink" title="integrity 属性"></a>integrity 属性</h3><p><code>integrity</code>属性是子资源完整性新规范的一部分, 他允许你为脚本文件将包含的内容提供一个 hash, 这意味着可以防止在传输的时候内容丢失或被恶意修改. 就算使用了 SSL, 这个规范也是有意义的, 因为有时候你要加载的资源是你无法控制的站外资源.<br>如果你选择使用他, 就要在&lt;script&gt;标记里添加一个 hash 类型以及 hash 值, 将他们以连字符分隔<br><code>&amp;lt;script src=&quot;...&quot; integrity = &quot;hash-value&quot;&amp;gt;&amp;lt;/script&amp;gt;</code></p>
<h3 id="document-currentScript"><a href="#document-currentScript" class="headerlink" title="document.currentScript"></a>document.currentScript</h3><p>IE 不支持的一个新东西叫 <code>document.currentScript</code>, 他指向当前正在执行的脚本, 如果你要从你嵌入的&lt;script&gt;中拿一些属性用</p>
<h3 id="lt-script-gt-和-innerHTML"><a href="#lt-script-gt-和-innerHTML" class="headerlink" title="&lt;script&gt;和 innerHTML"></a>&lt;script&gt;和 innerHTML</h3><p>通过 DOM 动态添加到页面上的 &lt;script&gt; 会被浏览器执行</p>
<pre><code>var myScript = document.createElement(&quot;script&quot;);
myScript.textContent = &quot;alert(&apos;hello&apos;)&quot;;
document.head.appendChild(myScript);
</code></pre><p>然而, 通过<code>innerHTML</code>动态添加到到 HTML 的 &lt;script&gt; 则不会被执行<br><code>document.head.innerHTML += &quot;&amp;lt;script&amp;gt;alert(&#39;Hello&#39;)&amp;lt;/script&amp;gt;&quot;</code><br>Note: 但是他会显示在 HTML 里(尽管不会执行)</p>
]]></content>
      
        <categories>
            
            <category> Uncategorized </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Event]]></title>
      <url>/2016/07/18/event/</url>
      <content type="html"><![CDATA[<p>In computing, an <strong>event</strong> is an action or occurrence recognized by software that may be handled by the software. Computer events can be generated or triggered by the system, by the user or in other ways. Typically, events are handled synchronously with the program flow, that is, the software may have one or more dedicated places where events are handled, frequently an event loop. A source of events includes the user, who may interact with the software by way of, for example, keystroke on the keyboard. Another source is a hardware device such as a timer. Software can be trigger its own set of events into the event loop, e.g. to communicate the completion of a task. Software that changes its behavior in response to events is said to be event-driven, often with the goal of being inactive.</p>
<h3 id="Event-handler"><a href="#Event-handler" class="headerlink" title="Event handler"></a>Event handler</h3><p>In computer programming, an <em>event handler</em> is a <strong>callback</strong> subroutine that handles inputs received in a program(called a <em>listener</em> in Java and JavaScript). Each <em>event</em> is a piece of application-level information from the underlying framework, typically the GUI Toolkit. GUI events including key presses, mouse movement, action selections, and timer expiring.</p>
]]></content>
      
        <categories>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
            <tag> DOM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[DOM Events]]></title>
      <url>/2016/07/18/dom-events/</url>
      <content type="html"><![CDATA[<p><strong>DOM(Document Object Model) events</strong> allow <em>event-driven programming</em> language like JavaScript, JScript, ECMAScript, VBScript and Java to register various <strong>event handler/listener</strong> on the element nodes inside a DOM tree, e.g. HTML, XHTML, XUL, and SVG documents.</p>
<h3 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h3><h4 id="HTML-Events"><a href="#HTML-Events" class="headerlink" title="HTML Events"></a>HTML Events</h4><p>There is a huge collection of events that can be generated by most element nodes:</p>
<ul>
<li>Mouse events;</li>
<li>Keyboard events;</li>
<li>HTML frame/object events;</li>
<li>HTML form events;</li>
<li>User interface events;</li>
<li>Mutation events(notification of any changes to the structure of a document);</li>
<li>Progress events(used by XMLHttpResponse, File API, …)</li>
</ul>
<p>Mouse:<br>click, dblclick, mousedown, mouseover, mousemove, mouseout, dragstart, drag, dragenter, dragleave, dragover, drop, dragend</p>
<ul>
<li>Click: The sequence of click: mousedown, mouseup, click</li>
<li>Mouseover: Fires when the pointing device is moved onto an element</li>
<li>Mouseover: Fires when the pointing device is moved while it is over an element</li>
<li>Dragstart: Fired on an element when a drag is started</li>
<li>Dragend: The source of the drag will receive a dragend event when the drag operation is complete, whether it was sucessful or not,</li>
</ul>
<p>Keyboard:<br>keydown, keypress, keyup</p>
<p>HTML frame/object:<br>load, unload, abort, error, resize, scroll</p>
<ul>
<li>Load: Fires when the <em>user agent</em> finishes loading all content within a document, including window, frames, objects, and images.</li>
<li>Unlaod: Fires when the <em>user agent</em> removes all content from a window or frame.</li>
<li>Abort: Fires when an object/image is stopped from loading before completely loaded.</li>
<li>Error: Fires when an object/image/frame/ cannot be loaded properly.</li>
<li>Resize: Fires when a document view is resized.</li>
<li>Scroll: Fires when an element or document view is scrolled</li>
</ul>
<p>HTML form:<br>select, change, submit, reset, focus, blur</p>
<ul>
<li>Select: Fires when a user selects some text in a <em>text field</em>, including input and textarea.</li>
<li>Change: Fires <strong>when a control loses the input focus</strong> and <strong>its value has been modified since gaining focus</strong>.</li>
<li>Submit: Fires when a form is submitted.</li>
<li>Reset: Fires when a form is reset.</li>
<li>Focus: Fires when an element receives focus either via the pointing device or by tab navigation.</li>
<li>Blur: Fires when an element loses focus.</li>
</ul>
<p>User Interface:<br>focusin, focusout, DOMActivate</p>
<p>Mutation:<br>DOMSubtreeModified, DOMNodeInserted, DOMNodeRemoved, DOMNodeRemovedFromDocument, DOMNodeInsertedIntoDocument, DOMAttrModified, DOMCharacterDataModified</p>
<p>Progress:<br>loadstart, progress, error, abort, load, loadnd</p>
<h4 id="Touch-Events"><a href="#Touch-Events" class="headerlink" title="Touch Events"></a>Touch Events</h4><p>Web broswer running on touch-enabled devices will generate additional events</p>
<p>Touch:<br>touchstart, touchend, touchmove, touchenter, touchleave, touchcancel</p>
<ul>
<li>Touchstart: Fires when a finger is placed on the touch surface/screen.</li>
<li>Touchend: Fires when a finger is removed from the touch surface/screen.</li>
<li>Touchenter: Fires when a touch point moves onto the interactive area defined by a DOM Element</li>
<li>Touchcancel: A <strong>user-agent</strong> must dispatch this event type to indicate when a TouchPoint has been disrupted in an implementation-specific manner, such as by moving outside the bounds of the UA window.</li>
</ul>
<p>In the W3C draft recommendation, a <code>TouchEvent</code> delivers a <code>TouchList</code> of <code>Touch</code> location, the modifier keys that were active, a <code>TouchList</code> of <code>Touch</code> locations within the targeted DOM element, and a <code>TouchList</code> of <code>Touch</code> lcoations that have changed since the previous <code>TouchEvent</code>.</p>
<h4 id="Internet-Explorer-specific-events"><a href="#Internet-Explorer-specific-events" class="headerlink" title="Internet Explorer-specific events"></a>Internet Explorer-specific events</h4><p>In addition to the common/W3C events, two major types of events are added by <em>Internet Explorer</em>. Some of the events have been implemented as <em>de facto standards</em> by other browsers.</p>
<p>Clipbord:<br>cut, copy, paste, beforecut, beforecopy, beforepaste</p>
<p>Data binding:<br>afterupdate, beforeupdate, cellchange, dataavailable, datasetchagned, datasetcomplete, errorudpate, rowenter, rowexit, rowsdelete, rowinserted</p>
<ul>
<li>Afterupdate: Fires immediately after a databound object has been updated.</li>
<li>Beforeupdate: Fires before a data source has changed.</li>
<li>Cellchange: Fires when a data source has change.</li>
<li>Dataavailable: Fires when new data from a data source become available.</li>
<li>Rowenter: Fires whena new row of data from the data source is available.</li>
</ul>
<p>Mouse:<br>contextmenu, selectstart</p>
<ul>
<li>Contentmenu: Fires when the context menu is shown.</li>
<li>Selectstart: Fires when the user starts to select text.</li>
</ul>
<p>Keyboard:<br>help</p>
<ul>
<li>Help: Fires when the user initiates help.</li>
</ul>
<p>HTML frame/object:<br>beforeunload, stop</p>
<ul>
<li>Beforeunload: Fires before a document is unloaded.</li>
<li>Stop: Fires when the user stop loading the object. (unlike abort, stop event can be attached to document).</li>
</ul>
]]></content>
      
        <categories>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
            <tag> DOM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[理解伪元素:before 和 :after]]></title>
      <url>/2016/07/18/e7-90-86-e8-a7-a3-e4-bc-aa-e5-85-83-e7-b4-a0before-e5-92-8c-after/</url>
      <content type="html"><![CDATA[<p><img src="http://jbcdn2.b0.upaiyun.com/2013/10/syntax1.jpg" alt=""></p>
<p>本篇中的”伪元素”特指”:before”和”:after”</p>
<h3 id="语法和浏览器支持"><a href="#语法和浏览器支持" class="headerlink" title="语法和浏览器支持"></a>语法和浏览器支持</h3><p>早起的伪元素是使用一个冒号声明的”:”, 在 CSS3中修订后伪元素的声明使用两个冒号”::”, 但是为了目前的兼容性考虑(IE8), 建议使用”:”声明.</p>
<p>伪元素会在内容元素的前后插入额外的元素, 技术上等同于</p>
<pre><code>&amp;lt;p&amp;gt;
&amp;lt;span&amp;gt;:before&amp;lt;/span&amp;gt;
This is the main content.
&amp;lt;span&amp;gt;:after&amp;lt;/span&amp;gt;
</code></pre><p><img src="http://jbcdn2.b0.upaiyun.com/2013/10/quotationmark-11.jpg" alt=""></p>
<p>当然, 这些元素无法在文档的源码中找到</p>
]]></content>
      
        <categories>
            
            <category> workNote </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[7 Ways You Can Design Your Home Office for Maximum Productivity]]></title>
      <url>/2016/07/16/7-ways-you-can-design-your-home-office-for-maximum-productivity/</url>
      <content type="html"><![CDATA[<h3 id="1-Keep-Your-Personal-Life-in-a-Separate-Room"><a href="#1-Keep-Your-Personal-Life-in-a-Separate-Room" class="headerlink" title="1. Keep Your Personal Life in a Separate Room"></a>1. Keep Your Personal Life in a Separate Room</h3><p>You should never work in your comfort zone. For example: the kitchen is for eating, the common space is for socializing, the bedroom is for sleeping and so the office is for <strong>working</strong>.<br>You need to establish those boundaries early on, because they can quickly become bad habits.</p>
<h3 id="2-Establish-Boundaries-with-Your-Housemates"><a href="#2-Establish-Boundaries-with-Your-Housemates" class="headerlink" title="2. Establish Boundaries with Your Housemates"></a>2. Establish Boundaries with Your Housemates</h3><p>Housemates need to understand that there are boundaries, that you can not be distracted or take on responsibilities such as housework or babysitting children.</p>
<h3 id="3-Don’t-Buy-Too-Much-Equipments"><a href="#3-Don’t-Buy-Too-Much-Equipments" class="headerlink" title="3. Don’t Buy Too Much Equipments"></a>3. Don’t Buy Too Much Equipments</h3><h3 id="4-Don’t-Commit-to-Your-Home-Office-Design-Too-Much"><a href="#4-Don’t-Commit-to-Your-Home-Office-Design-Too-Much" class="headerlink" title="4. Don’t Commit to Your Home Office Design Too Much"></a>4. Don’t Commit to Your Home Office Design Too Much</h3><p>It’s important to remember that an outside world does in fact exist.</p>
<h3 id="5-Get-Natural-Light-and-Green-Plants"><a href="#5-Get-Natural-Light-and-Green-Plants" class="headerlink" title="5. Get Natural Light and Green Plants"></a>5. Get Natural Light and Green Plants</h3><h3 id="6-Treat-Working-Hours-as-If-You-Were-at-Work"><a href="#6-Treat-Working-Hours-as-If-You-Were-at-Work" class="headerlink" title="6.Treat Working Hours as If You Were at Work"></a>6.Treat Working Hours as If You Were at Work</h3><h3 id="7-Tweak-Your-Comfort-Level"><a href="#7-Tweak-Your-Comfort-Level" class="headerlink" title="7. Tweak Your Comfort Level"></a>7. Tweak Your Comfort Level</h3><p>Ensure the environment won’t distract you. For example, music, seat, temperature, make sure everything can keep you attention to your work.</p>
]]></content>
      
        <categories>
            
            <category> Soup </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Gulp 能够解决哪些问题]]></title>
      <url>/2016/07/15/gulp-e8-83-bd-e5-a4-9f-e8-a7-a3-e5-86-b3-e9-82-a3-e4-ba-9b-e9-97-ae-e9-a2-98/</url>
      <content type="html"><![CDATA[<p>通常一个前端构建流程包括:</p>
<ul>
<li>文件清理: gulp-clear</li>
<li>文件拷贝: gulp-copy</li>
<li>文件转换: gulp-webpack</li>
<li>文件合并: gulp-concat</li>
<li>文件压缩: gulp-minify</li>
<li>文件服务: gulp-connect</li>
<li>文件监控: gulp-watch</li>
<li>css 相关:<ul>
<li>less, sass 转换(gulp-less, gulp-sass)</li>
<li>css 自动添加前缀(gulp-autoprefixer)</li>
</ul>
</li>
<li>js 相关:<ul>
<li>jslint(gulp-jshint)</li>
</ul>
</li>
<li>html 转换<ul>
<li>html 模板(gulp-jade, gulp-ejs)</li>
<li>html prettify</li>
<li>html validator</li>
<li>html min</li>
</ul>
</li>
</ul>
<p>Gulp 通过定义<code>gulpfile.js</code>配置文件的方式定义流程, gulp.js 会通过调用 Node.js 来执行流程.</p>
<h3 id="引入插件"><a href="#引入插件" class="headerlink" title="引入插件"></a>引入插件</h3><pre><code>var gulp = require(&quot;gulp&quot;), ...
`&lt;/pre&gt;

### 设定路径

&lt;pre&gt;`var paths = {
  styles:{
    src: &quot;src/styles/**/*.less&quot;,
    dest: &quot;assets/styles/&quot;
  },
  scripts:{
    src: &quot;src/scripts/**/*.js&quot;,
    dest: &quot;assets/scripts/&quot;
  }
};
`&lt;/pre&gt;

### 设定任务

&lt;pre&gt;`gulp.task(&quot;taskName&quot;, function(){
  gulp.src(paths.styles.src)
      .pipe(task())
      .pipe(gulp.dest(paths.styles.dest));
});
`&lt;/pre&gt;

一个 gulpfile.js 文件只是一个 Node 程序, 在 gulpfile 中可以使用任何 npm 中的模块或者其他 Node.js
并非所有的任务都是基于流, 例如删除文件

&lt;pre&gt;`function clean(){
  //del 也可以和 gulp.src 一样基于模式匹配的文件路径定义方式
  return del([&quot;assets&quot;]);
}
`&lt;/pre&gt;

如果要控制 task 顺序, 可以通过回调函数实现
gulp.task(taskName, function(fn){})
现在新增加了串行和并行 API
- gulp.parallel: 并行执行
- gulp.series: 串行执行
e.g.

&lt;pre&gt;`gulp.task(&quot;one&quot;, function(done){
  //do stuff
  done(); //回调函数
})
gulp.task(&quot;two&quot;, function(done){
  //do stuff
  done();
});
//并行执行任务, 执行完后可以添加回调函数
gulp.task(&quot;parallelTask&quot;, gulp.parallel(&quot;one&quot;, &quot;two&quot;, function(done){
  done();
}));
//串行任务
gulp.task(&quot;seriesTask&quot;, gulp.series(&quot;one&quot;, &quot;two&quot;, function(done){
  done();
}));
`&lt;/pre&gt;

### 前端常用插件
</code></pre><ul>
<li>gulp-sass: 编译 SASS</li>
<li>browser-sync: 保持多浏览器, 多设备同步</li>
<li>gulp-imagemin: 压制 png/jpg/git/svg 图片</li>
<li>gulp-minify-css: 压缩 CSS</li>
<li>gulp-rename</li>
<li>gulp-concat: 合并 JS</li>
<li>gulp-uglify: 压缩 JS</li>
<li>gulp-autoprefixer: 添加前缀</li>
<li>gulp-css-spriter: 生成雪碧图</li>
<li>gulp-htmlmin</li>
<li><p>gulp-server-livereload</p>
<h3 id="拥有live-reloading的服务器"><a href="#拥有live-reloading的服务器" class="headerlink" title="拥有live-reloading的服务器"></a>拥有live-reloading的服务器</h3><p>使用 BrowserSync 和 gulp, 你可以轻松创建一个开发服务器, 然后同一个WiFi 中的任何设备都可以方便访问.<br>BrowserSync 同时集成了 live-reload, 所以不需要做另外的配置.</p>
<p>首先安装模块<br><code>npm install brower-sync --save-dev</code><br>假设目前目录结构为</p>
<pre>`gulpfile.js
app/
    styles/
            main.css
        scripts/
            main.js
        index.html
`</pre>

<p>配置 gulpfile.js, 将 app 目录中的文件加入到服务器中, 并且所有的浏览器会在文件发生变化后自动刷新</p>
<pre>`var gulp = requrie("gulp");
var browserSync = require("browser-sync").create();
var reload = browerSync.reload;

//监视文件改动并重新载入
gulp.task("browser-sync", function(){
    browserSync.init({
            server:{
                    baseDir: 'app'
                }
        });

        gulp.watch(['*.html', 'styles/**/*.css', 'scripts/**/*.js'], {cwd: 'app'}, browserSync.reload);
});
`</pre>

<h3 id="CSS-预处理"><a href="#CSS-预处理" class="headerlink" title="CSS 预处理"></a>CSS 预处理</h3><p>指定浏览器无需刷新即可重载 CSS<br>假设目录如上</p>
<p><pre>`var gulp = require(“gulp”);<br>var sass = require(“gulp-ruby-sass”);<br>var browserSync = require(“browser-sync”).create();</pre></p>
<p>gulp.task(“sass”, function(){</p>
<pre><code>return sass(&quot;styles/**/*.scss&quot;)
             .pipe(gulp.dest(&quot;app/css&quot;)
                     .pipe(reload({stream:true}));
</code></pre><p>{);<br>/*<br>gulp.task(“sass”, function(){</p>
<pre><code>gulp.src(&quot;styles/**/*.scss&quot;)
    .pipe(sass({outputstyle: &apos;compressed&apos;}).on(&apos;error&apos;,sass.logError))
    .pipe(gulp.dest(&quot;app/css&quot;);
</code></pre><p>});<br>*/<br>gulp.task(“browser-sync”, [“sass”], function(){</p>
<pre><code>browserSync({
        server: {
                baseDir: &quot;app&quot;;
            }
    });
    gulp.watch(&quot;app/styles/**/*.scss&quot;, [&quot;sass&quot;], browserSync.reload);
</code></pre><p>});</p>
</li>
</ul>
<p>设置<code>tunnel: true</code> 来使用一个公开的 URL 来访问本地站点</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Gulp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[高性能 CSS]]></title>
      <url>/2016/07/15/e9-ab-98-e6-80-a7-e8-83-bd-css/</url>
      <content type="html"><![CDATA[<h3 id="HTML-和-CSS-本身的性能问题并不突出-在提高可读性和可维护性的前提下-如果能让代码运行和解析的速度更快-则是锦上添花"><a href="#HTML-和-CSS-本身的性能问题并不突出-在提高可读性和可维护性的前提下-如果能让代码运行和解析的速度更快-则是锦上添花" class="headerlink" title="HTML 和 CSS 本身的性能问题并不突出, 在提高可读性和可维护性的前提下, 如果能让代码运行和解析的速度更快, 则是锦上添花."></a>HTML 和 CSS 本身的性能问题并不突出, 在提高可读性和可维护性的前提下, 如果能让代码运行和解析的速度更快, 则是锦上添花.</h3><h4 id="使用高效的-CSS-选择器"><a href="#使用高效的-CSS-选择器" class="headerlink" title="使用高效的 CSS 选择器"></a>使用高效的 CSS 选择器</h4><p>首先要知道浏览器如何解析 CSS<br>以 .nav ul.list li div{} 为例<br>浏览器遍历 div, 然后从遍历结果中寻找父集为 li 的对象, 依次进行选择器搜索. 所以如果选择器层级过多, 会导致性能低下.<br>解决方法: 令第一次匹配时的数量最少, 并让整体的匹配查找次数更少.<br>具体做法:</p>
<ul>
<li>避免使用通配符</li>
<li>避免使用标签选择器和单个属性选择器作为关键选择器</li>
<li>不要在 id 选择器前加标签名</li>
<li>不要设定过多层级, 降低 CSS 和 DOM 结构的耦合度</li>
</ul>
<h4 id="CSS-相关的图片处理"><a href="#CSS-相关的图片处理" class="headerlink" title="CSS 相关的图片处理"></a>CSS 相关的图片处理</h4><ul>
<li>不给图片设置尺寸: 有时候同一张图会在页面不同低昂多次使用, 比如缩略图, 正常图, 大图等. 如果图片的原始尺寸与实际需求不同, 在使用时通过缩放会给 CPU 带来额外的计算过程, 增加了图片在浏览器中的渲染时间. 网络传输过程也会占用更多带宽, 增加下载时间. 最佳做法是为需要的部分单独做一套图片, 初始页面加载时就能更快显示.</li>
<li><p>使用雪碧图, 利用 css 进行背景定位, 好处是减少请求次数, 提高图片的整体的加载速度; 缺点是需要精确计算位置(现在有一些工具可用), 维护过程复杂, 要换图片比较复杂</p>
<pre><code>*   在后期使用 CSS Sprite 技术, 因为在开发的时候会比较频繁修改图片
</code></pre><ul>
<li>合理组织图片</li>
<li>控制雪碧图的尺寸, 推荐长宽相乘不超过2500, 大小不超过200kb</li>
<li>合理控制背景图单元之间的距离及背景图的位置</li>
<li>借助相关工具</li>
</ul>
</li>
</ul>
<h4 id="减少-CSS-代码量"><a href="#减少-CSS-代码量" class="headerlink" title="减少 CSS 代码量"></a>减少 CSS 代码量</h4><ul>
<li>定义简洁的 CSS 规则</li>
<li>合并相同的定义</li>
<li>删除无效的定义</li>
</ul>
<h4 id="其他途径"><a href="#其他途径" class="headerlink" title="其他途径"></a>其他途径</h4><ul>
<li>避免使用@ import</li>
<li>避免使用 IE 浏览器独有的样式</li>
<li>避免使用 CSS 表达式: 动态设置 CSS 属性, 可以通过 js 修改</li>
</ul>
<h3 id="兼容性查询"><a href="#兼容性查询" class="headerlink" title="兼容性查询"></a>兼容性查询</h3><ul>
<li>caniuse.com</li>
<li>css3 click chart</li>
<li>css contents and browsers compatibility</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[BFC 基本概念]]></title>
      <url>/2016/07/15/bfc-e5-9f-ba-e6-9c-ac-e6-a6-82-e5-bf-b5/</url>
      <content type="html"><![CDATA[<h3 id="Box-CSS-布局的基本单位"><a href="#Box-CSS-布局的基本单位" class="headerlink" title="Box: CSS 布局的基本单位"></a>Box: CSS 布局的基本单位</h3><p>Box 是 CSS 布局的对象, 和基本单位, 直观点来说, 就是一个页面是由很多个 Box 组成的. 元素的类型和 display 属性, 决定了这个 Box 的类型. 不同类型的 Box, 会参与不同的 Formatting Context(一个决定如何渲染文档的容器), 因此 Box 内的元素会以不同方式渲染.<br>盒子的类型:</p>
<ul>
<li>block-level: <code>display:block</code>的 block, list-item, table 元素会形成 block-level box, 并参与 Block formatting context.</li>
<li>inline-level box: <code>display:inline</code>的 inline-block, inline-table 元素会形成 inline-level box, 并参与 inline formatting context;</li>
<li>run-in box: CSS3才有, 略;</li>
</ul>
<h3 id="Formatting-Context"><a href="#Formatting-Context" class="headerlink" title="Formatting Context"></a>Formatting Context</h3><p>Formatting Context 是 W3C CSS2.1规范中的一个概念, 是页面中的一块渲染区域, 并有一套渲染规则, 决定了其子元素如何定位, 以及其他元素的关系和相互作用. 最常见的的 Formatting Context 有 Block Formatting Context(BFC) 和 Inline Formatting Context(IFC).<br>CSS2.1中只有 BFC 和 IFC, 在 CSS3中添加了 GFC 和 FFC</p>
<h3 id="BFC-的定义"><a href="#BFC-的定义" class="headerlink" title="BFC 的定义"></a>BFC 的定义</h3><p>BFC 直译为”块级格式上下文”, 是一个独立的渲染区域, 只有 Block-level Box 可以参与, 他规定了内部的 Block-level Box 如何布局, 并且与这个区域外部毫不相干.</p>
<h4 id="BFC-布局规则"><a href="#BFC-布局规则" class="headerlink" title="BFC 布局规则"></a>BFC 布局规则</h4><ul>
<li>内部的 Box 会在垂直方向依次排列</li>
<li>Box 垂直方向的距离由 margin 决定, 属于同一个 BFC 的两个相邻的 Box 的 margin 会发生坍塌</li>
<li>BFC 内部不会发生 float box 重叠</li>
<li>BFC 就是页面上的一个隔离的独立容器, 容器内的子元素不会影响到外部的元素, 反之亦然</li>
<li>计算 BFC 高度的时候, <strong>浮动元素也参与计算</strong>(使用 border 消除父元素坍塌的原理)</li>
<li>BFC 内部每一个 Box 的左外边缘(margin-left)会碰触容器的左边缘(border-left)(如果是从右向左的格式, 则是碰触右边缘)</li>
</ul>
<h4 id="BFC-的通俗理解"><a href="#BFC-的通俗理解" class="headerlink" title="BFC 的通俗理解"></a>BFC 的通俗理解</h4><p>BFC 容器是一个独立的箱子, 里面的元素的布局不受外部元素影响.<br>我们往往利用这个特性来消除浮动元素对其他非浮动的兄弟元素及其子元素带来的影响.<br>并且在一个 BFC 容器中, 块盒和行盒都会沿其父元素的边框排列</p>
<h4 id="BFC-成因"><a href="#BFC-成因" class="headerlink" title="BFC 成因"></a>BFC 成因</h4><ul>
<li>float 属性不为 None;</li>
<li>position 为 Absolute 或 Fixed</li>
<li>display 为 inline-block, table-cell, table-caption, flex, inline-flex</li>
<li>overflow 不是 visible</li>
</ul>
<h4 id="BFC-的作用与原理"><a href="#BFC-的作用与原理" class="headerlink" title="BFC 的作用与原理"></a>BFC 的作用与原理</h4><h5 id="自适应两栏布局"><a href="#自适应两栏布局" class="headerlink" title="自适应两栏布局"></a>自适应两栏布局</h5>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> Trick </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS 外边距合并]]></title>
      <url>/2016/07/14/css-e5-a4-96-e8-be-b9-e8-b7-9d-e5-90-88-e5-b9-b6/</url>
      <content type="html"><![CDATA[<p><strong>外边距合并的意思是两个垂直排列的块的外边距可能发生(坍塌)合并, 仅保留较大的边距.</strong></p>
<h2 id="情况一"><a href="#情况一" class="headerlink" title="情况一:"></a>情况一:</h2><p>两元素上下排列<br><img src="http://www.w3school.com.cn/i/ct_css_margin_collapsing_example_1.gif" alt=""></p>
<h2 id="情况二"><a href="#情况二" class="headerlink" title="情况二:"></a>情况二:</h2><p>两元素是父子关系, 若此时父元素没有设定 border, margin(或者宽度为0), 他们的上下边距也会发生合并.<br><img src="http://www.w3school.com.cn/i/ct_css_margin_collapsing_example_2.gif" alt=""></p>
<h2 id="情况三"><a href="#情况三" class="headerlink" title="情况三:"></a>情况三:</h2><p>自身是一个有上下外边距的空元素, 如果没有 border 和 margin, 自身的上下外边距也会合并<br><img src="http://www.w3school.com.cn/i/ct_css_margin_collapsing_example_3.gif" alt=""></p>
<h3 id="如果这个空元素还与另一个元素垂直排列-会继续发生合并"><a href="#如果这个空元素还与另一个元素垂直排列-会继续发生合并" class="headerlink" title="如果这个空元素还与另一个元素垂直排列, 会继续发生合并"></a>如果这个空元素还与另一个元素垂直排列, 会继续发生合并</h3><p><img src="http://www.w3school.com.cn/i/ct_css_margin_collapsing_example_4.gif" alt=""></p>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><p>只有普通文档流中的块元素会发生外边距合并, 如果是浮动块, 或者是绝对定位块, 他的外边距是不会合并的.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mix-blend-mode之 multiply, screen, difference]]></title>
      <url>/2016/06/28/mix-blend-mode-e4-b9-8b-multiply-screen-difference/</url>
      <content type="html"><![CDATA[<p>语法</p>
<pre><code>mix-blend-mode: &amp;lt;mode&amp;gt;
</code></pre><p>normal: 默认值, 正常</p>
<p>multiply: 正片叠底 - 查看对应像素的颜色信息, 并将基色和混合色复合, 结果色总是比较暗的颜色, 任何颜色与黑色正片叠底都产生黑色, 任何颜色与白色正片叠底都保持不变. 正片就是常见的幻灯片, 正片叠底的效果就是把基色和混合色的图像都做成幻灯片, 把他们叠放在一起, 凑近亮处显示的效果, 由于两张幻灯片都有内容, 所以重叠起来的图像比单张要暗</p>
<p>screen: 滤色 - 滤色原理和显示器成像原理相同, 将两副幻灯片分别放在不同投影仪上, 打向同一个屏幕, 由于光线的叠加效应, 得到的是一个更明亮的图像. 基色的反相与混合色的反相相乘, 得到的结果除以255后再反相.</p>
<p>overlay: 叠加</p>
<p>lighten: 变量</p>
<p>darken: 变暗</p>
<p>color-dodge: 颜色减淡</p>
<p>color-blur: 颜色加深</p>
<p>hard-light: 强光</p>
<p>soft-light: 柔光</p>
<p>difference: 差值 - 混合色与基色相减后取绝对值</p>
<p>exclusion: 排除</p>
<p>hue: 色相</p>
<p>saturation: 饱和度</p>
<p>color: 颜色</p>
<p>luminosity: 亮度</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> Trick </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Gulp 自动化部署快速入门]]></title>
      <url>/2016/06/27/gulp-e8-87-aa-e5-8a-a8-e5-8c-96-e9-83-a8-e7-bd-b2-e5-bf-ab-e9-80-9f-e5-85-a5-e9-97-a8/</url>
      <content type="html"><![CDATA[<ol>
<li><code>$ npm install —g gulp</code>全局安装</li>
</ol>
<ul>
<li>安装前保证已经安装了 ruby</li>
</ul>
<ol>
<li><code>$ npm install —save-dev- gulp</code>作为项目的开发依赖( devDependence)安装到项目目录<p></p></li>
<li><p>在项目根目录下创建一个名为<code>gulpfile.js</code>的文件:</p>
<pre><code>//引用 gulp plugin
</code></pre><p>var gulp = require(‘gulp’);<br>//建立 gulp task<br>gulp.task(‘default’, function(){<br> //任务代码<br>})<br><code>&lt;/pre&gt;
在项目根目录运行 gulp 时, gulp 会直接读取</code>gulpfile.js`中定义的任务并执行.</p>
</li>
</ol>
<ul>
<li>gulp 可以将每一个你要执行的工作命名, 而默认运行的task 名为<code>default</code></li>
</ul>
<ol>
<li>$ gulp`运行 gulp, 运行默认的名为’ default’ 的任务( task)</li>
</ol>
<ul>
<li><code>gulp &amp;lt;task&amp;gt; &amp;lt;othertask&amp;gt;</code>运行指定 task</li>
</ul>
<ol>
<li>gulp 基本 API</li>
</ol>
<ul>
<li><p><code>gulp.src(globs[, options])</code></p>
<pre><code>*   `glob`参考 [node-glob 语法](https://github.com/isaacs/node-glob), 也可以直接写文件的路径
</code></pre><ul>
<li><code>options</code>:略</li>
</ul>
</li>
<li><p><code>gulp.dest(path[,options])</code></p>
<pre><code>*   能被`pipe`进来, 并能写文件到文件夹, 如果文件夹不存在, 则自动创建文件夹.
</code></pre><ul>
<li><code>path</code>: String 或 Function, 可以直接写输出目录, 也可以传入一个返回路径的函数</li>
<li><code>options</code>:略</li>
</ul>
</li>
<li><p><code>gulp.task(name[, deps], fn)</code></p>
<pre><code>*   &lt;pre&gt;`gulp.task(&apos;script&apos;,function(){
</code></pre><p> //待执行<br>})<br>`</p>
<ul>
<li><code>name</code>: 赋予任务名称</li>
<li><p><code>deps</code>: 任务列表数组, 这些任务会在当前任务运行之前完成</p>
<pre><code>    *   task 默认以最大并发数执行, 也就是说 gulp 会一次性执行所有 task 并不做任何等待, 如果要以特定顺序执行, 需要:

            *   给出一个提示, 告知 task 什么时候执行完毕
*   再给出一个提示, 告知 task 依赖另一个 task 的完成
*   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">var gulp = require(&apos;gulp&apos;);</div><div class="line">//返回一个 callback, 因此系统可以知道他什么时候完成</div><div class="line">gulp.task(&apos;one&apos;, function(cb)&#123;</div><div class="line">//执行一些任务</div><div class="line"> cb(err); //如果 err 不是 null 或者 undefined, 则会停止执行, 这样代表执行失败.</div><div class="line">&#125;);</div><div class="line">//定义一个所以来的 task 必须在这个 task 执行之前完成</div><div class="line">gulp.task(&apos;two&apos;, [&apos;one&apos;], function()&#123;</div><div class="line"> //&apos;one&apos;完成后要执行的任务</div><div class="line">&#125;)</div><div class="line">gulp.task(&apos;default&apos;, [&apos;one&apos;, &apos;two&apos;]);</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p><code>fn</code>:要执行的操作</p>
</li>
</ul>
</li>
<li><p><code>gulp.watch(glob [, opts], tasks)</code></p>
<pre><code>*   监听文件, 并可以在文件发生改动的时候做一些事情, 他总会返回一个 EventEmiiter 来发射`change`事件.
</code></pre><ul>
<li><code>glob</code>: 指定具体监听哪些文件的变动</li>
<li><p><code>tasks</code>: 需要在文件变动后执行的任务</p>
<pre><code>*   &lt;pre&gt;`var watcher = gulp.watch(&apos;js/**/*.js&apos;, [&apos;uglify&apos;, &apos;reload&apos;]);
</code></pre><p>watcher.on(‘change’, function(event){<br>console.log(‘File’+event.path+’ was ‘+event.type+’, running tasks…’);<br>});<br>`</p>
</li>
</ul>
</li>
</ul>
<ol>
<li>工作流程</li>
</ol>
<ul>
<li><p>设定任务</p>
<pre><code>*   gulp 可以对不同的 task 命名, 而 default 是默认的人物名称, 如果执行 gulp 的时候没有指定任务名称, 则会执行`default` 任务.
</code></pre><ul>
<li><pre>`//载入 gulp plugin
var gulp = require('gulp');
//定义名称为 default 的 gulp 任务
gulp.task('default', function(){
console.log('Hello Gulp Default Task');
});
//定义名称为 other 的 gulp 任务
gulp.task('other', function(){
console.log('Hello Gulp Other Task');
})
`</pre></li>
</ul>
</li>
<li><p>执行指定的 gulp 任务</p>
<pre><code>*   &lt;pre&gt;`$ gulp
</code></pre><p>`</p>
<pre><code>*   执行默认的 default 任务
</code></pre><ul>
<li><pre>`$ gulp other
`</pre>

<pre><code>*   执行任务`other`
</code></pre></li>
<li><pre>`$ gulp.task('default', ['other', 'script']);
`</pre>

<pre><code>*   在 default 任务中设定要执行的任务队列可以执行多个任务
</code></pre></li>
</ul>
</li>
<li><p>监听</p>
<pre><code>*   比如我们使用`gulp-uglify`最小化 JS 时, 希望可以在每次改动 JS 的时候自动执行 gulp 最小化动作

        *   &lt;pre&gt;`var gulp = require(&apos;gulp&apos;),
</code></pre><p>gulpUglify = require(‘gulp-uglify’);<br>gulp.task(‘script’, function(){<br>gulp.src(‘javascript/original/*.js’) //指定要处理的原始 JS 目录<br>.pipe(gulpUglify()) //执行最小化<br>.pipe(gulp.dest(‘javascript/minify’)); //最小化后部署到 JS 目录<br>})<br>`</p>
<ul>
<li><p>添加监听</p>
<pre><code>*   &lt;pre&gt;`gul.task(&apos;watch&apos;, function(){
</code></pre><p>gulp.watch(‘javascript/original/*.js’, [‘script’]);<br>})<br>`</p>
<ul>
<li><pre>`$ gulp watch //执行监听
`</pre>

<pre><code>*   执行监听后, 每次改动 javascript/origin/*.js 中所有 JS 文件时都会重新执行 script 任务.
</code></pre><ul>
<li>可以用<code>**</code>监听所有文件</li>
<li>可以将<code>watch</code>添加到任务列表, 这样只需要指令<code>gulp</code>就可以执行监听</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>例外处理</p>
<pre><code>*   经历例外错误记录任务

        *   由于例外错误可能会在很多地方出现, 最好是定义为可调用的函数
*   &lt;pre&gt;`function errorLog(error){
</code></pre><p>console.error(error);<br>this.emit(‘end’);<br>}<br>gulp.task(‘script’, function(){<br>gulp.src(‘…’)<br>.on(‘error’,errorLog)<br>.pipe(gulpUglify())<br> .pipe(gulp.dest(‘…’));<br>});<br>`</p>
</li>
</ul>
<ol>
<li>常用插件</li>
</ol>
<ul>
<li><p>gulp-uglify</p>
<pre><code>*   `$ npm install —save-dev gulp-uglify`
</code></pre><ul>
<li>将要最小化的 JS 文件放在 javascript/original 下</li>
<li>将最小化后的 JS 文件放在 javascript/minify 下</li>
<li><pre>`var gulp = require('gulp'),
gulpUgligy = require('gulp-uglify');
gulp.task('script', function(){
gulp.src('javascript/original/*js')
.pipe(gulpUglify())
.pipe(gulp.dest('javascript/minify'));
})
`</pre></li>
</ul>
</li>
<li><p>gulp-sass</p>
<pre><code>*   `$ npm install —save-dev gulp-sass`

        *   将要编译的 Scss 文件放在 scss 目录下
*   将编译后的 CSS 文件放在 css 目录下
*   &lt;pre&gt;`var gulp = require(&apos;gulp&apos;),
</code></pre><p>gulpSass = required(‘gulp-sass’);<br>gulp.task(‘styles’,function(){<br>gulp.src(‘scss/*.scss’)<br>.pipe(gulpSass())<br>.pipe(gulp.dest(‘css’));<br>})<br>`</p>
<pre><code>*   向 gulpSass()传入参数`{outputStyle:&apos;compressed&apos;}`输出压缩后的 CSS 文件
</code></pre></li>
<li><p>gulp-imagemin</p>
<pre><code>*   压缩图片, 支持格式有 gif, jpg, png, svg
</code></pre><ul>
<li><code>$ npm install --save-dev gulp-imagemin</code></li>
<li>指定 images/origin下所有图片都压缩, 并把压缩后的图片放到images 中</li>
<li><pre>`var gulp = require('gulp'),
gulpImagemin = require('gulp-imagemin');
gulp.task('image', function(){
gulp.src('images/original/**')
.pipe(gulpImagemin())
.pipe(gulp.dest('images'));
})
`</pre></li>
</ul>
</li>
<li><p>gulp-plumber</p>
<pre><code>*   `$ npm install —save-dev gulp-plumber`
</code></pre><ul>
<li><code>pipe(gulpPlumber())</code>一定要在编译 scss 及最小化 js 之前就加入(注意顺序)</li>
<li><pre>`var gulp = require('gulp'),
gulpUglify = require('gulp-uglify');
gulp.watch('watch', function(){
gulp.watch('javascript/original/*.js', ['script']);
});
gulp.task('script', function(){
gulp.src('javascript/original/*.js')
.pipe(gulpPlumber())
.pipe(gulpUglify())
.pipe(gulp.dest('javascript/minify'));
});
`</pre></li>
<li>gulp-autoprefixer</li>
<li>gulp-minify-css</li>
<li>gulp-clean</li>
<li>gulp-livereload</li>
</ul>
</li>
</ul>
<ol>
<li>工作范例</li>
</ol>
<ul>
<li><p>明确任务</p>
<pre><code>*   检查 JS
</code></pre><ul>
<li>编译 Scss</li>
<li>合并 JS</li>
<li>压缩并重命名合并后的 JS</li>
</ul>
</li>
<li><p>安装依赖</p>
<pre><code>*   `$ npm install gulp-jshint gulp-sass gulp-concat gulp-uglify gulp-rename —save-dev`
</code></pre><ul>
<li><p></p><p>新建<code>gulpfile.js</code></p>
<pre><code>*   &lt;pre&gt;`//引入 gulp 及插件
</code></pre><p>var gulp = require(‘gulp’),<br>gulpJshint = require(‘gulp-jshint’),<br>gulpSass = require(‘gulp-sass’),<br>gulpConcat = require(‘gulp-concat’),<br>gulpUglify = require(‘gulp-uglify’),<br>gulpRename(‘gulp-rename’);<br>//检查 JS, 该任务会检查 js/下的 js 文件有没有报错或警告<br>gulp.task(‘lint’,function(){<br>gulp.src(‘./js/<em>.js’)<br>.pipe(gulpJshint())<br>.pipe(gulpJshint.reporter(‘default’));<br>});<br>//编译 Scss, 该任务会编译 scss/下的 scss 文件, 并把编译后的 css 文件保存到 /css 中<br>gulp.task(‘sass’, function(){<br>gulp.src(‘./scss/</em>.scss’)<br>.pipe(gulpSass())<br>.pipe(gulp.dest(‘./css’));<br>});<br>//合并, 压缩 JS 文件, 该任务会合并 js/下的所有 js 文件, 并输出到 dist/目录, 然后重命名为.min.js, 并压缩再输出到 dist/下<br>gulp.task(‘scripts’, function(){<br>gulp.src(‘./js/<em>.js’)<br>.pipe(gulpConcat(‘all.js’))<br>.pipe(gulp.dest(‘./dist’))<br>.pipe(gulpRename(‘all.min.js’)).<br>pipe(gulpUglify())<br>.pipe(gulp.dest(‘./dist’));<br>});<br>//默认任务, 默认任务基于其他任务, 使用.run()方法关联和运行我们之前定义的方法, 使用.watch()方法监听指定目录的文件<br>gulp.task(‘default’, function(){<br>gulp.run(‘lint’, ‘sass’, ‘scripts’);<br>//监听文件<br>gulp.watch(‘./js/</em>.js’, function(){<br>gulp.run(‘lint’,’sass’,’scripts’);<br>});<br>});</p>
</li>
</ul>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Gulp </tag>
            
            <tag> automatic </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JS 获取 input file name]]></title>
      <url>/2016/06/24/js-e8-8e-b7-e5-8f-96-input-file-name/</url>
      <content type="html"><![CDATA[<p>获得文件路径: <code>var filePath = document.getElementById(&quot;file&quot;).value</code></p>
<p>截取文件名:</p>
<ul>
<li><p>保留后缀:</p>
<pre><code>*   `var fileName = filePath.split(&apos;\\&apos;).pop()`
</code></pre><ul>
<li><code>var fileName = filePath.substring(filePath.lastIndexOf(&#39;\\&#39;)+1)</code></li>
</ul>
</li>
<li><p>不保留后缀:</p>
<pre><code>*   `var fileName = filePath.split(/\.|\\/).slice(-2,-1)[0]`
</code></pre><ul>
<li><code>var fileName = filePath.substring(filePath.lastIndexOf(&quot;\\&quot;)+1,filePath.lastIndexPathOf(&quot;\.&quot;))</code></li>
</ul>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Distinction between 'nth-child' and 'nth-of-type']]></title>
      <url>/2016/06/23/distinction-between-nth-child-and-nth-of-type/</url>
      <content type="html"><![CDATA[<p>In HTML</p>
<pre><code>&amp;lt;p&amp;gt;0&amp;lt;/p&amp;gt;
&amp;lt;div&amp;gt;1&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;2&amp;lt;/div&amp;gt;
&amp;lt;p&amp;gt;3&amp;lt;/p&amp;gt;
&amp;lt;div&amp;gt;4&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;5&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;6&amp;lt;/div&amp;gt;
</code></pre><p>The Selector <code>div:nth-child(3)</code> will choose the 3rd element from all elements in the level where div is, then check if the 3rd element is a ‘div’. In this case, the 3rd element is a ‘div’, so it works(<code>&amp;lt;div&amp;gt;2&amp;lt;/div&amp;gt;</code>), but Selector <code>div:nth-child(4)</code> will select the 4st element which is ‘p’ (<code>&amp;lt;p&amp;gt;3&amp;lt;/p&amp;gt;</code>), it’s not a ‘div’, so it doesn’t work.</p>
<p>However, the Selector <code>div:nth-of-type(3)</code> will choose the 3rd ‘div’ from all ‘div’s in the level where div is, so it choose the <code>&amp;lt;div&amp;gt;4&amp;lt;/div&amp;gt;</code>.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS3: border-image]]></title>
      <url>/2016/06/23/css3-border-image/</url>
      <content type="html"><![CDATA[<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><pre><code>border-image: none|&amp;lt;image&amp;gt;[&amp;lt;slice&amp;gt;|&amp;lt;width&amp;gt;|&amp;lt;repeat&amp;gt;]
</code></pre><ul>
<li><code>border-image-source: url(&quot;…&quot;);</code></li>
<li><p><code>border-image-slice:[&amp;lt;number&amp;gt;|&amp;lt;percentage]</code></p>
<pre><code>*   用于分解引入的图片, px 是默认单位, 如果用 number 则一定不能加上 px
</code></pre><ul>
<li>percentage 是相对于引入的 image 而言的, 例如 image 的大小为300 x 240, 若设定 slice: 25%, 30%, 15%, 20%, <strong>等于截取了图片外侧的60px, 90px, 36px, 60px 的部分作为边框</strong></li>
<li><img src="http://cdn1.w3cplus.com/cdn/farfuture/Z78eIzBXIkFO02LKoPUpOhn7DIjZdlGOqeeIiANZiNA/mtime:1341237495/sites/default/files/border-image-slice.jpg" alt="示例图"></li>
<li>实际上 CSS3 将该图片划分成9个部分, 再根据 width 和 repeat 进行处理后拼接成边框</li>
<li>四个角不会受到 repeat 的影响而产生变形, 四个边会受到 repeat 的影响而变形.</li>
</ul>
</li>
<li><p><code>border-image-width: [&amp;lt;length&amp;gt;|&amp;lt;percentage&amp;gt;|&amp;lt;number&amp;gt;|auto]</code></p>
<pre><code>*   border-image-width 就是 border-width, 用于设置边框宽度
</code></pre><ul>
<li>如果 slice 截取的宽度正好等于 width, 那么不会发生变形</li>
</ul>
</li>
<li><p><code>border-image-repeat: [stretch|repeat|round]</code></p>
<pre><code>*   指定四条边的排列方式
</code></pre><ul>
<li>最多接受两个参数, 第一个水平方向, 第二个垂直方向</li>
<li>round -&gt; 平铺</li>
<li>round 会压缩或伸展 sliced-block, 保证平铺过程中其完整性</li>
<li><img src="http://cdn2.w3cplus.com/cdn/farfuture/Fnx2B9-7WSVP5CmFE9QNNOMbawlHVGYZ3O1cFF5gQSw/mtime:1341237495/sites/default/files/border-image-round-HV.png" alt=""></li>
<li>repeat -&gt; 重复</li>
<li>repeat 不会改变 sliced-block 的完整性, 从中间开始向两边排列</li>
<li><img src="http://cdn2.w3cplus.com/cdn/farfuture/2-H9Gx7nr6n9NkwQJB0vnOBtrdlI4iRphA7unyN6zto/mtime:1341237494/sites/default/files/border-image-repeat-HV.png" alt=""></li>
<li>stretch</li>
<li>拉伸</li>
</ul>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS3: Filter]]></title>
      <url>/2016/06/23/css3-filter/</url>
      <content type="html"><![CDATA[<p>英语原文: <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/filter" target="_blank" rel="external">MDN:filter</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>Filter</strong> 属性用于实现”模糊”, “锐化”, “颜色替换”等图像渲染效果.</p>
<p><strong>Filter</strong> 通常用于调整图像, 背景, 边框的呈现.</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><pre><code>filter: url(&quot;filter.svg#filter-id&quot;);
filter:blur(5px);
filter:brightness(.4);
filter:contrast(200%);
filter:drop-shadow(16px 16px 20px blue);
filter:grayscale(50%);
filter:hue-rotate(90deg);
filter:invert(75%);
filter:opacity(25%);
filter:saturate(30%);
filter:sepia(60%);

/*Apply multiple filters*/
filter: contrast(75%) brightness(3%);

/*Global Values*/
filter: inherit;
filter:initial;
filter:unset;
`&lt;/pre&gt;

### 设置一种函数

&lt;pre&gt;`filter: &amp;lt;filter-function&amp;gt; [&amp;lt;filter-function&amp;gt;]* | none
`&lt;/pre&gt;

### 给 SVG 元素 &lt;filter&gt; 引用滤镜

&lt;pre&gt;`filter: url(svg-url#element-id)
`&lt;/pre&gt;

### 实例

&lt;pre&gt;`.mydiv{filter:grayscale(50%)}
/*gray all images by 50% and blur by 10px*/
img{
  filter: grayscale(.5) blur(10px);
}
`&lt;/pre&gt;

#### 通过 url 函数引入一个 SVG 资源

&lt;pre&gt;`.target{filter:url(#c1):}
.mydiv{filter:url(commonfilters.xml#large-blur)}
`&lt;/pre&gt;

### 函数

参数可以传入百分数或小数, 34%和.34效果相同

&lt;pre&gt;`url(): 接受一个 XML 文件, 该文件设置一个 SVG 滤镜, 并通过锚点确定一个具体的滤镜元素
filter: url(resource.svg#c1)
`&lt;/pre&gt;

&lt;pre&gt;`blur(): 接收 radius 值为图像设置高斯模糊, radius 为标准差(px), 默认为0, 不接收百分比
`&lt;/pre&gt;

&lt;pre&gt;`brightness(): 给图片应用一种线性惩罚, 使其看起来更亮或更暗, 0%对应全黑, 100%对应原图, 超过100%更亮, 默认为1;
`&lt;/pre&gt;

&lt;pre&gt;`contrast(): 调整图像对比度, 0对应全黑, 1对应原图, 大于1则应用更低的对比度
`&lt;/pre&gt;

&lt;pre&gt;`drop-shadow(): 给图像设置一个阴影效果, 阴影是合成在图像下方的, 可以设置模糊度, 可以用特定颜色画出遮罩图的偏移版本. 函数能接受&amp;lt;shadow&amp;gt;(在 CSS3 背景中定义)类型的值, 除了 inset 关键字不可使用, 与 box-shadow 属性很相似.

不过通过滤镜, 一些浏览器会提供硬件加速

参数如下:

&amp;lt;offset-x&amp;gt;和&amp;lt;offset-y&amp;gt; (不可省略)

&amp;lt;blur-radius&amp;gt;(可选)

&amp;lt;spread-radius&amp;gt;(可选)

&amp;lt;color&amp;gt;(可选)
`&lt;/pre&gt;

&lt;pre&gt;`grayscale(): 将图像转为灰度图像, 1对应完全灰度图像, 0对应原图
`&lt;/pre&gt;

&lt;pre&gt;`hue-rotate(): 给图像应用色相旋转, &quot;angle&quot; 设定图像会被调整的色环角度, 默认为0, 对应无变化.
`&lt;/pre&gt;

&lt;pre&gt;`invert(): 翻转输入图像, 即反相, 1对应完全反相, 0对应原图
`&lt;/pre&gt;

&lt;pre&gt;`opacity(): 转换图像的透明程度, 0对应完全透明, 1对应原图

和 CSS3 的 opacity 功能相似, 但是一些浏览器会提供硬件加速
`&lt;/pre&gt;

&lt;pre&gt;`saturate(): 修改图像饱和度, 0对应完全不饱和, 1对应原图
`&lt;/pre&gt;

&lt;pre&gt;`sepia(): 将图像转为深褐色, 1对应完全深褐色, 0对应原图
</code></pre><p>复合函数</p>
<p><code>filter: contrast(175%) brightness(3%);</code></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[box-shadow小用法]]></title>
      <url>/2016/06/23/box-shadow-e5-b0-8f-e7-94-a8-e6-b3-95/</url>
      <content type="html"><![CDATA[<h2 id="box-shadow-常规用法"><a href="#box-shadow-常规用法" class="headerlink" title="box-shadow 常规用法"></a>box-shadow 常规用法</h2><h3 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h3><p><code>box-shadow</code> 属性向边框添加一个或多个阴影;</p>
<p><code>box-shadow: (inset) x-offset, y-offset, blur, spread color;</code></p>
<h3 id="模拟多边框"><a href="#模拟多边框" class="headerlink" title="模拟多边框"></a>模拟多边框</h3><pre><code>div{
  width: 100px;
  height: 100px;
  margin: 100px;
  border:5px solid ;
  box-shadow: inset 0 0 0 5px #ccc,
    0 0 0 5px #333;
}
`&lt;/pre&gt;

要注意: box-shadow 毕竟不是实际边框, 不占据实际空间, 也不属于 `box-sizing`范围

### 模拟半透明遮罩层

&lt;pre&gt;`#foo{
  width:200px;
  height:200px;
  background:#FFF;
  box-shadow:0 0 0 1920px rgba(0,0,0,.5);
}
`&lt;/pre&gt;

### 多重 box-shadow 绘制简图案

&lt;pre&gt;`&amp;lt;div class=&quot;bg&quot;&amp;gt;
  &amp;lt;div class=&quot;cloud&quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;

.bg{
  width: 100%;
  height: 100px;
  padding: 10px;
  background-color: #00bcd4;
}
.cloud{
  width: 50px;
  height: 50px;
  margin: 20px auto;
  background-color: #FFF;
  border-radius:50%;
  box-shadow:80px 10px 0 10px #FFF,
    50px 0 0 20px #FFF, 10px -10px #FFF, -10px 10px 0 10px #FFF;
}
`&lt;/pre&gt;

### 多重 shadow 实现立体感

&lt;pre&gt;`&amp;lt;div&amp;gt;Solid&amp;lt;/div&amp;gt;

div{
  width: 200px;
  line-height: 68px;
  font-size: 48px;
  text-align: center;
  color:rgba(0,0,0,.3);
  text-shadow: 1px 1px 0 rgba(0,0,0,.55),
    2px 1.5px 0 rgba(0,0,0,.25),
    3px 2px 0 rgba(0,0,0,.2),
    4px 2.5px 0 rgba(0,0,0,.15),
    5px 3px 0 rgba(0,0,0,.1);
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> Trick </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[优化 HTML 结构]]></title>
      <url>/2016/06/22/e4-bc-98-e5-8c-96-html-e7-bb-93-e6-9e-84/</url>
      <content type="html"><![CDATA[<h3 id="语义化命名"><a href="#语义化命名" class="headerlink" title="语义化命名"></a>语义化命名</h3><ul>
<li>语义化的 HTML 能够直接表示出某个 Tag 的业务功能;</li>
<li>语义化的 CSS 可以提高样式的抽象程度, 方便复用;</li>
</ul>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><ul>
<li>提高代码复用程度;</li>
<li>使业务逻辑更加清晰;</li>
</ul>
<h3 id="选择一个好的命名约定"><a href="#选择一个好的命名约定" class="headerlink" title="选择一个好的命名约定"></a>选择一个好的命名约定</h3><h3 id="遵循单一职责原则"><a href="#遵循单一职责原则" class="headerlink" title="遵循单一职责原则"></a>遵循单一职责原则</h3><p>SRP 原则即每个模块或者类应当只承担系统中的某一个单一功能, 并且该功能应当完整封装起来. 比如 CSS 组织结构中的 Carousel, NavigationBar 等, 要做成独立的 CSS Component.</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> HTML5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Notes on 'POST' and 'GET' in form]]></title>
      <url>/2016/06/22/notes-on-post-and-get-in-form/</url>
      <content type="html"><![CDATA[<p>The ‘method’ attribute in form element specifies how to send form-data(the form-data is sent to the page specified in the ‘action’ attribute).</p>
<p>The form-data can be sent as <strong>URL variables</strong>(with <code>method=&#39;get&#39;</code>) or as <strong>HTTP Post transaction</strong>(with <code>method=&#39;post&#39;</code>).</p>
<h4 id="Notes-on-GET"><a href="#Notes-on-GET" class="headerlink" title="Notes on GET:"></a>Notes on GET:</h4><ul>
<li>Appends form-data into the URL in name-value pairs;</li>
<li>The length of a URL is limited(about 3000 characters);</li>
<li>Never use GET to send sensitive data cause they will be visible in the URL;</li>
<li>Useful for form submissions where a user want to bookmark the result;</li>
<li>GET is better than non-secure data, like query string in Google.</li>
</ul>
<h4 id="Notes-on-POST"><a href="#Notes-on-POST" class="headerlink" title="Notes on POST:"></a>Notes on POST:</h4><ul>
<li>Appends form-data inside the body of HTTP request(both in head-line and body);</li>
<li>Has no size limitation;</li>
<li>Form submissions with POST cannot be bookmarked.</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[滚动视差效果]]></title>
      <url>/2016/06/20/e6-bb-9a-e5-8a-a8-e8-a7-86-e5-b7-ae-e6-95-88-e6-9e-9c/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<p><style><br>.container{<br>  overflow-y:scroll;<br>  overflow-x:hidden;<br>  perspective:1px;<br>  transform-style:preserve-3d;<br>  color:yellow;<br>  text-align:center;<br>}<br>.bg{<br>  width: 100vw;<br>  height: 40vh;<br>  position:relative;<br>}<br>h1{<br>  padding:100px;<br>}<br>.bg:before{<br>  position:absolute;<br>  top: 0;<br>  left: 0;<br>  right: 0;<br>  bottom: 0;<br>  content:””;<br>  display:block;<br>  background: url(“<a href="http://7xu8mu.com1.z0.glb.clouddn.com/katong_1.jpg">http://7xu8mu.com1.z0.glb.clouddn.com/katong_1.jpg</a>“);<br>  background-size:cover;<br>  z-index: -1;<br>  transform:translateZ(-1px) scale(2);<br>}<br></style><br></p>
<body><br><br><div class="container"><br>  <div class="bg"><br><br># Hello World<br><br>        原理是将图片放在bg:before, 然后为 container 设置 perspective:1px 和 preserve-3d, 并蛇者 overflow:auto(要避免 x-index 则使用 overflow-y:scroll), 然后将 bg:before 向 Z 轴移动-1px, 形成前后空间<br>  </div><br></div><br><br>    /<em>HTML</em>/<br>    div.container<br>        div.bg<br>            h1{…}<br>            p{…}<br>    /<em>CSS</em>/<br>    .container{<br>      overflow-y:scroll;<br>      overflow-x:hidden;<br>      perspective:1px;<br>      transform-style:preserve-3d;<br>      color:yellow;<br>      text-align:center;<br>    }<br>    .bg{<br>      width: 100vw;<br>      height: 40vh;<br>      position:relative;<br>    }<br>    h1{<br>      padding:100px;<br>    }<br>    .bg:before{<br>      position:absolute;<br>      top: 0;<br>      left: 0;<br>      right: 0;<br>      bottom: 0;<br>      content:””;<br>      display:block;<br>      background: url(“<a href="http://7xu8mu.com1.z0.glb.clouddn.com/katong_1.jpg" target="_blank" rel="external">http://7xu8mu.com1.z0.glb.clouddn.com/katong_1.jpg</a>“);<br>      background-size:cover;<br>      z-index: -1;<br>      transform:translateZ(-1px) scale(2);<br>    }<br><br></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Card Style - 1]]></title>
      <url>/2016/06/20/card-style-1/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<style>
        _,_:before,*:after{
            box-sizing: border-box;
        }
        .wrapper{
            padding-top: 40px;
            padding-bottom: 40px;
        }
        .wrapper:focus{
            outline:0;
        }
        .clash-card{
            background-color: #fff;
            width: 300px;
            display: inline-block;
            margin:auto;
            border-radius: 20px;
            position:relative;
            text-align: center;
            box-shadow: -1px 15px 30px -12px black;
            z-index: 9999;
        }
        .clash-card__image{
            position: relative;
            height: 230px;
            margin-bottom: 35px;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .clash-card__image--barbarian{
            background: url("http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/barbarian-bg.jpg")
        }
        .clash-card__image--barbarian img{
            width: 400px;
            position: absolute;
            top: -65px;
            left: -70px;
        }
        .clash-card__level{
            text-transform: uppercase;
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 3px;
        }
        .clash-card__level--barbarian{
            color:#EC9B3B;
        }
        .clash-card__unit-name{
            font-size: 26px;
            color:#000;
            font-weight: 900;
            margin-bottom: 5px;
        }
        .clash-card__unit-description{
            padding: 20px;
            margin-bottom: 10px;
        }
        .clash-card__unit-stats--barbarian{
            background: #EC9B3B;
        }
        .clash-card__unit-stats--barbarian .one-third{
            border-right: 1px solid #BD7C2F;
        }
        .clash-card__unit-stats{
            color:#fff;
            font-weight: 700;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            overflow: hidden;
        }
        .clash-card__unit-stats .one-third{
            width: 33.33%;
            float: left;
            padding: 20px 15px;
        }
        .clash-card__unit-stats sup{
            position: absolute;
        }
        .clash-card__unit-stats .stat{
            position: relative;
            font-size: 20px;
            margin-bottom: 10px;
        }
        .clash-card__unit-stats .stat-value{
            text-transform: uppercase;
            font-weight: 400;
            font-size: 12px;
        }
        .clash-card__unit-stats .no-border{
            border-right: none;
        }
        .clearfix:after{
            content:"";
            clear:both;
            visibility: hidden;
            height: 0;
            font-size: 0;
        }
    </style>

<body>
    <div class="wrapper">
        <div class="clash-card barbarian">
            <div class="clash-card__image clash-card__image--barbarian">
                ![barbarian](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/barbarian.png)
            </div>
            <div class="clash-card__level clash-card__level--barbarian">Level 5</div>
            <div class="clash-card__unit-name">The Barbarian</div>
            <div class="clash-card__unit-description">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Itaque, optio! Provident iure architecto atque sequi alias! Tempore alias doloremque tempora, quod enim nulla quia, saepe accusantium eius minus quisquam architecto.</div>
            <div class="clash-card__unit-stats clash-card__unit-stats--barbarian clearfix">
                <div class="one-third">
                    <div class="stat">20<sup>s</sup></div>
                    <div class="stat-value">Training</div>
                </div>
                <div class="one-third">
                    <div class="stat">16</div>
                    <div class="stat-value">Speed</div>
                </div>
                <div class="one-third no-border">
                    <div class="stat">150</div>
                    <div class="stat-value">Cost</div>
                </div>
            </div>
        </div>
    </div>

<pre>
`
    /*HTML*/
    div.wrapper
        div.clash-card.barbarian
            div.clash-card__image.clash-card_image--barbarian
                img.src
            div.cash-card__level.clash-card__level--barbarian{Level 5}
            div.clash-card__unit-name{The Barbarian}
            div.clash-card__unit-description{...}
            div.clash-card__unit-stats.clash-card__unit-stats--barbarian.clearfix
                div.one-third
                    div.stat{20s}
                    div.stat-value{Training}
                div.one-third
                    div.stat{16}
                    div.stat-value{Speed}
                div.one-third.no-border
                    div.stat{150}
                    div.stat-value{Cost}
    /*CSS*/
    <style>
        *,*:before,*:after{
            box-sizing: border-box;
        }
        .wrapper{
            padding-top: 40px;
            padding-bottom: 40px;
        }
        .wrapper:focus{
            outline:0;
        }
        .clash-card{
            background-color: #fff;
            width: 300px;
            display: inline-block;
            margin:auto;
            border-radius: 20px;
            position:relative;
            text-align: center;
            box-shadow: -1px 15px 30px -12px black;
            z-index: 9999;
        }
        .clash-card__image{
            position: relative;
            height: 230px;
            margin-bottom: 35px;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }
        .clash-card__image--barbarian{
            background: url("http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/barbarian-bg.jpg")
        }
        .clash-card__image--barbarian img{
            width: 400px;
            position: absolute;
            top: -65px;
            left: -70px;
        }
        .clash-card__level{
            text-transform: uppercase;
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 3px;
        }
        .clash-card__level--barbarian{
            color:#EC9B3B;
        }
        .clash-card__unit-name{
            font-size: 26px;
            color:#000;
            font-weight: 900;
            margin-bottom: 5px;
        }
        .clash-card__unit-description{
            padding: 20px;
            margin-bottom: 10px;
        }
        .clash-card__unit-stats--barbarian{
            background: #EC9B3B;
        }
        .clash-card__unit-stats--barbarian .one-third{
            border-right: 1px solid #BD7C2F;
        }
        .clash-card__unit-stats{
            color:#fff;
            font-weight: 700;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            overflow: hidden;
        }
        .clash-card__unit-stats .one-third{
            width: 33.33%;
            float: left;
            padding: 20px 15px;
        }
        .clash-card__unit-stats sup{
            position: absolute;
        }
        .clash-card__unit-stats .stat{
            position: relative;
            font-size: 20px;
            margin-bottom: 10px;
        }
        .clash-card__unit-stats .stat-value{
            text-transform: uppercase;
            font-weight: 400;
            font-size: 12px;
        }
        .clash-card__unit-stats .no-border{
            border-right: none;
        }
        .clearfix:after{
            content:"";
            clear:both;
            visibility: hidden;
            height: 0;
            font-size: 0;
        }
    </style>

<p>`<br></p></pre><p></p>
<p></p></body><p></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Accordion with jQuery]]></title>
      <url>/2016/06/20/accordion-with-jquery/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<p><style><br>.accordion{<br>  margin:50px auto;<br>  width: 380px;<br>  cursor:pointer;<br>}<br>.accordion .item{<br>  height:100px;<br>}<br>.accordion .item h3{<br>  display:inline-block;<br>  vertical-align:middle;<br>  height: 100%;<br>  padding-left: 50px;<br>  font-size: 20px;<br>  font-weight: 400;<br>}<br>.accordion .item h3:before{<br>  content:””;<br>  display:inline-block;<br>  vertical-align:middle;<br>  height: 100%;<br>}<br>.accordion .item:first-of-type{<br>  background-color: #620808;<br>  color:#f4ce74;<br>}<br>.accordion .item:nth-of-type(2){<br>  background-color: #a53f3f;<br>  color:#ffe9c1;<br>}<br>.accordion .item:nth-of-type(3){<br>  background-color: #f4ce74;<br>  color:#620808;<br>}<br>.accordion p{<br>  font-family:arial;<br>  font-size: 18px;<br>  font-weight: 400;<br>  padding: 15px;<br>  display:none;<br>    margin:0;<br>  box-shadow: inset 0 3px 7px rgba(0,0,0,.2);<br>}<br>.accordion p:first-of-type{<br>  background-color: #620808;<br>  color:#f4ce74;<br>}<br>.accordion p:nth-of-type(2){<br>  background-color: #a53f3f;<br>  color:#ffe9c1;<br>}<br>.accordion p:nth-of-type(3){<br>  background-color: #f4ce74;<br>  color:#620808;<br>}<br></style><br></p>
<body><br><br><section class="accordion"><br>  <div class="item"><br><br>### Item1<br><br>  </div><br>  Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio in error ipsa facere, veritatis fuga incidunt tempore perferendis placeat. Dolore iste laborum porro possimus officia ratione rerum cumque itaque ullam.<br>  <div class="item"><br><br>### Item2<br><br>  </div><br>  Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio in error ipsa facere, veritatis fuga incidunt tempore perferendis placeat. Dolore iste laborum porro possimus officia ratione rerum cumque itaque ullam.<br>  <div class="item"><br><br>### Item3<br><br>  </div><br>  Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio in error ipsa facere, veritatis fuga incidunt tempore perferendis placeat. Dolore iste laborum porro possimus officia ratione rerum cumque itaque ullam.<br></section><br><br>    /<em>HTML</em>/<br>    section.accordion<br>        div.item<br>            h3{Item1}<br>        p{Lorem}<br>        div.item<br>            h3{Item2}<br>        p{Lorem}<br>        div.item<br>            h3{Item3}<br>        p{Lorem}<br>    /<em>CSS</em>/<br>        body{<br>      background-color: #f6704b;<br>    }<br>    <em>{<br>      margin:0;<br>      padding: 0;<br>    }<br>    .accordion{<br>      margin:50px auto;<br>      width: 380px;<br>      background-color: #ccc;<br>      cursor:pointer;<br>    }<br>    .accordion .item{<br>      height:100px;<br>    }<br>    .accordion .item h3{<br>      display:inline-block;<br>      vertical-align:middle;<br>      height: 100%;<br>      padding-left: 50px;<br>      font-size: 20px;<br>      font-weight: 400;<br>    }<br>    .accordion .item h3:before{<br>      content:””;<br>      display:inline-block;<br>      vertical-align:middle;<br>      height: 100%;<br>    }<br>    .accordion .item:first-of-type{<br>      background-color: #620808;<br>      color:#f4ce74;<br>    }<br>    .accordion .item:nth-of-type(2){<br>      background-color: #a53f3f;<br>      color:#ffe9c1;<br>    }<br>    .accordion .item:nth-of-type(3){<br>      background-color: #f4ce74;<br>      color:#620808;<br>    }<br>    .accordion p{<br>      font-family:arial;<br>      font-size: 18px;<br>      font-weight: 400;<br>      padding: 15px;<br>      display:none;<br>      box-shadow: inset 0 3px 7px rgba(0,0,0,.2);<br>    }<br>    .accordion p:first-of-type{<br>      background-color: #620808;<br>      color:#f4ce74;<br>    }<br>    .accordion p:nth-of-type(2){<br>      background-color: #a53f3f;<br>      color:#ffe9c1;<br>    }<br>    .accordion p:nth-of-type(3){<br>      background-color: #f4ce74;<br>      color:#620808;<br>    }<br>    /</em>jQuery*/<br>    (function($) {<br>          ‘use strict’;<br>          $(“.item”).on(“click”,function(){<br>            $(this).next().slideToggle(100);<br>            $(“p”).not($(this).next()).slideUp(‘fast’);<br>          });<br>        }(jQuery));<br><br><script src="https://code.jquery.com/jquery-3.0.0.min.js" integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0=" crossorigin="anonymous"></script><br><br><script><br>    (function($) {<br>      ‘use strict’;<br>      $(“.item”).on(“click”,function(){<br>        $(this).next().slideToggle(100);<br>        $(“p”).not($(this).next()).slideUp(‘fast’);<br>      });<br>    }(jQuery));<br>  </script><br><br></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> jQuery </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[1 dot -> 3 dots]]></title>
      <url>/2016/06/19/1-dot-3-dots/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<p><style><br>section{<br>margin:0 auto;<br>}<br>.button{<br>  display:inline-block;<br>  font-size:30px;<br>  border:1px solid maroon;<br>  padding:10px 20px;<br>  color:maroon;<br>  position:relative;<br>}<br>.button:before{<br>  position:absolute;<br>  top: 50%;<br>  left: 50%;<br>  color:transparent;<br>  content:”·”;<br>  text-shadow:0 0 transparent;<br>  font-size: 1.2em;<br>  transition: text-shadow .3s,color .3s;<br>  transform:translateX(-50%);<br>}<br>.button:hover:before{<br>  color:maroon;<br>  text-shadow: 10px 0 maroon, -10px 0 maroon;<br>}<br></style><br></p>
<body><br><br><section><div class="button">Button</div></section><br><br>Use <code>text-shadow</code> to generate other dots.<br><br>        /<em>HTML</em>/<br>        div.button{Button}<br>        /<em>CSS</em>/<br>        .button{<br>      display:inline-block;<br>      font-size:30px;<br>      border:1px solid maroon;<br>      padding:10px 20px;<br>      color:maroon;<br>      position:relative;<br>    }<br>    .button:before{<br>      position:absolute;<br>      top: 50%;<br>      left: 50%;<br>      color:transparent;<br>      content:”·”;<br>      text-shadow:0 0 transparent;<br>      font-size: 1.2em;<br>      transition: text-shadow .3s,color .3s;<br>      transform:translateX(-50%);<br>    }<br>    .button:hover:before{<br>      color:maroon;<br>      text-shadow: 10px 0 maroon, -10px 0 maroon;<br>    }<br><br></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Page Scroll with CSS3]]></title>
      <url>/2016/06/17/page-scroll-with-css3/</url>
      <content type="html"><![CDATA[<pre><code>.st-container{
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
}
.st-container &amp;gt; input,
 .st-container &amp;gt; a{
    position:fixed;
    bottom: 0;
    width: 20%;
    cursor:pointer;
    font-size: 16px;
    height: 34px;
    line-height: 34px;
}
.st-container &amp;gt; input{
    opacity: 0;
    z-index: 1000;
}
.st-container &amp;gt; a{
    z-index: 10;
    font-weight: 700;
    background: #e23a6e;
    color:#fff;
    text-align: center;
    text-shadow: 1px 1px 1px rgba(151,24,64,.2);
}
.st-container:before{
    content:&quot;&quot;;
    position: fixed;
    width: 100%;
    height: 34px;
    background-color: #e23a6e;
    z-index: 9;
    bottom: 0;
}
#st-control-1, #st-control-1+a{
    left:0;
}
#st-control-2, #st-control-2+a{
    left:20%;
}
#st-control-3, #st-control-3+a{
    left:40%;
}
#st-control-4, #st-control-4+a{
    left:60%;
}
#st-control-5, #st-control-5+a{
    left:80%;
}
.st-container &amp;gt; input:checked + a,
.st-container &amp;gt; input:checked:hover + a{
    background-color: #821134;
}
.st-container &amp;gt; input:checked + a:after,
.st-container &amp;gt; input:checked:hover + a:after{
    bottom:100%;
    border:solid transparent;
    content:&quot;&quot;;
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
    border-bottom-color: #821134;
    border-width: 20px;
    left:50%;
    margin-left:-20px;
}
.st-container &amp;gt; input:hover+a:after{
    border-bottom-color: #AD244F;
}
.st-scroll,
.st-panel{
    position:relative;
    width: 100%;
    height: 100%;
}
.st-scroll{
    top: 0;
    left: 0;
    transition:all .6s ease-in-out;
}
.st-panel{
    background-color: #fff;
    overflow: hidden;
}
#st-control-1:checked ~ .st-scroll{ //scroll
    transform:translateY(0%);
}
#st-control-2:checked ~ .st-scroll{ //scroll
    transform: translateY(-100%);
}
#st-control-3:checked ~ .st-scroll{ //scroll
    transform: translateY(-200%);
}
#st-control-4:checked ~ .st-scroll{ //scroll
    transform: translateY(-300%);
}
#st-control-5:checked ~ .st-scroll{ //scroll
    transform: translateY(-400%);
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Button Transition with Background-position]]></title>
      <url>/2016/06/17/button-transition-with-background-position/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<p><style><br>button{<br>  color:maroon;<br>  border:1px solid maroon;<br>  font-size:50px;<br>  padding:20px 40px;<br>  border-radius:15px;<br>  transition-duration:0.5s;<br>  position:relative;<br>  overflow:hidden;<br>}<br>button:hover{<br>  color:#fff;<br>}<br>.left{<br>  background:-webkit-linear-gradient(left, maroon 50%, transparent 50%);<br>  background-size:200% 100%;<br>  background-position:100% 0%;<br>}<br>.left:hover{<br>  background-position:0% 0%;<br>}<br>.angle{<br>  background:-webkit-linear-gradient(225deg, maroon 50%, transparent 50%);<br>  background-size:250% 100%;<br>}<br>.angle:hover{<br>  background-position:100% 0%;<br>}<br>.close{<br>  background:-webkit-linear-gradient(left, transparent 50%, maroon 50%);<br>  background-size:200% 100%;<br>}<br>.close:after{<br>  content:””;<br>  position:absolute;<br>  z-index: -1;<br>  top:0;<br>  left:0;<br>  right: 0;<br>  bottom: 0;<br>  background:-webkit-linear-gradient(left, maroon 50%, transparent 50%);<br>  background-size:200% 100%;<br>  background-position:100% 0%;<br>  transition-duration:.5s;<br>}<br>.close:hover{<br>  background-position:50% 0%;<br>}<br>.close:hover:after{<br>  background-position:50% 0%;<br>}<br>}<br></style><br></p>
<body><br>  <button class="left">Left</button><br><br>  <button class="angle">Angle</button><br><br>  <button class="close">Close</button><br><br><pre><code>button{
  color:maroon;
  border:1px solid maroon;
  font-size:50px;
  padding:20px 40px;
  border-radius:15px;
  transition-duration:0.5s;
  position:relative;
  overflow:hidden;
}
button:hover{
  color:#fff;
}
.left{
  background:-webkit-linear-gradient(left, maroon 50%, transparent 50%);
  background-size:200% 100%;
  background-position:100% 0%;

}
.left:hover{
  background-position:0% 0%;
}

.angle{
  background:-webkit-linear-gradient(225deg, maroon 50%, transparent 50%);
  background-size:250% 100%;
}
.angle:hover{
  background-position:100% 0%;
}

.close{
  background:-webkit-linear-gradient(left, transparent 50%, maroon 50%);
  background-size:200% 100%;
}
.close:after{
  content:&quot;&quot;;
  position:absolute;
  z-index: -1;
  top:0;
  left:0;
  right: 0;
  bottom: 0;
  background:-webkit-linear-gradient(left, maroon 50%, transparent 50%);
  background-size:200% 100%;
  background-position:100% 0%;
  transition-duration:.5s;
}
.close:hover{
  background-position:50% 0%;
}
.close:hover:after{
  background-position:50% 0%;
}
}
&lt;/pre&gt;</code><br></pre></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[图片翻转+文字翻转特效]]></title>
      <url>/2016/06/17/e5-9b-be-e7-89-87-e7-bf-bb-e8-bd-ac-e6-96-87-e5-ad-97-e7-bf-bb-e8-bd-ac-e7-89-b9-e6-95-88/</url>
      <content type="html"><![CDATA[<head><br><style><br>.box{<br>  position:relative;<br>  perspective: 1000px;<br>  text-align:center;<br>}<br>.box img{<br>  width:200px;<br>  height:auto;<br>  opacity:1;<br>  transform:translateY(0) rotateX(0);<br>  transition: all 1s ease-in-out 0s;<br>}<br><br>.box:hover img{<br>  transform: translateY(-100%) rotateX(90deg);<br>  transform-origin: center bottom 0;<br>  opacity:0;<br>}<br><br>.box .over-layer{<br>  position:absolute;<br>  top:0;<br>  left:0;<br>  width:100%;<br>  height:100%;<br>  transform: translateY(100%) rotateX(-90deg);<br>    opacity:0;<br>  transform-origin:top center;<br>  transition: all 1s ease-in-out;<br>}<br>.box:hover .over-layer{<br>  transform: translateY(0) rotateX(0);<br>    opacity:1;<br>}<br></style><br></head>

<body><br><br><div><br>    <div class="box"><br>        <img src="http://a1.att.hudong.com/75/68/05300000467416128543684500954.jpg" alt="蒙娜丽莎"><br>    <div class="over-layer"><br><br>### Web Designer<br><br>Description<br><br>    </div><br>    </div><br></div><br><br></body>

<pre><code>/*HTML*/
    div.box
        img[src=&quot;...&quot;]
        div.over-layer
            h3
            p
/*CSS*/
.box{
  position:relative;
  perspective: 1000px;
  text-align:center;
}
.box img{
  width:200px;
  height:auto;
  opacity:1;
  transform:translateY(0) rotateX(0);
  transition: all 1s ease-in-out 0s;
}

.box:hover img{
  transform: translateY(-100%) rotateX(90deg);
  transform-origin: center bottom 0;
  opacity:0;
}

.box .over-layer{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  transform: translateY(100%) rotateX(-90deg);
    opacity:0;
  transform-origin:top center;
  transition: all 1s ease-in-out;
}
.box:hover .over-layer{
  transform: translateY(0) rotateX(0);
    opacity:1;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[转角跑马灯]]></title>
      <url>/2016/06/16/e8-bd-ac-e8-a7-92-e8-b7-91-e9-a9-ac-e7-81-af/</url>
      <content type="html"><![CDATA[<head><br><style><br>.marquee{<br>  margin-top:3rem;<br>  perspective:500px;<br>  font-size:0;<br>  font-family:”Microsoft YaHei”, “Segoe UI”, “Lucida Granda”, Helvetica, Arial;<br>}<br><br>.marquee div{<br>  display:inline-block;<br>  height:12rem;<br>  width:30rem;<br>  position:relative;<br>}<br>.marquee div{<br>  font-size:8rem;<br>  overflow:hidden;<br>}<br>.marquee div span{<br>  position:absolute;<br>  width:400%;<br>  line-height:1.4;<br>}<br>.marquee div:first-of-type{<br>  background:#e5233e;<br>  transform-origin: top right;<br>  transform: rotateY(-40deg);<br>  color:#fff;<br>}<br>.marquee div:last-of-type{<br>  background:#b31e31;<br>  transform-origin:top left;<br>  transform:rotateY(45deg);<br>  color:#f8c9d9;<br>}<br>@keyframes leftcrawl{<br>  to{   transform:translateX(-100rem);<br>}<br>}<br>@keyframes rightcrawl{<br>  to{<br>    transform:translateX(-100rem);}<br>}<br><br>.marquee div:first-of-type span{<br>  transform:translateX(60rem);<br>  animation:leftcrawl 14s linear infinite;<br>  text-shadow:4px 0 4px rgba(0,0,0,0.3);<br>}<br>.marquee div:last-of-type span{<br>  transform:translateX(43rem);<br>  animation:rightcrawl 14s ease-out infinite;<br>}<br>}<br></style><br></head>

<body><br><br><div class="marquee"><br>    <div><span> 跑马灯</span></div><br>    <div aria-hidden="true"><span> 跑马灯</span></div><br>  </div><br><br><pre><br><code>/*HTML*/
div.marquee
    div&gt;span{跑马灯}
    div&gt;span{跑马灯}
/*CSS*/
.marquee{
  margin-top:3rem;
  perspective:500px;
  font-size:0;
  font-family:&quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, &quot;Lucida Granda&quot;, Helvetica, Arial;
}

.marquee div{
  display:inline-block;
  height:12rem;
  width:30rem;
  position:relative;
}
.marquee div{
  font-size:8rem;
  overflow:hidden;
}
.marquee div span{
  position:absolute;
  width:400%;
  line-height:1.4;
}
.marquee div:first-of-type{
  background:#e5233e;
  transform-origin: top right;
  transform: rotateY(-40deg);
  color:#fff;
}
.marquee div:last-of-type{
  background:#b31e31;
  transform-origin:top left;
  transform:rotateY(45deg);
  color:#f8c9d9;
}
@keyframes leftcrawl{
  to{   transform:translateX(-100rem);
}
}
@keyframes rightcrawl{
  to{
    transform:translateX(-100rem);}
}

.marquee div:first-of-type span{
  transform:translateX(60rem);
  animation:leftcrawl 14s linear infinite;
  text-shadow:4px 0 4px rgba(0,0,0,0.3);
}
.marquee div:last-of-type span{
  transform:translateX(43rem);
  animation:rightcrawl 14s ease-out infinite;
}
}</code><br></pre><br><br></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS Cube Transform]]></title>
      <url>/2016/06/16/css-cube-transform/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<p><style><br>.container{<br>  width:200px;<br>  height:200px;<br>  position:relative;<br>  perspective:1000px;<br>    margin:0 auto;<br>}<br>.cube{<br>  width:100%;<br>  height:100%;<br>  position:absolute;<br>  transform-style:preserve-3d;<br>}<br>.cube figure{<br>  width:196px;<br>  height:196px;<br>  border:2px solid #ccc;<br>  position:absolute;<br>  font-size:20px;<br>  line-height:196px;<br>  font-weight:bold;<br>  color:white;<br>  text-align:center;<br>  transition:transform 1s ease;<br>}<br>.cube:hover .front{<br>  background: hsla(   0, 100%, 50%, 0.5 );<br>  transform:translateZ(100px);<br>}<br>.cube:hover .back{<br>  background: hsla(  60, 100%, 50%, 0.5 );<br>  transform:rotateY(180deg) translateZ(100px);<br>}<br>.cube:hover .right{<br>  background: hsla( 120, 100%, 50%, 0.5 );<br>  transform: rotateY(90deg) translateZ(100px);<br>}</p>
<p>.cube:hover .left{<br>  background: hsla( 180, 100%, 50%, 0.5 );<br>  transform: rotateY(-90deg) translateZ(100px);<br>}<br>.cube:hover .top{<br>  background: hsla( 240, 100%, 50%, 0.5 );<br>  transform: rotateX(90deg) translateZ(100px);<br>}<br>.cube:hover .bottom{<br>  background: hsla( 300, 100%, 50%, 0.5 );<br>  transform: rotateX(-90deg) translateZ(100px);<br>}<br></style><br></p>
<body><br><br><div><br><div class="container"><br>  <div class="cube"><br>    <figure class="front">Front</figure><br>    <figure class="back">Back</figure><br>    <figure class="right">Right</figure><br>    <figure class="left">Left</figure><br>    <figure class="top">Top</figure><br>    <figure class="bottom">Bottom</figure><br>  </div><br></div><br><strong>Notice</strong>, when the rotate applied to the element, its coordinates will rotate with it. In this case, all Z-indices rotate to pointing outside the cube.<br><pre><br><code>/*HTML*/
div.container
    div.cube
        fiture.front{Front}
        fiture.back{Back}
        fiture.right{Right}
        figure.left{Left}
        figure.top{Top}
        figure.bottom{Bottom}

/*CSS*/
.container{
  width:200px;
  height:200px;
  position:relative;
  perspective:1000px;
}
.cube{
  width:100%;
  height:100%;
  position:absolute;
  transform-style:preserve-3d;
}
.cube figure{ //Set single Aspect
  width:196px;
  height:196px;
  border:2px solid #ccc;
  position:absolute;
  font-size:20px;
  line-height:196px;
  font-weight:bold;
  color:white;
  text-align:center;
  transition:transform 1s ease;
}
.cube:hover .front{ 
  background: hsla(   0, 100%, 50%, 0.5 ); 
  transform:translateZ(100px);
}

.cube:hover .back{ 
  background: hsla(  60, 100%, 50%, 0.5 );
  transform:rotateY(180deg) translateZ(100px);
}

.cube:hover .right{ 
  background: hsla( 120, 100%, 50%, 0.5 );
  transform: rotateY(90deg) translateZ(100px);
}

.cube:hover .left{
  background: hsla( 180, 100%, 50%, 0.5 );
  transform: rotateY(-90deg) translateZ(100px);
}

.cube:hover .top{ 
  background: hsla( 240, 100%, 50%, 0.5 ); 
  transform: rotateX(90deg) translateZ(100px);
}

.cube:hover .bottom{ 
  background: hsla( 300, 100%, 50%, 0.5 );
  transform: rotateX(-90deg) translateZ(100px);
}</code><br></pre><br></div><br><br></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS Progress Bar]]></title>
      <url>/2016/06/16/css-progress-bar/</url>
      <content type="html"><![CDATA[<p><head><style><br>.wrapper{<br>  position:relative;<br>  overflow:visible;<br>  width:500px;<br>  margin:0 auto;<br>}<br>.bar{<br>  border:1px solid maroon;<br>  margin:40px 30px;<br>  padding: 8px 0;<br>  height:55px;<br>  background: maroon;<br>  background: -webkit-linear-gradient(left, maroon 50%, #fff 50%);<br>  background-size:200% 100%;<br>  background-position: 100% 0%;<br>  -webkit-animation: AnimationName 10s ease infinite;<br>}<br>@keyframes AnimationName{<br>  100%{<br>    background-position:0% 0%;<br>  }}<br>.text{<br>  font-size:22px;<br>  margin:15px 0;<br>  text-align:center;<br>  text-transform:uppercase;<br>  text-weight:bold;<br>  background: -webkit-linear-gradient(left, #fff 50%, maroon 50%);<br>  background-size:200% 100%;<br>  background-position: 100% 0%;<br>  -webkit-background-clip:text;<br>  -webkit-text-fill-color: transparent;<br>  animation: AnimationName 10s ease infinite;<br>}<br></style></head></p>
<body><br><br><div class="wrapper"><br>  <div class="bar"><br><br>      Loading Bar<br><br>  </div><br></div><br><br>    .bar{<br>      border:1px solid maroon;<br>      margin:40px 30px;<br>      padding: 8px 0;<br>      height:55px;<br>      background: maroon;<br>      background: -webkit-linear-gradient(left, maroon 50%, #fff 50%);<br>      background-size:200% 100%;<br>      background-position: 100% 0%;<br>      -webkit-animation: AnimationName 10s ease infinite;<br>    }<br>    @keyframes AnimationName{<br>      100%{<br>        background-position:0% 0%;<br>      }}<br><br>    .text{<br>      font-size:22px;<br>      margin:15px 0;<br>      text-align:center;<br>      text-transform:uppercase;<br>      text-weight:bold;<br>      background: -webkit-linear-gradient(left, #fff 50%, maroon 50%);<br>      background-size:200% 100%;<br>      background-position: 100% 0%;<br>      -webkit-background-clip:text;<br>      -webkit-text-fill-color: transparent;<br>      animation: AnimationName 10s ease infinite;<br>    }<br><br></body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Text Gradient]]></title>
      <url>/2016/06/16/text-gradient/</url>
      <content type="html"><![CDATA[<p><head></head></p>
<p><style><br>.background{<br>  background:#04161f;<br>  font-family:”Lato”, sans-serif;<br>  margin:3em auto;<br>  max-width:50em;<br>}<br>.grad1{<br>  display:inline-block;<br>  font-size: 96px;<br>  margin:0;<br>  opacity:0.9;<br>  background:#fff;<br>  color:black;<br>  position:relative;<br>  text-shadow:1px 1px 0px #04161f, 1px 1px 0px #04161f, -1px -1px 0px #04161f;<br>}<br>.grad1:before, .grad1:after{<br>  position:absolute;<br>  top:0;<br>  right:0;<br>  bottom:0;<br>  left:0;<br>  pointer-events:none;<br>}<br>.grad1:before{<br>  background: -webkit-linear-gradient(left, #23966c, #faaa54, #e23b4a, #db0768, #350670);<br>  content:””;<br>  display:block;<br>  mix-blend-mode:screen;<br>}<br>.grad1:after{<br>  content:”CSS Gradient”;<br>  background:#04161f;<br>  color:#fff;<br>  mix-blend-mode:multiply;<br>}<br>.grad2{<br>  font-size:72px;<br>  background:-webkit-linear-gradient(left, #23966c, #faaa54, #e23b4a, #db0768, #350670);<br>  -webkit-background-clip:text;<br>  -webkit-text-fill-color:transparent;<br>}<br></style><br></p>
<body>

<ol>
<li><p>Mix-Blend-Mode</p>
<div class="background grad1">CSS Gradient</div>

<p>body{<br>  background:#04161f;<br>  font-family:”Lato”, sans-serif;<br>  margin:3em auto;<br>  max-width:50em;<br>}<br>.grad1{<br>  display:inline-block;<br>  font-size: 96px;<br>  margin:0;<br>  opacity:0.9;<br>  background:#fff;<br>  color:black;<br>  position:relative;<br>  text-shadow:1px 1px 0px #04161f, 1px 1px 0px #04161f, -1px -1px 0px #04161f;<br>}<br>.grad1:before, .grad1:after{<br>  position:absolute;<br>  top:0;<br>  right:0;<br>  bottom:0;<br>  left:0;<br>  pointer-events:none;<br>}<br>.grad1:before{<br>  background: -webkit-linear-gradient(left, #23966c, #faaa54, #e23b4a, #db0768, #350670);<br>  content:””;<br>  display:block;<br>  mix-blend-mode:screen;<br>}<br>.grad1:after{<br>  content:”CSS Gradient”;<br>  background:#04161f;<br>  color:#fff;<br>  mix-blend-mode:multiply;<br>}<br>`</p>
</li>
<li>-webkit-background-clip + -webkit-text-fill-mode<br><div class="background"><div class="grad2">CSS Gradient</div></div><br><pre>`<br>.grad2{<br>  font-size:72px;<br>  background:-webkit-linear-gradient(left, #23966c, #faaa54, #e23b4a, #db0768, #350670);<br>  -webkit-background-clip:text;<br>  -webkit-text-fill-color:transparent;<br>}</pre></li>
</ol>
</body>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS3 中的 pointer-events 属性]]></title>
      <url>/2016/06/15/css3-e4-b8-ad-e7-9a-84-pointer-events-e5-b1-9e-e6-80-a7/</url>
      <content type="html"><![CDATA[<h3 id="功能"><a href="#功能" class="headerlink" title="功能:"></a>功能:</h3><ul>
<li>阻止用户的点击产生任何效果</li>
<li>阻止默认鼠标指针样式的显示(比如放在<code>&amp;lt;a&amp;gt;</code>上不会变成<code>pointer</code>)</li>
<li>阻止 CSS 里的<code>hover</code> 和<code>active</code>状态的监听*   阻止触发 JS 事件(同上)</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS3 Transitions Basics]]></title>
      <url>/2016/06/15/css3-transitions-basics/</url>
      <content type="html"><![CDATA[<h3 id="Benefits-of-CSS-3"><a href="#Benefits-of-CSS-3" class="headerlink" title="Benefits of CSS 3"></a>Benefits of CSS 3</h3><ol>
<li>CSS3 Transitions are natively handled by the browser, which means they are always faster than a comparable JS animation.</li>
<li>JS animation is more difficult.</li>
</ol>
<h3 id="Bezier-Timing-Functions"><a href="#Bezier-Timing-Functions" class="headerlink" title="Bezier Timing Functions"></a>Bezier Timing Functions</h3><p>CSS3 has a <code>transition-timing-function</code> property which accepts keywords like <code>ease</code>, <code>ease-in</code>, and <code>linear</code>.</p>
<p>However we can define our own timing function using a <code>cubic-bezier</code> value. It sounds and looks complicated but can be explained with some simple diagrams.</p>
<ol>
<li><code>linear</code> curse<br><img src="http://blogs.sitepointstatic.com/images/tech/855-css3-transitions-3-chart1.png" alt=""></li>
<li><code>ease-in-out</code> curse<br><img src="http://blogs.sitepointstatic.com/images/tech/855-css3-transitions-3-chart2.png" alt=""><br>it starts slowly, about 12% of the animation is completed in the first 25% of time;<br>it ends slowly, about 12 % of the animation is completed in the last 25% of time</li>
</ol>
<h4 id="What’s-a-Bezier-Curve"><a href="#What’s-a-Bezier-Curve" class="headerlink" title="What’s a Bezier Curve"></a>What’s a Bezier Curve</h4><p><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Bezier_3_big.gif/240px-Bezier_3_big.gif" alt=""></p>
<p>Since the animation line starts at (0, 0) and ends at (1, 1), we just need to define the points P0 and P1 in the cubic bezier value, e.g.</p>
<pre><code>cubic-bezier(p0x, p0y, p1x, p1y);
transition-timing-function: cubic-bezier(0.25, 0.25, 0.75, 0.75) //linear
transition-timing-function: cubic-bezier(0.42,0,0.58,1) //ease-in-out
`&lt;/pre&gt;

&lt;pre&gt;`transition-timing-function: cubic-bezier(0.5, -0.5, 0.5, 1.5) // invalid, points cannot locate outsite (0,1)
</code></pre><p><img src="http://blogs.sitepointstatic.com/images/tech/855-css3-transitions-3-chart4.png" alt=""></p>
<h4 id="Let-the-Tools-do-the-Work"><a href="#Let-the-Tools-do-the-Work" class="headerlink" title="Let the Tools do the Work"></a>Let the Tools do the Work</h4><p><a href="http://cubic-bezier.com/" target="_blank" rel="external">cubic-bezier.com</a></p>
<p><a href="http://matthewlein.com/ceaser/" target="_blank" rel="external">Ceaser</a></p>
<h3 id="Transition-Property-Basics"><a href="#Transition-Property-Basics" class="headerlink" title="Transition Property Basics"></a>Transition Property Basics</h3><h4 id="Which-CSS-Properties-can-be-animated"><a href="#Which-CSS-Properties-can-be-animated" class="headerlink" title="Which CSS Properties can be animated?"></a>Which CSS Properties can be animated?</h4><ul>
<li>width</li>
<li>padding</li>
<li>color</li>
<li>top</li>
<li>border-radius</li>
<li>transform</li>
<li>all</li>
</ul>
<p>you can set one or more to property <code>transition-property</code></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[大公司怎么开发和部署前端代码]]></title>
      <url>/2016/06/14/e5-a4-a7-e5-85-ac-e5-8f-b8-e6-80-8e-e4-b9-88-e5-bc-80-e5-8f-91-e5-92-8c-e9-83-a8-e7-bd-b2-e5-89-8d-e7-ab-af-e4-bb-a3-e7-a0-81/</url>
      <content type="html"><![CDATA[<h6 id="原文出处-fouber"><a href="#原文出处-fouber" class="headerlink" title="原文出处: fouber"></a>原文出处: <a href="https://github.com/fouber/blog/issues/6" target="_blank" rel="external">fouber</a></h6><p>个人总结</p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/01.png" alt=""></p>
<p>图中 a.css 是页面 index.html 的样式, 对于高访问量的页面而言, 每次访问 index.html 都需要请求 a.css, 会很影响性能.</p>
<p>因此我们希望这样安排</p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/03.png" alt=""></p>
<p>利用304, 让浏览器使用本地缓存: 304叫协商缓存, 仍然需要和服务器通信一次</p>
<p>进一步优化, 强制浏览器使用本地缓存( cache-control/expires ), 不需要和服务器痛心了</p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/04.png" alt=""></p>
<p>新的问题: 浏览器不发送资源请求, 如何更新缓存?</p>
<p><strong>通过更新页面中引用的资源路径, 让浏览器主动放弃缓存, 加载新资源</strong></p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/05.png" alt=""></p>
<p>下次上线把链接地址改成新版本的, 就更新了资源</p>
<p>如果有很多样式引用, 但是仅仅改了其中一个呢?</p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/07.png" alt=""></p>
<p>解决方法: 让url 的修改与文件内容关联, 即只有文件内容发生变化, 才会更新 url</p>
<p>利用<strong>数据摘要算法</strong>对文件请求摘要信息, 摘要信息和文件内容一一对应, 就有了一种可以精确到单个文件粒度的缓存控制依据.</p>
<p>把 URL 改成带摘要信息的格式:</p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/08.png" alt=""></p>
<p>以后如有文件修改, 就只更新对应的 URL 了</p>
<h4 id="进一步提高网站性能"><a href="#进一步提高网站性能" class="headerlink" title="进一步提高网站性能"></a>进一步提高网站性能</h4><p>把静态资源和动态网页分集群部署, 静态资源会被部署到 CDN 节点上, 网页中引用的资源也会变成对应的部署路径</p>
<p><img src="https://raw.githubusercontent.com/fouber/blog/master/assets/resource/09.png" alt=""></p>
<p>静态资源优化方案</p>
<ul>
<li>配置超长时间的本地缓存 — 节省带宽, 提高性能</li>
<li>采用内容摘要作为缓存更新依据 — 精确控制缓存</li>
<li>静态资源 CDN 部署 — 优化网络请求</li>
<li>更新资源发布路径实现非覆盖式发布 — 平滑升级</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS 添加条纹背景]]></title>
      <url>/2016/06/14/css-e6-b7-bb-e5-8a-a0-e6-9d-a1-e7-ba-b9-e8-83-8c-e6-99-af/</url>
      <content type="html"><![CDATA[<head><br><style><br>.bg{<br>  height:300px;<br>  width:300px;<br>    color:#fff;<br>}<br>.type1{<br>  background: linear-gradient(#fb3 20%, #58a 80%);<br>}<br>.type2{<br>background: linear-gradient(#fb3 50%, #58a 50%);<br>}<br>.type3{<br>background-size:100% 30px;<br>}<br>.type4{<br>  background: linear-gradient(45deg, #fb3 50%, #58a 50%);<br>  background-size:30px 30px;<br>}<br>.type5{<br>  background: repeating-linear-gradient(45deg, #fb3, #58a 30px)<br>}<br>.type6{<br>  background: #58a;<br>  background-image: repeating-linear-gradient(45deg, hsla(0,0%,100%,.1),hsla(0,0%,100%,.1) 15px,transparent 0, transparent 30px);<br>}<br>    </style><br>    </head>

<pre><code>&amp;lt;body&amp;gt;
&amp;lt;div class=&quot;bg type1&quot;&amp;gt;background: linear-gradient(#fb3 20%, #58a 80%);&amp;lt;br&amp;gt;
</code></pre><p>整个背景上下各有20%的纯色, 中间是过渡颜色</p>
<div class="bg type2">background: linear-gradient(#fb3 50%, #58a 50%);<br><br>上下两部分都是纯色</div>

<div class="bg type2 type3">添加 background-size:100% 30px;<br><br>  宽100%, 高30px, 默认 repeat<br></div>

<div class="bg type4">斜向条纹<br><br>修改 linear-gradient 的角度: linear-gradient(45deg, #fb3 50%, #58a 50%)<br><br>添加重复:background-size:30px;</div>

<div class="bg type5">使用 repeat-linear-gradient:<br><br>background: repeating-linear-gradient(45deg, #fb3, #58a 30px)<br></div>

<p>&lt;</p>
<p>div class=”bg type6”&gt;<br>关于颜色设定, 如果我们希望条纹使用相近的颜色, 可以使用如下方法:</p>
<p>background: #58a;</p>
<p>background-image: repeating-linear-gradient(30deg, hsla(0,0%,100%,.1),hsla(0,0%,100%,.1) 15px,transparent 0, transparent 30px);</p>
<p>其原理是指定背景中最深的颜色, 其他颜色用透明度调整</p>
<p>&lt;</p>
<p>div&gt;</p>
<p></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS 中的 clear]]></title>
      <url>/2016/06/13/css-e4-b8-ad-e7-9a-84-clear/</url>
      <content type="html"><![CDATA[<h3 id="为什么要清除浮动"><a href="#为什么要清除浮动" class="headerlink" title="为什么要清除浮动"></a>为什么要清除浮动</h3><p>一个块级元素的如果没有设置 <code>height</code>, 则其高度由其子元素撑开. 如果所有子元素都是浮动的(脱离标准文档流), 那么父元素就会发生”坍塌”.</p>
<h3 id="两种情况"><a href="#两种情况" class="headerlink" title="两种情况"></a>两种情况</h3><p>清除浮动包括清除<strong>子元素浮动</strong>和清除<strong>上级元素浮动</strong>, 如果要清除上级元素浮动, 只需要设置 clear:both 即可.<br>如果要清除子元素浮动, 可以用空标签法, clearfix 法或者 overflow 法.</p>
<h5 id="clear-的用法"><a href="#clear-的用法" class="headerlink" title="clear 的用法"></a>clear 的用法</h5><pre><code>.subElement{
    clear:both; 
}
`&lt;/pre&gt;

##### clearfix(最优浮动闭合方案)

父元素添加 class=clearfix
简洁版

&lt;pre&gt;`.clearfix:before, .clearfix:after{
  content:&quot;&quot;;
    display:table;
}
.clearfix:after{
  clear:both;
    overflow:hidden;
}
.clearfix{
  zoom:1;
}
`&lt;/pre&gt;

经典版

&lt;pre&gt;`.clearfix:after{
  display:block;
    content:&quot;&quot;;
    clear:both;
    height:0;
    visibility:hidden
}
`&lt;/pre&gt;

使用时在浮动元素的父元素上添加 class=&quot;clearfix&quot;

#### 简单的方法

&lt;pre&gt;`.clearfix{
  overflow:auto;
  _height:1%;
}
`&lt;/pre&gt;

#### 常用的方法

&lt;pre&gt;`.clearfix{
  clear:both;
  height:0;
  overflow:hidden;
}
</code></pre><p>在需要清除浮动的地方加上一个 div.clear 或者 br.clear(不是套上)</p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[4 Simple Transitions of Button]]></title>
      <url>/2016/05/29/4-simple-transitions-of-button/</url>
      <content type="html"><![CDATA[<h1 id="4-Simple-CSS-Transition-to-Enchance-Your-Buttons"><a href="#4-Simple-CSS-Transition-to-Enchance-Your-Buttons" class="headerlink" title="4 Simple CSS Transition to Enchance Your Buttons"></a>4 Simple CSS Transition to Enchance Your Buttons</h1><h2 id="Darken"><a href="#Darken" class="headerlink" title="Darken"></a>Darken</h2><p>Set a darker shade background color when <code>:hover</code> is activated</p>
<h2 id="Fade-Out"><a href="#Fade-Out" class="headerlink" title="Fade Out"></a>Fade Out</h2><p>Set opacity to 1 by default, and reduce the opacity when <code>:hover</code> is activated.</p>
<h2 id="Change-Color"><a href="#Change-Color" class="headerlink" title="Change Color"></a>Change Color</h2><h2 id="Inset-Border"><a href="#Inset-Border" class="headerlink" title="Inset Border"></a>Inset Border</h2><p>To create an inset of border,</p>
<pre><code>button: hover{
  box-shadow: inset 0 0 0 5px #darkderColor;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[媒体查询]]></title>
      <url>/2016/05/28/e5-aa-92-e4-bd-93-e6-9f-a5-e8-af-a2/</url>
      <content type="html"><![CDATA[<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p><strong>媒体查询</strong>包括一个<strong>媒体类型</strong>和至少一个<strong>媒体属性</strong>, 这些<strong>媒体属性</strong>会被解析成真或假.</p>
<p>当媒体查询为真时, 相关的样式表或样式规则就会按照正常的级联规则被应用.</p>
<p>即使媒体查询的结果为假, <code>&amp;lt;link&amp;gt;</code>标签上带有媒体查询的样式表仍然会被下载.</p>
<h2 id="逻辑操作符"><a href="#逻辑操作符" class="headerlink" title="逻辑操作符"></a>逻辑操作符</h2><p>操作符 not, and 和 only, 可以用来构建复杂的媒体查询</p>
<p>逗号分隔符相当于 or 操作符, 其中一个为真, 则媒体查询结果为真</p>
<p>一个基本的媒体查询, 即一个媒体属性与默认指定的 all 媒体类型, 可能是这样子:</p>
<pre><code>@media (min-width: 700px) {...}
`&lt;/pre&gt;

如果要添加横屏限制

&lt;pre&gt;`@media (min-width: 700px) and (orientation: landscape) {...}
`&lt;/pre&gt;

### not

not 关键字应用于整个媒体查询, 如

&lt;pre&gt;`@media not all and (monochrome){...} 等价于
@media not (all and (monochrome)) {...}
`&lt;/pre&gt;

在逗号媒体查询列表中, not 仅否定他所在的 item.

## 媒体属性

大多数媒体属性都带有&quot; min-&quot; 和&quot; max-&quot;前缀

### Color
</code></pre><ul>
<li>值: <code>&amp;lt;color&amp;gt;</code></li>
<li>媒体: <code>visual</code></li>
<li><p>是否接受 min/max 前缀: 是</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>向所有能显示颜色的设备应用样式表</p>
<p><pre><code>@media all and (color) {...}</code></pre></p>
<h3 id="Aspect-ratio"><a href="#Aspect-ratio" class="headerlink" title="Aspect-ratio"></a>Aspect-ratio</h3></li>
<li><p>值: <code>&amp;lt;ratio&amp;gt;</code></p>
</li>
<li>媒体: <code>visual, tactile</code></li>
<li><p>是否接受min/max 前缀: 是</p>
<p>宽高比以”宽/高”表示</p>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><p>向<strong>显示区域</strong>宽高比至少1:1的设备应用样式表</p>
<p><pre><code>@media screen and (min-aspect-ratio: 1/1){...}</code></pre></p>
<h3 id="Device-aspect-ratio"><a href="#Device-aspect-ratio" class="headerlink" title="Device-aspect-ratio"></a>Device-aspect-ratio</h3></li>
<li><p>值: <code>&amp;lt;ratio&amp;gt;</code></p>
</li>
<li>媒体: <code>visual, tactile</code></li>
<li><p>是否接受min/max 前缀: 是</p>
<h4 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h4><p>为宽屏设备应用样式表</p>
<p><pre><code>@media screen and (device-aspect-ratio:16/9), screen and (device-aspect-ratio:16/10){...}</code></pre></p>
<h3 id="Device-height"><a href="#Device-height" class="headerlink" title="Device-height"></a>Device-height</h3></li>
<li><p>值: <code>&amp;lt;length&amp;gt;</code></p>
</li>
<li>媒体: <code>visual, tactile</code></li>
<li><p>是否接受 min/max 前缀: 是</p>
<p>描述输出设备的高度(整个屏幕或页的高度, 而不是渲染窗口的高度)</p>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><p>向显示在最大宽度800px 的屏幕上的文档应用样式表</p>
<p><pre>`&lt;link rel=”stylesheet” media=”screen and (max-device-height: 799px)” /&gt;</pre></p>
</li>
</ul>
<h3 id="Device-width"><a href="#Device-width" class="headerlink" title="Device-width"></a>Device-width</h3><ul>
<li>值: <code>&amp;lt;length&amp;gt;</code></li>
<li>媒体: <code>visual, tactile</code></li>
<li>是否接受 min/max 前缀: 是</li>
</ul>
<p>描述输出设备的宽度</p>
<h3 id="Grid"><a href="#Grid" class="headerlink" title="Grid"></a>Grid</h3><ul>
<li>值: <code>&amp;lt;integer&amp;gt;</code></li>
<li>媒体: all</li>
<li>是否接受 min/max 前缀: 否</li>
<li>判断输出设备是网格设备还是位图设备. 如果是网格设备(例如电传打字机中断或只能显示一种字形的电话), 该值为1, 否则为0</li>
</ul>
<h3 id="Height"><a href="#Height" class="headerlink" title="Height"></a>Height</h3><ul>
<li>值: <code>&amp;lt;length&amp;gt;</code></li>
<li>媒体: <code>visual, tactile</code></li>
<li>是否接受 min/max 前缀: 是</li>
</ul>
<p>height 描述输出设备的渲染区域高度</p>
<h3 id="Monochrome"><a href="#Monochrome" class="headerlink" title="Monochrome"></a>Monochrome</h3><h3 id="Orientation"><a href="#Orientation" class="headerlink" title="Orientation"></a>Orientation</h3><ul>
<li>值: <code>&amp;lt;landscape | portrait&amp;gt;</code></li>
<li>媒体: <code>visual</code></li>
<li>是否接受 min/max 前缀: 否</li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[学习 CSS 布局]]></title>
      <url>/2016/05/28/e5-ad-a6-e4-b9-a0-css-e5-b8-83-e5-b1-80/</url>
      <content type="html"><![CDATA[<h2 id="Display-属性"><a href="#Display-属性" class="headerlink" title="Display 属性"></a>Display 属性</h2><p>每个元素都有一个默认的 display 值, 这个与元素的类型有关.</p>
<p>大部分元素他们的 display 默认为 <code>blcok</code> 或 <code>inline</code> .</p>
<p>一个 <code>blcok</code> 元素通常称为 <strong>块级元素</strong> , 一个 <code>inline</code> 元素通常称为 <strong>行内元素</strong> .</p>
<h3 id="Block"><a href="#Block" class="headerlink" title="Block"></a>Block</h3><p>一个 <code>Block</code> 元素会从新开始一行并盛满容器的宽度, 默认为 <code>blcok</code> 的元素有 <code>p, form, header, footer, section</code>等.</p>
<h3 id="Inline"><a href="#Inline" class="headerlink" title="Inline"></a>Inline</h3><p>一个 <code>inline</code>元素可以位于段落中, 包裹一些文字而不会打乱段落的布局.</p>
<h3 id="None"><a href="#None" class="headerlink" title="None"></a>None</h3><p>一些特殊元素的默认 display 是他, 例如 <code>script</code>. 用于不删除元素的情况下隐藏某些元素.</p>
<p>和  <code>visibility</code> 不同, <code>display: none</code>不会在文档流中占据空间, 但是 <code>visibility: hidden</code> 则会在文档流中占据空间.</p>
<h3 id="inline-blcok"><a href="#inline-blcok" class="headerlink" title="inline-blcok"></a>inline-blcok</h3><p><code>inline</code> 元素是可以位于段落内不导致换行的, 但是不可控制 <code>height</code>, <code>width</code> 属性</p>
<p><code>block</code> 元素独立成段, 但是可以控制 <code>height</code>, <code>width</code> 属性</p>
<p><code>inline-block</code> 元素可以位于段落中, 且独立控制 <code>height</code>, <code>width</code> 属性</p>
<p><strong>注意事项</strong>:</p>
<ul>
<li><code>vertical-align</code>属性会影响到<code>inline-block</code>元素, 你可能会把他的值设置为 top</li>
<li>需要设置每一个 <code>inline-block</code> 的宽度</li>
<li>在  HTML 代码中如果两个<code>inline-block</code>代码中有空格, 则实际排版中会出现空隙</li>
</ul>
<h2 id="Margin-auto"><a href="#Margin-auto" class="headerlink" title="Margin: auto"></a>Margin: auto</h2><p>设置 <code>Block</code> 元素的 <code>width</code> 属性可以组织他水平方向占据容器, 同时设置 <code>margin: 0 auto;</code> 可以令其居中显示.</p>
<h2 id="Box-sizing"><a href="#Box-sizing" class="headerlink" title="Box-sizing"></a>Box-sizing</h2><p><code>box-sizing: border-box;</code> 设置该元素的盒子尺寸为 <code>border</code> 的外尺寸</p>
<pre><code>.simple{
  width:500px;
  margin: 20px auto;
  padding: 20px;
  -webkit-box-sizing: border-box;
     -moz-box-sizing: border-box;
          box-sizing: border-box;
}
// simple 的  width 为 border+padding+content 的尺寸, 即元素的 border 整体宽度为 width
`&lt;/pre&gt;

## Position

### static

`position`默认为 `static` , 一个 `static`元素不会被&quot;positioned&quot;, 一个`position` 被设置为其他值的元素表示他会被&quot;positioned&quot;.

### relative

对`position:relativ`的元素设置 `top, bottom, left, right`属性可以使其偏离原有位置, 但是在文档流中占据原来的位置, 即偏离前的空间在文档流中作为其他元素的位置参考.

### fixed

一个`fixed` 元素会相对 window 定位, 即使页面滚动, 他在的浏览器中的位置也不会变化. `fixed` 元素不占据文档流.

### absolute

`absolute` 和 `fixed` 表现类似, 只是参考系变为最近的&quot;positioned&quot; 父级元素, 如果不存在这样的父级元素, 则以 body 元素为参考.

### float

### clear

用于控制悬浮.

&lt;pre&gt;`&amp;lt;div class=&apos;box&apos;&amp;gt;...&amp;lt;/div&amp;gt;
&amp;lt;section class=&apos;after-box&apos;&amp;gt;...&amp;lt;/section&amp;gt;

.box{
  float:left;
  width: 200px;
  height: 100px;
  margin: 1em;
}
.after-box{
  clear: left // 控制该元素左侧无浮动元素
}
`&lt;/pre&gt;

## 控制浮动

使用浮动经常会遇到一些古怪的排版

&lt;pre&gt;`&amp;lt;div class=&apos;clearfix&apos;&amp;gt;
文字描述
&amp;lt;img src=&apos;http://zh.learnlayout.com/images/ilta.png&apos;&amp;gt;
&amp;lt;/div&amp;gt;

.img{
  float:right;
}
.clearfix{
  overflow: auto; // 扩大 div 阻止 img 溢出
}
`&lt;/pre&gt;

## 媒体查询

&lt;pre&gt;`@media screen and (min-width:600px){
  nav{
    float:left;
    width:25%;
  }
  section{
    margin-left:25%;
  }
}
@media screen and (max-width:599px){
  nav li{
    display: inline;
  }
}
`&lt;/pre&gt;

## Column

&lt;pre&gt;`.three-column{
  padding:1em;
  -moz-column-count: 3;
  -moz-column-gap: 1em;
  -webkit-column-count: 3;
  -webkit-column-gap: 1em;
  column-count: 3;
  column-gap: 1em;
}
`&lt;/pre&gt;

实现 div 中三列布局

## Flexbox

&lt;pre&gt;`.container{
  display:-webkit-flex;
  display:flex;
}
nav{
  width:200px;
}
.flex-column{
  -webkit-flex:1;//剩余宽度的100%
          flex:1;
}
`&lt;/pre&gt;

### 使用  flex box 实现(vertical-container 内元素)垂直居中

&lt;pre&gt;`.vertical-container{
  height:300px;
  display:-webkit-flex;
  display:flex;
  -webkit-align-items: center;
         -align-items: center;
  -webkti-justify-content: center;
         -justify-content: center;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Tooltip]]></title>
      <url>/2016/05/27/mdl-tooltip/</url>
      <content type="html"><![CDATA[<head><br><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<h3 id="Default-Tooltip"><a href="#Default-Tooltip" class="headerlink" title="Default Tooltip"></a>Default Tooltip</h3><!-- Simple Tooltip -->
<div class="icon material-icons" id="tt1">Title1</div>

<div class="mdl-tooltip" for="tt1">Follow</div>

<pre><code>&amp;lt;!-- Simple Tooltip --&amp;gt;
&amp;lt;div class=&quot;icon material-icons&quot; id=&quot;tt1&quot;&amp;gt;Title1&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;mdl-tooltip&quot; for=&quot;tt1&quot;&amp;gt;Follow&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Large Tooltip

&lt;!-- Simple Tooltip --&gt;

&lt;div class=&quot;icon material-icons&quot; id=&quot;tt2&quot;&gt;Title2&lt;/div&gt;

&lt;div class=&quot;mdl-tooltip mdl-tooltip--large&quot; for=&quot;tt2&quot;&gt;Large&lt;/div&gt;

&lt;pre&gt;`&amp;lt;!-- Simple Tooltip --&amp;gt;
&amp;lt;div class=&quot;icon material-icons&quot; id=&quot;tt2&quot;&amp;gt;Title2&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;mdl-tooltip mdl-tooltip--large&quot; for=&quot;tt2&quot;&amp;gt;Large&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Rich Tooltip

&lt;!-- Rich Tooltip --&gt;

&lt;div class=&quot;icon material-icons&quot; id=&quot;tt3&quot;&gt;Rich&lt;/div&gt;

&lt;div class=&quot;mdl-tooltip&quot; for=&quot;tt3&quot;&gt;Upload **file.zip**&lt;/div&gt;

&lt;pre&gt;`&amp;lt;!-- Rich Tooltip --&amp;gt;
&amp;lt;div class=&quot;icon material-icons&quot; id=&quot;tt3&quot;&amp;gt;Rich&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;mdl-tooltip&quot; for=&quot;tt3&quot;&amp;gt;Upload &amp;lt;strong style=&apos;color:yellow&apos;&amp;gt;file.zip&amp;lt;/strong&amp;gt;&amp;lt;/div&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Textfield]]></title>
      <url>/2016/05/27/mdl-textfield/</url>
      <content type="html"><![CDATA[<head><br><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<h3 id="Text-Field-amp-Numeric-Textfield"><a href="#Text-Field-amp-Numeric-Textfield" class="headerlink" title="Text Field &amp; Numeric Textfield"></a>Text Field &amp; Numeric Textfield</h3><!-- Simple Textfield -->
<form action="#"><br>        <div class="mdl-textfield mdl-js-textfield"><br>            <input type="text" class="mdl-textfield__input" id="sample1"><br>            <label for="sample1" class="mdl-textfield__label">PlaceHolder..</label><br>        </div><br>    </form>

<pre><code>&amp;lt;br&amp;gt;
&amp;lt;!-- Numeric Textfield --&amp;gt;
&amp;lt;form action=&quot;#&quot;&amp;gt;
    &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield&quot;&amp;gt;
        &amp;lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample2&quot; pattern=&quot;-?[0-9]*(.[0-9]+)?&quot;&amp;gt;
        &amp;lt;label for=&quot;sample2&quot; class=&quot;mdl-textfield__label&quot;&amp;gt;Numeric Textfield&amp;lt;/label&amp;gt;
        &amp;lt;span class=&quot;mdl-textfield__error&quot;&amp;gt;Input is not a number!&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

&lt;/form&gt;

&lt;pre&gt;`&amp;lt;!-- Simple Textfield --&amp;gt;
    &amp;lt;form action=&quot;#&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield&quot;&amp;gt;
            &amp;lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample1&quot;&amp;gt;
            &amp;lt;label for=&quot;sample1&quot; class=&quot;mdl-textfield__label&quot;&amp;gt;PlaceHolder..&amp;lt;/label&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/form&amp;gt;
    &amp;lt;br&amp;gt;
    &amp;lt;!-- Numeric Textfield --&amp;gt;
    &amp;lt;form action=&quot;#&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield&quot;&amp;gt;
            &amp;lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample2&quot; pattern=&quot;-?[0-9]*(.[0-9]+)?&quot;&amp;gt;
            &amp;lt;label for=&quot;sample2&quot; class=&quot;mdl-textfield__label&quot;&amp;gt;Numeric Textfield&amp;lt;/label&amp;gt;
            &amp;lt;span class=&quot;mdl-textfield__error&quot;&amp;gt;Input is not a number!&amp;lt;/span&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/form&amp;gt;
`&lt;/pre&gt;

### Floating Label Textfield

&lt;!-- Floating Label --&gt;

&lt;form action=&quot;#&quot;&gt;
        &lt;div class=&quot;mdl-textfield mdl-js-textfield mdl-textfield--floating-label&quot;&gt;
            &lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample3&quot;&gt;
            &lt;label for=&quot;sample3&quot; class=&quot;mdl-textfield__label&quot;&gt;Floating&lt;/label&gt;
        &lt;/div&gt;
&lt;/form&gt;

&lt;pre&gt;`&amp;lt;!-- Floating Label --&amp;gt;
    &amp;lt;form action=&quot;#&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield mdl-textfield--floating-label&quot;&amp;gt;
            &amp;lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample3&quot;&amp;gt;
            &amp;lt;label for=&quot;sample3&quot; class=&quot;mdl-textfield__label&quot;&amp;gt;Floating&amp;lt;/label&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/form&amp;gt;
`&lt;/pre&gt;

### Multiple Line Textfield

&lt;!-- Multiple Line --&gt;

&lt;form action=&quot;#&quot;&gt;
        &lt;div class=&quot;mdl-textfield mdl-js-textfield&quot;&gt;
            &lt;textarea name=&quot;&quot; id=&quot;sample4&quot; cols=&quot;30&quot; rows=&quot;3&quot; class=&quot;mdl-textfield__input&quot; type=&quot;text&quot;&gt;&lt;/textarea&gt;
            &lt;label for=&quot;sample4&quot; class=&quot;mdl-textfield__label&quot;&gt;Multiple Line&lt;/label&gt;
        &lt;/div&gt;
&lt;/form&gt;

&lt;pre&gt;`    &amp;lt;!-- Multiple Line --&amp;gt;
    &amp;lt;form action=&quot;#&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield&quot;&amp;gt;
            &amp;lt;textarea name=&quot;&quot; id=&quot;sample4&quot; cols=&quot;30&quot; rows=&quot;3&quot; class=&quot;mdl-textfield__input&quot; type=&quot;text&quot;&amp;gt;&amp;lt;/textarea&amp;gt;
            &amp;lt;label for=&quot;sample4&quot; class=&quot;mdl-textfield__label&quot;&amp;gt;Multiple Line&amp;lt;/label&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/form&amp;gt;
`&lt;/pre&gt;

### Expandable Textfield

&lt;!-- Expandable Textfield --&gt;

&lt;form action=&quot;#&quot;&gt;
        &lt;div class=&quot;mdl-textfield mdl-js-textfield mdl-textfield--expandable&quot;&gt;
            &lt;label for=&quot;sample5&quot; class=&quot;mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect&quot;&gt;
                _S_
            &lt;/label&gt;
            &lt;div class=&quot;mdl-textfield__expandable-holder&quot;&gt;
                &lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample5&quot;&gt;
                &lt;label for=&quot;sample5&quot; class=&quot;mdl-textfield__label&quot;&gt;Expandable Input&lt;/label&gt;
            &lt;/div&gt;
        &lt;/div&gt;
&lt;/form&gt;

&lt;pre&gt;`    &amp;lt;!-- Expandable Textfield --&amp;gt;
    &amp;lt;form action=&quot;#&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield mdl-textfield--expandable&quot;&amp;gt;
            &amp;lt;label for=&quot;sample5&quot; class=&quot;mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect&quot;&amp;gt;
                &amp;lt;i class=&quot;material-icons&quot;&amp;gt;S&amp;lt;/i&amp;gt;
            &amp;lt;/label&amp;gt;
            &amp;lt;div class=&quot;mdl-textfield__expandable-holder&quot;&amp;gt;
                &amp;lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; id=&quot;sample5&quot;&amp;gt;
                &amp;lt;label for=&quot;sample5&quot; class=&quot;mdl-textfield__label&quot;&amp;gt;Expandable Input&amp;lt;/label&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/form&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Table]]></title>
      <url>/2016/05/27/mdl-table/</url>
      <content type="html"><![CDATA[<head><br><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<h3 id="Selectable-Table"><a href="#Selectable-Table" class="headerlink" title="Selectable Table"></a>Selectable Table</h3><table class="mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp"><br>    <thead><br>        <tr><br>            <th class="mdl-data-table__cell--non-numeric">Material</th><br>            <th>Quantity</th><br>            <th>Unit Price</th><br>        </tr><br>    </thead><br>    <tbody><br>        <tr><br>            <td class="mdl-data-table__cell--non-numeric">Acrylic(Transparent)</td><br>            <td>25</td><br>            <td>$2.90</td><br>        </tr><br>        <tr><br>            <td class="mdl-data-table__cell--non-numeric">Plywood(Birch)</td><br>            <td>50</td><br>            <td>$1.25</td><br>        </tr><br>        <tr><br>            <td class="mdl-data-table__cell--non-numeric">Laminate(Gold on Blue)</td><br>            <td>10</td><br>            <td>$2.35</td><br>        </tr><br>    </tbody><br></table>

<pre><code>&amp;lt;table class=&quot;mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp&quot;&amp;gt;
    &amp;lt;thead&amp;gt;
        &amp;lt;tr&amp;gt;
            &amp;lt;th class=&quot;mdl-data-table__cell--non-numeric&quot;&amp;gt;Material&amp;lt;/th&amp;gt;
            &amp;lt;th&amp;gt;Quantity&amp;lt;/th&amp;gt;
            &amp;lt;th&amp;gt;Unit Price&amp;lt;/th&amp;gt;
        &amp;lt;/tr&amp;gt;
    &amp;lt;/thead&amp;gt;
    &amp;lt;tbody&amp;gt;
        &amp;lt;tr&amp;gt;
            &amp;lt;td class=&quot;mdl-data-table__cell--non-numeric&quot;&amp;gt;Acrylic(Transparent)&amp;lt;/td&amp;gt;
            &amp;lt;td&amp;gt;25&amp;lt;/td&amp;gt;
            &amp;lt;td&amp;gt;$2.90&amp;lt;/td&amp;gt;
        &amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;
            &amp;lt;td class=&quot;mdl-data-table__cell--non-numeric&quot;&amp;gt;Plywood(Birch)&amp;lt;/td&amp;gt;
            &amp;lt;td&amp;gt;50&amp;lt;/td&amp;gt;
            &amp;lt;td&amp;gt;$1.25&amp;lt;/td&amp;gt;
        &amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;
            &amp;lt;td class=&quot;mdl-data-table__cell--non-numeric&quot;&amp;gt;Laminate(Gold on Blue)&amp;lt;/td&amp;gt;
            &amp;lt;td&amp;gt;10&amp;lt;/td&amp;gt;
            &amp;lt;td&amp;gt;$2.35&amp;lt;/td&amp;gt;
        &amp;lt;/tr&amp;gt;
    &amp;lt;/tbody&amp;gt;
&amp;lt;/table&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Selection]]></title>
      <url>/2016/05/27/mdl-selection/</url>
      <content type="html"><![CDATA[<head><br><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<h3 id="Checkbox"><a href="#Checkbox" class="headerlink" title="Checkbox"></a>Checkbox</h3><!-- Checkbox -->
<label for="checkbox1" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect"><br>        <input type="checkbox" class="mdl-checkbox__input" id="checkbox1"><br>        <span class="mdl-checkbox__label">Checkbox</span><br></label>

<pre><code>&amp;lt;!-- Checkbox --&amp;gt;
&amp;lt;label for=&quot;checkbox1&quot; class=&quot;mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect&quot;&amp;gt;
        &amp;lt;input type=&quot;checkbox&quot; class=&quot;mdl-checkbox__input&quot; id=&quot;checkbox1&quot;&amp;gt;
        &amp;lt;span class=&quot;mdl-checkbox__label&quot;&amp;gt;Checkbox&amp;lt;/span&amp;gt;
&amp;lt;/label&amp;gt;
`&lt;/pre&gt;

### Radio Button

&lt;!-- Radio Button --&gt;
&lt;label for=&quot;option-1&quot; class=&quot;mdl-radio mdl-js-radio mdl-js-ripple-effect&quot;&gt;
    &lt;input type=&quot;button&quot; id=&quot;option-1&quot; class=&quot;mdl-radio__button&quot; name=&quot;options&quot; value=&quot;1&quot;&gt;
    &lt;span class=&quot;mdl-radio__label&quot;&gt;Radio&lt;/span&gt;
&lt;/label&gt;

&lt;pre&gt;`&amp;lt;!-- Radio Button --&amp;gt;
&amp;lt;label for=&quot;option-1&quot; class=&quot;mdl-radio mdl-js-radio mdl-js-ripple-effect&quot;&amp;gt;
    &amp;lt;input type=&quot;button&quot; id=&quot;option-1&quot; class=&quot;mdl-radio__button&quot; name=&quot;options&quot; value=&quot;1&quot;&amp;gt;
    &amp;lt;span class=&quot;mdl-radio__label&quot;&amp;gt;Radio&amp;lt;/span&amp;gt;
&amp;lt;/label&amp;gt;
`&lt;/pre&gt;

### Icon Toggle

&lt;!-- Icon Toggle --&gt;
&lt;label for=&quot;icon-toggle-1&quot; class=&quot;mdl-icon-toggle mdl-js-icon-toggle mdl-js-ripple-effect&quot;&gt;
&lt;input type=&quot;checkbox&quot; class=&quot;mdl-icon-toggle__input&quot; id=&quot;icon-toggle-1&quot;&gt;
_Icon_
&lt;/label&gt;

&lt;pre&gt;`&amp;lt;!-- Icon Toggle --&amp;gt;
 &amp;lt;label for=&quot;icon-toggle-1&quot; class=&quot;mdl-icon-toggle mdl-js-icon-toggle mdl-js-ripple-effect&quot;&amp;gt;
    &amp;lt;input type=&quot;checkbox&quot; class=&quot;mdl-icon-toggle__input&quot; id=&quot;icon-toggle-1&quot;&amp;gt;
    &amp;lt;i class=&quot;mdl-icon-toggle__label material-icons&quot;&amp;gt;Icon&amp;lt;/i&amp;gt;
&amp;lt;/label&amp;gt;
`&lt;/pre&gt;

### Switch

&lt;!-- Switch --&gt;
&lt;label for=&quot;switch-1&quot; class=&quot;mdl-switch mdl-js-switch mdl-js-ripple-effect&quot;&gt;
    &lt;input type=&quot;checkbox&quot; class=&quot;mdl-switch__input&quot; id=&quot;switch-1&quot;&gt;
    &lt;span class=&quot;mdl-switch__label&quot;&gt;&lt;/span&gt;
&lt;/label&gt;

&lt;pre&gt;`&amp;lt;!-- Switch --&amp;gt;
&amp;lt;label for=&quot;switch-1&quot; class=&quot;mdl-switch mdl-js-switch mdl-js-ripple-effect&quot;&amp;gt;
    &amp;lt;input type=&quot;checkbox&quot; class=&quot;mdl-switch__input&quot; id=&quot;switch-1&quot;&amp;gt;
    &amp;lt;span class=&quot;mdl-switch__label&quot;&amp;gt;&amp;lt;/span&amp;gt;
&amp;lt;/label&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Snackbar]]></title>
      <url>/2016/05/27/mdl-snackbar/</url>
      <content type="html"><![CDATA[<head><br><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<button id="show-snackbar" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect" type="button">Show Snackbar</button>

<div id="snackbar" class="mdl-snackbar mdl-js-snackbar"><br>        <div class="mdl-snackbar__text"></div><br>        <button class="mdl-snackbar__action" type="button"></button><br></div>

<script>
(function(){
'user strict'
var snackbarContainer = document.querySelector('#snackbar');
var showSnackbarButton = document.querySelector('#show-snackbar');
var handler = function(event){
showSnackbarButton.style.backgroundColor = '';
};
showSnackbarButton.addEventListener('click', function(){
'user strict'
showSnackbarButton.style.backgroundColor = '#' + Math.floor(Math.random() * 0xffffff).toString(16);
var data={
message: "Button Color Changed.",
timeout: 2000,
actionHandler: handler,
actionText: "Undo"
};
snackbarContainer.MaterialSnackbar.showSnackbar(data);
});
}());
</script>

<pre><code>&amp;lt;button id=&quot;show-snackbar&quot; class=&quot;mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect&quot; type=&quot;button&quot;&amp;gt;Show Snackbar&amp;lt;/button&amp;gt;
&amp;lt;div id=&quot;snackbar&quot; class=&quot;mdl-snackbar mdl-js-snackbar&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-snackbar__text&quot;&amp;gt;&amp;lt;/div&amp;gt;
        &amp;lt;button class=&quot;mdl-snackbar__action&quot; type=&quot;button&quot;&amp;gt;&amp;lt;/button&amp;gt;
&amp;lt;/div&amp;gt;

&amp;lt;script&amp;gt;
        (function(){
            &apos;user strict&apos;
            var snackbarContainer = document.querySelector(&apos;#snackbar&apos;);
            var showSnackbarButton = document.querySelector(&apos;#show-snackbar&apos;);
            var handler = function(event){
                showSnackbarButton.style.backgroundColor = &apos;&apos;;
            };
            showSnackbarButton.addEventListener(&apos;click&apos;, function(){
                &apos;user strict&apos;
                showSnackbarButton.style.backgroundColor = &apos;#&apos; + Math.floor(Math.random() * 0xffffff).toString(16);
                var data={
                    message: &quot;Button Color Changed.&quot;,
                    timeout: 2000,
                    actionHandler: handler,
                    actionText: &quot;Undo&quot;
                };
                snackbarContainer.MaterialSnackbar.showSnackbar(data);
            });
        }());
&amp;lt;/script&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Slider]]></title>
      <url>/2016/05/27/mdl-slider/</url>
      <content type="html"><![CDATA[<head><br><!-- Default Slider --><br>    <input type="range" class="mdl-slider mdl-js-slider" min="0" max="100" value="0" tabindex="0"><br></head>

<h3 id="Default-Slider"><a href="#Default-Slider" class="headerlink" title="Default Slider"></a>Default Slider</h3><!-- Default Slider -->
<input type="range" class="mdl-slider mdl-js-slider" min="0" max="100" value="0" tabindex="0">

<pre><code>&amp;lt;!-- Default Slider --&amp;gt;
&amp;lt;input type=&quot;range&quot; class=&quot;mdl-slider mdl-js-slider&quot; min=&quot;0&quot; max=&quot;100&quot; value=&quot;0&quot; tabindex=&quot;0&quot;&amp;gt;
`&lt;/pre&gt;

### Slider with Starting Value

&lt;!-- Slider with Starting Value --&gt;
&lt;input type=&quot;range&quot; class=&quot;mdl-slider mdl-js-slider&quot; min=&quot;0&quot; max=&quot;100&quot; value=&quot;25&quot; tabindex=&quot;0&quot;&gt;

&lt;pre&gt;`&amp;lt;!-- Slider with Starting Value --&amp;gt;
&amp;lt;input type=&quot;range&quot; class=&quot;mdl-slider mdl-js-slider&quot; min=&quot;0&quot; max=&quot;100&quot; value=&quot;25&quot; tabindex=&quot;0&quot;&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Menu]]></title>
      <url>/2016/05/27/mdl-menu/</url>
      <content type="html"><![CDATA[<head><br><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<h3 id="Left-Aligned-Menu-Below-Button"><a href="#Left-Aligned-Menu-Below-Button" class="headerlink" title="Left Aligned Menu Below Button"></a>Left Aligned Menu Below Button</h3><!-- Left aligned menu below button -->
<button id="leftBelowButton" class="mdl-button mdl-js-button mdl-button--icon mdl-button--fab"><br>    <em>i</em><br></button>

<ul>
<li>Some Action</li>
<li>Another Action</li>
<li>Disabled Action</li>
<li><p>Yet Another Action</p>
<pre><code>&amp;lt;!-- Left aligned menu below button --&amp;gt;
&amp;lt;button id=&quot;leftBelowButton&quot; class=&quot;mdl-button mdl-js-button mdl-button--icon mdl-button--fab&quot;&amp;gt;
    &amp;lt;i class=&quot;material-icons&quot;&amp;gt;i&amp;lt;/i&amp;gt;
&amp;lt;/button&amp;gt;
&amp;lt;ul class=&quot;mdl-menu mdl-js-menu mdl-menu--bottom-left mdl-js-ripple-effect&quot; for=&quot;leftBelowButton&quot;&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item&quot;&amp;gt;Some Action&amp;lt;/li&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item mdl-menu__item--full-bleed-divider&quot;&amp;gt;Another Action&amp;lt;/li&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item&quot; disabled&amp;gt;Disabled Action&amp;lt;/li&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item&quot;&amp;gt;Yet Another Action&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
</code></pre><p>`</p>
<h3 id="Right-Aligned-Menu-Below-Button"><a href="#Right-Aligned-Menu-Below-Button" class="headerlink" title="Right Aligned Menu Below Button"></a>Right Aligned Menu Below Button</h3><!-- Right aligned menu below button -->
<button id="rightBelowButton" class="mdl-button mdl-js-button mdl-button--icon mdl-button--fab"><br>    <em>i</em><br></button>
</li>
<li><p>Some Action</p>
</li>
<li>Another Action</li>
<li>Disabled Action</li>
<li><p>Yet Another Action</p>
<pre>`    &lt;!-- Right aligned menu below button --&gt;
    &lt;button id="rightBelowButton" class="mdl-button mdl-js-button mdl-button--icon mdl-button--fab"&gt;
        &lt;i class="material-icons"&gt;i&lt;/i&gt;
    &lt;/button&gt;
    &lt;ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect" for="rightBelowButton"&gt;
        &lt;li class="mdl-menu__item"&gt;Some Action&lt;/li&gt;
        &lt;li class="mdl-menu__item mdl-menu__item--full-bleed-divider"&gt;Another Action&lt;/li&gt;
        &lt;li class="mdl-menu__item" disabled&gt;Disabled Action&lt;/li&gt;
        &lt;li class="mdl-menu__item"&gt;Yet Another Action&lt;/li&gt;
    &lt;/ul&gt;
`</pre>

<h3 id="Left-Aligned-Menu-Above-Button"><a href="#Left-Aligned-Menu-Above-Button" class="headerlink" title="Left Aligned Menu Above Button"></a>Left Aligned Menu Above Button</h3><!-- Left aligned menu above button -->
<button id="leftAboveButton" class="mdl-button mdl-js-button mdl-button--icon mdl-button--fab"><br>    <em>i</em><br></button>
</li>
<li><p>Some Action</p>
</li>
<li>Another Action</li>
<li>Disabled Action</li>
<li><p>Yet Another Action</p>
<pre>`    &lt;!-- Left aligned menu above button --&gt;
    &lt;button id="leftAboveButton" class="mdl-button mdl-js-button mdl-button--icon mdl-button--fab"&gt;
        &lt;i class="material-icons"&gt;i&lt;/i&gt;
    &lt;/button&gt;
    &lt;ul class="mdl-menu mdl-js-menu mdl-menu--top-left mdl-js-ripple-effect" for="leftAboveButton"&gt;
        &lt;li class="mdl-menu__item"&gt;Some Action&lt;/li&gt;
        &lt;li class="mdl-menu__item mdl-menu__item--full-bleed-divider"&gt;Another Action&lt;/li&gt;
        &lt;li class="mdl-menu__item" disabled&gt;Disabled Action&lt;/li&gt;
        &lt;li class="mdl-menu__item"&gt;Yet Another Action&lt;/li&gt;
    &lt;/ul&gt;
`</pre>

<h3 id="Right-Aligned-Menu-Above-Button"><a href="#Right-Aligned-Menu-Above-Button" class="headerlink" title="Right Aligned Menu Above Button"></a>Right Aligned Menu Above Button</h3><!-- Right aligned menu above button -->
<button id="rightAboveButton" class="mdl-button mdl-js-button mdl-button--icon mdl-button--fab"><br>    <em>i</em><br></button>
</li>
<li><p>Some Action</p>
</li>
<li>Another Action</li>
<li>Disabled Action</li>
<li><p>Yet Another Action</p>
<p><pre>`    &lt;!– Right aligned menu above button –&gt;</pre></p>
<pre><code>&amp;lt;button id=&quot;rightAboveButton&quot; class=&quot;mdl-button mdl-js-button mdl-button--icon mdl-button--fab&quot;&amp;gt;
    &amp;lt;i class=&quot;material-icons&quot;&amp;gt;i&amp;lt;/i&amp;gt;
&amp;lt;/button&amp;gt;
&amp;lt;ul class=&quot;mdl-menu mdl-js-menu mdl-menu--top-right mdl-js-ripple-effect&quot; for=&quot;rightAboveButton&quot;&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item&quot;&amp;gt;Some Action&amp;lt;/li&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item mdl-menu__item--full-bleed-divider&quot;&amp;gt;Another Action&amp;lt;/li&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item&quot; disabled&amp;gt;Disabled Action&amp;lt;/li&amp;gt;
    &amp;lt;li class=&quot;mdl-menu__item&quot;&amp;gt;Yet Another Action&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
</code></pre></li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[图解 Git]]></title>
      <url>/2016/05/26/e5-9b-be-e8-a7-a3-git/</url>
      <content type="html"><![CDATA[<h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><p><img src="https://marklodato.github.io/visual-git-guide/basic-usage.svg" alt="Git基本用法"><br>图中, History 即为本地仓库(local repository), Stage(Index) 为暂存目录, 也称为索引, Working Directory 为工作目录.</p>
<ul>
<li><code>git add *file*</code> 把Current Working Directory 下的file 放入 Stage</li>
<li><code>git commit</code> 对 Stage 生成快照并放入 local Repo</li>
<li><code>git reset -- *file*</code> 用来将 Stage 恢复到上一次 commit 的状态(快照)</li>
<li><code>git checkout -- *file*</code> 把文件从 Stage 复制到 Current Working Directory, 并且丢弃本地修改</li>
</ul>
<p>可以使用 <code>git reset -p</code>, <code>git checkout -p</code>, <code>git add -p</code>进入交互模式.</p>
<p>可以跳过 Stage, 实现 Working Directory 和 Local Repo 的直接交流.<br><img src="https://marklodato.github.io/visual-git-guide/basic-usage-2.svg" alt="跳过 Stage"></p>
<ul>
<li><code>git commit -a</code> 相当于运行 <code>git add</code>把Working Directory 下的文件放入 Stage 并 Commit</li>
<li><code>git commit *file*</code> 进行一次包含最后一次 Commit, 并加上 Working Directory 快照的提交, 并且文件添加到 Stage</li>
<li><code>git checkout HEAD</code> 从 Local Repo 中取出上一次 commit 的快照并回滚</li>
</ul>
<h2 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h2><p><img src="https://marklodato.github.io/visual-git-guide/conventions.svg" alt="图例"></p>
<h2 id="命令详解"><a href="#命令详解" class="headerlink" title="命令详解"></a>命令详解</h2><h3 id="Diff"><a href="#Diff" class="headerlink" title="Diff"></a>Diff</h3><p>查看两次提交之间的变动<br><img src="https://marklodato.github.io/visual-git-guide/diff.svg" alt="diff"></p>
<h3 id="Commit"><a href="#Commit" class="headerlink" title="Commit"></a>Commit</h3><p>执行 Commit 的时候, git 对 Stage 中的文件做一个快照, 提交给 local repo, 记为指向父节点的<strong>新节点</strong>, 然后把 HEAD 指向<strong>新节点</strong>,<br><img src="https://marklodato.github.io/visual-git-guide/commit-master.svg" alt="commit"><br>图中执行 commit 后, stage 生成快照并提交给 repo, 记为新节点 f0cec, 其指向父节点 ed489, 同时 HEAD 从父节点转移至新节点.</p>
<p>即使当前分支是从某祖父节点出发的, git 也会生成新节点并指向该祖父节点, 并将 HEAD 指向新节点<br><img src="https://marklodato.github.io/visual-git-guide/commit-maint.svg" alt="git"><br>图中 maint 在 commit 前是 master 的子父节点, 在 commit 不再是 master 的祖父节点, 此时合并或衍合是必须的.</p>
<p>如果想更改一次commit, 使用 <code>git commit --amend</code>, git 会使用当前父节点进行一次新的提交, 新的子节点依旧指向该父节点, 旧的提交会被取消, 如图<br><img src="https://marklodato.github.io/visual-git-guide/commit-amend.svg" alt="amend"></p>
<h3 id="Checkout"><a href="#Checkout" class="headerlink" title="Checkout"></a>Checkout</h3><p><code>Checkout</code>用于从 Stage 中取出文件放到 Working Directory 中, 也可用于切换分支</p>
<p>当给定某个文件名时, git 会从指定的节点中拷贝文件到 Stage 和 Working Directory. 比如 <code>git checkout HEAD~ foo.c</code> 会从 HEAD~(即当前父节点)中拷贝 foo.c 文件到 Working Directory 并加到 Stage, 如果<code>checkout</code> 没有添加指定节点, 就会从 Stage 中拷贝文件.<br><img src="https://marklodato.github.io/visual-git-guide/checkout-files.svg" alt="checkout"></p>
<p>如果不指定文件名, 而是给出一个本地分支名, 则会将 HEAD 指向该分支, 即转为 current branch<br><img src="https://marklodato.github.io/visual-git-guide/checkout-branch.svg" alt="checkout"></p>
<p>如果没有指定文件名和分支名, 而是一个标签, 远程分支, SHA-1值, 或者像是 master~3之类的东西, 则得到一个匿名分支, 称为 detached HEAD( 被分离的 HEAD 标识)<br><img src="https://marklodato.github.io/visual-git-guide/checkout-detached.svg" alt="checkout"></p>
<p>当 HEAD 处于分离状态时(不指向任何有名的 branch), commit 可以正常提交, 但不会更新任何有名的 branch( 称为新的匿名分支)<br><img src="https://marklodato.github.io/visual-git-guide/commit-detached.svg" alt="commit"></p>
<p>此时如果切换到其他分支, 就无法返回这个匿名分支<br><img src="https://marklodato.github.io/visual-git-guide/checkout-after-detached.svg" alt="commit"></p>
<p>如果想对该匿名分支创建引用, 可以用 <code>git checkout -b *name*</code> 来创建一个指向匿名分支的新分支<br><img src="https://marklodato.github.io/visual-git-guide/checkout-b-detached.svg" alt="commit"></p>
<h3 id="Reset"><a href="#Reset" class="headerlink" title="Reset"></a>Reset</h3><p><code>reset</code> 指令把当前分支指向另一个位置, 并且有选择的变动 Working Directory 和 Stage. 也用来从 Local Repo 中复制文件到 Stage, 不修改 Working Directory.</p>
<p>如果不给参数, 则当前分支指向那个节点, 并将 Stage 恢复到对应commit; 如果用 <code>--hard</code> 参数, 则 Working Directory 也恢复到该节点的commit, 如果用 <code>--soft</code> 参数, 则都不变<br><img src="https://marklodato.github.io/visual-git-guide/reset-commit.svg" alt="reset"></p>
<p>如果不提供版本号, 则默认 HEAD, 这样分支指向不变(依旧指向当前节点), 但是 Stage 会回滚到上一次 commit, 如果用了– hard, 则 Working Directory 也会回滚.<br><img src="https://marklodato.github.io/visual-git-guide/reset.svg" alt="reset"></p>
<h3 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h3><p><code>merge</code> 将不同的 branch 合并, 合并前, 其他分支的Stage 必须和当前分支的 Stage 相同(即合并的几个分支需要有相同的 Stage).</p>
<ul>
<li>如果另一个分支是当前分支的祖父节点, 则合并命令将什么也不做.</li>
<li>如果当前节点是另一个分支的祖父节点, 则带哦之 fast-forward 合并, 即简单易懂 HEAD, 并生成一个新的 commit<br><img src="https://marklodato.github.io/visual-git-guide/merge-ff.svg" alt="merge"></li>
</ul>
<p>如果是一次真正的合并, 默认把当前节点(ed489)和另一个节点(33104)及他们的共同祖父节点(b325c)进行一次三方合并. 结果是先保存Working Directory 和 Stage, 然后在当前节点(ed489)处提交新的节点.<br><img src="https://marklodato.github.io/visual-git-guide/merge.svg" alt="merge"></p>
<h3 id="Cherry-Pick"><a href="#Cherry-Pick" class="headerlink" title="Cherry Pick"></a>Cherry Pick</h3><p><code>cherry-pick</code> 命令”复制”一个提交节点并在当前分支做一次完全一样的新提交(将某节点作为新节点).<br><img src="https://marklodato.github.io/visual-git-guide/cherry-pick.svg" alt="cherry-pick"></p>
<h3 id="Rebase"><a href="#Rebase" class="headerlink" title="Rebase"></a>Rebase</h3><p>衍合是合并命令的另一种选择. 合并吧两个父分支合并进行一次提交, 提交历史不是线性的. 衍合在当前分支上重演另一个分支的历史, 提交历史是线性的, 本质上是线性化的自动的 cherry-pick<br><img src="https://marklodato.github.io/visual-git-guide/rebase.svg" alt="rebase"></p>
<p>上面所有的命令都在 topic 分支中进行, 而不是 master 分支( HEAD 指向 topic), 在 master 分支上重演, 并把分支指向新的节点(就得 topic 分支被回收).</p>
<p>要限制回滚返回, 使用 <code>--onto</code> 参数<br><img src="https://marklodato.github.io/visual-git-guide/rebase-onto.svg" alt="rebase"></p>
]]></content>
      
        <categories>
            
            <category> github </category>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> github </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Loading]]></title>
      <url>/2016/05/26/mdl-loading/</url>
      <content type="html"><![CDATA[<h3 id="Defaut-Progress-Bar"><a href="#Defaut-Progress-Bar" class="headerlink" title="Defaut Progress Bar"></a>Defaut Progress Bar</h3><pre><code>&amp;lt;!-- Simple MDL Progress Bar --&amp;gt;
    &amp;lt;div class=&quot;mdl-progress mdl-js-progress&quot; id=&quot;p1&quot;&amp;gt;&amp;lt;/div&amp;gt;
    &amp;lt;script&amp;gt;
        document.querySelector(&apos;#p1&apos;).addEventListener(&apos;mdl-componentupgraded&apos;, function(){
            this.MaterialProgress.setProgress(44);
        })
    &amp;lt;/script&amp;gt;
`&lt;/pre&gt;

### Intedeterminate Progress Bar

&lt;!-- MDL Progress Bar with Indeterminate Progress --&gt;

&lt;div id=&quot;p2&quot; class=&quot;mdl-progress mdl-js-progress mdl-progress__indeterminate&quot;&gt;&lt;/div&gt;

&lt;pre&gt;`&amp;lt;!-- MDL Progress Bar with Indeterminate Progress --&amp;gt;
&amp;lt;div id=&quot;p2&quot; class=&quot;mdl-progress mdl-js-progress mdl-progress__indeterminate&quot;&amp;gt;&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Buffering Progress Bar

&lt;pre&gt;`    &amp;lt;!-- MDL Progress Bar with Buffering --&amp;gt;
    &amp;lt;div class=&quot;mdl-progress mdl-js-progress&quot; id=&quot;p1&quot;&amp;gt;&amp;lt;/div&amp;gt;
    &amp;lt;script&amp;gt;
        document.querySelector(&apos;#p1&apos;).addEventListener(&apos;mdl-componentupgraded&apos;, function(){
            this.MaterialProgress.setProgress(33);
            this.MaterialProgress.setBuffer(66);
        })
    &amp;lt;/script&amp;gt;
`&lt;/pre&gt;

### Default Spinner

&lt;div class=&quot;mdl-spinner mdl-js-spinner is-active&quot;&gt;&lt;/div&gt;

&lt;pre&gt;`&amp;lt;div class=&quot;mdl-spinner mdl-js-spinner is-active&quot;&amp;gt;&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Single Color Spinner

&lt;div class=&quot;mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active&quot;&gt;&lt;/div&gt;

&lt;pre&gt;`&amp;lt;div class=&quot;mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active&quot;&amp;gt;&amp;lt;/div&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-List]]></title>
      <url>/2016/05/26/mdl-list/</url>
      <content type="html"><![CDATA[<head><br>    <meta charset="UTF-8"><br>    <title>Document</title><br>    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br><link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br><script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br></head>

<h3 id="Simple-List"><a href="#Simple-List" class="headerlink" title="Simple List"></a>Simple List</h3><!-- Simple List -->
<ul>
<li><span class="mdl-list__item-primary-content">Content 1</span></li>
<li><span class="mdl-list__item-primary-content">Content 2</span></li>
<li><span class="mdl-list__item-primary-content">Content 3</span></li>
<li><span class="mdl-list__item-primary-content">Content 4</span></li>
<li><p><span class="mdl-list__item-primary-content">Content 5</span></p>
<p>&lt;!– Simple List –&gt;<br>&lt;ul class=”mdl-list”&gt;</p>
<pre><code>&amp;lt;li class=&quot;mdl-list_item&quot;&amp;gt;&amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;Content 1&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;
&amp;lt;li class=&quot;mdl-list_item&quot;&amp;gt;&amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;Content 2&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;
&amp;lt;li class=&quot;mdl-list_item&quot;&amp;gt;&amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;Content 3&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;
&amp;lt;li class=&quot;mdl-list_item&quot;&amp;gt;&amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;Content 4&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;
&amp;lt;li class=&quot;mdl-list_item&quot;&amp;gt;&amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;Content 5&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;
</code></pre><p>&lt;/ul&gt;<br>`</p>
<h3 id="Icon-List"><a href="#Icon-List" class="headerlink" title="Icon List"></a>Icon List</h3><!-- Icon List -->
</li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>    _1_
    Content 1
&lt;/span&gt;
</code></pre></li>
<li><span class="mdl-list__item-primary-content"><pre><code>    _2_
    Content 2
&lt;/span&gt;
</code></pre></span></li>
<li><span class="mdl-list__item-primary-content"><pre><code>    _3_
    Content 3
&lt;/span&gt;
</code></pre></span></li>
<li><span class="mdl-list__item-primary-content"><pre><code>    _4_
    Content 4
&lt;/span&gt;
</code></pre></span></li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>    _5_
    Content 5
&lt;/span&gt;
</code></pre><pre>`&lt;!-- Icon List --&gt;
&lt;ul class="mdl-list"&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-icon"&gt;1&lt;/i&gt;
            &lt;p&gt;Content 1&lt;/p&gt;
        &lt;/span&gt;&lt;/li&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-icon"&gt;2&lt;/i&gt;
            &lt;p&gt;Content 2&lt;/p&gt;
        &lt;/span&gt;&lt;/li&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-icon"&gt;3&lt;/i&gt;
            &lt;p&gt;Content 3&lt;/p&gt;
        &lt;/span&gt;&lt;/li&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-icon"&gt;4&lt;/i&gt;
            &lt;p&gt;Content 4&lt;/p&gt;
        &lt;/span&gt;&lt;/li&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-icon"&gt;5&lt;/i&gt;
            &lt;p&gt;Content 5&lt;/p&gt;
        &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
`</pre>

<h3 id="Avatars-and-Actions"><a href="#Avatars-and-Actions" class="headerlink" title="Avatars and Actions"></a>Avatars and Actions</h3><!-- List Item with Avatar and Action -->
</li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>    _A1_
    &lt;span&gt;content 1&lt;/span&gt;
    [Star]()
&lt;/span&gt;
</code></pre></li>
<li><span class="mdl-list__item-primary-content"><pre><code>    _A2_
    &lt;span&gt;content 2&lt;/span&gt;
    [Star]()
&lt;/span&gt;
</code></pre></span></li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>    _A3_
    &lt;span&gt;content 3&lt;/span&gt;
    [Star]()
&lt;/span&gt;
</code></pre><pre>`&lt;!-- List Item with Avatar and Action --&gt;
&lt;ul class="mdl-list"&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-avatar"&gt;A1&lt;/i&gt;
            &lt;span&gt;content 1&lt;/span&gt;
            &lt;a href="" class="mdl-list_item-secondary-action"&gt;Star&lt;/a&gt;
        &lt;/span&gt;&lt;/li&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-avatar"&gt;A2&lt;/i&gt;
            &lt;span&gt;content 2&lt;/span&gt;
            &lt;a href="" class="mdl-list_item-secondary-action"&gt;Star&lt;/a&gt;
        &lt;/span&gt;&lt;/li&gt;
    &lt;li class="mdl-list__item"&gt;
        &lt;span class="mdl-list__item-primary-content"&gt;
            &lt;i class="material-icons mdl-list__item-avatar"&gt;A3&lt;/i&gt;
            &lt;span&gt;content 3&lt;/span&gt;
            &lt;a href="" class="mdl-list_item-secondary-action"&gt;Star&lt;/a&gt;
        &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
`</pre>

<h3 id="Avatars-and-Controls"><a href="#Avatars-and-Controls" class="headerlink" title="Avatars and Controls"></a>Avatars and Controls</h3><!-- List with Avatar and Controls -->
</li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>    _C_
Checkbox
&lt;/span&gt;
&lt;span class=&quot;mdl-list__item-secondary-action&quot;&gt;
    &lt;label for=&quot;list-checkbox-1&quot; class=&quot;mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect&quot;&gt;
        &lt;input type=&quot;checkbox&quot; class=&quot;mdl-checkbox__input&quot; checked id=&quot;list-checkbox-1&quot;&gt;
    &lt;/label&gt;
&lt;/span&gt;
</code></pre></li>
<li><span class="mdl-list__item-primary-content"><pre><code>    _R_
    Radio
&lt;/span&gt;
&lt;span class=&quot;mdl-list__item-secondary-action&quot;&gt;
    &lt;label for=&quot;list-option-1&quot; class=&quot;mdl-radio mdl-js-radio mdl-js-ripple-effect&quot;&gt;
        &lt;input type=&quot;radio&quot; class=&quot;mdl-radio__button&quot; id=&quot;list-option-1&quot; name=&quot;options&quot; value=&quot;1&quot; checked=&quot;&quot;&gt;
    &lt;/label&gt;
&lt;/span&gt;
</code></pre></span></li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>    _S_
    Switch
&lt;/span&gt;
&lt;span class=&quot;mdl-list__item-secondary-action&quot;&gt;
    &lt;label for=&quot;list-switch-1&quot; class=&quot;mdl-switch mdl-js-switch mdl-js-ripple-effect&quot;&gt;&lt;input type=&quot;checkbox&quot; checked class=&quot;mdl-switch__input&quot; id=&quot;list-switch-1&quot;&gt;&lt;/label&gt;
&lt;/span&gt;
</code></pre><pre>`    &lt;!-- List with Avatar and Controls --&gt;
    &lt;ul class="mdl-list"&gt;
        &lt;li class="mdl-list__item"&gt;
            &lt;span class="mdl-list__item-primary-content"&gt;
                &lt;i class="material-icons mdl-list__item-avatar"&gt;C&lt;/i&gt;
            Checkbox
            &lt;/span&gt;
            &lt;span class="mdl-list__item-secondary-action"&gt;
                &lt;label for="list-checkbox-1" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect"&gt;
                    &lt;input type="checkbox" class="mdl-checkbox__input" checked id="list-checkbox-1"&gt;
                &lt;/label&gt;
            &lt;/span&gt;
        &lt;/li&gt;
        &lt;li class="mdl-list__item"&gt;
            &lt;span class="mdl-list__item-primary-content"&gt;
                &lt;i class="material-icons mdl-list__item-avatar"&gt;R&lt;/i&gt;
                Radio
            &lt;/span&gt;
            &lt;span class="mdl-list__item-secondary-action"&gt;
                &lt;label for="list-option-1" class="mdl-radio mdl-js-radio mdl-js-ripple-effect"&gt;
                    &lt;input type="radio" class="mdl-radio__button" id="list-option-1" name="options" value="1" checked=""&gt;
                &lt;/label&gt;
            &lt;/span&gt;
        &lt;/li&gt;
        &lt;li class="mdl-list__item"&gt;
            &lt;span class="mdl-list__item-primary-content"&gt;
                &lt;i class="material-icons mdl-list__item-avatar"&gt;S&lt;/i&gt;
                Switch
            &lt;/span&gt;
            &lt;span class="mdl-list__item-secondary-action"&gt;
                &lt;label for="list-switch-1" class="mdl-switch mdl-js-switch mdl-js-ripple-effect"&gt;&lt;input type="checkbox" checked class="mdl-switch__input" id="list-switch-1"&gt;&lt;/label&gt;
            &lt;/span&gt;
        &lt;/li&gt;
    &lt;/ul&gt;
`</pre>

<h3 id="List-of-Multi-line"><a href="#List-of-Multi-line" class="headerlink" title="List of Multi-line"></a>List of Multi-line</h3><!-- Two Line List with Secondary Info and Action -->
</li>
<li><p><span class="mdl-list__item-primary-content"></span></p>
<pre><code>        _1_
        &lt;span&gt;Content&lt;/span&gt;
        &lt;span class=&quot;mdl-list__item-sub-title&quot;&gt;Subtitle&lt;/span&gt;
    &lt;/span&gt;
    &lt;span class=&quot;mdl-list__item-secondary-content&quot;&gt;
        &lt;span class=&quot;mdl-list__item-secondary-info&quot;&gt;Actor&lt;/span&gt;
        [
            _Star_
        ](#)
    &lt;/span&gt;

&lt;!-- List with Text Body --&gt;*   &lt;span class=&quot;mdl-list__item-primary-content&quot;&gt;
        _2_
        &lt;span&gt;Content&lt;/span&gt;
        &lt;span class=&quot;mdl-list__item-text-body&quot;&gt;
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laboriosam dolor asperiores totam accusantium quaerat sint nam illum ad praesentium et, reiciendis vel doloremque ex minima ipsam sit dignissimos facilis excepturi.
        &lt;/span&gt;
    &lt;/span&gt;
    &lt;span class=&quot;mdl-list__item-secondary-content&quot;&gt;
        [
            _Star_
        ](#)
    &lt;/span&gt;
</code></pre><p><pre>`&lt;!– Two Line List with Secondary Info and Action –&gt;</pre></p>
<pre><code>&amp;lt;ul class=&quot;mdl-list&quot;&amp;gt;
    &amp;lt;li class=&quot;mdl-list__item mdl-list__item--two-line&quot;&amp;gt;
        &amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;
            &amp;lt;i class=&quot;material-icons mdl-list__item-avatar&quot;&amp;gt;1&amp;lt;/i&amp;gt;
            &amp;lt;span&amp;gt;Content&amp;lt;/span&amp;gt;
            &amp;lt;span class=&quot;mdl-list__item-sub-title&quot;&amp;gt;Subtitle&amp;lt;/span&amp;gt;
        &amp;lt;/span&amp;gt;
        &amp;lt;span class=&quot;mdl-list__item-secondary-content&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-list__item-secondary-info&quot;&amp;gt;Actor&amp;lt;/span&amp;gt;
            &amp;lt;a href=&quot;#&quot; class=&quot;mdl-list__item-secondary-action&quot;&amp;gt;
                &amp;lt;i class=&quot;material-icons&quot;&amp;gt;Star&amp;lt;/i&amp;gt;
            &amp;lt;/a&amp;gt;
        &amp;lt;/span&amp;gt;
    &amp;lt;/li&amp;gt;
    &amp;lt;!-- List with Text Body --&amp;gt;
    &amp;lt;li class=&quot;mdl-list__item mdl-list__item--three-line&quot;&amp;gt;
        &amp;lt;span class=&quot;mdl-list__item-primary-content&quot;&amp;gt;
            &amp;lt;i class=&quot;material-icons mdl-list__item-avatar&quot;&amp;gt;2&amp;lt;/i&amp;gt;
            &amp;lt;span&amp;gt;Content&amp;lt;/span&amp;gt;
            &amp;lt;span class=&quot;mdl-list__item-text-body&quot;&amp;gt;
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laboriosam dolor asperiores totam accusantium quaerat sint nam illum ad praesentium et, reiciendis vel doloremque ex minima ipsam sit dignissimos facilis excepturi.
            &amp;lt;/span&amp;gt;
        &amp;lt;/span&amp;gt;
        &amp;lt;span class=&quot;mdl-list__item-secondary-content&quot;&amp;gt;
            &amp;lt;a href=&quot;#&quot; class=&quot;mdl-list__item-secondary-action&quot;&amp;gt;
                &amp;lt;i class=&quot;material-icons&quot;&amp;gt;Star&amp;lt;/i&amp;gt;
            &amp;lt;/a&amp;gt;
        &amp;lt;/span&amp;gt;
    &amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
</code></pre></li>
</ul>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Navigation]]></title>
      <url>/2016/05/26/mdl-navigation/</url>
      <content type="html"><![CDATA[<h3 id="Transparent-Navigation"><a href="#Transparent-Navigation" class="headerlink" title="Transparent Navigation"></a>Transparent Navigation</h3><p><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/Transparent%20Navigation.png" alt="Transparent Navigation"></p>
<pre><code>.demo-layout-transparent{
        background: url(&apos;https://getmdl.io/assets/demos/transparent.jpg&apos;) center/cover;
    }
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;/body&amp;gt;
    &amp;lt;div class=&quot;demo-layout-transparent mdl-layout mdl-js-layout&quot;&amp;gt;
        &amp;lt;header class=&quot;mdl-layout__header mdl-layout__header--transparent&quot;&amp;gt;
            &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
                &amp;lt;!--Title--&amp;gt;
                &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
                &amp;lt;!--Add spacer, to align navigation to the right--&amp;gt;
                &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
                &amp;lt;!--Navigation--&amp;gt;
                &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;/nav&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/header&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;nav class=&quot;mdl-navigation__link&quot; href=&quot;#&quot;&amp;gt;Link&amp;lt;/nav&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation__link&quot; href=&quot;#&quot;&amp;gt;Link&amp;lt;/nav&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation__link&quot; href=&quot;#&quot;&amp;gt;Link&amp;lt;/nav&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation__link&quot; href=&quot;#&quot;&amp;gt;Link&amp;lt;/nav&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Fixed Drawer without Header(The drawer will open automatically in large screen)

![Fixed Drawer](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/FixedDrawer1.png)

&lt;pre&gt;`    &amp;lt;div class=&quot;mdl-layout mdl-js-layout mdl-layout--fixed-drawer&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Fixed Header(The Header shows always, even in small screen)

![Fixed Header](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/FixedHeader.png)

&lt;pre&gt;`    &amp;lt;div class=&quot;mdl-layout mdl-js-layout mdl-layout--fixed-header&quot;&amp;gt;
        &amp;lt;header class=&quot;mdl-layout__header&quot;&amp;gt;
            &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
                &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
                &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
                &amp;lt;nav class=&quot;mdl-navigation mdl-navigation--large-screen-only&quot;&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;/nav&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/header&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;
                Title
            &amp;lt;/span&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Fixed Header and Drawer

![Fixed Header and Drawer](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/FixedHeader&amp;Drawer.png)

&lt;pre&gt;`&amp;lt;div class=&quot;mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header&quot;&amp;gt;
        &amp;lt;header class=&quot;mdl-layout__header&quot;&amp;gt;
            &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
                &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
                &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-text--align-right&quot;&amp;gt;
                    &amp;lt;label for=&quot;fixed-header-drawer-exp&quot; class=&quot;mdl-button mdl-js-button mdl-button--icon&quot;&amp;gt;S&amp;lt;/label&amp;gt;
                    &amp;lt;div class=&quot;mdl-textfield__expandable-holder&quot;&amp;gt;
                        &amp;lt;input type=&quot;text&quot; class=&quot;mdl-textfield__input&quot; name=&quot;sample&quot; id=&quot;fixed-header-drawer-exp&quot;&amp;gt;
                    &amp;lt;/div&amp;gt;
                &amp;lt;/div&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/header&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Scrolling Header

&lt;pre&gt;`&amp;lt;div class=&quot;mdl-layout mdl-js-layout&quot;&amp;gt;
        &amp;lt;header class=&quot;mdl-layout__header mdl-layout__header--scroll&quot;&amp;gt;
            &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
                &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
            &amp;lt;/div&amp;gt;
            &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/header&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;#&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Waterfall Header

&lt;pre&gt;`    &amp;lt;div class=&quot;demo-layout-water mdl-layout mdl-js-layout&quot;&amp;gt;
        &amp;lt;header class=&quot;mdl-layout__header mdl-layout--water&quot;&amp;gt;
            &amp;lt;!-- Top Row Always Visible --&amp;gt;
            &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
                &amp;lt;!-- Title --&amp;gt;
                &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
                &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
                &amp;lt;div class=&quot;mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right&quot;&amp;gt;
                    &amp;lt;label for=&quot;waterfall-exp&quot; class=&quot;mdl-button mdl-js-button mdl-button--icon&quot;&amp;gt;
                        &amp;lt;i class=&quot;material-icons&quot;&amp;gt;Search&amp;lt;/i&amp;gt;
                    &amp;lt;/label&amp;gt;
                    &amp;lt;div class=&quot;mdl-textfield__expandable-holder&quot;&amp;gt;
                        &amp;lt;input type=&quot;text&quot; name=&quot;sample&quot; id=&quot;waterfall-exp&quot; class=&quot;mdl-textfield__input&quot;&amp;gt;
                    &amp;lt;/div&amp;gt;
                &amp;lt;/div&amp;gt;
            &amp;lt;/div&amp;gt;
            &amp;lt;!-- Bottom Row, Invisible on Scroll --&amp;gt;
            &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
                &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
                &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                    &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                    &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;/nav&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/header&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt; 
            &amp;lt;nav class=&quot;mdl-navigation&quot;&amp;gt;
                &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
                &amp;lt;a href=&quot;&quot; class=&quot;mdl-navigation__link&quot;&amp;gt;Link&amp;lt;/a&amp;gt;
            &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Scrollable Tabs

&lt;pre&gt;`&amp;lt;div class=&quot;mdl-layout mdl-js-layout mdl-layout--fixed-header&quot;&amp;gt;
    &amp;lt;header class=&quot;mdl-layout__header&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;!-- Tab --&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__tab-bar mdl-js-ripple-effect&quot;&amp;gt;
            &amp;lt;a href=&quot;#scroll-tab-1&quot; class=&quot;mdl-layout__tab is-active&quot;&amp;gt;Tab 1&amp;lt;/a&amp;gt;
            &amp;lt;a href=&quot;#scroll-tab-2&quot; class=&quot;mdl-layout__tab&quot;&amp;gt;Tab 2&amp;lt;/a&amp;gt;
            &amp;lt;a href=&quot;#scroll-tab-3&quot; class=&quot;mdl-layout__tab&quot;&amp;gt;Tab 3&amp;lt;/a&amp;gt;
            &amp;lt;a href=&quot;#scroll-tab-4&quot; class=&quot;mdl-layout__tab&quot;&amp;gt;Tab 4&amp;lt;/a&amp;gt;
            &amp;lt;a href=&quot;#scroll-tab-5&quot; class=&quot;mdl-layout__tab&quot;&amp;gt;Tab 5&amp;lt;/a&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/header&amp;gt;
    &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
        &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;main class=&quot;mdl-layout__content&quot;&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel is-active&quot; id=&quot;scroll-tab-1&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 1&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;scroll-tab-2&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 2&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;scroll-tab-3&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 3&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;scroll-tab-4&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 4&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;scroll-tab-5&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 5&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
    &amp;lt;/main&amp;gt;
&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### Fixed Tabs

&lt;pre&gt;`&amp;lt;div class=&quot;mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-tabs&quot;&amp;gt;
    &amp;lt;header class=&quot;mdl-layout__header&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__header-row&quot;&amp;gt;
            &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;div class=&quot;mdl-layout__tab-bar mdl-js-ripple-effect&quot;&amp;gt;
            &amp;lt;a href=&quot;#fixed-tab-1&quot; class=&quot;mdl-layout__tab is-active&quot;&amp;gt;Tab 1&amp;lt;/a&amp;gt;
            &amp;lt;a href=&quot;#fixed-tab-2&quot; class=&quot;mdl-layout__tab&quot;&amp;gt;Tab 2&amp;lt;/a&amp;gt;
            &amp;lt;a href=&quot;#fixed-tab-3&quot; class=&quot;mdl-layout__tab&quot;&amp;gt;Tab 3&amp;lt;/a&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/header&amp;gt;
    &amp;lt;div class=&quot;mdl-layout__drawer&quot;&amp;gt;
        &amp;lt;span class=&quot;mdl-layout-title&quot;&amp;gt;Title&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;main class=&quot;mdl-layout__content&quot;&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;fixed-tab-1&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 1&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;fixed-tab-2&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 2&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
        &amp;lt;section class=&quot;mdl-layout__tab-panel&quot; id=&quot;fixed-tab-3&quot;&amp;gt;
            &amp;lt;div class=&quot;page-content&quot; style=&quot;height:500px&quot;&amp;gt;Tab 3&amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
    &amp;lt;/main&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Card]]></title>
      <url>/2016/05/25/mdl-card/</url>
      <content type="html"><![CDATA[<h3 id="Wide-Card"><a href="#Wide-Card" class="headerlink" title="Wide Card"></a>Wide Card</h3><p><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/Card-Wide.png" alt="Wide Card"></p>
<pre><code>    &amp;lt;style&amp;gt;
        .demo-card-wide.mdl-card{
            width:512px
        }
        .demo-card-wide&amp;gt;.mdl-card__title{
            color: #fff;
            height: 176px;
            background: url(&quot;https://getmdl.io/assets/demos/welcome_card.jpg&quot;) center/cover;
        }
    &amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;div class=&quot;demo-card-wide mdl-card mdl-shadow--2dp&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-card__title&quot;&amp;gt;
            &amp;lt;h2 class=&quot;mdl-card__title-text&quot;&amp;gt;TItle&amp;lt;/h2&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;div class=&quot;mdl-card__supporting-text&quot;&amp;gt;
            Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text;
        &amp;lt;/div&amp;gt;
        &amp;lt;div class=&quot;mdl-card__actions mdl-card--border&quot;&amp;gt;
            &amp;lt;a href=&quot;#&quot; class=&quot;mdl-button mdl-js-button mdl-js-ripple-effect&quot;&amp;gt;Get Start&amp;lt;/a&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;div class=&quot;mdl-card__menu&quot;&amp;gt;
            &amp;lt;button class=&quot;mdl-button mdl-js-button mdl-js-ripple-effect&quot;&amp;gt;Share&amp;lt;/button&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;

&amp;lt;/body&amp;gt;
`&lt;/pre&gt;

### Square Card

![Square Card](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/squareCard.png)

&lt;pre&gt;`&amp;lt;style&amp;gt;
    .demo-card-square.mdl-card{
        width:320px;
        height: 320px;
    }
    .demo-card-square&amp;gt;.mdl-card__title{
        color: #fff;
  background:
    url(&apos;https://getmdl.io/assets/demos/dog.png&apos;) bottom right 15% no-repeat #46B6AC;
    }
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;div class=&quot;demo-card-square mdl-card mdl-shadow--2dp&quot;&amp;gt;
    &amp;lt;div class=&quot;mdl-card__title mdl-card--expand&quot;&amp;gt;
        &amp;lt;h2 class=&quot;mdl-card__title-text&quot;&amp;gt;
            Square Card
        &amp;lt;/h2&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;div class=&quot;mdl-card__supporting-text&quot;&amp;gt;
        Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text; Supporting Text;
    &amp;lt;/div&amp;gt;
    &amp;lt;div class=&quot;mdl-card__actions mdl-card--border&quot;&amp;gt;
        &amp;lt;a href=&quot;&quot; class=&quot;mdl-button mdl-js-button mdl-js-ripple-effect&quot;&amp;gt;View Update&amp;lt;/a&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
`&lt;/pre&gt;

### Image Card

![Image Card](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/ImageCard.png)

&lt;pre&gt;`&amp;lt;style&amp;gt;
    .demo-card-image.mdl-card{
        width: 256px;
        height: 256px;
        background: url(&apos;https://getmdl.io/assets/demos/image_card.jpg&apos;) center/cover;
    }
    .demo-card-image&amp;gt;.mdl-card__actions{
        height: 52px;
        padding:16px;
        background: rgba(0,0,0,0.2);
    }
    .demo-card-image__filename{
        color: #fff;
        font-size: 14px;
        font-weight: 500;
    }
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;div class=&quot;demo-card-image mdl-card mdl-shadow--2dp&quot;&amp;gt;
    &amp;lt;div class=&quot;mdl-cart__title mdl-card--expand&quot;&amp;gt;&amp;lt;/div&amp;gt;
    &amp;lt;div class=&quot;mdl-card__actions&quot;&amp;gt;
        &amp;lt;span class=&quot;demo-card-image__filename&quot;&amp;gt;Image Filename&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
`&lt;/pre&gt;

### Event Card

![Event Card](http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads/EventCard.png)

&lt;pre&gt;`&amp;lt;style&amp;gt;
    .demo-card-event.mdl-card{
        width: 256px;
        height: 256px;
        background: #3E4EB8;
    }
    .demo-card-event&amp;gt;.mdl-card__actions{
        border-color: rgba(255,255,255,0.2);
    }
    .demo-card-event&amp;gt;.mdl-card__title{
        align-items: flex-start;
    }
    .demo-card-event&amp;gt;.mdl-card__title&amp;gt;h4{
        margin-top: 0;
    }
    .demo-card-event&amp;gt;.mdl-card__actions{
        display: flex;
        box-sizing: border-box;
        align-items: center;
    }
    .demo-card-event&amp;gt;.mdl-card__actions&amp;gt;.material-icons{
        padding-right: 10px;
    }
    .demo-card-event&amp;gt;.mdl-card__title, .demo-card-event&amp;gt;.mdl-card__actions, .demo-card-event&amp;gt;.mdl-card__actions&amp;gt;.mdl-button{
        color:#fff;
    }
&amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;/body&amp;gt;
    &amp;lt;div class=&quot;demo-card-event mdl-card mdl-shadow--2dp&quot;&amp;gt;
        &amp;lt;div class=&quot;mdl-card__title mdl-card--expand&quot;&amp;gt;
            &amp;lt;h4&amp;gt;
                Featured event:&amp;lt;br&amp;gt;
                May 24, 2016&amp;lt;br&amp;gt;
                7 - 11pm
            &amp;lt;/h4&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;div class=&quot;mdl-card__actions mdl-card--border&quot;&amp;gt;
            &amp;lt;a href=&quot;#&quot; class=&quot;mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect&quot;&amp;gt;
                Add to Calendar
            &amp;lt;/a&amp;gt;
            &amp;lt;div class=&quot;mdl-layout-spacer&quot;&amp;gt;&amp;lt;/div&amp;gt;
            &amp;lt;i class=&quot;material-icons&quot;&amp;gt;Evnet&amp;lt;/i&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Button]]></title>
      <url>/2016/05/25/mdl-button/</url>
      <content type="html"><![CDATA[<html><br>  <head><br>    <!-- Material Design Lite --><br>    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br>    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br>    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br>  </head><br><br><pre><br><!-- Colored FAB Button --><br>  <button class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored mdl-js-ripple-effect">Add</button>: class=”mdl-button mdl-js-button mdl-button–fab mdl-button–colored mdl-js-ripple-effect”, <strong>“mdl-button–fab” adds the 3D circle, “mdl-button–colored” colors the 3D circle, “mdl-js-ripple-effect” adds ripple effect ont the button</strong><br><br>  <!-- Raised Button --><br>  <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Button</button>: class=”mdl-button mdl-js-button mdl-button–raised mdl-js-ripple-effect”, <strong>“mdl-button–raised” adds the 3D Rectangle on the button.</strong><br><br>  <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored">Button</button>: class=”mdl-button mdl-js-button mdl-button–raised mdl-button–colored”, <strong>“mdl-button–colored” add Primary color to Button.</strong><br><br>  <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">Button</button>: class=”mdl-button mdl-js-button mdl-button–raised mdl-button–accent”, <strong>“mdl-button–accent” adds Accent color ont he Button.</strong><br><br>  <button class="mdl-button mdl-js-button mdl-button--primary">Button</button>: class=”mdl-button mdl-js-button mdl-button–primary”, <strong>“mdl-button–primary” adds primary color on the text.</strong><br><br>  <button class="mdl-button mdl-js-button mdl-button--accent">Button</button>: class=”mdl-button mdl-js-button mdl-button–accent”, <strong>“mdl-button–accent” adds accent color on the text</strong><br><br><!--   Mini FAB Button --><br>  <button class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab">i</button>: class=”mdl-button mdl-js-button mdl-button–fab mdl-button–mini-fab”, <strong>“mdl-button–mini-fab” make a mini button”</strong><br><br>    </pre><br><br>    &lt;!– Colored FAB Button –&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–fab mdl-button–colored mdl-js-ripple-effect”&gt;Add&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–fab mdl-button–colored mdl-js-ripple-effect”, &lt;strong&gt;”mdl-button–fab” adds the 3D circle, “mdl-button–colored” colors the 3D circle, “mdl-js-ripple-effect” adds ripple effect ont the button&lt;/strong&gt;&lt;br&gt;<br>      &lt;!– Raised Button –&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–raised mdl-js-ripple-effect”&gt;Button&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–raised mdl-js-ripple-effect”, &lt;strong&gt;”mdl-button–raised” adds the 3D Rectangle on the button.&lt;/strong&gt;&lt;br&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–raised mdl-button–colored”&gt;Button&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–raised mdl-button–colored”, &lt;strong&gt;”mdl-button–colored” add Primary color to Button.&lt;/strong&gt;&lt;br&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–raised mdl-button–accent”&gt;Button&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–raised mdl-button–accent”, &lt;strong&gt;”mdl-button–accent” adds Accent color ont he Button.&lt;/strong&gt;&lt;br&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–primary”&gt;Button&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–primary”, &lt;strong&gt;”mdl-button–primary” adds primary color on the text.&lt;/strong&gt;&lt;br&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–accent”&gt;Button&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–accent”, &lt;strong&gt;”mdl-button–accent” adds accent color on the text&lt;/strong&gt;&lt;br&gt;<br>    &lt;!–   Mini FAB Button –&gt;<br>      &lt;button class=”mdl-button mdl-js-button mdl-button–fab mdl-button–mini-fab”&gt;i&lt;/button&gt;: class=”mdl-button mdl-js-button mdl-button–fab mdl-button–mini-fab”, &lt;strong&gt;”mdl-button–mini-fab” make a mini button”&lt;/strong&gt;&lt;br&gt;<br><br></html>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MDL-Badge]]></title>
      <url>/2016/05/24/mdl-badge/</url>
      <content type="html"><![CDATA[<head><br>    <!-- Material Design Lite --><br>    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><br>    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css"><br>    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script><br>  </head>

<pre>
<!-- Number badge on icon -->
<div class="material-icons mdl-badge mdl-badge--overlap" data-badge="1">Badge</div>: class="material-icons mdl-badge mdl-badge--overlap"

<span class="mdl-badge" data-badge="2">Badge</span>: class="mdl-badge", **the material-icons makes the text bigger, and mdl-badge--overlap makes badge overlap the text**

[Badge](#): Badge in the inlink

[Badge](#)<span class="mdl-badge" data-badge="4"></span>: Badge outside the link

[Badge](#): Badge with too many characters(12345)

[Badge](#): class="mdl-badge mdl-badge--no-background"
</pre>

<pre><code>&amp;lt;!-- Number badge on icon --&amp;gt;
&amp;lt;div class=&quot;material-icons mdl-badge mdl-badge--overlap&quot; data-badge=&quot;1&quot;&amp;gt;Badge&amp;lt;/div&amp;gt;: class=&quot;material-icons mdl-badge mdl-badge--overlap&quot;&amp;lt;br&amp;gt;
&amp;lt;span class=&quot;mdl-badge&quot; data-badge=&quot;2&quot;&amp;gt;Badge&amp;lt;/span&amp;gt;: class=&quot;mdl-badge&quot;, &amp;lt;strong&amp;gt;the material-icons makes the text bigger, and mdl-badge--overlap makes badge overlap the text&amp;lt;/strong&amp;gt;&amp;lt;br&amp;gt;
&amp;lt;a href=&quot;#&quot; class=&quot;mdl-badge&quot; data-badge=&quot;3&quot;&amp;gt;Badge&amp;lt;/a&amp;gt;: Badge in the inlink&amp;lt;br&amp;gt;
&amp;lt;a href=&quot;#&quot;&amp;gt;Badge&amp;lt;/a&amp;gt;&amp;lt;span class=&quot;mdl-badge&quot; data-badge=&quot;4&quot;&amp;gt;&amp;lt;/span&amp;gt;: Badge outside the link&amp;lt;br&amp;gt;
&amp;lt;a href=&quot;#&quot; class=&quot;mdl-badge&quot; data-badge=&quot;12345&quot;&amp;gt;Badge&amp;lt;/a&amp;gt;: Badge with too many characters(12345)&amp;lt;br&amp;gt;
&amp;lt;a href=&quot;#&quot; class=&quot;mdl-badge mdl-badge--no-background&quot; data-badge=&quot;6&quot;&amp;gt;Badge&amp;lt;/a&amp;gt;: class=&quot;mdl-badge mdl-badge--no-background&quot;
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
            <tag> MDL </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Material Design Lite Glossary]]></title>
      <url>/2016/05/24/materialdesignliteglossary/</url>
      <content type="html"></content>
      
        <categories>
            
            <category> github </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[CFB MindMap]]></title>
      <url>/2016/05/23/cfb-mindmap/</url>
      <content type="html"><![CDATA[<iframe width="100%" height="800px" src="https://embed.coggle.it/diagram/V0MZgJAlfGdrF97n/fa2bc4066df743e227a47743f2e618ad12096f3b615cb2bca7d05cd28a5107bb" frameborder="0" allowfullscreen></iframe>]]></content>
      
        <categories>
            
            <category> workNote </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[侧边栏固定宽度, 主体自适应宽度的等高布局]]></title>
      <url>/2016/05/22/e4-be-a7-e8-be-b9-e6-a0-8f-e5-9b-ba-e5-ae-9a-e5-ae-bd-e5-ba-a6-e4-b8-bb-e4-bd-93-e8-87-aa-e9-80-82-e5-ba-94-e5-ae-bd-e5-ba-a6-e7-9a-84-e7-ad-89-e9-ab-98-e5-b8-83-e5-b1-80/</url>
      <content type="html"><![CDATA[<h1 id="两列布局实现"><a href="#两列布局实现" class="headerlink" title="两列布局实现"></a>两列布局实现</h1><h2 id="方法1-浮动布局"><a href="#方法1-浮动布局" class="headerlink" title="方法1, 浮动布局"></a>方法1, 浮动布局</h2><p>Sidebar 设置为浮动, Content Body 的 margin 设置为 Sidebar 的宽度</p>
<h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><pre><code>&amp;lt;div class=&apos;sidebar&apos;&amp;gt;
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
&amp;lt;/div&amp;gt;
&amp;lt;div class=&apos;contentBody&apos;&amp;gt;
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### CSS

&lt;pre&gt;`*{
margin:0;
padding:0
}
.sidebar{
float:left;
width: 220px;
background-color: #ccc;
}
.contentBody{
margin-left: 220px;
}
`&lt;/pre&gt;

## 方法2, 浮动和负边距

### HTML

&lt;pre&gt;`&amp;lt;div class=&apos;sidebar&apos;&amp;gt;
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
&amp;lt;/div&amp;gt;
&amp;lt;div class=&apos;contentBody&apos;&amp;gt;
    &amp;lt;div class=&apos;contentInner&apos;&amp;gt;
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### CSS

&lt;pre&gt;`.sidebar{
float:left;
width: 220px;
margin-right: -100%;
background-color: green;
}
.contentBody{
float:left;
width:100%;
}
.contentInner{
margin-left: 220px;
}
`&lt;/pre&gt;

# 等高实现

## Demo1

### HTML

&lt;pre&gt;`&amp;lt;div class=&apos;container&apos;&amp;gt;
    &amp;lt;div class=&apos;wrapper&apos;&amp;gt;
        &amp;lt;div class=&apos;sidebar&apos;&amp;gt;SideBar&amp;lt;/div&amp;gt;
        &amp;lt;div class=&apos;content&apos;&amp;gt;Main Content&amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### CSS

&lt;pre&gt;`.container{
background-color:#ccc;
}
.wrapper{
display:inline-block; //保证 wrapper 的最小高度不小于被 float 的 sidebar
border-left: 200px solid #333; //等于 sidebar 宽度
vertical-align:bottom
}
.sidebar{
float:left;
width: 200px;
margin-left: -200px; //等于 wrapper 的 border-left 宽度
}
.sidebar, .content{
min-height: 200px;
height: auto !important;
height:200px;
}
`&lt;/pre&gt;

## Demo2

### HTML

&lt;pre&gt;`&amp;lt;div class=&apos;container&apos;&amp;gt;
    &amp;lt;div class=&apos;sidebar&apos;&amp;gt;SideBar&amp;lt;/div&amp;gt;
    &amp;lt;div class=&apos;content&apos;&amp;gt;Main Content&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### CSS

&lt;pre&gt;`.sidebar{
background-color:#ccc;
float:left;
width:200px;
margin-bottom:-99999px;
padding-bottom:99999px;
}
.content{
background-color: #eee;
margin-left:200px;
margin-bottom:-99999px;
padding-bottom:99999px;
}
.sidebar, .content{
min-height: 200px;
height:auto!important;
height:200px;
}
`&lt;/pre&gt;

## Demo3

### HTML

&lt;pre&gt;`&amp;lt;div class=&apos;container&apos;&amp;gt;
    &amp;lt;div class=&apos;wrapper&apos;&amp;gt;
        &amp;lt;div class=&apos;col1&apos;&amp;gt;Left Col&amp;lt;/div&amp;gt;
        &amp;lt;div class=&apos;col2&apos;&amp;gt;Right Col&amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
`&lt;/pre&gt;

### CSS

&lt;pre&gt;`.container{
float:left;
width:100%;
background:orange;
position:relative;
overflow:hidden;
}
.wrapper{
float:left;
width:100%;
background:green;
position:relative;
left:200px;
}
.col1{
width:200px;
float:left;
position:relative;
margin-left:-200px;
}
.col2{
position:relative;
margin-right:200px;
}
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[8 Material Design Web UI Framework]]></title>
      <url>/2016/05/22/7-material-design-web-ui-framework/</url>
      <content type="html"><![CDATA[<h2 id="Origin-of-Material-Design"><a href="#Origin-of-Material-Design" class="headerlink" title="Origin of Material Design"></a><strong>Origin of Material Design</strong></h2><div style="text-align:justify"><br>Google has its own Polymer Project which embraces Material Design thourghout its Web Components. And in fact, the Polymer Project played a key role in Material Design’s development and in showcase of Material Design Concept of Web.<br></div>

<h2 id="8-Material-Design-Web-UI-Framework"><a href="#8-Material-Design-Web-UI-Framework" class="headerlink" title="8 Material Design Web UI Framework"></a><strong>8 Material Design Web UI Framework</strong></h2><h3 id="1-Materialize"><a href="#1-Materialize" class="headerlink" title="1. Materialize"></a>1. <a href="http://materializecss.com/" target="_blank" rel="external">Materialize</a></h3><p><a href="http://materializecss.com/" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/materialze-framework-material-design.png" alt=""></a></p>
<div style="text-align:justify"><br>A modern responsive front-end framework based on Material Design. It provides an option of both CSS as well as source SCSS Files, along with JavaScript, Material Design Icon and Roboto font. Included components are basic ones such as grids, forms, buttons, navbar and cards.</div>

<p>Available in <a href="https://github.com/Dogfalo/materialize" target="_blank" rel="external"><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads//2016/05/1463860438_social_media_online_github.png" alt="1463860438_social_media_online_github"></a></p>
<h3 id="2-Material-UI"><a href="#2-Material-UI" class="headerlink" title="2. Material UI"></a>2. <a href="http://material-ui.com/" target="_blank" rel="external">Material UI</a></h3><p><a href="http://material-ui.com/" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/material-ui-css-framework.png" alt=""></a></p>
<div style="text-align:justify"><br>Material UI is a CSS Framework and a Set of React Components that implement Google’s Material Design.</div>

<p>Avaiblable in <a href="https://github.com/callemall/material-ui" target="_blank" rel="external"><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads//2016/05/1463860438_social_media_online_github.png" alt="github"></a></p>
<h3 id="3-Paper-Bootstrap-for-Bootstrap"><a href="#3-Paper-Bootstrap-for-Bootstrap" class="headerlink" title="3. Paper Bootstrap for Bootstrap"></a>3. <a href="http://bootswatch.com/paper/#" target="_blank" rel="external">Paper Bootstrap for Bootstrap</a></h3><p><a href="http://bootswatch.com/paper/#" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/paper-bootstrap-material-design-theme.png" alt=""></a></p>
<div style="text-align:justify">Paper is a bootstrap theme for the Bootstrap Framework.</div>

<h3 id="4-Bootstrap-Material"><a href="#4-Bootstrap-Material" class="headerlink" title="4. Bootstrap Material"></a>4. <a href="http://fezvrasta.github.io/bootstrap-material-design/" target="_blank" rel="external">Bootstrap Material</a></h3><p><a href="http://fezvrasta.github.io/bootstrap-material-design/" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/bootstrap-material-design.png" alt=""></a></p>
<div style="text-align:justify"><br>Similar to Paper, Bootstrap Material is another theme for Bootstrap framework and provides all the components included in Bootstrap. Besides, it covers 740 original Material Design Icons from the Google Material Design Icons Repo.</div>

<h3 id="5-Leaf"><a href="#5-Leaf" class="headerlink" title="5.Leaf"></a>5.<a href="http://getleaf.com/" target="_blank" rel="external">Leaf</a></h3><p><a href="http://getleaf.com/" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/leaf-meterial-css-framework.jpg" alt=""></a></p>
<div style="text-align:justify"><br>Leaf is CSS Framework developed by Kim Korte based on the Google’s material design. While still in beta, it has extensive list of components such as buttons, cards, sliders, menu, tabs etc. It includes icons by Icomoon, instead of the original Material Design Icons.</div>

<p>Leaf is also available on <a href="http://github.com/kkortes/leaf" target="_blank" rel="external"><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads//2016/05/1463860438_social_media_online_github.png" alt="github"></a></p>
<h3 id="6-MUI-CSS-Framework"><a href="#6-MUI-CSS-Framework" class="headerlink" title="6.MUI CSS Framework"></a>6.<a href="https://www.muicss.com/" target="_blank" rel="external">MUI CSS Framework</a></h3><p><a href="https://www.muicss.com/" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/mui-material-design-css-framework.png" alt=""></a></p>
<div style="text-align:justify"><br>MUI is lightweighted HTML, CSS and JS Framework for building sites following Google’s Material Design Principles. MUI is designed from the ground up to be fast, small and developer friendly. By design it only includes the basic components you need to build a site that follows Material Design Guideline.</div>

<p>Availabel in <a href="https://www.muicss.com/" target="_blank" rel="external"><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads//2016/05/1463860438_social_media_online_github.png" alt="github"></a></p>
<h3 id="7-Polymer-Project"><a href="#7-Polymer-Project" class="headerlink" title="7. Polymer Project"></a>7. <a href="https://www.polymer-project.org/docs/elements/material.html" target="_blank" rel="external">Polymer Project</a></h3><p><a href="https://www.polymer-project.org/docs/elements/material.html" target="_blank" rel="external"><img src="https://superdevresources.com/wp-content/uploads/2014/11/google-polymer-paper-material.png" alt=""></a></p>
<div style="text-align:justify"><br>Google’s Polymer Project is a web framework and their embodiment of material design of teh web.<br>While still in ‘developer preview’, most of the components are quite mature. Polymer aims to support all major modern browser such as IE(10+), Chrome, Safari, and Firefox.</div>

<h3 id="8-Material-Design-Lite"><a href="#8-Material-Design-Lite" class="headerlink" title="8. Material Design Lite"></a>8. <a href="https://getmdl.io/index.html" target="_blank" rel="external">Material Design Lite</a></h3><p><a href="https://getmdl.io/index.html" target="_blank" rel="external"><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads//2016/05/屏幕快照-2016-05-22-下午5.50.45.png" alt=""></a></p>
<div style="text-align:justify"><br>Material Design lets you add a Material Design look and feel to your website. It doesn’t rely on any JS frameworks adn aims to optimize for cross devices use, gracefully degrade in older browsers, and offer an experience that is immediately accessible.<br></div>

<p>Availabel in <a href="https://github.com/google/material-design-lite" target="_blank" rel="external"><img src="http://7xu8mu.com1.z0.glb.clouddn.com/wp-content/uploads//2016/05/1463860438_social_media_online_github.png" alt="github"></a></p>
]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Material Design </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Git Commands]]></title>
      <url>/2016/05/21/git-commands/</url>
      <content type="html"><![CDATA[<ol>
<li><code>git init</code> to init a working space into a git repo</li>
<li><code>git add filename</code> or <code>git add .</code> to track file or all files, and add them to <strong>stage</strong></li>
<li><code>git commit -m &quot;message&quot;</code> to commit changes to local repo</li>
<li>Several files can be commited together: <code>git add file1; git add file2; git commit -m &quot;add 2 files&quot;</code></li>
<li>Use regx: <code>git add &quot;*.txt&quot;; git commit -m &quot;add all text&quot;</code></li>
<li><code>git status</code> to check which file has been modified</li>
<li><code>git diff filename</code> to check details of modification in filename</li>
<li><code>git log</code> to show logs</li>
<li><code>git log --pretty</code> to show concise info of log, <code>git log --graph --pretty=online --abbrev-commit</code> for more info</li>
<li><code>git reset --hard HEAD^</code> to recover to last commit</li>
<li><code>git reset --hard ID</code> to recover to specific version</li>
<li><code>git checkout -- filename</code> to dismiss modification in local working space, e.g. if you delete text.txt in working space and want to recover it, <code>git checkout -- text.txt</code> can pull it from local repo to working space</li>
<li><code>git reset HEAD filename</code> to recover file from local repo</li>
<li><code>rm filename</code> to delete file in working space, only phisically delete the file without log</li>
<li><code>git rm filename</code> to delete file in working space and add a deletion operation in log waiting for commit</li>
<li><code>git remote add origin **https**</code> to connect to a remote repo</li>
<li><code>git push -u origin master</code> to push local repo to remote repo. <code>-u</code> for first push, it will connect local and remote repo for pull and push in future</li>
<li><code>git clone **https**</code> to clone a remote repo to local position</li>
<li><code>git checkout -b dev</code> create a new branch named dev, and switch to it. This command equals to <code>git branch dev; git checkout dev</code></li>
<li><code>git branch</code> to check current branch</li>
<li><code>git merge dev</code> to merge modification from dev to current branch</li>
<li><code>git branch -d dev</code> to delete branch dev</li>
<li><code>git merge</code> is <strong>Fast Forward</strong> mode which will lose merge log, <code>git merge --no-ff -m &quot;merge with no-ff&quot;</code> will keep the merge log and make a new commit(so it needs a -m), with –no-ff you can see the merge in log</li>
</ol>
<h3 id="Bug-Branch"><a href="#Bug-Branch" class="headerlink" title="Bug Branch"></a>Bug Branch</h3><p><code>git stash</code> to keep current working space</p>
<pre><code>git stash
git checkout master
git checkout -b bug-101
*fix the but*
git add .
git commit -m &apos;fix but-101&apos;
git checkout master
git merge --no-ff &apos;merge bug-101 fix&apos; bug-101
git branch -d but-101
git checkout dev #return to previous working branch
git stash list #check kept working space, e.g. *stash@{0}: ...
git stash apply stash@{0} #recover the working space without delete it in the list
**or**
git stash pop stash@{0} #recover and delete it in the list
`&lt;/pre&gt;

### Omit unmerged Branch

&lt;pre&gt;`git checkout -b new-feature #new branch for feature development
git add featurefile
git commit -m &quot;add new feature&quot;
git checkout dev
*requirement changed, the feature is dismissed*
*new feature has not been merged, so need force Delete*
git branch -D new-feature
`&lt;/pre&gt;

### Coordination

&lt;pre&gt;`git remote #return remote repo name, e.g. origin
git remote -v #return details
git push origin dev #push current branch to origin dev
git checkout -b dev origin/dev #create a dev, and push it to origin/dev
git pull #git fetch and merge to current branch
</code></pre>]]></content>
      
        <categories>
            
            <category> note </category>
            
        </categories>
        
        
        <tags>
            
            <tag> github </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CFB HomePage(RWD)]]></title>
      <url>/2016/05/19/cfb/</url>
      <content type="html"><![CDATA[<p>Chinafiremag.cn is a non-responsive website and this is a prototype of RW one.</p>
]]></content>
      
        <categories>
            
            <category> github </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> HTML5 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bootstrap 4 Guide written by BS3]]></title>
      <url>/2016/05/19/bootstrap4/</url>
      <content type="html"><![CDATA[<p>Make new features of BS4 by BS3</p>
]]></content>
      
        <categories>
            
            <category> github </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS3 </tag>
            
            <tag> BOOTSTRAP </tag>
            
            <tag> HTML5 </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
