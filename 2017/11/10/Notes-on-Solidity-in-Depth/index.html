<!DOCTYPE html>
<html  lang="en">

<head>
    <meta charset="utf-8">
<title>Notes on Solidity in Depth - EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">

<link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre|DM+Serif+Text&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">




    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    



    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">







<link rel="stylesheet" href="/css/back-to-top.css">




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>




<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>



    



    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    




<link rel="stylesheet" href="/css/style.css">
<script data-ad-client="ca-pub-8896169856986797" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</head>

<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Notes on Solidity in Depth" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/projects">Projects</a>
                
                <a class="navbar-item"
                href="https://wiki.digit-map.de/">Digit Map</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>

    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-10T08:33:02.000Z">2017-11-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 minutes read (About 2404 words)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span> visits
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Notes on Solidity in Depth
            
        </h1>
        <div class="content">
            <h3 id="Layout-of-a-Solidity-Source-File"><a href="#Layout-of-a-Solidity-Source-File" class="headerlink" title="Layout of a Solidity Source File"></a>Layout of a Solidity Source File</h3><h4 id="Version-Pragma"><a href="#Version-Pragma" class="headerlink" title="Version Pragma"></a>Version Pragma</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div></pre></td></tr></table></figure>
<h4 id="Importing-other-Source-File"><a href="#Importing-other-Source-File" class="headerlink" title="Importing other Source File"></a>Importing other Source File</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"filename"</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> symbolName <span class="hljs-keyword">from</span> <span class="hljs-string">"filename"</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> &#123; symbol <span class="hljs-keyword">as</span> alias, symbol2 &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"filename"</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"filename"</span> <span class="hljs-keyword">as</span> symbolName;</div></pre></td></tr></table></figure>
<p>In the above, <code>filename</code> is always treated as a path with <code>/</code> as directory seperator.</p>
<p>All path names are treated as absolute paths unless thay start with <code>.</code> or <code>..</code>.</p>
<h5 id="Remapping"><a href="#Remapping" class="headerlink" title="Remapping"></a>Remapping</h5><p>For example, remap <code>github.com/ethereum/dapp-bin/library</code> to <code>/usr/local/dapp-bin/library</code></p>
<p><strong>solc</strong></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/ethereum/dapp-bin/library/iterable_mapping.sol` as it_mapping;</span></div></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">solc github.com/ethereum/dapp-bin/=/usr/<span class="hljs-built_in">local</span>/dapp-bin/ source.sol</div></pre></td></tr></table></figure>
<h4 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h4><p>Single Line Comments: <code>//</code></p>
<p>Multi-line Comments: <code>/* ... */</code></p>
<p>Natspec Comments: <code>///</code> or <code>/** ... */</code></p>
<p>Natspec should be used directly above function declarations or statements.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line"><span class="hljs-comment">/** @title Shape calculator */</span></div><div class="line">contract shapeCaculator &#123;</div><div class="line">  <span class="hljs-comment">/** @dev Calculates a rectangle's surface and perimeter.</span></div><div class="line">    * @param w Width of the rectangle.</div><div class="line">    * @param h Height of the rectangle.</div><div class="line">    * @param s The calculated surface.</div><div class="line">    * @param p The calculated perimeter.</div><div class="line">    */</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rectangle</span>(<span class="hljs-params">uint w, uint h</span>) <span class="hljs-title">returns</span> (<span class="hljs-params">uint s, uint p</span>) </span>&#123;</div><div class="line">    s = w * h;</div><div class="line">    p = <span class="hljs-number">2</span> * (w + h);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Structure-of-Contract"><a href="#Structure-of-Contract" class="headerlink" title="Structure of Contract"></a>Structure of Contract</h3><p>Contracts in Solidity are similar to classes in object-oriented languages. Each contract can contain declarations of <strong>State Variables</strong>, <strong>Functions</strong>, <strong>Function Modifiers</strong>, <strong>Events</strong>, <strong>Struct Types</strong> and <strong>Enum Types</strong>.</p>
<h4 id="State-Variables"><a href="#State-Variables" class="headerlink" title="State Variables"></a>State Variables</h4><p>State variables are values which are permanently stored in contract storage.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract SimpleStorage &#123;</div><div class="line">  uint storedData; <span class="hljs-comment">// state variable</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h4><p>Functions are executable units of code within a contract.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract SimpleAuction &#123;</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bid</span>(<span class="hljs-params"></span>) <span class="hljs-title">payable</span> </span>&#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Function-Modifiers"><a href="#Function-Modifiers" class="headerlink" title="Function Modifiers"></a>Function Modifiers</h4><p>Function modifiers can be used to amend the semantics of functions in a declarative way.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract Purchase &#123;</div><div class="line">  address public seller;</div><div class="line"></div><div class="line">  modifier onlySeller () &#123; <span class="hljs-comment">// Modifier</span></div><div class="line">    <span class="hljs-built_in">require</span>(msg.sender == seller);</div><div class="line">    _;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abort</span>(<span class="hljs-params"></span>) <span class="hljs-title">onlySeller</span> </span>&#123; <span class="hljs-comment">// Modifier usage</span></div><div class="line">    <span class="hljs-comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h4><p>Events are convenience interfaces with the EVM logging facilities.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract SimpleAuction &#123;</div><div class="line">  event HighestBidIncreased(address bidder, uint amount);</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bid</span>(<span class="hljs-params"></span>) <span class="hljs-title">payable</span> </span>&#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">    HighestBidIncreased(msg.sender, msg.value);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Struct-Types"><a href="#Struct-Types" class="headerlink" title="Struct Types"></a>Struct Types</h4><p>Structs are custom defined types that can group several variables.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract Ballot &#123;</div><div class="line">  struct Voter &#123;</div><div class="line">    uint weight;</div><div class="line">    bool voted;</div><div class="line">    address delegate;</div><div class="line">    uint vote;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Enum-Types"><a href="#Enum-Types" class="headerlink" title="Enum Types"></a>Enum Types</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.0</span>;</div><div class="line"></div><div class="line">contract Purchase &#123;</div><div class="line">  enum State &#123;</div><div class="line">    Created,</div><div class="line">    Locked,</div><div class="line">    Inactive</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h4><ul>
<li><p><code>bool</code>: <code>true</code> or <code>false</code></p>
<ul>
<li><p><code>!</code> logical negation</p>
</li>
<li><p><code>&amp;&amp;</code> logical and</p>
</li>
<li><p><code>||</code> logical or</p>
</li>
<li><p><code>==</code> logical equality</p>
</li>
<li><p><code>!=</code> logical inequality</p>
</li>
</ul>
</li>
<li><p><code>int/uint</code>: <code>uint8</code> to <code>uint256</code>, <code>int8</code> to <code>int256</code></p>
<ul>
<li><p><code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code></p>
</li>
<li><p><code>&amp;</code>, <code>|</code>, <code>^</code>, <code>~</code>, bit operators</p>
</li>
<li><p><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>**</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code></p>
</li>
</ul>
</li>
<li><p><code>address</code>: holds a 20 bytes value(size of an Ethereum address)</p>
<ul>
<li><code>&lt;=</code>, <code>=&gt;</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>Starting with version 0.5.0 contracts do not derive from the <code>address</code> type, but can still be explicitly converted to address.</p>
</blockquote>
<h4 id="Members-of-Address"><a href="#Members-of-Address" class="headerlink" title="Members of Address"></a>Members of Address</h4><ul>
<li><p><code>balance</code></p>
</li>
<li><p><code>transfer</code>, address.transfer(value), send value Wei to the address.</p>
</li>
<li><p><code>send</code>: Send is the low-level counterpart of <code>transfer</code>. If the execution fails, the current contract will not stop with an exception, but <code>send</code> will return <code>false</code></p>
</li>
</ul>
<blockquote>
<p>There are some dangers in using <code>send</code>: The transfer fails if the call stack depth is 1024 and it also fails if the recipient runs out of gas. So in order to make safe Ether transfers, always check the return value of <code>send</code>, use <code>transfer</code> or even better.</p>
</blockquote>
<ul>
<li><code>call</code>, <code>callcode</code>, and <code>delegatecall</code></li>
</ul>
<p>Furthermore, to interface with contracts that do not adhere to the ABI, the function <code>call</code> is provided which takes an arbitrary number of arguments of any type. The arguments are padding to 32 bytes and concatenated. One exception is the case where the first argument is encoded to exactly four bytes. In this case, it is not padding to allow the use of function signatures here.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">address nameReg = <span class="hljs-string">'0x72ba7d8e73fe8eb666ea66babc8116a41bfb10e2'</span>;</div><div class="line">nameReg.call(<span class="hljs-string">'register'</span>, <span class="hljs-string">'MyName'</span>);</div><div class="line">nameReg.call(bytes4(keccak256(<span class="hljs-string">"fun(uint256))), );</span></div></pre></td></tr></table></figure>
<p><code>call</code> returns a boolean indicating whether the invoked function terminated (true) or caused an EVM exception (false). It is not possible to access the actual data returned.</p>
<p>It is possible to adjust the supplied gas with the <code>.gas()</code> modifier:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nameReg.call.gas(<span class="hljs-number">1000000000</span>)(<span class="hljs-string">'register'</span>, <span class="hljs-string">'myName'</span>);</div></pre></td></tr></table></figure>
<p>and supplied Ether value can be controlled too:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nameReg.call.value(<span class="hljs-number">1</span> ether)(<span class="hljs-string">'regiter'</span>, <span class="hljs-string">'myName'</span>);</div></pre></td></tr></table></figure>
<p>Chained</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nameReg.call.value(<span class="hljs-number">1</span> ether).gas(<span class="hljs-number">100000000</span>)(<span class="hljs-string">'register'</span>, <span class="hljs-string">'myName'</span>);</div></pre></td></tr></table></figure>
<p>In a similar way, the function <code>delegatecall</code> can be used: the difference is that only the code of the given address is used, all other aspects(storage, balance, …) are taken from the current contract. The purpose of <code>delegatecall</code> is to use library code which is stored in another contract. The user has to ensure that the layout of storage in both contracts is suitable for delegatecall to be used. Prior to homestead, only a limited variant called <code>callcode</code> was available that did not provide access to the original <code>msg.sender</code> and <code>msg.value</code>.</p>
<p>All three functions <code>call</code>, <code>delegatecall</code>, and <code>callcode</code> are very low-level functions and should only be used as a <em>last resort</em> as they break the type-safety of Solidity.</p>
<p>The <code>.gas()</code> option is available on all three methods, while the <code>.value()</code> option is not supported for <code>delegatecall</code>.</p>
<blockquote>
<p>All Contracts inherit the members of address, so it is possible to query the balance of the current contract using <code>this.balance</code>.</p>
<p>The use of <code>callcode</code> is discouraged and will be removed in the future.</p>
</blockquote>
<h4 id="Fixed-size-byte-array"><a href="#Fixed-size-byte-array" class="headerlink" title="Fixed-size byte array"></a>Fixed-size byte array</h4><ul>
<li><code>.length</code> yields the fixed length of the byte array(read-only)</li>
</ul>
<blockquote>
<p>It is possible to use an array of bytes as <code>byte[]</code>, but it is wasting a lot of space, 21 bytes every element, to be exact, when passing in calls. It is better to use <code>bytes</code>.</p>
</blockquote>
<h4 id="Dynamically-sized-byte-array"><a href="#Dynamically-sized-byte-array" class="headerlink" title="Dynamically-sized byte array"></a>Dynamically-sized byte array</h4><p><code>bytes</code>: dynamically-sized array, see Array, not a value-type.</p>
<p><code>string</code>: dynamically-sized UTF-8-encoded string, see Array, not a value-type.</p>
<h4 id="Address-Liberals"><a href="#Address-Liberals" class="headerlink" title="Address Liberals"></a>Address Liberals</h4><p>Hexadecimal literals that pass the address checksum test, for example <code>0xdCad3a6d3569DF655070DEd06cb7A1b2Ccd1D3AF</code> are of <code>address</code> type. Hexadecimal literals that are between 39 and 41 digits long and do not pass the checksum test produce a warning and are treated as regular rational number literals</p>
<h4 id="Rational-and-Integer-Literals"><a href="#Rational-and-Integer-Literals" class="headerlink" title="Rational and Integer Literals"></a>Rational and Integer Literals</h4><p>Integer literal are formed form a sequence of numbers in the range 0-9. They are interpreted as decimals, for example, <code>69</code> means sixty nine. Octal literals do not exist in Solidity and leading zeros are invalid.</p>
<p>Decimal fraction literals are formed by a <code>.</code> with at least one number on one side(<code>1.</code>, <code>.2</code>, <code>1.3</code>)</p>
<p>Scientific notation is also supported, where the base can have fractions, white the exponent cannot(2e10, -2e10, 2e-10, 2.5e10)</p>
<p>Number literal expressions retains arbitrary precision until they are converted to a non-literal type.</p>
<p>For example <code>(2**800 + 1) - 2**800</code> result in the constant <code>1</code>, <code>.5 * 8</code> results in the integer <code>4</code></p>
<blockquote>
<p>Number literal expressions are converted into a non-literal type as soon as they are used with non-literal expressions. Even though we know that the value of the expression assigned to <code>b</code> in the following example evaluates to an integer, but the partial expression <code>2.5 + a</code> does not type check so the code does not compile.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uint128 a = <span class="hljs-number">1</span>;</div><div class="line">uint128 b = <span class="hljs-number">2.5</span> + a + <span class="hljs-number">0.5</span>;</div></pre></td></tr></table></figure>
<h4 id="String-Literals"><a href="#String-Literals" class="headerlink" title="String Literals"></a>String Literals</h4><p>String literals are written with either double or sinlge-quotes. They do not imply trailing zeros as in C, <code>&quot;foo&quot;</code> represents three bytes not four.</p>
<p>String Literal supports escape characters, such as <code>\n</code>, <code>\xNN</code> and <code>\uNNNN</code>.</p>
<h4 id="Hexadecimal-Literals"><a href="#Hexadecimal-Literals" class="headerlink" title="Hexadecimal Literals"></a>Hexadecimal Literals</h4><p><code>hex&quot;001122FF&quot;</code></p>
<h4 id="Enums"><a href="#Enums" class="headerlink" title="Enums"></a>Enums</h4><p>Enums are one way to create a user-defined type in Solidity. They are explicitly convertable to and from all integer types but implicit conversion is not allowed. The explicit conversions check the value ranges at runtime, and a failure causes an exception.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract test &#123;</div><div class="line">  enum ActionChoices &#123;</div><div class="line">    GoLeft,</div><div class="line">    GoRight,</div><div class="line">    GoStraight,</div><div class="line">    GoStill</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  ActionChoices choice;</div><div class="line">  ActionChoices constant defaultChoice = ActionChoices.GoStraight;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setGoStraight</span>(<span class="hljs-params"></span>) </span>&#123;</div><div class="line">    choice = ActionChoices.GoStraight;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getChoice</span>(<span class="hljs-params"></span>) <span class="hljs-title">returns</span> (<span class="hljs-params">ActionChoices</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">return</span> choice;</div><div class="line">  &#125;</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDefaultChoice</span>(<span class="hljs-params"></span>) <span class="hljs-title">returns</span> (<span class="hljs-params">uint</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">return</span> uint(defaultChoice);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Function-Types"><a href="#Function-Types" class="headerlink" title="Function Types"></a>Function Types</h4><p>Function types are notated as follows:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">&lt;parameter types&gt;</span>) </span>&#123;internal|external&#125; [pure|constant|view|payable] [returns (<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">return</span> <span class="hljs-attr">types</span>&gt;</span>)]</span></div></pre></td></tr></table></figure>
<p>In contrast to the parameter types, the return types cannot be empty - if the function type should not return anything, the whole <code>returns (&lt;return type&gt;)</code> part has to be omitted.</p>
<p>Public (or external) functions have a special member called <code>selector</code>, which returns the <code>ABI function selector</code>:</p>
<h4 id="Reference-Types"><a href="#Reference-Types" class="headerlink" title="Reference Types"></a>Reference Types</h4><p>Complex types, i.e. types which do not always fit into 256 bits have to be handled more carefully than than the value-types we have already seen. Since copying them can be quite expensive, we have to think about whether we want them to be store in <strong>memory</strong>(which is not persisting) or <strong>storage</strong>(where the state variables are held).</p>
<h4 id="Data-location"><a href="#Data-location" class="headerlink" title="Data location"></a>Data location</h4><p>Every complex type, i.e. <em>arrays</em> and <em>structs</em> has an additional annotation, the “data location” about where it is stored in <strong>memory</strong> or in <strong>storage</strong>. Depending on the context, there is always a default, but it can be overrideen by appeding either <code>storage</code> or <code>memory</code> to the type. The default for function parameters(including return parameters) is <strong>memory</strong> the default for local variable is <strong>storage</strong> and the location is forced to <strong>storage</strong> for state variables</p>
<p>There is also a third data location, <strong>calldata</strong>, which is a non-modificable, non-persistent area where function arguments are stored. Function parameter(not return parameters) of external functions are forced to <strong>calldata</strong> and behave mostly like <strong>memory</strong>.</p>
<p>Data locations are imortant because they change how assignment behave: assignments between storage and memory and also to a state variable always create an independent copy. Assignments to local storage variables only assign a reference though, and this reference always points to the state variable even if the latter is changed in the meantime. On the other hand, assignments from a memory stoted reference type to another memory-stored reference type do not create a copy.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract C &#123;</div><div class="line">  uint[] x; <span class="hljs-comment">// the data location of x is storage</span></div><div class="line"></div><div class="line">  <span class="hljs-comment">// the data location of memoryArray is memory</span></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">uint[] memoryArray</span>) </span>&#123;</div><div class="line">    x = memoryArray; <span class="hljs-comment">// works, copy the whole array to storage</span></div><div class="line">    <span class="hljs-keyword">var</span> y = x; <span class="hljs-comment">// works, assigns a pointer, data location of y is storage</span></div><div class="line">    y[<span class="hljs-number">7</span>]; <span class="hljs-comment">// fine, returns the 8th element</span></div><div class="line">    y.length = <span class="hljs-number">2</span>; <span class="hljs-comment">// fine, modifies x through y</span></div><div class="line">    <span class="hljs-keyword">delete</span> x; <span class="hljs-comment">// fine, clears the array, also modifies y</span></div><div class="line">    <span class="hljs-comment">// the following does not work; it would need to create a new temporary / unamed array in storage, but storage is 'statically' allocated</span></div><div class="line">    <span class="hljs-comment">// y = memoryArray;</span></div><div class="line">    <span class="hljs-comment">// This does not work either, since it would 'reset' the pointer, but there is not sensible location it could point to.</span></div><div class="line">    <span class="hljs-comment">// delete y;</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h5><ul>
<li><p>Forced data location:</p>
<ul>
<li><p>parameters(not return) of external functions: calldata</p>
</li>
<li><p>state variables: storage</p>
</li>
</ul>
</li>
<li><p>Default data location:</p>
<ul>
<li><p>parameters(also return) of functions: memory</p>
</li>
<li><p>all other local variables: storage</p>
</li>
</ul>
</li>
</ul>
<h4 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h4><p>An array of fixed size <code>k</code> and element type <code>T</code> is written as <code>T[k]</code></p>
<p>An array of dynamic size as <code>T[]</code></p>
<p>An array of 5 dynamic arrays of <code>uint</code> is <code>uint[][5]</code>. (note that the notation is reversed when compared to some other language). To access the second uint in the third dynamic array, you use <code>x[2][1]</code></p>
<p>Variables of type <code>bytes</code> and <code>string</code> are special arrays. A <code>bytes</code> is similar to <code>byte[]</code>, but it is packed tightly in calldata. <code>string</code> is equal to <code>bytes</code> but does not allow length or index access(for now).</p>
<p>So <code>bytes</code> should always be preferred over <code>byte[]</code> because it is cheaper.</p>
<h4 id="Structs"><a href="#Structs" class="headerlink" title="Structs"></a>Structs</h4><p>Solidity provides a way to define new types in the form of structs, which is shown in the following example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract CrowdFunding &#123;</div><div class="line">  struct Funder &#123;</div><div class="line">    address addr;</div><div class="line">    uint amount;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  struct Campaign &#123;</div><div class="line">    address beneficiary;</div><div class="line">    uint fundingGoal;</div><div class="line">    uint numFunders;</div><div class="line">    uint amount;</div><div class="line">    mapping(<span class="hljs-function"><span class="hljs-params">uint</span> =&gt;</span> Funder) funders;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It is not possible for a struct to contain a member of its own type, although the struct itself can be the value type of a mapping member. This restriction is necessary, as the size of the struct has to be finite.</p>
<h4 id="Mappings"><a href="#Mappings" class="headerlink" title="Mappings"></a>Mappings</h4><p>Mapping types are declared as <code>mapping(_keyType =&gt; _valueType)</code>. Here <code>_keyType</code> can be almost any type except for a mapping, a dynamically sized array, a contract, an enum, and a struct. <code>_valueType</code> can actually be any type, including mappings.</p>
<p>Mappings can be seen as hash tables which are virtually initialized such that every possible key exists and is mapped to a value whose byte-representation is all zeros: a type’s default value.</p>
<p>Mappings are only allowed for state variables( or as storage reference types in internal function).</p>
<p>It is possible to mark mapping <code>public</code> and have Solidity create a getter. The <code>_keyType</code> will become a required parameter for the getter and it will return <code>_valueType</code>.</p>
<p>Mappings are not iterable, but it is possible to implement a data structure on top of them.</p>
<h4 id="Operators-Involving-LValues"><a href="#Operators-Involving-LValues" class="headerlink" title="Operators Involving LValues"></a>Operators Involving LValues</h4><p>LValue, i.e. a variable or something that can be assigned to.</p>
<h5 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h5><p><code>delete a</code> assigns the initial value for the type to a. I.e., for integers, it is equivalent to <code>a = 0</code>.</p>
<p><code>delete</code> has no effect on whole mappints. So if you delete a struct, it will reset all members that are not mappings and also recurse into the memebers unless they are mappings. However, individual keys and what they map to can be deleted.</p>
<p>It’s really important to note that <code>delete a</code> really behaves like an assignment to <code>a</code>, it stores a new object in <code>a</code>.</p>
<h4 id="Conversions-between-Elementary-Types"><a href="#Conversions-between-Elementary-Types" class="headerlink" title="Conversions between Elementary Types."></a>Conversions between Elementary Types.</h4><h5 id="Implicit-Conversions"><a href="#Implicit-Conversions" class="headerlink" title="Implicit Conversions"></a>Implicit Conversions</h5><p>In general, an implicit conversion between value-types is possible if it makes sense semantically and no information is lost: <code>uint8</code> is convertible to <code>uint16</code>, but <code>uint16</code> is not convertible to <code>uint8</code>. And <code>int8</code> is not convertible to <code>uint256</code>(because <code>uint256</code> cannot hold hold e.g. <code>-1</code>).</p>
<h5 id="Explicit-Conversions"><a href="#Explicit-Conversions" class="headerlink" title="Explicit Conversions"></a>Explicit Conversions</h5><p>If the compiler does not allow implicit conversion but you know what you are doing, an explicit type conversion is sometimes possible.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">int8 y = <span class="hljs-number">-3</span>;</div><div class="line">uint x = uint(y);</div></pre></td></tr></table></figure>
<h4 id="Type-Deduction"><a href="#Type-Deduction" class="headerlink" title="Type Deduction"></a>Type Deduction</h4><p>For convenience, it is not always necessary to explicitly specify the type of a variable, the compiler automatically infers it from the type of the first expression that is assigned to the variable:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uint24 x = <span class="hljs-number">0x123</span>;</div><div class="line"><span class="hljs-keyword">var</span> y = x;</div></pre></td></tr></table></figure>
<h3 id="Units-and-Globally-Available-Variables"><a href="#Units-and-Globally-Available-Variables" class="headerlink" title="Units and Globally Available Variables"></a>Units and Globally Available Variables</h3><h4 id="Ether-Units"><a href="#Ether-Units" class="headerlink" title="Ether Units"></a>Ether Units</h4><p>A literal number can take a suffix of <code>wei</code>, <code>finney</code>, <code>szabo</code>, or <code>ether</code> to convert between the subdenominations of Ether, where Ether currency numbers without a postfix are assumed to be Wei.</p>
<p><code>2 ether === 2000 finney</code> evaluates to <code>true</code></p>
<h4 id="Time-Units"><a href="#Time-Units" class="headerlink" title="Time Units"></a>Time Units</h4><p>Suffixes like <code>seconds</code>, <code>minutes</code>, <code>hours</code>, <code>days</code>, <code>weeks</code> and <code>years</code> after literal numbers can be used to convert between units of time where seconds are the base unit.</p>
<p>Take care if you perform calendar calculations using these units, because not every year equals 365 days and not even every day has 24 hours because of leap seconds. Due to the fact that leap seconds cannot be predicted, an exact calendar library has to be updated by an external oracle.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">unit start, unit dayAfter</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (now &gt;= start + dayAfter + <span class="hljs-number">1</span> days) &#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Other Global Variables and Functions:</p>
<p><a href="http://ezcook.de/2017/11/10/Solidity-CheatSheet/" target="_blank" rel="noopener">Post</a></p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Solidity/">Solidity</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Like this article? Support the author with</h3>
        <div class="buttons is-centered">
            
                <!-- Visit https://www.paypal.com/donate/buttons/ to get your donate button -->

<a class="button is-warning donate" onclick="document.getElementById(&#39;paypal-donate-form&#39;).submit()">
    <span class="icon is-small">
        <i class="fab fa-paypal"></i>
    </span>
    <span>Paypal</span>
</a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" id="paypal-donate-form">
    <input type="hidden" name="cmd" value="_donations" />
    <input type="hidden" name="business" value="chen.yu.keith@foxmail.com" />
    <input type="hidden" name="currency_code" value="USD" />
</form>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2017/11/14/Solidity-Style-Guide/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Solidity Style Guide</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2017/11/10/Solidity-CheatSheet/">
                <span class="level-item">Solidity CheatSheet</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
	var gitment = new Gitment({
		id: '2017/11/10/Notes-on-Solidity-in-Depth/',
		owner: 'Keith-CY',
		repo: 'Keith-CY.github.io',
		oauth: {
			client_id: '56319e1ce36ed4313555',
			client_secret: 'ca7f10a8357d52290f5509fb54e5173a8bea0a5d',
		},
	})
	gitment.render('comment-container')
</script>

    </div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>

</html>
