<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>History API | EzCook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The DOM window object provides access to the browser’s history through the history object. Moving Forward and Backward12window.history.back()window.history.forward() Moving to a specific point in hist">
<meta property="og:type" content="article">
<meta property="og:title" content="History API">
<meta property="og:url" content="http://yoursite.com/2017/08/09/History-API/index.html">
<meta property="og:site_name" content="EzCook">
<meta property="og:description" content="The DOM window object provides access to the browser’s history through the history object. Moving Forward and Backward12window.history.back()window.history.forward() Moving to a specific point in hist">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2017-08-10T04:01:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="History API">
<meta name="twitter:description" content="The DOM window object provides access to the browser’s history through the history object. Moving Forward and Backward12window.history.back()window.history.forward() Moving to a specific point in hist">
  
    <link rel="alternate" href="/atom.xml" title="EzCook" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>

  
    
      <body class="dark">
    
  
      <div id="container" class="container">
        <article id="post-History-API" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      History API
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p>The DOM window object provides access to the browser’s history through the <code>history</code> object.</p>
<h3 id="Moving-Forward-and-Backward"><a href="#Moving-Forward-and-Backward" class="headerlink" title="Moving Forward and Backward"></a>Moving Forward and Backward</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.history.back()</div><div class="line"><span class="built_in">window</span>.history.forward()</div></pre></td></tr></table></figure>
<h3 id="Moving-to-a-specific-point-in-history"><a href="#Moving-to-a-specific-point-in-history" class="headerlink" title="Moving to a specific point in history"></a>Moving to a specific point in history</h3><p>You can use the <code>go()</code> method to load a specific page from session history, identified by its relative position to the current page.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.history.go(<span class="number">-1</span>)</div><div class="line"><span class="built_in">window</span>.history.go(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>You can determine the number of pages in the history stack by looking at the value of the length property:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> numberOfEntries = <span class="built_in">window</span>.history.length</div></pre></td></tr></table></figure>
<h3 id="Adding-and-Modifying-History-Entries"><a href="#Adding-and-Modifying-History-Entries" class="headerlink" title="Adding and Modifying History Entries"></a>Adding and Modifying History Entries</h3><p><code>history.pushState()</code> and <code>history.replaceState()</code> methods work in conjunction with the <code>window.onpopstate</code> event.</p>
<p>Using <code>history.pushState()</code> changes the referrer that gets used in the HTTP header for <code>XMLHttpRequest</code> objects created after you change the state. The referrer will be the URL of the document whose window is this at the time of creation of the <code>XMLHttpRequest</code> object.</p>
<h4 id="Example-of-pushState-Method"><a href="#Example-of-pushState-Method" class="headerlink" title="Example of pushState() Method"></a>Example of pushState() Method</h4><p>Suppose <a href="http://mozilla.org/foo.html" target="_blank" rel="external">http://mozilla.org/foo.html</a> executes the following JS.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// history.pushState(StateObj, title, URL)</span></div><div class="line"><span class="keyword">var</span> stateObj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;</div><div class="line">history.pushState(&#123; stateObj, <span class="string">'page 2'</span>, <span class="string">'bar.html'</span> &#125;)</div></pre></td></tr></table></figure>
<p>This will cause the URL bar to display <a href="http://mozilla.org/bar.html" target="_blank" rel="external">http://mozilla.org/bar.html</a>, but won’t cause the browser to load <code>bar.html</code> or even check that <code>bar.html</code> exists.</p>
<p>Suppose now that the user now navigates to <a href="http://google.com" target="_blank" rel="external">http://google.com</a>, then click back. At this point, the URL bar will display <a href="http://mozilla.org/bar.html" target="_blank" rel="external">http://mozilla.org/bar.html</a>, and the page will get a <code>popstate</code> event whose <code>state object</code> contains a copy of <code>stateObj</code>.</p>
<p>If we click back again, the URL change to <a href="http://mozilla.org/foo.html" target="_blank" rel="external">http://mozilla.org/foo.html</a>, and the document will get another <code>popstate</code> event, this time with a null state object.(which is different from replaceState).</p>
<h4 id="The-pushState-method"><a href="#The-pushState-method" class="headerlink" title="The pushState() method"></a>The pushState() method</h4><p><code>pushState()</code> takes three arguments: a state object, a title(which is currently ignored), and (optionally) a URL.</p>
<ul>
<li><code>state object</code> - The state object is a javascript object which is associated with the new history entry created by <code>pushState</code>. Whenever the user navigates to the new state, a <code>popstate</code> event is fired, and the state property of the event contains a copy of the history entry’s state object.</li>
</ul>
<p>The state object can be anything that can be serialized. Because Firefox saves the state objects to the user’s disk so they can be restored after the user restarts the browser, we impose a size limit of 640k characters on the serialized representation of a state object. If you pass a state object whose serialized representation is larger than this to <code>pushState()</code>, the method will throw an exception. If you need more space than this, you’re encouraged to use <code>sessionStorage</code> and/or <code>localStorage</code>.</p>
<ul>
<li><p><code>title</code> - Firefox currently ingores this parameter, although it may use it in the future. Passing the empty string here should be safe against future changes to the method.</p>
</li>
<li><p><code>URL</code> - The new history entry’s URL is given by this parameter. Note that the browser won’t attempt to load this URL after a call to <code>pushState()</code>, but it might attempt to load the URL later, for instance after the user restarts the browser. The new URL does not need to be absolute; if it’s relative, it’s resolved to the current URL. The new URL must be of the same origin as the current URL; otherwise <code>pushState</code> will throw an exception. The parameter is optional, if it isn’t specified, it’s set to the document’s current URL.</p>
</li>
</ul>
<p>In a sense, calling <code>pushState()</code> is similar to setting <code>window.location = &#39;#foo&#39;</code>, in that both will create and activate another history entry associated with the current document, but <code>pushState</code> has a few advantages:</p>
<ul>
<li><p>The new URL can be any URL in the same origin as the current URL. In contrast, setting <code>window.location</code> keeps you at the same document only if you modify only the hash</p>
</li>
<li><p>You don’t have to change the URL if you don’t want to. In contrast, setting <code>window.location = &#39;#foo&#39;</code> only creates a new history entry if the current hash isn’t <code>#hash</code></p>
</li>
<li><p>You can associate arbitrary data with your new history entry. With the hash-based approach, you need to encode all of the relevant data int o a short string.</p>
</li>
</ul>
<h4 id="The-replaceState-method"><a href="#The-replaceState-method" class="headerlink" title="The replaceState() method"></a>The replaceState() method</h4><p><code>history.replaceState()</code> operates exactly like <code>history.pushState()</code> except the <code>replaceState()</code> modifies the current history entry instead of creating a new one. Note that this doesn’t prevent the creation of a new entry in the global browser history.</p>
<p><code>replaceState()</code> is particularly useful when you want to upate the state object or URL of the current history entry in reponse to some user action.</p>
<h4 id="Example-of-replaceState-method"><a href="#Example-of-replaceState-method" class="headerlink" title="Example of replaceState() method"></a>Example of replaceState() method</h4><p>Suppose <a href="http://mozilla.org/foo.html" target="_blank" rel="external">http://mozilla.org/foo.html</a> executes the following JS:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stateObj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;</div><div class="line">history.replaceState(stateObj, <span class="string">'page 2'</span>, <span class="string">'bar.htmk'</span>)</div></pre></td></tr></table></figure>
<p>This will cause the URL bar to display <a href="http://mozilla.org/bar.html" target="_blank" rel="external">http://mozilla.org/bar.html</a>, but won’t cause the browser to load bar.html or even check that bar.html exists.</p>
<p>Suppose now that the user navigates to <a href="http://www.microsoft.com" target="_blank" rel="external">http://www.microsoft.com</a>, then clicks back. At this point, the URL bar will display <a href="http://mozilla.org/bar.html" target="_blank" rel="external">http://mozilla.org/bar.html</a>.</p>
<p>If you click back again, you will be nagivated to the page before foo.html. (which is different from pushState())</p>
<h3 id="The-popstate-event"><a href="#The-popstate-event" class="headerlink" title="The popstate event"></a>The popstate event</h3><p>A popstate event is dispatched to the <code>window</code> every time the active history entry changes. If the history entry being activated was created by a call to <code>pushState</code> or affected by <code>replaceState</code>, the <code>popstate</code> event’s <code>state</code> property contains a copy of the history entry’s state object.</p>
<h3 id="Reading-the-current-state"><a href="#Reading-the-current-state" class="headerlink" title="Reading the current state"></a>Reading the current state</h3><p>When your page loads, it might have a non-null state object. This can be happen, for example, if the page sets a state object(by <code>pushState</code>, or <code>replaceState</code>) and then the user restarts their browser. When your page reloads, the page will receive an <code>onload</code> event, but no <code>popstate</code> event. However if you read the <code>history.state</code> property, you’ll get back the state object you would have to gotten if a <code>popstate</code> had fired.</p>
<p>You can read it directly:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> currentState = history.state</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2017/08/09/History-API/" class="article-date">
  <time datetime="2017-08-09T05:59:40.000Z" itemprop="datePublished">2017-08-09</time>
</a>

        </li>
        
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2017/08/10/Build-GraphQL-Server-with-Express-1/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Build GraphQL Server with Express
        
      </div>
    </a>
  
  
    <a href="/2017/08/07/Note-on-Sequelize/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Note on Sequelize</div>
    </a>
  
</nav>


  
</article>




      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>Write for Archive</p>


      </div>
    </footer>

      

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







    </div>
  </body>
</html>
