<!DOCTYPE html>
<html  lang="en">

<head>
    <meta charset="utf-8">
<title>Start in Drizzle  - EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">

<link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre|DM+Serif+Text&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">




    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    



    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">







<link rel="stylesheet" href="/css/back-to-top.css">




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>




<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>



    



    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    




<link rel="stylesheet" href="/css/style.css">

</head>

<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Start in Drizzle " height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/projects">Projects</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>

    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-03-13T03:31:23.000Z">2018-03-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 921 words)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span> visits
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Start in Drizzle 
            
        </h1>
        <div class="content">
            <p>Drizzle is a collection of front-end libraries that make wirting dapp front-ends easier and more predicable. The core of Drizzle is based on Redux Store, so you can access to the spectacular development tools around Redux. We take care of synchronizing your contract data, transaction data and more. Things stay fast because you declare what to keep in sync.</p>
<ul>
<li><p>Fully reactive contract data, including state, events and transactions</p>
</li>
<li><p>Declarative, so you’re not wasting valuable cycles on unneeded data.</p>
</li>
<li><p>Maintainer access to underlying functionaliy. Web3 and your contract’s methods are still there, untouched.</p>
</li>
</ul>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add drizzle</div></pre></td></tr></table></figure>
<p>If use React you can use <a href="https://github.com/trufflesuite/drizzle-react" target="_blank" rel="noopener">drizzle-react</a> and (optionally) its companion <a href="https://github.com/trufflesuite/drizzle-react-components" target="_blank" rel="noopener">drizzle-react-components</a></p>
<blockquote>
<p>Drizzle uses web3 1.0 and web sockets, be sure your development environment can support these.</p>
</blockquote>
<ol>
<li>Import the provider</li>
</ol>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> &#123; Drizzle, generateStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'drizzle'</span></div></pre></td></tr></table></figure>
<ol>
<li>Create an <code>options</code> object and pass in the desired contract artifacts for Drizzle to instantiate. Other options are available, just keep going on.</li>
</ol>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// import contract</span></div><div class="line"><span class="hljs-keyword">import</span> SimpleStorage <span class="hljs-keyword">from</span> <span class="hljs-string">'./../build/contracts/SimpleStorage.json'</span></div><div class="line"><span class="hljs-keyword">import</span> TutorialToken <span class="hljs-keyword">from</span> <span class="hljs-string">'./../build/contracts/TutorialToken.json'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> options = &#123;</div><div class="line">  <span class="hljs-attr">contracts</span>: [</div><div class="line">    SimpleStorage</div><div class="line">  ]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> drizzleStore = generateStore(<span class="hljs-keyword">this</span>.props.options)</div><div class="line"><span class="hljs-keyword">const</span> drizzle = <span class="hljs-keyword">new</span> Drizzle(<span class="hljs-keyword">this</span>.props.options, drizzleStore)</div></pre></td></tr></table></figure>
<h3 id="Contract-Interaction"><a href="#Contract-Interaction" class="headerlink" title="Contract Interaction"></a>Contract Interaction</h3><p>Drizzle provides helpful methods on top of the default web3 Contract methods to keep you calls and transactions in sync with the store.</p>
<h4 id="cacheCall"><a href="#cacheCall" class="headerlink" title="cacheCall()"></a>cacheCall()</h4><p>Gets contract data. Calling the <code>cacheCall()</code> function on a contract will execute the desired call and return a <strong>corresponding key</strong> so the data can be retrieved from the store.</p>
<p>When a new block is received, Drizzle will refresh the store automatically <em>if</em> any transactions in the block touched our contract.</p>
<blockquote>
<p>Note: We have to check that Drizzle is <strong>initialized before fetching data</strong>. A simple if statement such as below is fine for display a few pieces of data, but a better approach for larger dapps is to use a <code>loading component</code>. Drizzle built one in <code>drizzle-react-component</code> as well.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// Assuming we're observing the store for changes</span></div><div class="line"><span class="hljs-keyword">var</span> state = drizzle.store.getState()</div><div class="line"></div><div class="line"><span class="hljs-comment">// If Drizzle is initialized (and therefore web3, accounts, and contracts ), continue</span></div><div class="line"><span class="hljs-keyword">if</span> (state.drizzleStatus.initialized) &#123;</div><div class="line">  <span class="hljs-comment">// Declare this call to be cached and synchornized. We'll receive the store key for recall</span></div><div class="line">  <span class="hljs-keyword">const</span> dataKey = drizzle.contracts.SimpleStorage.methods.storedData.cacheCall()</div><div class="line"></div><div class="line">  <span class="hljs-comment">// Use the dataKey to display data from the store</span></div><div class="line">  <span class="hljs-keyword">return</span> state.contracts.SimpleStorage.methods.storedData[dataKey].value</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-comment">// If Drizzle isn't initialized, display some loading indication</span></div><div class="line"><span class="hljs-keyword">return</span> <span class="hljs-string">'loading'</span></div></pre></td></tr></table></figure>
<p>The Contract instance has all of its standard web3 properties and methods. For example, you could still call as normal if you don’t want something in the store:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">drizzle.contracts.SimpleStorage.methods.storedData().call() <span class="hljs-comment">// different from methods.storedData.cacheCall()</span></div></pre></td></tr></table></figure>
<h3 id="cacheSend"><a href="#cacheSend" class="headerlink" title="cacheSend()"></a>cacheSend()</h3><p>Sends a contract transaction. Calling the <code>cacheSend()</code> function on a contract will send the desired transaction and return a correnponding hash so the status can be retrieved from the store. The last argument can optionally be an options object with the typical <strong>from, gas, gasPrice</strong> keys. Drizzle will update the transaction’s state in the store(pending, success, error) and store the transaction receipt.</p>
<blockquote>
<p>Note: We have to check that Drizzle is initialized before fetching data. A simple if statement such as below is fine for display a few pieces of data, but a better approach for larger dapps is to use a loading component.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// Assuming we're observing the store of changes</span></div><div class="line"><span class="hljs-keyword">var</span> state = drizzle.store.getState()</div><div class="line"></div><div class="line"><span class="hljs-comment">// if Drizzle is initialized ( and therefore web3, accounts, and contracts ), continue</span></div><div class="line"><span class="hljs-keyword">if</span> (state.drizzleStatus.initialized) &#123;</div><div class="line">  <span class="hljs-comment">// Declare this transaction to be observed. We'll receive the stackId of reference.</span></div><div class="line">  <span class="hljs-keyword">const</span> stackId = drizzle.contracts.SimpleStorage.methods.set.cacacheSend(<span class="hljs-number">2</span>, &#123;<span class="hljs-attr">from</span>: <span class="hljs-string">'0x3f...'</span>&#125;)</div><div class="line"></div><div class="line">  <span class="hljs-comment">// Use the dataKey to display the transaction status</span></div><div class="line">  <span class="hljs-keyword">if</span> (state.transactionStack[stackId]) &#123;</div><div class="line">    <span class="hljs-keyword">const</span> txHash = state.trasnactionStack[stackId]</div><div class="line"></div><div class="line">    <span class="hljs-keyword">return</span> state.transactions[txHash].status</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-comment">// If Drizzle isn't initialized, display some loading indication.</span></div><div class="line"><span class="hljs-keyword">return</span> <span class="hljs-string">'loading'</span></div></pre></td></tr></table></figure>
<p>The contract instance has all of its standard web3 properties and methods.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">drizzle.contracts.SimpleStorage.methods.set(<span class="hljs-number">2</span>).send(&#123;<span class="hljs-attr">from</span>: <span class="hljs-string">'0x3f...'</span>&#125;)</div></pre></td></tr></table></figure>
<h3 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h3><figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  contracts,</div><div class="line">  events: &#123;</div><div class="line">    contractsName: [</div><div class="line">      eventName</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  web3: &#123;</div><div class="line">    fallback: &#123;</div><div class="line">      type</div><div class="line">      url</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>Contracts: Array, Required, an array of contract artifacts files</p>
</li>
<li><p>Events: Object, an object consisting of contract names each containing an array of strings of the event names we’d like to listen for and sync with the store</p>
</li>
<li><p>Web3: Object, options regarding web3 instantiation</p>
</li>
<li><p>Fallback: Object, an object consisting of the type and url of a fallback web3 provider. This is used if no injected provider, such as MetaMask or Mist, is detect.</p>
<ul>
<li><p>type: string, the type of web3 fallback, currently <code>ws</code> is the only possibility</p>
</li>
<li><p>url: string, the full websocket url. For example, <code>ws://127.0.0.1:8546</code></p>
</li>
</ul>
</li>
</ul>
<h3 id="How-data-stays-fresh"><a href="#How-data-stays-fresh" class="headerlink" title="How data stays fresh"></a>How data stays fresh</h3><ol>
<li>Once initialized, Drizzle instantiates <code>web3</code> and our desired contracts, then observes the chain by subscribing to new block headers</li>
</ol>
<p><img src="https://github.com/trufflesuite/drizzle/blob/master/readme/drizzle-sync1.png?raw=true" alt=""></p>
<ol>
<li>Drizzle keeps track of contract calls so it knows what to synchronize</li>
</ol>
<p><img src="https://github.com/trufflesuite/drizzle/blob/master/readme/drizzle-sync2.png?raw=true" alt=""></p>
<ol>
<li>When a new block header comes in, Drizzle checks that the block isn’t pending, then goes through the transactions looking to see if any of them touched our contracts</li>
</ol>
<p><img src="https://github.com/trufflesuite/drizzle/blob/master/readme/drizzle-sync3.png?raw=true" alt=""></p>
<ol>
<li>If they did, we replay the calls already in the store to refresh any potentially altered data. If they didn’t we continue with the store data.</li>
</ol>
<p><img src="https://github.com/trufflesuite/drizzle/blob/master/readme/drizzle-sync4.png?raw=true" alt=""></p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Drizzle-Ethereum-BlockChain/">Drizzle, Ethereum, BlockChain</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Like this article? Support the author with</h3>
        <div class="buttons is-centered">
            
                <!-- Visit https://www.paypal.com/donate/buttons/ to get your donate button -->

<a class="button is-warning donate" onclick="document.getElementById(&#39;paypal-donate-form&#39;).submit()">
    <span class="icon is-small">
        <i class="fab fa-paypal"></i>
    </span>
    <span>Paypal</span>
</a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" id="paypal-donate-form">
    <input type="hidden" name="cmd" value="_donations" />
    <input type="hidden" name="business" value="chen.yu.keith@foxmail.com" />
    <input type="hidden" name="currency_code" value="USD" />
</form>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2018/03/13/Error-Handling-in-Solidity/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Error Handling in Solidity</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2018/03/12/Constant-View-and-Pure-in-Solidity/">
                <span class="level-item">Constant, View, and Pure in Solidity</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
	var gitment = new Gitment({
		id: '2018/03/13/Start-in-Drizzle/',
		owner: 'Keith-CY',
		repo: 'Keith-CY.github.io',
		oauth: {
			client_id: '56319e1ce36ed4313555',
			client_secret: 'ca7f10a8357d52290f5509fb54e5173a8bea0a5d',
		},
	})
	gitment.render('comment-container')
</script>

    </div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>

</html>
