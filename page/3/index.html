<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8">
<title>EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>


    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="EzCook" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-07T01:43:53.000Z">2017-11-07</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 772 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/07/HTTP-2-by-Node-js/">HTTP/2 by Node.js</a>
            
        </h1>
        <div class="content">
            <p><a href="https://dexecure.com/blog/how-to-create-http2-static-file-server-nodejs-with-examples/" target="_blank" rel="noopener">Origin</a></p>
<p>Websites delivered using HTTP/2 enjoys a wide range of new features including -</p>
<ul>
<li><p>fully multiplexed connections: all requests and responses to a domain are fully multiplexed via a single connection, making best use of available bandwidth.</p>
</li>
<li><p>header compression: repeated headers are compressed with HPACK compression so that they are not resent with every request and response.</p>
</li>
<li><p>PUSH: resources can be pre-emptively pushed by the server to the client, speeding up page load times.</p>
</li>
</ul>
<p>Node.js just launched support(v8.8.1) for HTTP/2 as part of their core. In this post, we will create a simple HTTP/2 server to serve static files and then demonstrate some cool features like HTTP/2 PUSH.</p>
<h3 id="Get-an-SSL-certificate"><a href="#Get-an-SSL-certificate" class="headerlink" title="Get an SSL certificate"></a>Get an SSL certificate</h3><p>Even though the HTTP/2 spec does not mandate HTTPS, browsers have decided that they will only support HTTP/2 on a HTTPS connection. This would also mitigate interference from older proxies which may not understand newer protocol.</p>
<p>For your local server, a self-signed certificate will work. You can find how to setup a self-signed certificate <a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-in-ubuntu-16-04" target="_blank" rel="noopener">here</a></p>
<h3 id="Building-a-Static-File-Server"><a href="#Building-a-Static-File-Server" class="headerlink" title="Building a Static File Server"></a>Building a Static File Server</h3><p>Let us start with a simple server which just serves static files. Note that if you are using node.js 8.7.0, you need to run node with the <code>--expose-http2</code> flag.</p>
<p>We will be listening to the <code>stream</code> event and responding to it with the corresponding file from the server root(public, in this case) using the <code>respondWithFile</code> API. We are using the <code>mime-type</code> module to look up the correct mime type to send along with the response.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> http2 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http2'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> mime = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mime-types'</span>)</span><br><span class="line"></span><br><span class="line">cosnt &#123;</span><br><span class="line">  HTTP2_HEADER_PATH,</span><br><span class="line">  HTTP2_HEADER_METHOD,</span><br><span class="line">  HTTP_STATUS_NOT_FOUND,</span><br><span class="line">  HTTP_STATUS_INTERNAL_SERVER_ERROR</span><br><span class="line">&#125; = http2.constants</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> options = &#123;</span><br><span class="line">  key: fs.readFileSync(<span class="hljs-string">'./selfsigned.key'</span>),</span><br><span class="line">  cert: fs.readFileSync(<span class="hljs-string">'./selfsigned.crt'</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> server = http2.createSecureServer(options)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> serverRoot = <span class="hljs-string">'./public'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">respondToStreamError</span>(<span class="hljs-params">err, stream</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-keyword">if</span> (err.code === <span class="hljs-string">'ENOENT'</span>) &#123;</span><br><span class="line">    stream.respond(&#123;</span><br><span class="line">      <span class="hljs-string">':stats'</span>: HTTPS_STATUS_NOT_FOUND,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    stream.respond(&#123;</span><br><span class="line">      <span class="hljs-string">':status'</span>: HTTP_STATUS_INTERNAL_SERVER_ERROR,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  stream.end()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server.on(<span class="hljs-string">'stream'</span>, (stream, headers) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> reqPath = headers[HTTP2_HEADER_PATH]</span><br><span class="line">  <span class="hljs-keyword">const</span> reqMethod = headers[HTTP2_METHOD]</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">const</span> fullPath = path.join(serverRoot, reqPath)</span><br><span class="line">  <span class="hljs-keyword">const</span> responseMimeType = mime.lookup(fullPath)</span><br><span class="line"></span><br><span class="line">  stream.respondWithFile(fullPath, &#123;</span><br><span class="line">    <span class="hljs-string">'content-type'</span>: responseMimeType</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    onError: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> respondToStreamError(err, stream)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="hljs-number">443</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Server-PUSH-Example"><a href="#Server-PUSH-Example" class="headerlink" title="Server PUSH Example"></a>Server PUSH Example</h3><p>Now we have simpel HTTP/2 server running, lets try to use one of the new featues in HTTP/2 - HTTP/2 PUSH. This can lead to significant performance improvements in high latency environments, if done correctly.</p>
<p>We are loading a simple HTML file pointing to style.css which references to our font file. The request to the font file is only made after css file is discovered in the HTML, downloaded and then parsed. This is how the waterfall would have usually looked like:</p>
<p><img src="https://dexecure.com//images/blog/waterfall-without-http2.53b722f2.png" alt=""></p>
<p>You can initate a new PUSH with the <code>pushStream</code> API. Since we know that the browser is going to be requesting the font file in the future, we can PUSH the font file as soon as the server receives the request for the HTML file.</p>
<p>When the actual request for the font file takes place, it is claimed from the PUSH cache, instead of making a network request then.</p>
<p><img src="https://dexecure.com//images/blog/waterfall-with-http2.b47218ea.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> http2 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http2'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> mime = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mime-types'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> &#123;</span><br><span class="line">  HTTP2_HEADER_PATH,</span><br><span class="line">  HTTP2_HEADER_METHOD,</span><br><span class="line">  HTTP_STATUS_NOT_FOUND,</span><br><span class="line">  HTTP_STATUS_INTERNAL_SERVER_ERROR,</span><br><span class="line">&#125; = http2.constants</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> options = &#123;</span><br><span class="line">  key: fs.readFileSync(<span class="hljs-string">'./selfsigned.key'</span>),</span><br><span class="line">  cert: fs.readFileSync(<span class="hljs-string">'./selfsigned.crt'</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> server = http2.createSecureServer(options)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> serverRoot = <span class="hljs-string">'./public'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">respondToStreamError</span> (<span class="hljs-params">err, stream</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-keyword">if</span> (err.code === <span class="hljs-string">'ENOENT'</span>) &#123;</span><br><span class="line">    stream.respond(&#123;</span><br><span class="line">      <span class="hljs-string">':status'</span>: HTTP_STATUS_NOT_FOUND,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    stream.respond(&#123;</span><br><span class="line">      <span class="hljs-string">':status'</span>: HTTP_STATUS_INTERNAL_SERVER_ERROR,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  stream.end()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server.on(<span class="hljs-string">'stream'</span>, (stream, headers) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> reqPath = headers[HTTP2_HEADER_PATH]</span><br><span class="line">  <span class="hljs-keyword">const</span> reqMethod = headers[HTTP2_HEADER_METHOD]</span><br><span class="line">  <span class="hljs-keyword">const</span> fullPath = path.join(serverRoot, reqPath)</span><br><span class="line">  <span class="hljs-keyword">const</span> responseMimeType = mime.lookup(fullPath)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">if</span> (fullPath.endsWith(<span class="hljs-string">'.html'</span>)) &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'html'</span>)</span><br><span class="line">    <span class="hljs-comment">// handle the html file</span></span><br><span class="line">    stream.respondWithFile(fullPath, &#123;</span><br><span class="line">      <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'text/html'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      onError: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        respondToStreamError(err, stream)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    stream.pushStream(&#123;</span><br><span class="line">      <span class="hljs-string">':path'</span>: <span class="hljs-string">'/font.woff'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      parent: stream.id,</span><br><span class="line">    &#125;, pushStream =&gt; &#123;</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'pushing'</span>)</span><br><span class="line">      pushStream.respondWithFile(path.join(serverRoot, <span class="hljs-string">'/font.woff'</span>), &#123;</span><br><span class="line">        <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'text/css'</span>,</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        onError: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">          respondToStreamError(err, pushStream)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-comment">// handle the static file</span></span><br><span class="line">    <span class="hljs-built_in">console</span>.log(fullPath)</span><br><span class="line">    stream.respondWithFile(fullPath, &#123;</span><br><span class="line">      <span class="hljs-string">'content-type'</span>: responseMimeType,</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      onError: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> respondToStreamError(err, stream)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="hljs-number">443</span>)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-06T06:10:05.000Z">2017-11-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 927 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/06/Rocket-of-Rust/">Rocket of Rust</a>
            
        </h1>
        <div class="content">
            <h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>Rocket’s design is centered around three core philosophies:</p>
<ul>
<li><p><strong>Function declaration and parameter type should contain all necessary information to validate and process a request</strong>. This immediately prohibits APIs where request state is retrieved from a global context. As a result, request handling is <strong>self-contained</strong> in Rocket: handlers are regular functions with regular arguments.</p>
</li>
<li><p><strong>All request handling information should be typed</strong>. Because the web and HTTP are themselves untyped(or stringly typed, as some call it), this means that something or someone has to convert strings to native types. Rocket does this for you with zero programming overhead.</p>
</li>
<li><p><strong>Decisions should not be forced</strong>. Templates, serialization, sessions and just about everything else are all pluggable, optional components. While Rocket has official support and libraries for each of these, they are completely optional and swappable.</p>
</li>
</ul>
<h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo new hello-rocket --bin</span><br></pre></td></tr></table></figure>
<p>Add Dependencies</p>
<figure class="highlight toml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-section">[dependencies]</span></span><br><span class="line"><span class="hljs-attr">rocket</span> = <span class="hljs-string">"0.3.3"</span></span><br><span class="line"><span class="hljs-attr">rocket_codegen</span> = <span class="hljs-string">"0.3.3"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#![feature(plugin)]</span></span><br><span class="line"><span class="hljs-meta">#![plugin(rocket_codegen)]</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> rocket;</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">#[get(<span class="hljs-meta-string">"/"</span>)]</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">index</span></span>() -&gt; &amp;<span class="hljs-symbol">'static</span> <span class="hljs-built_in">str</span> &#123;</span><br><span class="line">  <span class="hljs-string">"Hello World"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  rocket::ignite().mount(<span class="hljs-string">"/"</span>, routes![index]).launch();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It creates an <code>index</code> route, <em>mount</em> the route at the <code>/</code> path, and launches the application. Compile and run the program with <code>cargo run</code>, you should see the following:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">🔧  Configured <span class="hljs-keyword">for</span> development.</span><br><span class="line">    =&gt; address: localhost</span><br><span class="line">    =&gt; port: 8000</span><br><span class="line">    =&gt; <span class="hljs-built_in">log</span>: normal</span><br><span class="line">    =&gt; workers: [core count * 2]</span><br><span class="line">    =&gt; secret key: generated</span><br><span class="line">    =&gt; limits: forms = 32KiB</span><br><span class="line">    =&gt; tls: disabled</span><br><span class="line">🛰  Mounting <span class="hljs-string">'/'</span>:</span><br><span class="line">    =&gt; GET /</span><br><span class="line">🚀  Rocket has launched from http://localhost:8000</span><br></pre></td></tr></table></figure>
<h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>Rocket provides primitives to build web servers and applications with Rust: the rest is up to you. In short, Rocket provides <strong>routing, pre-processing of requests and psot-processing of response</strong>. Your application code instructs Rocket what to pre-process and post-process and fills the gaps between pre-processing and post-processing.</p>
<h4 id="LifeCycle"><a href="#LifeCycle" class="headerlink" title="LifeCycle"></a>LifeCycle</h4><p>Rocket’s main task is to listen for incoming web prequests, dispatch the request to the application code, and retur a response to the client. We call the process that goes form request to response the ‘lifecycle’. The lifecycle can be summarized as following sequence of steps:</p>
<ul>
<li><p><strong>Routing</strong></p>
<p>Rocket parse an incoming HTTP request into native structure that your code operates on indirectly. Rocket determines which request handler to invoke by matching against route attributes declared in your application.</p>
</li>
<li><p><strong>Validation</strong></p>
<p>Rocket validates the incoming request against types and guards present in the matched route. If validation fails, Rocket <em>forwards</em> the request to the next matching route or calls an <em>error handler</em>.</p>
</li>
<li><p><strong>Processing</strong></p>
<p>The request handler associated with the route is invoked with validated arguments. This is the main business logic of an application. Processing completes by returning a <code>Response</code>.</p>
</li>
<li><p><strong>Response</strong></p>
<p>The returned <code>Response</code> is processed. Rocket generates the appropriate HTTP response and sends it to the client. This completes the lifecycle. Rocket continues listening for requesting, restarting the lifecycle for each incoming request.</p>
</li>
</ul>
<h4 id="Routing"><a href="#Routing" class="headerlink" title="Routing"></a>Routing</h4><p>Rocket applications are centered around routes and handlers. A <em>route</em> is a combination of: </p>
<ul>
<li><p>A set of parameters to match an incoming request against.</p>
</li>
<li><p>A handler to process the request and return a response.</p>
</li>
</ul>
<p>A handler is simply a function that takes an arbirary number of arguments and returns any arbitrary type.</p>
<p>The parameters to match against include static paths, dynamic paths, path segments, forms, query string, request format specifiers and body data. Rocket uses attributes, which look like function decoration in other languages to make declaring routes easy. Routes are declared by annotating a function, the handler, with a set of parameters to match against. A complete route declaration looks like this:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#[get(<span class="hljs-meta-string">"/world"</span>)]</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">world</span></span>() -&gt; &amp;<span class="hljs-symbol">'static</span> <span class="hljs-built_in">str</span> &#123;</span><br><span class="line">  <span class="hljs-string">"Hello World"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This declare the <code>world</code> route to match against the static path <code>/world</code> on incoming <code>GET</code> requests. The <code>world</code> route is simple, but additional route parameters are necessary when building more interesting application.</p>
<h4 id="Mounting"><a href="#Mounting" class="headerlink" title="Mounting"></a>Mounting</h4><p>Before Rocket can dispatch requests to a route, the route needs to be <em>mounted</em>. Mounting a route is like namespacing it. Routes are mounted via the <code>mount</code> method on a <code>Rocket</code> instance. A <code>Rocket</code> instance is typically created with the <code>racket::ignite()</code> static method.</p>
<p>The <code>mount</code> method takes:</p>
<ul>
<li><p>A path to namespace a list of routes under.</p>
</li>
<li><p>A list of route handlers through the <code>routes!</code> macro, typing Rocket’s code generation to your application.</p>
</li>
</ul>
<p>For instance, to mount the <code>world</code> route we declared above, we can write the following:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![world]);</span><br></pre></td></tr></table></figure>
<p>This create a new <code>Rocket</code> instance via the <code>ignite</code> function and mounts the <code>world</code> route to the <code>/hello</code> path. As a result, <code>GET</code> requests to the <code>/hello/world</code> path will be directed to the <code>world</code> function.</p>
<h4 id="Namespacing"><a href="#Namespacing" class="headerlink" title="Namespacing"></a>Namespacing</h4><p>When a route is declared inside a module other than the root, you may find yourself with unexpected errors when mounting: </p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">mod</span> other &#123;</span><br><span class="line">  <span class="hljs-meta">#[get(<span class="hljs-meta-string">"/world"</span>)]</span></span><br><span class="line">  <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">world</span></span>() -&gt; <span class="hljs-built_in">String</span> &#123;</span><br><span class="line">    <span class="hljs-string">"Hello World"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![world]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This occurs because the <code>routes!</code> macro implicitly converts the route’s name into the name of a structure generated by Rocket’s code generation. The solution is to name the route by a module path instead:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![other::world]);</span><br></pre></td></tr></table></figure>
<h4 id="Launching"><a href="#Launching" class="headerlink" title="Launching"></a>Launching</h4><p>Now that Rocket knows about the route, you can tell Rocket to start accepting requests via the <code>launch</code> method. The method starts up the server and wait for incoming requests. When a request arrives, Rocket finds the matching route and dispatches the requests to the route’s handler.</p>
<p>We typically call <code>launch</code> from the <code>main</code> function. Our complete <em>Hello World</em> application thus looks like:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#![feature(plugin)]</span></span><br><span class="line"><span class="hljs-meta">#![plugin(rocket_codegen)]</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> rocket;</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">#[get(<span class="hljs-meta-string">"/world"</span>)]</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">world</span></span>() -&gt; <span class="hljs-built_in">String</span> &#123;</span><br><span class="line">  <span class="hljs-string">"Hello World"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![world]).launch();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-26T03:05:07.000Z">2017-10-26</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 216 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/26/Fastify-Plugin-Guide/">Fastify Plugin Guide</a>
            
        </h1>
        <div class="content">
            <p>In Fastify everything is a plugin, your routes, your utilities and so on are all plugins. And to add a new plugin, whatever its functionality is, in Fastify</p>
<h3 id="Registers"><a href="#Registers" class="headerlink" title="Registers"></a>Registers</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastify.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./my-plugin'</span>, opts, callback))</span><br></pre></td></tr></table></figure>
<p>Register creates a new Fastify context, this means that if you do any change to the Fastify instance, that change will not be reflected into the context’s ancestors. In other words, encapsulated!</p>
<p>Required Plugins must expose a single function with the following signature:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">instance, opts, next</span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>The Fastify’s plugin module is fully reentrant and graph-based, it handles without any kind of problem asynchronous code and it guarantees the load order of the plugins, even the close order.</p>
<h3 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h3><p>Fastify offers you a way nice and elegant to wrote an utility: decorator.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastify.decorate(<span class="hljs-string">'util'</span>, (a, b) =&gt; a + b)</span><br></pre></td></tr></table></figure>
<p>Now you can access your utility by doing <code>fastify.util</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fastify.register(<span class="hljs-function">(<span class="hljs-params">instance, opts, next</span>)=&gt;</span> &#123;</span><br><span class="line">  instance.decorate(<span class="hljs-string">'util'</span>, (a, b) =&gt; a + b)</span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><p>Execute your utility.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fastify.register(<span class="hljs-function">(<span class="hljs-params">instance, opts, next</span>) =&gt;</span> &#123;</span><br><span class="line">  instance.decorate(<span class="hljs-string">'util'</span>, (req, key, value) =&gt; &#123; req.key = value &#125;)</span><br><span class="line"></span><br><span class="line">  instance.addHook(<span class="hljs-string">'preHandler'</span>, (req, reply, done) =&gt; &#123;</span><br><span class="line">    instance.util(req, <span class="hljs-string">'timestamp'</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>())</span><br><span class="line">    done()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  instance.get(<span class="hljs-string">'/plugin1'</span>, (req, reply) =&gt; &#123;</span><br><span class="line">    reply.send(req)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.get(<span class="hljs-string">'/plugin2'</span>, (req, reply) =&gt; &#123;</span><br><span class="line">  reply.send(req)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-23T06:50:14.000Z">2017-10-23</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    19 minutes read (About 2782 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/23/Time-to-start-fastify/">Time to Start Fastify</a>
            
        </h1>
        <div class="content">
            <h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><h4 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add fastify</span><br></pre></td></tr></table></figure>
<h4 id="First-Server"><a href="#First-Server" class="headerlink" title="First Server"></a>First Server</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Require the framework and instantiate it</span></span><br><span class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Declare a route</span></span><br><span class="line">fastify.get(<span class="hljs-string">'/'</span>, (req, reply) =&gt; &#123;</span><br><span class="line">  reply.send(&#123;</span><br><span class="line">    hello: <span class="hljs-string">'world'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Run the server</span></span><br><span class="line">fastify.listen(<span class="hljs-number">3000</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server is running on <span class="hljs-subst">$&#123;fastify.server.address().port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Schema-Serialization"><a href="#Schema-Serialization" class="headerlink" title="Schema Serialization"></a>Schema Serialization</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> opts = &#123;</span><br><span class="line">  schema: &#123;</span><br><span class="line">    response: &#123;</span><br><span class="line">      <span class="hljs-number">200</span>: &#123;</span><br><span class="line">        type: <span class="hljs-string">'object'</span>,</span><br><span class="line">        properties: &#123;</span><br><span class="line">          hello: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Declare a route with an output shcema</span></span><br><span class="line">fastify.get(<span class="hljs-string">'/'</span>, opts, (req, reply) =&gt; &#123;</span><br><span class="line">  replysend(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.listen(<span class="hljs-number">3000</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server is running on <span class="hljs-subst">$&#123;fastify.server.address().port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Register"><a href="#Register" class="headerlink" title="Register"></a>Register</h4><p>Register routes in seperate files</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// server.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</span><br><span class="line"></span><br><span class="line">fastify.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./route'</span>))</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> opts = &#123;</span><br><span class="line">  hello: <span class="hljs-string">'world'</span>,</span><br><span class="line">  something: <span class="hljs-literal">true</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fastify.register([</span><br><span class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./another-route'</span>),</span><br><span class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./yet-another-route'</span>),</span><br><span class="line">], opts, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.listen(<span class="hljs-number">3000</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server is running on <span class="hljs-subst">$&#123;fastify.server.address().port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// route.js</span></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = (fastify, options, next) &#123;</span><br><span class="line">  fastify.get(<span class="hljs-string">'/'</span>, (req, reply) =&gt; &#123;</span><br><span class="line">    replysend(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>or <code>async/await</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> (fastify, options) =&gt; &#123;</span><br><span class="line">  fastify.get(<span class="hljs-string">'/'</span>, (req, reply) =&gt; &#123;</span><br><span class="line">    replysend(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Server-Methods"><a href="#Server-Methods" class="headerlink" title="Server Methods"></a>Server Methods</h3><h4 id="server"><a href="#server" class="headerlink" title="server"></a>server</h4><p><code>fastify.server</code>: The Node Core <code>server</code> object.</p>
<h4 id="ready"><a href="#ready" class="headerlink" title="ready"></a>ready</h4><p>Function  called when all the plugins has been loaded. It takes an error parameter if something went wrong.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastify.ready(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123; <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="listen"><a href="#listen" class="headerlink" title="listen"></a>listen</h4><p>Starts the server on the given port after all the plugins loaded, internally waits for the <code>.ready()</code> event. The callback is the same as the Node Core.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastify.listen(<span class="hljs-number">3000</span>, err =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Specifying an address is also supported:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastify.listen(<span class="hljs-number">3000</span>, <span class="hljs-string">'127.0.0.1'</span>, err =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="route"><a href="#route" class="headerlink" title="route"></a>route</h4><p>Method to add routes to the server, it also have shorthands.</p>
<h4 id="routes-iterator"><a href="#routes-iterator" class="headerlink" title="routes iterator"></a>routes iterator</h4><p>The fastify instance is an Iterable object with all the registered routes. The route properties are the same the developer has declared.</p>
<h4 id="close"><a href="#close" class="headerlink" title="close"></a>close</h4><p><code>fastify.close(callback)</code>, call this function to close the server instance and run the <code>onClose</code> hook.</p>
<h4 id="decorate"><a href="#decorate" class="headerlink" title="decorate*"></a>decorate*</h4><p>Function useful if you need to decorate the fastify instance, Reply or Request.</p>
<h4 id="register"><a href="#register" class="headerlink" title="register"></a>register</h4><p>Fastify allows the user to extends its functionalities with plugins. A plugin can be a set of routes, a server decorator or whatever.</p>
<h4 id="use"><a href="#use" class="headerlink" title="use"></a>use</h4><p>Function to add middlewares to Fastify.</p>
<h4 id="addHook"><a href="#addHook" class="headerlink" title="addHook"></a>addHook</h4><p>Function to add a specific hook in the lifecycle of Fastify.</p>
<h4 id="logger"><a href="#logger" class="headerlink" title="logger"></a>logger</h4><p>The logger instance.</p>
<h4 id="Inject"><a href="#Inject" class="headerlink" title="Inject"></a>Inject</h4><p>Fake http injection(for testing purpose).</p>
<h4 id="setSchemaCompiler"><a href="#setSchemaCompiler" class="headerlink" title="setSchemaCompiler"></a>setSchemaCompiler</h4><p>Set the schema compiler for all routes.</p>
<h4 id="setNotFoundHandler"><a href="#setNotFoundHandler" class="headerlink" title="setNotFoundHandler"></a>setNotFoundHandler</h4><p><code>fastify.setNotFoundHandler(handler(req, reply))</code>: set the 404 handler. This call is fully encapsulated, so different plugins can set different not found handlers.</p>
<h4 id="setErrorHandler"><a href="#setErrorHandler" class="headerlink" title="setErrorHandler"></a>setErrorHandler</h4><p><code>fastify.setErrorHandler(handler(err, reply))</code>: set a function that will be called whenever an error happens. The handler is fully encapsulated, so different plugins can set different error handlers.</p>
<h3 id="Routes"><a href="#Routes" class="headerlink" title="Routes"></a>Routes</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastify.route(options)</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>method</code>: currently it supports <code>DELETE</code>, <code>GET</code>, <code>HEAD</code>, <code>PATCH</code>, <code>POST</code>, <code>PUT</code>, and <code>OPTIONS</code>, it could be an array of methods.</p>
</li>
<li><p><code>url</code>: the path of the url to match this route (alias: <code>path</code>)</p>
</li>
<li><p><code>schema</code>: an object containing the schemas for the request and response. They need to be in <code>JSON Schema</code> format.</p>
<ul>
<li><p><code>body</code>: validates the body of the request if it is a POST or PUT.</p>
</li>
<li><p><code>querystring</code>: validates the querystring. This can be a complete JSON Schema Object, with the property <code>type</code> of <code>object</code> and <code>properties</code> object of parameters, or simply the values of what would be contained in the properties object as shown below.</p>
</li>
<li><p><code>params</code>: validates the params.</p>
</li>
<li><p><code>response</code>: fitler and generate a schema for the response, setting a schema allows us to have 10-20% more throughput.</p>
</li>
</ul>
</li>
<li><p><code>beforeHandler(req, res, done)</code>: a function called just before the request handler, useful if you need to perform authentication at route level for example, it could also be and array of functions.</p>
</li>
<li><p><code>handler(req, reply)</code>: the function that will handle this request.</p>
</li>
<li><p><code>request</code> if defined in <code>Request</code>.</p>
</li>
<li><p><code>reply</code> is defined in <code>Reply</code>.</p>
</li>
</ul>
<p>Exmaple</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">fastify.route(&#123;</span><br><span class="line">  method: <span class="hljs-string">'GET'</span>,</span><br><span class="line">  url: <span class="hljs-string">'/'</span>,</span><br><span class="line">  schema: &#123;</span><br><span class="line">    querystring: &#123;</span><br><span class="line">      name: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</span><br><span class="line">      excitement: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'integer'</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    response: &#123;</span><br><span class="line">      <span class="hljs-number">200</span>: &#123;</span><br><span class="line">        type: <span class="hljs-string">'object'</span>,</span><br><span class="line">        properties: &#123;</span><br><span class="line">          hello: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  handler: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, reply</span>) </span>&#123;</span><br><span class="line">    reply.send(&#123;</span><br><span class="line">      hello: <span class="hljs-string">'world'</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.route(&#123;</span><br><span class="line">  method: <span class="hljs-string">'GET'</span>,</span><br><span class="line">  url: <span class="hljs-string">'/'</span>,</span><br><span class="line">  schema: &#123;<span class="hljs-comment">/*..*/</span>&#125;,</span><br><span class="line">  beforeHandler: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, reply, done</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-comment">// auth</span></span><br><span class="line">    done()</span><br><span class="line">  &#125;,</span><br><span class="line">  handler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, reply</span>) </span>&#123;</span><br><span class="line">    reply.send(&#123;</span><br><span class="line">      hello: <span class="hljs-string">'world'</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="ShortHands"><a href="#ShortHands" class="headerlink" title="ShortHands"></a>ShortHands</h4><p><code>fastify.method(path, [options], handler)</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> opts = &#123;</span><br><span class="line">  schema: &#123;</span><br><span class="line">    response: &#123;</span><br><span class="line">      <span class="hljs-number">200</span>: &#123;</span><br><span class="line">        type: <span class="hljs-string">'object'</span>,</span><br><span class="line">        properites: &#123;</span><br><span class="line">          hello: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fastify.get(<span class="hljs-string">'/'</span>, opts, (req, reply) =&gt; &#123;</span><br><span class="line">  reply.send(&#123;</span><br><span class="line">    hello: <span class="hljs-string">'world'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>fastify.all(path, [options], handler)</code> will add the same handler to all the supported methods.</p>
<h4 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fastify.get(<span class="hljs-string">'/'</span>, options, <span class="hljs-keyword">async</span> (req, reply) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">var</span> data = <span class="hljs-keyword">await</span> getData()</span><br><span class="line">  <span class="hljs-keyword">var</span> processed = <span class="hljs-keyword">await</span> processData(data)</span><br><span class="line">  <span class="hljs-keyword">return</span> processed</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Route-Prefixing"><a href="#Route-Prefixing" class="headerlink" title="Route Prefixing"></a>Route Prefixing</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// server.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</span><br><span class="line"></span><br><span class="line">fastify.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./routes/v1/users'</span>), &#123;</span><br><span class="line">  prefix: <span class="hljs-string">'/v1'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// routes/v1/users</span></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">fastify, opts, next</span>) </span>&#123;</span><br><span class="line">  fastify.get(<span class="hljs-string">'/user'</span>, handler_v1)</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now your client can access to <code>/v1/user</code>.</p>
<p>Be aware that if you use <code>fastify-plugin</code> this option won’t work.</p>
<h3 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h3><p>Logging is disabled by default, and you can enable it by passing <code>{ logger: true }</code> or <code>{ logger: { level: &#39;info&#39; } }</code> when you create the fastify instance.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)(&#123;</span><br><span class="line">  logger: <span class="hljs-literal">true</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.get(<span class="hljs-string">'/'</span>, options, (req, reply) =&gt; &#123;</span><br><span class="line">  req.log.info(<span class="hljs-string">'Some info about the current request'</span>)</span><br><span class="line">  reply.send(&#123;</span><br><span class="line">    hello: <span class="hljs-string">'world'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Middlewares"><a href="#Middlewares" class="headerlink" title="Middlewares"></a>Middlewares</h3><p>Fastify provides out of the box an asynchronous middleare engine compatible with Express and Restify middlewares.</p>
<p>Fastify middleware don’t support the full syntax <code>middleware(err, req, res, next)</code> because error handling is done inside Fastify.</p>
<p>Also if you are using a middleware taht bundles different, smaller middlewares such as helmet, we recommand to use the single module to get better performances.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)())</span><br><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'dns-prefetch-control'</span>)())</span><br><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'frameguard'</span>)())</span><br><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'hide-powered-by'</span>)())</span><br><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'hsts'</span>)())</span><br><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'ienoopen'</span>)())</span><br><span class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'x-xss-protection'</span>)())</span><br></pre></td></tr></table></figure>
<p>If you need to run a middleware only under certain path, just pass the path as first parameter to <code>use</code> and you are done.</p>
<p>Note that this does not support routes with parameters, (eg: <code>/users/:id/comments</code>) and wildcard is not supported in multiple paths.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> serveStatic = <span class="hljs-built_in">require</span>(<span class="hljs-string">'serve-static'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// single path</span></span><br><span class="line">fastify.use(<span class="hljs-string">'/css'</span>, servveStatic(<span class="hljs-string">'/asserts'</span>))</span><br><span class="line"><span class="hljs-comment">// wildcard path</span></span><br><span class="line">fastify.use(<span class="hljs-string">'/css/*'</span>, servveStatic(<span class="hljs-string">'/asserts'</span>))</span><br><span class="line"><span class="hljs-comment">// multiple paths</span></span><br><span class="line">fastify.use([<span class="hljs-string">'/css'</span>, <span class="hljs-string">'/js'</span>], servveStatic(<span class="hljs-string">'/asserts'</span>))</span><br></pre></td></tr></table></figure>
<h3 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h3><p>By using the hook you can interact directly inside the lifecycle of Fastify, there are three different Hooks that you can use(in order of execution):</p>
<ul>
<li><p><code>onRequest</code></p>
</li>
<li><p><code>preHandler</code></p>
</li>
<li><p><code>onResponse</code></p>
</li>
<li><p><code>onClose</code></p>
</li>
</ul>
<p>Example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fastify.addHook(<span class="hljs-string">'onRequest'</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// some code</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.addHook(<span class="hljs-string">'preHandler'</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// some code</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.addHook(<span class="hljs-string">'onResponse'</span>, (res, next) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// some code</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>If you want to pass a custom error code to the user, just use the <code>reply.code()</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fastify.addHook(<span class="hljs-string">'onRequest'</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// some code</span></span><br><span class="line">  reply.code(<span class="hljs-number">400</span>)</span><br><span class="line">  next(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'some error'</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>The error will be handled by <code>Reply</code></p>
<p>The unique hook that is not inside the lifecycle is <code>&#39;onClose&#39;</code>, this one is triggered when you call <code>fastify.close()</code> to stop the server, and it is useful if you have some plugins that need a ‘shutdown’ part, such as a connection to database.</p>
<p>Only for this hook the parameters of the functions changes.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fastify.addHook(<span class="hljs-string">'onClose'</span>, (instance, done) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// some code</span></span><br><span class="line">  done()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h4><p>Except for <code>onClose</code> all the hooks are encapsulated this means that you can decide where your hooks should run by using <code>register</code>.</p>
<h4 id="beforeHandler"><a href="#beforeHandler" class="headerlink" title="beforeHandler"></a>beforeHandler</h4><p><code>beforeHandler</code> is not a standard hook like <code>preHandler</code>, but is a function that your register right in the route option that will be executed only in the specified route.</p>
<p><code>beforeHandler</code> is executed always after the <code>preHandler</code> hook.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">fastify.addHook(<span class="hljs-string">'preHander'</span>, (req, reply, done) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">//  your code</span></span><br><span class="line">  done()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.route(&#123;</span><br><span class="line">  method: <span class="hljs-string">'GET'</span>,</span><br><span class="line">  url: <span class="hljs-string">'/'</span>,</span><br><span class="line">  schema: &#123;<span class="hljs-comment">/*...*/</span>&#125;,</span><br><span class="line">  beforeHandler: <span class="hljs-function">(<span class="hljs-params">req, reply, done</span>) =&gt;</span> &#123;<span class="hljs-comment">/*...*/</span> ;done()&#125;</span><br><span class="line">  handler: <span class="hljs-function">(<span class="hljs-params">req, reply</span>) =&gt;</span> &#123; reply.send(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;) &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.route(&#123;</span><br><span class="line">  method: <span class="hljs-string">'GET'</span>,</span><br><span class="line">  url: <span class="hljs-string">'/'</span>,</span><br><span class="line">  shcema: &#123;<span class="hljs-comment">/*...*/</span>&#125;,</span><br><span class="line">  beforeHandler: [</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">first</span> (<span class="hljs-params">req, reply, done</span>) </span>&#123;</span><br><span class="line">      done()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">second</span> (<span class="hljs-params">req, reply, done</span>) </span>&#123;</span><br><span class="line">      done()</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  handler: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, reply</span>) </span>&#123;</span><br><span class="line">    reply.send(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h3><p>If you need to add functionalities to the Fastify instance, the <code>decorator</code> api is what you need.</p>
<p>This api allows you to add new properties to the Fastify instance, a property value is not restricted to be a function, could also be an object or a string for example.</p>
<h4 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h4><h5 id="decorate-1"><a href="#decorate-1" class="headerlink" title="decorate"></a>decorate</h5><p>Just call the <code>decorate</code> api and pass the name of the new property and its value.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastify.decorate(<span class="hljs-string">'utility'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// something very useful</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>As said above, you can decorate the instance with other values and not only functions:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fastify.decorate(<span class="hljs-string">'conf'</span>, &#123;</span><br><span class="line">  db: <span class="hljs-string">'some db'</span>,</span><br><span class="line">  port: <span class="hljs-number">3000</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Once you decorate the instance you can access the value every time you need by using the name you passed as parameter:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastify.utility()</span><br><span class="line"><span class="hljs-built_in">console</span>.log(fastify.conf.db)</span><br></pre></td></tr></table></figure>
<p>Decorators are not <em>overwritable</em>, if you try to declare a decorator already declared, <code>decorate</code> will throw an exception.</p>
<h5 id="decorateReply"><a href="#decorateReply" class="headerlink" title="decorateReply"></a>decorateReply</h5><p>As the name suggest, this api is needed if you want to add new methods to the <code>Reply</code> core object. Just call the <code>decorateReply</code> api and pass the name of the new property and its value.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastify.decorateReply(<span class="hljs-string">'utility'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// something very useful</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Note: using an arrow function will break the binding of <code>this</code> to the Fastify <code>reply</code> instance.</p>
<h5 id="decorateRequest"><a href="#decorateRequest" class="headerlink" title="decorateRequest"></a>decorateRequest</h5><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastify.decorateRequest(<span class="hljs-string">'utility'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// something very useful</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Note: using an arrow function will break the binding of <code>this</code> to the Fastify <code>request</code> instance.</p>
<h5 id="extendServerError"><a href="#extendServerError" class="headerlink" title="extendServerError"></a>extendServerError</h5><p>If you need to extend the standard <code>server error</code>, this api is what you need.</p>
<p>You must pass a function that returns an Object, Fastify will extend the server error with the returned object of your function. The function will receive the original error object.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fastify.extendServerError(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> &#123;</span><br><span class="line">    timestamp: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment">  The resulting object will be: &#123;</span></span><br><span class="line"><span class="hljs-comment">    error: string,</span></span><br><span class="line"><span class="hljs-comment">    message: string,</span></span><br><span class="line"><span class="hljs-comment">    statusCode: number,</span></span><br><span class="line"><span class="hljs-comment">    timestamp: date,</span></span><br><span class="line"><span class="hljs-comment">  &#125;</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure>
<h4 id="Sync-and-Async"><a href="#Sync-and-Async" class="headerlink" title="Sync and Async"></a>Sync and Async</h4><p><code>decorate</code> is synchronous API, if you need to add a decorator that has an asynchronous bootstrap, could happen that Fastify boots up before your decorator is ready. To avoid this issue you must use <code>register</code> api in combination with <code>fastify-plugin</code>.</p>
<h4 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h4><p>If your decorator depends on another decorator, you can declare the dependencies of your function, it’s pretty easy, you just need to add an array of strings(representing the names of the decorators your are depending on) as third parameter.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastify.decorate(<span class="hljs-string">'utility'</span>, fn, [<span class="hljs-string">'greet'</span>, <span class="hljs-string">'log'</span>])</span><br></pre></td></tr></table></figure>
<p>If a dependency is not satisfied, <code>decorate</code> will throw an exception.</p>
<h4 id="hasDecorator"><a href="#hasDecorator" class="headerlink" title="hasDecorator"></a>hasDecorator</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastify.hasDecorator(<span class="hljs-string">'utility'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Validation-and-Serialize"><a href="#Validation-and-Serialize" class="headerlink" title="Validation and Serialize"></a>Validation and Serialize</h3><p>Fastify uses a schema based approach and even if it is not mandatory we recommend to use JSON Schema to validate you routes and serialize your output, internally Fastify compiles the schema in a highly performance function.</p>
<h4 id="Validation"><a href="#Validation" class="headerlink" title="Validation"></a>Validation</h4><p>The route validation internally uses <code>Ajv</code>, which is highly performant JSON validator. Validate the input is very easy, just add the fields that you need inside the route schema and you are done.</p>
<p>The supported validations are</p>
<ul>
<li><p>body: Validates the body of the request if it is a POST or PUT</p>
</li>
<li><p>querystring: Validates the querystring. This can be a complete JSON Schema object, with the property type of object and properties object of parameters, or simply the values of what would be contained in the properties object as shown below.</p>
</li>
<li><p>params: Validates teh route params.</p>
</li>
<li><p>headers: Validates teh request headers.</p>
</li>
</ul>
<p>Example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> schema = &#123;</span><br><span class="line">  body: &#123;</span><br><span class="line">    type: <span class="hljs-string">'object'</span>,</span><br><span class="line">    properties: &#123;</span><br><span class="line">      someKey: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>&#125;,</span><br><span class="line">      someOtherKey: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span> &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  querystring: &#123;</span><br><span class="line">    name: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</span><br><span class="line">    excitement: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'integer'</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  params: &#123;</span><br><span class="line">    type: <span class="hljs-string">'object'</span>,</span><br><span class="line">    properties: &#123;</span><br><span class="line">      par1: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</span><br><span class="line">      par2: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    type: <span class="hljs-string">'object'</span>,</span><br><span class="line">    properties: &#123;</span><br><span class="line">      <span class="hljs-string">'x-foo'</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    required: [<span class="hljs-string">'x-foo'</span>],</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Schema-Compiler"><a href="#Schema-Compiler" class="headerlink" title="Schema Compiler"></a>Schema Compiler</h4><p>The <code>schemaCompiler</code> is a function that returns a function that validates the body, url parameters, headers and query string.</p>
<p>The default <code>schemaCompiler</code> returns a function that implements the <code>ajv</code> validation interface. <code>fastify</code> use it internally to speed the valiation up.</p>
<h4 id="Serialize"><a href="#Serialize" class="headerlink" title="Serialize"></a>Serialize</h4><p>Usually you will send your data to the clients via JSON, and Fastify has a powerful tools to help you: <code>fast-json-stringify</code>, which is used if you have provided an output schema in the route options.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> schema = &#123;</span><br><span class="line">  response: &#123;</span><br><span class="line">    <span class="hljs-number">200</span>: &#123;</span><br><span class="line">      type: <span class="hljs-string">'object'</span>,</span><br><span class="line">      properties: &#123;</span><br><span class="line">        value: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</span><br><span class="line">        otherValue: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span> &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see the response schema is based on the status code, if you want to use the same schema for mutliple status code, you can use <code>2xx</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> schema = &#123;</span><br><span class="line">  response: &#123;</span><br><span class="line">    <span class="hljs-string">'2xx'</span>: &#123;</span><br><span class="line">      type: <span class="hljs-string">'object'</span>,</span><br><span class="line">      properties: &#123;</span><br><span class="line">        value: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</span><br><span class="line">        otherValue: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span> &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-number">201</span>: &#123;</span><br><span class="line">      type: <span class="hljs-string">'object'</span>,</span><br><span class="line">      properties: &#123;</span><br><span class="line">        value: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h3><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Incoming Request</span><br><span class="line">  │</span><br><span class="line">  └─▶ Instance Logger</span><br><span class="line">        │</span><br><span class="line">        └─▶ Routing</span><br><span class="line">             │</span><br><span class="line">       404 ◀─┴─▶ onRequest Hook</span><br><span class="line">                  │</span><br><span class="line">        4**/5** ◀─┴─▶ run Middlewares</span><br><span class="line">                        │</span><br><span class="line">              4**/5** ◀─┴─▶ Parsing</span><br><span class="line">                             │</span><br><span class="line">                       415 ◀─┴─▶ Validation</span><br><span class="line">                                   │</span><br><span class="line">                             400 ◀─┴─▶ preHandler Hook</span><br><span class="line">                                         │</span><br><span class="line">                               4**/5** ◀─┴─▶ beforeHandler</span><br><span class="line">                                               │</span><br><span class="line">                                     4**/5** ◀─┴─▶ User Handler</span><br><span class="line">                                                     │</span><br><span class="line">                                                     └─▶ Reply</span><br><span class="line">                                                          │ │</span><br><span class="line">                                                          │ └─▶ Outgoing Response</span><br><span class="line">                                                          │</span><br><span class="line">                                                          └─▶ onResponse Hook</span><br></pre></td></tr></table></figure>
<h3 id="Reply"><a href="#Reply" class="headerlink" title="Reply"></a>Reply</h3><p>The second parameter of the handler function is <code>Reply</code>.</p>
<p>Reply is a core Fastify object that exposes the following functions:</p>
<ul>
<li><p>.code(statusCode)</p>
</li>
<li><p>.header(name, value)</p>
</li>
<li><p>.type(value): Set the header <code>Content-Type</code></p>
</li>
<li><p>.redirect([code, ] url): default code 302</p>
</li>
<li><p>.serializer(function): Set a custom serializer for the payload</p>
</li>
<li><p>.send(payload)</p>
</li>
<li><p>.sent: A boolean value that you can use if you need to know it <code>send</code> has already been called.</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fastify.get(<span class="hljs-string">'/'</span>, options, (request, reply) =&gt; &#123;</span><br><span class="line">  reply</span><br><span class="line">    .code(<span class="hljs-number">200</span>)</span><br><span class="line">    .type(<span class="hljs-string">'application/json'</span>)</span><br><span class="line">    .send(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><p>If not set via <code>reply.code</code>, the resulting <code>statusCode</code> will be <code>200</code></p>
<h4 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h4><p>Sets a custom header to the response.</p>
<p>If you not set a <code>Content-Type</code> header, Fastify assumes that you are using <code>application/json</code>, unless you are send a stream, in that case Fastify recognize it and sets the <code>Content-Type</code> at <code>application/octet-stream</code>.</p>
<h4 id="Redirect"><a href="#Redirect" class="headerlink" title="Redirect"></a>Redirect</h4><p>Redirects a request to the specified url, the status code is optional, default to <code>302</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reply.redirect(<span class="hljs-string">'/home'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h4><p>Sets the content type for the response.</p>
<p>It’s the shortcut for <code>reply.header(&#39;Content-Type&#39;, &#39;application/json&#39;)</code></p>
<h4 id="Serializer"><a href="#Serializer" class="headerlink" title="Serializer"></a>Serializer</h4><h4 id="Send"><a href="#Send" class="headerlink" title="Send"></a>Send</h4><h4 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h4><p>If you are sending JSON Objects, send will serialize the object with <code>fast-json-stringify</code> if you setted an output schema, otherwise <code>fast-safe-stringify</code></p>
<h4 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h4><p>Send handle natively the promsies and supports out of the box async-await:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fastify.get(<span class="hljs-string">'/promises'</span>, options, (req, reply) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Prmise(<span class="hljs-comment">/*...*/</span>)</span><br><span class="line">  reply</span><br><span class="line">    .code(<span class="hljs-number">200</span>)</span><br><span class="line">    .send(promise)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fastify.get(<span class="hljs-string">'/async-await'</span>, options, <span class="hljs-keyword">async</span> (req, reply) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(resolve, <span class="hljs-number">200</span>, &#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="hljs-keyword">return</span> res</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h4><p>Send can also handle streams out of box, internally uses <code>pump</code> to avoid leaks of file description. If you are sneding a stream and you have not setted a <code>Content-Type</code> header, send will set it at <code>application/octet-stream</code>.</p>
<h4 id="Errors"><a href="#Errors" class="headerlink" title="Errors"></a>Errors</h4><p>If you pass to send an object that is an instance of Error, Fastify will automatically create error structured as the following:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  error: string, <span class="hljs-comment">// the http error message</span></span><br><span class="line">  message: string, <span class="hljs-comment">// the user error message</span></span><br><span class="line">  statusCode: number, <span class="hljs-comment">// the http status code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h3><p>The first parameter of the handler function is <code>Request</code>.</p>
<p>Request is a core Fastify object containing the following fields: </p>
<ul>
<li><p>query</p>
</li>
<li><p>body</p>
</li>
<li><p>params: the params matching the URL</p>
</li>
<li><p>headers</p>
</li>
<li><p>req: the incoming HTTP request from Node core</p>
</li>
<li><p>log</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fastify.post(<span class="hljs-string">'/:params'</span>, options, (req, reply) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(request.body)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(request.query)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(request.params)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(request.headers)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(request.req)</span><br><span class="line">  request.log.info(<span class="hljs-string">'some info'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Content-Type-Parser"><a href="#Content-Type-Parser" class="headerlink" title="Content Type Parser"></a>Content Type Parser</h3><p>Natively Fastify supports only <code>application/json</code> content-type. If you need to support different content types you can use the <code>addContentTypeParser</code> api.</p>
<h4 id="Catch-All"><a href="#Catch-All" class="headerlink" title="Catch All"></a>Catch All</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fastify.addContentTypeParser(<span class="hljs-string">'*'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, done</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">var</span> data = <span class="hljs-string">''</span></span><br><span class="line">  req.on(<span class="hljs-string">'data'</span>, chunk =&gt; &#123;data += chunk&#125;)</span><br><span class="line">  req.on(<span class="hljs-string">'end'</span>, () =&gt; done(data))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h3><p>Fastify allows the user to extend its functionalities with plugins. A plugin can be a set of routes, a server decorator or whatever.</p>
<p>The API you will need for one or more plugins is <code>register</code>.</p>
<p>By default, <code>register</code> creates a <strong>new scope</strong>, this means that if you do some changes to the Fastify instance(via decorate), this change will not be reflected to the current context ancestors, but only to its sons.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fastify.register(plugin, [options])</span><br><span class="line"></span><br><span class="line">fastify.register([</span><br><span class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./another-route'</span>),</span><br><span class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./yet-another-route'</span>),</span><br><span class="line">], opts)</span><br></pre></td></tr></table></figure>
<h3 id="Craete-a-Plugin"><a href="#Craete-a-Plugin" class="headerlink" title="Craete a Plugin"></a>Craete a Plugin</h3><p>Create a plugin is very easy, you just need to create a function that takes three paremters, the <code>fastify</code> instance, an options object and the next callback.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">fastify, opts, next</span>) =&gt;</span> &#123;</span><br><span class="line">  fastify.decorate(<span class="hljs-string">'utility'</span>, () =&gt; &#123;&#125;)</span><br><span class="line">  fastify.get(<span class="hljs-string">'/'</span>, handler)</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Handle-the-Scope"><a href="#Handle-the-Scope" class="headerlink" title="Handle the Scope"></a>Handle the Scope</h4><p>You have two ways to tell Fastify to avoid the creation of a new context:</p>
<ul>
<li><p>Use the <code>fastify-plugin</code> module</p>
</li>
<li><p>Use the <code>skip-override</code> hidden property</p>
</li>
</ul>
<p>We recomended to use the <code>fastify-plugin</code> module, because it solves this problem for you, and you can pass as parameter a version range of Fastify taht your plguin support.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> fp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify-plguin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = fp(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fastify, opts, next</span>) </span>&#123;</span><br><span class="line">  fastify.decorate(<span class="hljs-string">'utility'</span>, () =&gt; &#123;&#125;)</span><br><span class="line">  next()</span><br><span class="line">&#125;, <span class="hljs-string">'0.x'</span>)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-03T14:04:53.000Z">2017-10-03</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 386 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/03/Apollo-with-TypeScript/">Apollo With TypeScript</a>
            
        </h1>
        <div class="content">
            <p><a href="https://dev-blog.apollodata.com/getting-started-with-typescript-and-apollo-a9aa2c7dcf87" target="_blank" rel="noopener">Origin</a></p>
<p>Start with a simple React Component wrapped with the <code>graphql</code> higher order component from React Apollo.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> gql <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql-tag'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; graphql &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-apollo'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> HERO_QUERY = gql<span class="hljs-string">`</span></span><br><span class="line"><span class="hljs-string">  query GetCharacter($episode: Episodi!) &#123;</span></span><br><span class="line"><span class="hljs-string">    hero(episode: $episode) &#123;</span></span><br><span class="line"><span class="hljs-string">      name</span></span><br><span class="line"><span class="hljs-string">      id</span></span><br><span class="line"><span class="hljs-string">      friends &#123;</span></span><br><span class="line"><span class="hljs-string">        name</span></span><br><span class="line"><span class="hljs-string">        id</span></span><br><span class="line"><span class="hljs-string">        appearsIn</span></span><br><span class="line"><span class="hljs-string">      &#125;</span></span><br><span class="line"><span class="hljs-string">    &#125;</span></span><br><span class="line"><span class="hljs-string">  &#125;</span></span><br><span class="line"><span class="hljs-string">`</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> withCharacter = graphql(HERO_QUER, &#123;</span><br><span class="line">  options: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;</span><br><span class="line">    variables: &#123; <span class="hljs-attr">episode</span>: <span class="hljs-string">'JEDI'</span> &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> withCharacter(<span class="hljs-function">(<span class="hljs-params">&#123; data: &#123; loading, hero, error &#125;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (loading) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> &lt;div&gt;Loading&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> &lt;div&gt;Error&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;hero &amp;&amp;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;h3&gt;&#123;hero.name&#125;&lt;<span class="hljs-regexp">/h3&gt;</span></span><br><span class="line"><span class="hljs-regexp">          &#123;hero.friends.map(friend =&gt; &lt;h6 key=&#123;friend.i&#125;&gt;&#123;friend.name&#125;&lt;/</span>h6&gt;&#125;&gt;&lt;/h6&gt;)&#125;</span><br><span class="line">        &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &#125;</span></span><br><span class="line"><span class="hljs-regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>The above code pulls some data from a GraphQL API using a query and includes lifecycle information, such as loading and error information.</p>
<p>With a few minor changes, we can tell TypeScript how to support us in writing code within this render function.</p>
<ul>
<li>We need to tell TS what the shape of our data from our graphql server will look like. We manually write the types for our response data.</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">export</span> type Hero &#123;</span><br><span class="line">  name: string</span><br><span class="line">  id: string</span><br><span class="line">  appearsIn: string[]</span><br><span class="line">  friends: Hero[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> type Response &#123;</span><br><span class="line">  hero: Hero</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> withCharacter = graphql&lt;Response&gt;(HERO_QUERY, &#123;</span><br><span class="line">  options: <span class="hljs-function">(<span class="hljs-params">&#123;episode&#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">    variables: &#123; episode &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>The last line is where the magic happens. We tell TS what the shape of the result will look like from the server when the graphql enhancer wraps a component.</li>
</ul>
<p>If you already had your project set up with TS, and have already typed your response data, all you have to do is add the type to the <code>graphql</code> HOC and you are off!</p>
<h3 id="Take-Control-of-Your-Tree"><a href="#Take-Control-of-Your-Tree" class="headerlink" title="Take Control of Your Tree"></a>Take Control of Your Tree</h3><p>Wrapped components are almost always exported and used by a component somewhere else in your tree, so if your exported component has prop requirements, we need to tell TS so it can help prevent errors elsewhere in our tree. Since the <code>graphql</code> wrapper suppors polymorphic types, we can use the second type parameter of it to do just that.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">export</span> type InputProps = &#123;</span><br><span class="line">  episode: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> withCharacter = graphql&lt;Response, InputProps&gt;(HERO_QUERY, &#123;</span><br><span class="line">  options: <span class="hljs-function">(<span class="hljs-params">&#123; episode &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">    variables: &#123; episode &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Then the code looks like:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> ApolloClient, &#123; createNetworkInterface &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'apollo-client'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; ApolloProvider &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-apollo'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> Character <span class="hljs-keyword">from</span> <span class="hljs-string">'./Character'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> networkInterface = createNetworkInterface(&#123;</span><br><span class="line">  uri: <span class="hljs-string">'https://mpjk0plp9.lp.gql,zone/graphql'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> ApolloClient(&#123;</span><br><span class="line">  networkInterface,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> () =&gt; (</span><br><span class="line">  &lt;ApolloProvider client=&#123;client&#125;&gt;</span><br><span class="line">    &lt;Character /&gt;</span><br><span class="line">  &lt;<span class="hljs-regexp">/ApolloProvider&gt;</span></span><br><span class="line"><span class="hljs-regexp">)</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-30T02:12:20.000Z">2017-09-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 230 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/30/source-code-of-koa-static/">Source Code of Koa-Static</a>
            
        </h1>
        <div class="content">
            <h3 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Module Dependencies</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">'debug'</span>)(<span class="hljs-string">'koa-static'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">'assert'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> send = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-send'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Expose `serve()`</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = serve</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Serve static files from `root`</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;String&#125; root</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Object&#125; [opts]</span></span><br><span class="line"><span class="hljs-comment"> * @return &#123;Function&#125;</span></span><br><span class="line"><span class="hljs-comment"> * @api public</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serve</span> (<span class="hljs-params">root, opts</span>) </span>&#123;</span><br><span class="line">  opts = opts || &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="hljs-comment">// ensure `root`</span></span><br><span class="line">  assert(root, <span class="hljs-string">'root directory is required to serve files'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// options</span></span><br><span class="line">  debug(<span class="hljs-string">'static %s %j'</span>, root, opts)</span><br><span class="line">  <span class="hljs-comment">// set opts.root to absolute one</span></span><br><span class="line">  opts.root = resolve(root)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// set default static file</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (opts.index !== <span class="hljs-literal">false</span>) opts.index = opts.index || <span class="hljs-string">'index.html'</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// if defer is supported</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (!opts.defer) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serve</span> (<span class="hljs-params">ctx, next</span>) </span>&#123;</span><br><span class="line">      <span class="hljs-keyword">let</span> done = <span class="hljs-literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="hljs-keyword">if</span> (ctx.method === <span class="hljs-string">'HEAD'</span> || ctx.method === <span class="hljs-string">'GET'</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">          done = <span class="hljs-keyword">await</span> send(ctx, ctx.path, opts)</span><br><span class="line">        &#125; <span class="hljs-keyword">catch</span> (err) &#123;</span><br><span class="line">          <span class="hljs-keyword">if</span> (err.status !== <span class="hljs-number">404</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">throw</span> err</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="hljs-keyword">if</span> (!done) &#123;</span><br><span class="line">        <span class="hljs-keyword">await</span> next()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  retrun <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serve</span> (<span class="hljs-params">ctx, next</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">await</span> next()</span><br><span class="line">    <span class="hljs-keyword">if</span>(ctx.method !== <span class="hljs-string">'HEAD'</span> &amp;&amp; ctx.method !== <span class="hljs-string">'GET'</span>) <span class="hljs-keyword">return</span></span><br><span class="line">    <span class="hljs-comment">// response is already handled</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (ctx.body != <span class="hljs-literal">null</span> || ctx.status !== <span class="hljs-number">404</span>) <span class="hljs-keyword">return</span></span><br><span class="line">  </span><br><span class="line">    <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">await</span> send(ctx, ctx.path, opts)</span><br><span class="line">    &#125; <span class="hljs-keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (err.status !== <span class="hljs-number">404</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">throw</span> err</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> Koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</span><br><span class="line">app.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-static'</span>)(root, opts))</span><br></pre></td></tr></table></figure>
<h3 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h3><ul>
<li><p>maxage: default to 0.</p>
</li>
<li><p>hidden: Allow transfer of hidden files, detault to false.</p>
</li>
<li><p>index: Default file name, detault to ‘index.html’.</p>
</li>
<li><p>defer: If true, serves after <code>return next()</code>.</p>
</li>
<li><p>gzip: default to true.</p>
</li>
<li><p>extensions: default to false.</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-29T06:30:53.000Z">2017-09-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 187 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/29/react-hot-loader-in-with-ts-loader/">React-Hot-Loader in Webpack With Ts-Loader</a>
            
        </h1>
        <div class="content">
            <p>It’s very easy to integrate <code>react-hot-loader</code> into webpack with <code>ts-loader</code>.</p>
<h3 id="Config-the-webpack"><a href="#Config-the-webpack" class="headerlink" title="Config the webpack"></a>Config the webpack</h3><h4 id="Add-Hot-Module-Replacement"><a href="#Add-Hot-Module-Replacement" class="headerlink" title="Add Hot Module Replacement"></a>Add Hot Module Replacement</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.entry</span></span><br><span class="line">app: [</span><br><span class="line">  <span class="hljs-string">'webpack/hot/only-dev-server'</span>,</span><br><span class="line">  <span class="hljs-string">'webpack-dev-server/client?http://localhost:8080'</span>,</span><br><span class="line">  path.resolve(__dirname, <span class="hljs-string">'./src'</span>),</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">  <span class="hljs-keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">devServer: &#123;</span><br><span class="line">  hot: <span class="hljs-literal">true</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Add-React-Hot-Loader-into-webpack"><a href="#Add-React-Hot-Loader-into-webpack" class="headerlink" title="Add React-Hot-Loader into webpack"></a>Add React-Hot-Loader into webpack</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// add react-hot-loader to entry point</span></span><br><span class="line"></span><br><span class="line">entry: [</span><br><span class="line">  <span class="hljs-string">'webpack/hot/only-dev-server'</span>,</span><br><span class="line">  <span class="hljs-string">'webpack-dev-server/client?http://localhost:8080'</span>,</span><br><span class="line">  <span class="hljs-string">'react-hot-loader/patch'</span>,</span><br><span class="line">  path.resolve(__dirname, <span class="hljs-string">'./src/'</span>),</span><br><span class="line">],</span><br><span class="line"><span class="hljs-comment">// add loader</span></span><br><span class="line"><span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">    &#123;</span><br><span class="line">      test: <span class="hljs-regexp">/\.tsx$/</span>,</span><br><span class="line">      use: [<span class="hljs-string">'react-hot-loader/webpack/'</span>, <span class="hljs-string">'ts-loader'</span>],</span><br><span class="line">      exclude: <span class="hljs-regexp">/node_modules/</span>,</span><br><span class="line">      include: path.resolve(__dirname, <span class="hljs-string">'./src'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Wrap-Root-Container-into-module-hot-accept"><a href="#Wrap-Root-Container-into-module-hot-accept" class="headerlink" title="Wrap Root Container into module.hot.accept"></a>Wrap Root Container into <code>module.hot.accept</code></h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'./router'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> Root = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./router'</span>).default</span><br><span class="line">    render(<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Root</span> /&gt;</span>, htmlDOM)</span></span><br><span class="line"><span class="hljs-xml">  &#125;)</span></span><br><span class="line"><span class="hljs-xml">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note, if you are using ts with babel-preset-es2015, you can set babel to ignore <code>es2015</code> module transform by</p>
</blockquote>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"presets"</span>: [[<span class="hljs-string">"es2015"</span>, &#123;<span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span>&#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>because webpack 3 has built-in support for ES2015 modules. You won’t need to re-require you root module.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'./router'</span>, () =&gt; &#123;</span><br><span class="line">    render(<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Root</span> /&gt;</span>, htmlDOM)</span></span><br><span class="line"><span class="hljs-xml">  &#125;)</span></span><br><span class="line"><span class="hljs-xml">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Same treatment in ts if your target is es6</p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-25T07:14:53.000Z">2017-09-25</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    33 minutes read (About 5017 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/25/Methods-of-Observable/">Methods of Observable</a>
            
        </h1>
        <div class="content">
            <p><a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-switchMap" target="_blank" rel="noopener">Origin</a><br><a href="https://rxviz.com" target="_blank" rel="noopener">Playground</a></p>
<h3 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h3><h5 id="Direct-Subclass"><a href="#Direct-Subclass" class="headerlink" title="Direct Subclass"></a>Direct Subclass</h5><ul>
<li><p>ConnectableObservable</p>
</li>
<li><p>GroupedObservable</p>
</li>
<li><p>Subject</p>
</li>
</ul>
<h5 id="Indirect-Subclass"><a href="#Indirect-Subclass" class="headerlink" title="Indirect Subclass"></a>Indirect Subclass</h5><ul>
<li><p>AnonymousSubject</p>
</li>
<li><p>AsyncSubject</p>
</li>
<li><p>BehaviorSubject</p>
</li>
<li><p>ReplaySubject</p>
</li>
</ul>
<h4 id="Static-Public-Methods"><a href="#Static-Public-Methods" class="headerlink" title="Static Public Methods"></a>Static Public Methods</h4><ul>
<li>bindCallback</li>
</ul>
<p><code>public static bindCallback(func: function, selector: function, schedular: Schedular): function(...params: *): Observable</code></p>
<p>Convert a callback API to a function that returns an Observable</p>
<blockquote>
<p>Give it a function f of type f(x, callback) and it will return a function g taht when called as g(x) will output an Observable.</p>
</blockquote>
<p><code>bindCallback</code> is not an operator because its input and output are not Observables.</p>
<p>The input is a function with some parameters, but the last parameter must be a callback function.</p>
<p>The output of the <code>bindCallback</code> is a function that takes the <strong>same</strong> parameters as original function takes, except the last one(the callback). When the output function is called with arguments, it will return an Observable.</p>
<p>If the original function’s callback takes one argument, the Observable will emit that value. If on the other hand callback is called with multiple values, resulting Observable will emit an array with these argumetns.</p>
<h5 id="More-in-Origin-Article"><a href="#More-in-Origin-Article" class="headerlink" title="More in Origin Article"></a>More in Origin Article</h5><ul>
<li>bindNodeCallback</li>
</ul>
<p><code>public static bindNodeCallback(func: function, scheduler: Schedular): function(...param: *): Observable</code></p>
<ul>
<li>combineLatest</li>
</ul>
<p><code>public static combineLatest(observable1: ObservableInput, observable2: ObservableInput, project: function, schedular: Schedular): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/combineLatest.png" alt=""></p>
<p>Combines multiple Observables to create an Observable whose values are calculated from the latest values of each of its input Observables.</p>
<blockquote>
<p><strong>Whenever</strong> any input Observable emits a value, it computes a formula using the latest values from all the inputs, then emits the output of the formula.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// combine two timer Observable</span></span><br><span class="line"><span class="hljs-keyword">const</span> firstTimer = Rx.Observable.timer(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> secondTimer = Rx.Observable.timer(<span class="hljs-number">500</span>, <span class="hljs-number">1000</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> combineTimers = Rx.Observable.combineLatest(firstTimer, secondTimer)</span><br><span class="line">combineTimers.subscribe(<span class="hljs-built_in">console</span>.log)</span><br><span class="line"><span class="hljs-comment">// logs</span></span><br><span class="line"><span class="hljs-comment">// [0, 0] after 0.5s, triggered by secondTimer</span></span><br><span class="line"><span class="hljs-comment">// [1, 0] after 1s, triggered by firstTimer</span></span><br><span class="line"><span class="hljs-comment">// [1, 1.5] after 1.5s, triggered by secondTimer</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// combine an array of observable</span></span><br><span class="line"><span class="hljs-keyword">const</span> observables = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>].map(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> Rx.Observable.of(n).delay(n * <span class="hljs-number">1000</span>).startWith(<span class="hljs-number">0</span>))</span><br><span class="line"><span class="hljs-keyword">const</span> combined = Rx.Observable.combineLatest(observables)</span><br><span class="line">combined.subscribe(<span class="hljs-built_in">console</span>.log)</span><br><span class="line"><span class="hljs-comment">// logs</span></span><br><span class="line"><span class="hljs-comment">// [0, 0, 0] immediately</span></span><br><span class="line"><span class="hljs-comment">// [1, 0, 0] after 1s triggered by observables[0]</span></span><br><span class="line"><span class="hljs-comment">// [1, 2, 0] after 2s triggered by observables[1]</span></span><br><span class="line"><span class="hljs-comment">// [1, 2, 4] after 4s triggered by observables[2]</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// use project function to dynamically calculate the body-mass index</span></span><br><span class="line"><span class="hljs-keyword">const</span> weight = Rx.Observable.of(<span class="hljs-number">70</span>, <span class="hljs-number">72</span>, <span class="hljs-number">76</span>, <span class="hljs-number">79</span>, <span class="hljs-number">75</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> height = Rx.Observable.of(<span class="hljs-number">1.76</span>, <span class="hljs-number">1.77</span>, <span class="hljs-number">1.78</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> bmi = Rx.Observable.combineLatest(weight, height, (w, h) =&gt; w/(h*h))</span><br><span class="line">bmi.subscribe(<span class="hljs-built_in">console</span>.log)</span><br><span class="line"><span class="hljs-comment">// With output to console:</span></span><br><span class="line"><span class="hljs-comment">// BMI is 24.212293388429753</span></span><br><span class="line"><span class="hljs-comment">// BMI is 23.93948099205209</span></span><br><span class="line"><span class="hljs-comment">// BMI is 23.671253629592222</span></span><br></pre></td></tr></table></figure>
<ul>
<li>concat</li>
</ul>
<p><code>public static concat(input1: ObservableInput, input2: ObservableInput, scheduler: Schedular): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/concat.png" alt=""></p>
<p>Creates an output Observable which sequentially emits all values from given Observable and then moves on to the next.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Concatenate a timer counting form 0 to 3 with a synchronous sequence from 1 to 10</span></span><br><span class="line"><span class="hljs-keyword">var</span> timer = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">4</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> sequence = Rx.Observable.range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.concat(timer, sequence)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// concatenate an array of 3 Observables, different from the one above</span></span><br><span class="line"><span class="hljs-keyword">var</span> timer1 = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">10</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> timer2 = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">6</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> timer3 = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">10</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.concat([timer1, timer2, timer3])</span><br></pre></td></tr></table></figure>
<ul>
<li>create</li>
</ul>
<p><code>public static create(onSubscription: function(observer: Observer): TearDownLogic): Observable</code></p>
<p>Creates a new Observable, that will execute the specified function when an Observer subscribes to it.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> observable = Rx.Observable.create(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">observer</span>) </span>&#123;</span><br><span class="line">  observer.next(<span class="hljs-number">1</span>)</span><br><span class="line">  observer.next(<span class="hljs-number">2</span>)</span><br><span class="line">  observer.next(<span class="hljs-number">3</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>defer</li>
</ul>
<p><code>public static defer(observableFactory: function(): SubscribableOrPromise): Observable</code></p>
<p>Creates an Observable that, on subscribe, calls an Observable factory to make an Observable for each new Observer</p>
<blockquote>
<p>Creates the Observable lazily, that is, only when it is subscribed.</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/defer.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// when defer is called, it returns an Observable</span></span><br><span class="line"><span class="hljs-keyword">var</span> clicksOrInterval = Rx.Observable.defer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.5</span>) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> Rx.Observable.interval(<span class="hljs-number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>empty</li>
</ul>
<p><code>public static empty(scheduler: Scheduler): Observable</code></p>
<p>Creates an Observable that emits no items to the Observer and immediately emits a completion notification.</p>
<blockquote>
<p>Just emits ‘complete’ and nothing else</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/empty.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.empty().startWith(<span class="hljs-number">8</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>from</li>
</ul>
<p><code>public static from(ish: ObservableInput&lt;T&gt;, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p>Creates an Observable from an Array, an array-like Object, a Promise, an iterable object, or an Observable-like Object</p>
<blockquote>
<p>Convert almost anything to an Observable</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/from.png" alt=""></p>
<ul>
<li>fromEvent</li>
</ul>
<p><code>public static fromEvent(target: EventTargetLike, eventName: string, options: EventListenerOptions, selector: SelectorMethodSignature&lt;T&gt;): Observable&lt;T&gt;</code></p>
<blockquote>
<p>Creates an Observable from DOM events, or Node EventEmitter events or others</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/fromEvent.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>fromEventPattern</li>
</ul>
<p><code>public static fromEventPattern(addHandler: function(handler: Function): any, removeHandler: function(handler: Function, signal?: any): void, selector: function(...args: any): T): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/fromEventPattern.png" alt=""></p>
<blockquote>
<p>Converts any addHandler/removeHandler API to an Observable</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addClickHandler</span>(<span class="hljs-params">handler</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'click'</span>, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeClick</span>(<span class="hljs-params">handler</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">'click'</span>, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEventPattern(</span><br><span class="line">  addClickHandler,</span><br><span class="line">  removeClickHandler,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li>fromPromise</li>
</ul>
<p><code>public static fromPromise(promise: Promise&lt;T&gt;, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<blockquote>
<p>Returns an Observable that just emit the Promise’s resolved value, then complete</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.fromPromise(fetch(<span class="hljs-string">'reqres.in/api/users'</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>interval</li>
</ul>
<p><code>public static interval(period: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/interval.png" alt=""></p>
<blockquote>
<p>Emits incremental numbers periodically in time</p>
</blockquote>
<ul>
<li>merge</li>
</ul>
<p><code>public static merge(observables: ...ObservableInput, concurrent: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/merge.png" alt=""></p>
<p>Creates an output Observable which concurrently emits all values from every given input Observable</p>
<blockquote>
<p>Flatten multiple Observables together by blending their values into one Observable</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> timer = Rx.Observable.interval(<span class="hljs-number">1000</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> clicksOrTimer = Rx.Observable.merge(clicks, timer)</span><br></pre></td></tr></table></figure>
<ul>
<li>never</li>
</ul>
<p><code>public static never(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/never.png" alt=""></p>
<p>Creates an Observable that emits no items to the Observer</p>
<blockquote>
<p>An Observable that never emits anything</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.never().startWith(<span class="hljs-number">7</span>).subscribe(<span class="hljs-built_in">console</span>.log)</span><br><span class="line"><span class="hljs-comment">// won't console 7</span></span><br></pre></td></tr></table></figure>
<ul>
<li>of</li>
</ul>
<p><code>public static of(values: ...T, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/of.png" alt=""></p>
<p>Creates an Observbale that emits some values you specify as arguments, immediately one after the other, and then emits a complete notification.</p>
<blockquote>
<p>Emits the arguments you provide, then complete.</p>
</blockquote>
<ul>
<li>range</li>
</ul>
<p><code>public static range(start: number, count: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/range.png" alt=""></p>
<p>Creates an Observable that emits a sequence of numbers within a specified range.</p>
<blockquote>
<p>Emits a sequence of numbers in a range</p>
</blockquote>
<ul>
<li>throw</li>
</ul>
<p><code>public static throw(error: any, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/throw.png" alt=""></p>
<blockquote>
<p>Just emit ‘error’ and nothing else.</p>
</blockquote>
<ul>
<li>timer</li>
</ul>
<p><code>public static timer(initialDelay: number|Date, period: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/timer.png" alt=""></p>
<p>Creates an Observable that starts emitting after an <code>initialDelay</code> and emits ever increasing numbers after each <code>period</code> of time thereafter.</p>
<blockquote>
<p>It’s like interval, but you can specify when should the emissions start.</p>
</blockquote>
<ul>
<li>webSocket</li>
</ul>
<p><code>public static webSocket(urlConfigOrSource: string | WebSocketSubjectConfig): Observable</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> subject = Rx.Observable.webSocket(<span class="hljs-string">'ws://localhost:8001'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>zip</li>
</ul>
<p><code>public static zip(observables: *): Observable&lt;R&gt;</code></p>
<p>Combines multiple Observables to create an Observable whose values are calculated from the valeus, in order, of each of its input Observables.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> age$ = Rx.Observable.of(<span class="hljs-number">27</span>, <span class="hljs-number">25</span>, <span class="hljs-number">29</span>)</span><br><span class="line"><span class="hljs-keyword">let</span> name$ = Rx.Observable.of(<span class="hljs-string">'Foo'</span>, <span class="hljs-string">'Bar'</span>, <span class="hljs-string">'Beer'</span>)</span><br><span class="line"><span class="hljs-keyword">let</span> isDev$ = Rx.Observable.of(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>)</span><br><span class="line"></span><br><span class="line">Rx.Observable.zip(age$, name$, isDev$, (age, name, isDev) =&gt; (&#123;age, name, isDev&#125;))</span><br><span class="line"><span class="hljs-comment">// outputs</span></span><br><span class="line"><span class="hljs-comment">// &#123; age: 27, name: 'Foo', isDev: true &#125;</span></span><br><span class="line"><span class="hljs-comment">// &#123; age: 25, name: 'Bar', isDev: true &#125;</span></span><br><span class="line"><span class="hljs-comment">// &#123; age: 29, name: 'Beer', isDev: false &#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>constructor</li>
</ul>
<p><code>public constructor (subsribe: Function)</code></p>
<ul>
<li>audit</li>
</ul>
<p><code>public audit(durationSelector: function(value: T): SubscribableOrPromise): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/audit.png" alt=""></p>
<p>Ignores source value for a duration determined by another Observable, then emis the most recent value from the source Observable, then repeats this process.</p>
<blockquote>
<p>It’s like auditTime, but the silencing duration is determined by a second Observable.</p>
</blockquote>
<p><code>audit</code> is similar to <code>throttle</code>, but emits the last value from the silenced time window.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> result = clicks.audit(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>auditTime</li>
</ul>
<p><code>public auditTime(duration: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/auditTime.png" alt=""></p>
<p>Ignores source values for <code>duration</code> milliseconds, then emits the most recent value from the source Observable, then repeats this process.</p>
<p>Similar to <code>throttleTime</code></p>
<ul>
<li>buffer</li>
</ul>
<p><code>public buffer(closingNotifier: Observable&lt;any&gt;): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/buffer.png" alt=""></p>
<p>Buffers the source Observable values until <code>closingNotifier</code> emits.</p>
<blockquote>
<p>Collect values from the past as an array, and emits that array when another Observable emits.</p>
</blockquote>
<ul>
<li>bufferCount</li>
</ul>
<p><code>public bufferCount(bufferSize: number, startBufferEvery: number): Observable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferCount.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> interval = Rx.Observable.interval(<span class="hljs-number">1000</span>)</span><br><span class="line">interval.bufferCount(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>bufferTime</li>
</ul>
<p><code>public bufferTime(bufferTimeSpan: number, bufferCreationIntervel: number, maxBufferSize: number, scheduler: Scheduler): Observable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferTime.png" alt=""></p>
<p>Buffers the source Observable values for a specific time period.</p>
<blockquote>
<p>Collect values from the past as an array, and emits those array periodically in time.</p>
</blockquote>
<ul>
<li>bufferToggle</li>
</ul>
<p><code>public bufferToggle(openings: SubscribableOrPromise&lt;O&gt;, closingSelector: function(value: O): SubscribableOrPromise): Observable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferToggle.png" alt=""></p>
<ul>
<li>bufferWhen</li>
</ul>
<p><code>public bufferWhen(closingSelector: function(): Obversable): Obversable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferWhen.png" alt=""></p>
<p>Buffers the source Observable values, using a factory function of closing Observables to determine when to close, emit and reset the buffer.</p>
<ul>
<li>catch</li>
</ul>
<p><code>public catch(selector: function): Obversable</code></p>
<p><img src="http://reactivex.io/rxjs/img/catch.png" alt=""></p>
<p>Catches errors on the observable to be handled by returning a new obversable or throwing an error.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)</span><br><span class="line">.map(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (n === <span class="hljs-number">4</span>) <span class="hljs-keyword">throw</span> <span class="hljs-string">'four'</span></span><br><span class="line">  <span class="hljs-keyword">return</span> n</span><br><span class="line">&#125;).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> Rx.Observable.of(<span class="hljs-string">'I'</span> , <span class="hljs-string">'II'</span>, <span class="hljs-string">'III'</span>, <span class="hljs-string">'IV'</span>, <span class="hljs-string">'V'</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>combineAll</li>
</ul>
<p><code>public combineAll(project: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/combineAll.png" alt=""></p>
<p>Convert a higher-order Observable into a first-order Observable by waiting for the outer Observable to complete, then applying <code>combineLatest</code></p>
<p>Similar to CombineLatest</p>
<blockquote>
<p>Flatten an Observable-of-Observables by applying combineLatest when the Observable-of-Observable completes</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>);</span><br><span class="line"><span class="hljs-keyword">var</span> higherOrder = clicks.map(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span></span><br><span class="line">  Rx.Observable.interval(<span class="hljs-built_in">Math</span>.random()*<span class="hljs-number">2000</span>).take(<span class="hljs-number">13</span>)</span><br><span class="line">).take(<span class="hljs-number">3</span>);</span><br><span class="line"><span class="hljs-keyword">var</span> result = higherOrder.combineAll();</span><br></pre></td></tr></table></figure>
<ul>
<li>combineLatest</li>
</ul>
<p><code>public combineLatest(other: ObservableInput, project: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/combineLatest.png" alt=""></p>
<p>Combines multiple Observables to create an Observable whose values are calculated from the latest values of each of its input Observable.</p>
<ul>
<li>concat</li>
</ul>
<p><code>public concat(other: ObservableInput, scheduler: Scheduler): Observable</code></p>
<ul>
<li>concatAll</li>
</ul>
<p><code>public concatAll(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/concatAll.png" alt=""></p>
<p>Converts a higher-order Observable into a first-order Observable by concatenating the inner Observable in order.</p>
<blockquote>
<p>Flatten an Observable-of-Observable by putting one inner Observable after the other</p>
</blockquote>
<ul>
<li>concatMap</li>
</ul>
<p><code>public concatMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/concatMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable, in a serialized fashion waiting for each one to complete before merging the next.</p>
<p>Map =&gt; Concat</p>
<blockquote>
<p>Map each value to an Observable, then flatten all of these inner Observables using concatAll</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> result = clicks.concatMap(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">4</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>concatMaoTo</li>
</ul>
<p><code>public concatMapTo(innerObservable: ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observer</code></p>
<p><img src="http://reactivex.io/rxjs/img/concatMapTo.png" alt=""></p>
<blockquote>
<p>It’s like concatMap, but maps each value always to the same inner Observable</p>
</blockquote>
<ul>
<li>count</li>
</ul>
<p><code>public count(predicate: function(value: T, i: number, source: Observable&lt;T&gt;): boolean): Observable</code></p>
<p>Counts the number of emissions on the source and emits the number when the source completes.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// count how many seconds have passed before the first click</span></span><br><span class="line"><span class="hljs-keyword">var</span> seconds = Rx.Observable.interval(<span class="hljs-number">1000</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> secondsBeforeClick = seconds.takeUntil(clicks)</span><br><span class="line">secondsBeforeClick.count()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// count how many odd numbers are there between 1 and 7</span></span><br><span class="line"><span class="hljs-keyword">var</span> numbers = Rx.Observable.range(<span class="hljs-number">1</span>, <span class="hljs-number">7</span>)</span><br><span class="line">numbers.count(<span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> i % <span class="hljs-number">2</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>debounce</li>
</ul>
<p><code>public debounce(durationSelector: function(value: T): SubscribableOrPromise): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/debounce.png" alt=""></p>
<p>Emits a value from the source Observable only after a particular time span determined by another Observable has passes without another source emission.</p>
<blockquote>
<p>It’s like debounceTime, but the time span of emission silence is determined by a second Observable.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> result = clicks.debounce(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>debounceTime</li>
</ul>
<p><code>public debounceTime(dueTime: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/debounceTime.png" alt=""></p>
<p>Emits a value from the source Observable only after a particular time span has passed without another source emission.</p>
<blockquote>
<p>It’s like delay, but passes only the most recent value from each burst of emissions.</p>
</blockquote>
<ul>
<li>defaultEmpty</li>
</ul>
<p><img src="http://reactivex.io/rxjs/img/defaultIfEmpty.png" alt=""></p>
<p><code>public defaultIfEmpty(defaultValue: any): Observable</code></p>
<p>Emits a given value if the source Observable completes without emitting any <code>next</code> value, otherwise mirrors the source Observable.</p>
<blockquote>
<p>If the source Observable turns out to be empty, then this operator will emit a default value.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> clicksBeforeFive = clicks.takeUntil(Rx.Observable.interval(<span class="hljs-number">5000</span>))</span><br><span class="line">clicksBeforeFive.defaultIfEmpty(<span class="hljs-string">'no click'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>delay</li>
</ul>
<p><code>public delay(delay: number|Date, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/delay.png" alt=""></p>
<p>Delays the emission of items from the source Observable by a given timeout or until a given Date.</p>
<ul>
<li>delayWhen</li>
</ul>
<p><code>public delayWhen(delayDurationSelector: function(value: T): Observable): Observable</code></p>
<blockquote>
<p>It’s like delay, but the time span of the delay duration is determined by a second Observable.</p>
</blockquote>
<ul>
<li>dematerialize</li>
</ul>
<p><code>public dematerialize(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/dematerialize.png" alt=""></p>
<p>Convert an Observable of Notification objects into the emissions that they represent.</p>
<blockquote>
<p>Unwraps Notification objects as actual next, error, and complete emissions. The opposite of materialize.</p>
</blockquote>
<p><code>dematerialize</code> is assumed to operate an Observable that only emits <code>Notification</code> objects as <code>next</code> emission, and does not emit any <code>error</code>. Such Observable is the output of a <code>materialize</code> operation. Those notifications are then unwrapped using the metadata they contain, and emitted as <code>next</code>, <code>error</code>and <code>complete</code> on the output Observable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> notiA = <span class="hljs-keyword">new</span> Rx.Notification(<span class="hljs-string">'N'</span>, <span class="hljs-string">'A'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> notiB = <span class="hljs-keyword">new</span> Rx.Notification(<span class="hljs-string">'N'</span>, <span class="hljs-string">'B'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> notiE = <span class="hljs-keyword">new</span> Rx.Notification(<span class="hljs-string">'E'</span>, <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'x.toUpperCase is not a function'</span>))</span><br><span class="line"><span class="hljs-keyword">var</span> materialized = Rx.Observable.of(notiA, notiB, notiE)</span><br><span class="line"><span class="hljs-keyword">var</span> upperCase = materialized.dematerialize()</span><br></pre></td></tr></table></figure>
<ul>
<li>distinct</li>
</ul>
<p><code>public distinct(keySelector: function, flushes: Observable): Observable</code></p>
<p>Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from previous item<strong>s</strong>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">67</span>,<span class="hljs-number">6</span>,<span class="hljs-number">6</span>,).distinct()</span><br><span class="line"><span class="hljs-comment">// 1,2,3,4,5,67,6</span></span><br><span class="line"><span class="hljs-comment">// repeated 1 omitted</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// keySelector</span></span><br><span class="line">interface Person &#123;</span><br><span class="line">  age: number</span><br><span class="line">  name: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Rx.Observable.of&lt;Person&gt;(</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bar'</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</span><br><span class="line">).distinct(<span class="hljs-function">(<span class="hljs-params">p: Person</span>) =&gt;</span> p.name)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note: ‘1’ is different from 1</p>
</blockquote>
<ul>
<li>distinctUntilChanged</li>
</ul>
<p><code>public distinctUntilChanged(compare: function): Observable</code></p>
<p>Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from the previous item. (not items)</p>
<ul>
<li>distinctUntilKeyChanged</li>
</ul>
<p><code>public distinctUntilKeyChanged(key: string, compare: function): Observable</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface Person &#123;</span><br><span class="line">  age: number</span><br><span class="line">  name: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Rx.Observable.of&lt;Person&gt;(</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bar'</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">naem</span>: <span class="hljs-string">'For'</span> &#125;,</span><br><span class="line">).distinctUntilKeyChanged(<span class="hljs-string">'name'</span>, (x: string, <span class="hljs-attr">y</span>: string) =&gt; x.substring(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) === y.substring(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>do</li>
</ul>
<p><code>public do(nextOrObserver: Observer|function, error: function, complete: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/do.png" alt=""></p>
<p>Perform a <strong>side effect</strong> for every emission on the source Observable, but return an Observable that is <strong>identical</strong> to the source.</p>
<blockquote>
<p>Intercepts each emission on the source and runs a function, but returns an output which is identical to the source.</p>
</blockquote>
<ul>
<li>elemetnAt</li>
</ul>
<p><code>public elementAt(index: number, defaultValue: T): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/elementAt.png" alt=""></p>
<p>Emits the single value at the specified <code>index</code> in a sequence of emissions from the source Observable.</p>
<blockquote>
<p>Emits only the i-th value , then completes.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line">clicks.elementAt(<span class="hljs-number">2</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>every</li>
</ul>
<p><code>public every(predicate: function, thisArg: any): Observable</code></p>
<p>Returns an Observable that emits whether or not every item of the source satisfies the condition specified.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// all elements are less than 5, otherwise false</span></span><br><span class="line">Observable.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)</span><br><span class="line">  .every(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x &lt; <span class="hljs-number">5</span>)</span><br><span class="line">  .subscribe(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(x)); <span class="hljs-comment">// -&gt; false</span></span><br></pre></td></tr></table></figure>
<ul>
<li>exhaust</li>
</ul>
<p><code>public exhaust(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/exhaust.png" alt=""></p>
<p>Convert a higher-order Observable into a first-order Observable by dropping inner Observables while the previoud inner Observable has not yet completed.</p>
<blockquote>
<p>Flatten an Observable-of-Observables by dropping the next inner Observable while the current inner is still executing.</p>
</blockquote>
<p><code>exhaust</code> ingores every new inner Observable if the previous Observable has not yet completed.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> higherOrder = clicks.map(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">3</span>))</span><br><span class="line">higherOrder.exhaust()</span><br></pre></td></tr></table></figure>
<ul>
<li>exhaustMap</li>
</ul>
<p><code>public exhaustMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/exhaustMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable only if the previous projected Observable has completed.</p>
<ul>
<li>expand</li>
</ul>
<p><code>public expand(project: function(value: T, index: number), concurrent: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/expand.png" alt=""></p>
<p>Recursively projects each source value to an Observable which is merged in the output Observable.</p>
<blockquote>
<p>It’s similar to mergeMap, but applies the projection function to every source value as well as every output value. It’s recursive.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line">clicks.mapTo(<span class="hljs-number">1</span>).expand(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> Rx.Observable.of(<span class="hljs-number">2</span>*x).delay(<span class="hljs-number">1000</span>)).take(<span class="hljs-number">10</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>filter</li>
</ul>
<p><code>public filter(predicate: function(value T, index: number): boolean, thisArg: any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/filter.png" alt=""></p>
<p>Filter items emitted by the source Observable by only emitting those that satisfy a specified predicate.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line">clicks.filter(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> <span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.4</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>find</li>
</ul>
<p><code>public find(predicate: function(value: T, index: number, source: Observable&lt;T&gt;): boolean, thisArg: any): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/find.png" alt=""></p>
<p>Emits only the first value emitted by the source Observable that meets some condition.</p>
<ul>
<li>findIndex</li>
</ul>
<p><code>public findIndex(predicate: function(value: T, index: number, source: Observable&lt;T&gt;): boolean, thisArg: any): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/findIndex.png" alt=""></p>
<blockquote>
<p>It’s like find, but emits the index of the found value, not the value itself.</p>
</blockquote>
<ul>
<li>first</li>
</ul>
<p><code>public first(predicate: function(value: T, index: number, source: Obsevable&lt;T&gt;): boolean, resultSelector: function(value: T, index: number): R, defaultValue: R): Observable&lt;T|R&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/first.png" alt=""></p>
<p>Emits only the first value (or the fisrt value that meets some condition) emitted by the source Obsevable</p>
<ul>
<li>forEach</li>
</ul>
<p><code>public forEach(next: Function, PromiseCtor: PromiseConstructor): Promise</code></p>
<ul>
<li>groupBy</li>
</ul>
<p><code>public groupBy(keySelector: function(value: T): K, elementSelector: functioN(value: T): R, durationSelector: function(grouped: GroupedObservable&lt;K|R&gt;): Observable&lt;any&gt;): Observable&lt;GroupedObservable&lt;K, R&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/groupBy.png" alt=""></p>
<ul>
<li>ignoreElements</li>
</ul>
<p><code>public ignoreElements(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/ignoreElements.png" alt=""></p>
<p>Iggnores all items emitted by the source Observable and only pass calls of <code>complete</code> or <code>error</code></p>
<ul>
<li>isEmpty()</li>
</ul>
<p><code>public isEmpty(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/isEmpty.png" alt=""></p>
<ul>
<li>last</li>
</ul>
<p><code>public last(predicate: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/last.png" alt=""></p>
<ul>
<li>letProto</li>
</ul>
<p><code>public letProto(func: *): Observable&lt;T&gt;</code></p>
<ul>
<li>lift</li>
</ul>
<p><code>public lift(operator: Operator): Observable</code></p>
<p>Creates a new Observable, with this Observable as the source, and the passed operator defined as the new observable’s operator.</p>
<blockquote>
<p>Return a new Observable with the Operator applied.</p>
</blockquote>
<ul>
<li>map</li>
</ul>
<p><code>public map(project: function(value: T, index: number): R, thisArg: any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/map.png" alt=""></p>
<p>Applies a given <code>project</code> function to each value emitted by the source Observable, and emits the resulting values as an Observable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line">clicks.map(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> ev.clientX)</span><br></pre></td></tr></table></figure>
<ul>
<li>mapTo</li>
</ul>
<p><code>public mapTo(value: any): Observbale</code></p>
<p><img src="http://reactivex.io/rxjs/img/mapTo.png" alt=""></p>
<p>Emits the given constant value on the output Observable every time the source Observable emits a value.</p>
<ul>
<li>materialize</li>
</ul>
<p><code>public materialize(): Observable&lt;Notification&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/materialize.png" alt=""></p>
<p>Represents all of the notifications from the source Observable as <code>next</code> emission marked with their orignal types within <code>Notification</code> objects.</p>
<ul>
<li>max</li>
</ul>
<p><code>public max(comparer: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/max.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>).max()</span><br><span class="line"></span><br><span class="line">interface Person &#123;</span><br><span class="line">  name: string</span><br><span class="line">  age: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Rx.Observable.of&lt;Person&gt;(</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bar'</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'For'</span> &#125;,</span><br><span class="line">)</span><br><span class="line">.max&lt;Person&gt;<span class="hljs-function">(<span class="hljs-params">(a, b</span>) =&gt;</span> a.age - b.age)</span><br></pre></td></tr></table></figure>
<ul>
<li>merge</li>
</ul>
<p><code>public merge(other: ObservableInpt, concurrent: number, scheduler: Scheduer): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/merge.png" alt=""></p>
<p>Creates an output Observable which concurrently emits all values from every given input Observable.</p>
<blockquote>
<p>Flatten multiple Observable together by blending their values into one Observable.</p>
</blockquote>
<ul>
<li>mergeAll</li>
</ul>
<p><code>public mergeAll(concurrent: number): Obsevable</code></p>
<p><img src="http://reactivex.io/rxjs/img/mergeAll.png" alt=""></p>
<p>Converts a higher-order Observable into a first-order Observable which concurrently delivers all values that are emitted on the inner Observables.</p>
<ul>
<li>mergeMap</li>
</ul>
<p><code>public mergeMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any, concurrent: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/mergeMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable.</p>
<blockquote>
<p>Map each value to an Observable, then flattn all of these inner Observable using mergeAll</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> letters = Rx.Observable.of(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>)</span><br><span class="line">letters.mergeMap(<span class="hljs-function"><span class="hljs-params">letter</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>).map(<span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> i+letter))</span><br></pre></td></tr></table></figure>
<ul>
<li>mergeMapTo</li>
</ul>
<p><code>public mergeMapTo(innerObservable: ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any, concurrent: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/mergeMapTo.png" alt=""></p>
<p>Projects each source value to the same Observable which is merged multiple times in the output Observable.</p>
<ul>
<li>mergeScan</li>
</ul>
<p><code>public mergeScan(accumulator: function(acc: R, value: T): Observable&lt;R&gt;, seed: *, concurrent: number): Observable&lt;R&gt;</code></p>
<p>Applies an accumulator function over the source Observable where the accumulator function itself retunrs an Observable, then each intermediate Observable is merged into the output Obsevable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> click$ = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> one$ = click$.mapTo(<span class="hljs-number">1</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> seed = <span class="hljs-number">0</span></span><br><span class="line"><span class="hljs-keyword">const</span> count$ = one$.mergeScan(<span class="hljs-function">(<span class="hljs-params">acc, one</span>) =&gt;</span> Rx.Observable.of(acc + one), seed)</span><br></pre></td></tr></table></figure>
<ul>
<li>min</li>
</ul>
<p><code>public min(comparer: Function): Observable&lt;R&gt;</code></p>
<ul>
<li>multicast</li>
</ul>
<p><code>public multicast(subjectOrSubjectFactory: Function | Subject, selector: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/multicast.png" alt=""></p>
<p>Returns an Observable tghat emits the results of invoking a specified selector on items emitted by a ConnectableObservable that shares a single subscription to the underlying stream.</p>
<ul>
<li>observeOn</li>
</ul>
<p><code>public observeOn(scheduler: *, delay: *): Observable&lt;R&gt;</code></p>
<ul>
<li>pairwise</li>
</ul>
<p><code>public pairwise(): Observable&lt;Array&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/pairwise.png" alt=""></p>
<p>Groups pairs of consecutive emissions together and emits them as an array of two values.</p>
<blockquote>
<p>Puts the current value and previous value together as an array, and emits that.</p>
</blockquote>
<ul>
<li>partition</li>
</ul>
<p>`public partition(predicate: function(value: T, index: number): Boolean, thisArg: this): [Observable<t>, Observable<t>]</t></t></p>
<p><img src="http://reactivex.io/rxjs/img/partition.png" alt=""></p>
<p>Splits the source Observable into two, one with values that satisfy a predicate, and another values that don’t satisfy the predicate.</p>
<blockquote>
<p>It’s like filter, but returns two Observable, one like the output of filter, and the other with values that did not pass the condition.</p>
</blockquote>
<ul>
<li>pluck</li>
</ul>
<p><code>public pluck(properties: ...string): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/pluck.png" alt=""></p>
<p>Maps each source value (an object) to its specified nested property</p>
<blockquote>
<p>Like map, but meant only for picking on eof the nested properties of every emitted object.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> clicks$ = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line">clicks$.pluck(<span class="hljs-string">'target'</span>, <span class="hljs-string">'tagName'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>publish</li>
</ul>
<p><code>public publish(selector: Function): *</code></p>
<p>Returns a ConnectableObservable, which is a variety of Observable that waits until connect method is called before it begins emitting items to those Observers that have subscribed to it.</p>
<ul>
<li><p>publishBehavior</p>
</li>
<li><p>publishLast</p>
</li>
<li><p>publishReplay</p>
</li>
<li><p>race</p>
</li>
</ul>
<p><code>public race(...observables): Observable</code></p>
<p>Returns an Observable that mirrors the first source Observable to emit an item from the combination of this Observable and supplied Observables.</p>
<ul>
<li>reduce</li>
</ul>
<p><code>public reduce(accumulator: function(acc: R, value: T, index: number): R, seed: R): Observable&lt;R&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/reduce.png" alt=""></p>
<ul>
<li>repeat</li>
</ul>
<p><code>public repeat(count: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/repeat.png" alt=""></p>
<ul>
<li>repeatWhen</li>
</ul>
<p><code>public repeatWhen(notifier: functioN(notification: Observable): Observable): Observable</code></p>
<p>1<a href="http://reactivex.io/rxjs/img/repeatWhen.png" target="_blank" rel="noopener"></a></p>
<ul>
<li>retry</li>
</ul>
<p><code>public retry(count: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/retry.png" alt=""></p>
<p>Returns an Observable that mirrors the source Observable with the exception of an <code>error</code>, if the source Observable calls <code>error</code>, this method will resubscribe to the source Observable for a maximum of <code>count</code> resubscriptions rather than propagating the <code>error</code> call.</p>
<ul>
<li>retryWhen</li>
</ul>
<p><code>public retryWhen(notifier: function(errors: Observable): Observable): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/retryWhen.png" alt=""></p>
<ul>
<li>sample</li>
</ul>
<p><code>public sample(notifier: Observable&lt;any&gt;): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/sample.png" alt=""></p>
<p>Emits the most recently emitted value from the source Observable whenever another Observable, the <code>notifier</code> emits.</p>
<blockquote>
<p>It’s like sampleTime, but sampels whenever the notifier Observable emits.</p>
</blockquote>
<ul>
<li>sampleTime</li>
</ul>
<p><code>public sampleTime(period: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/sampleTime.png" alt=""></p>
<ul>
<li>scan</li>
</ul>
<p><code>public scan(accumulate: function(acc: R, value: T, index: number): R, seed: T|R): Observable&lt;R&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/scan.png" alt=""></p>
<p>Applies an accumulator function over the source Observable, and returns each intermediate result, with an optional seed value.</p>
<blockquote>
<p>It’s like reduce, but emits the current accumulation whenever the source emits a value</p>
</blockquote>
<ul>
<li>sequenceEqual(compareTo: Observbale, comparor: function): Observable`</li>
</ul>
<p><img src="http://reactivex.io/rxjs/img/sequenceEqual.png" alt=""></p>
<p>Compares all values of two observbales in sequence using an optional comparor function and returns an observable of a single boolean value representing whether or not the two sequences are equal.</p>
<blockquote>
<p>Checks to see of all values emitted by both observables are equal in order.</p>
</blockquote>
<ul>
<li>share</li>
</ul>
<p><code>public share(): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/share.png" alt=""></p>
<p>Returns a new Observable that multicasts (shares) the original Observable. As long as there is at least one Subscriber this Observable will be subscribed and emitting data. When all subscribers have unsubscribed it will unsubscribe from the source Observable. Because the Observable is multicasting it makes the stream hot. This is an alias for .publish().refCount().</p>
<ul>
<li>single</li>
</ul>
<p><code>public single(predicate: Function): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/single.png" alt=""></p>
<ul>
<li>skip</li>
</ul>
<p><code>public skip(count: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/skip.png" alt=""></p>
<ul>
<li>skipUntil</li>
</ul>
<p><code>public skipUntil(notifier: Observable): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/skipUntil.png" alt=""></p>
<p>Returns an Observable that skips items emitted by the source Observable until a second Observable emits an item.</p>
<ul>
<li>skipWhile</li>
</ul>
<p><code>public skipWhile(predicate: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/skipWhile.png" alt=""></p>
<p>Returns an Observable that skips all items emitted by the source Observable as long as a specified condition holds true, but emits all further source items as soon as the condition becomes false.</p>
<ul>
<li>startWith</li>
</ul>
<p><code>public startWith(values: ...T, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/startWith.png" alt=""></p>
<p>Returns an Observable that emits the items you specified before it begins to emit items by the source Observable.</p>
<ul>
<li>subscribeOn</li>
</ul>
<p><code>public subscribeOn(scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/subscribeOn.png" alt=""></p>
<p>Asynchornously subscribes Observables to this Observable on the specified Scheduler.</p>
<ul>
<li>switch</li>
</ul>
<p><code>public switch(): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/switch.png" alt=""></p>
<p>Converts a higher-order Observable into a first-order Observable by subscribing to only the most recently emitted of those inner Observables.</p>
<blockquote>
<p>Flatten an Observable-of-Observables by dropping the previous inner Obsevable once a new one appears.</p>
</blockquote>
<ul>
<li>switchMap</li>
</ul>
<p><code>public switchMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/switchMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable, emitting values only from the most recent projected Observable.</p>
<blockquote>
<p>Map each value to an Observable, then flatten all of these Observable using switch.</p>
</blockquote>
<ul>
<li>take</li>
</ul>
<p><code>public take(count: number): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/take.png" alt=""></p>
<p>Emits only the first <code>count</code> values emitted by the source Observable.</p>
<blockquote>
<p>Take the first count value from the source, then complete.</p>
</blockquote>
<ul>
<li>takeLast</li>
</ul>
<p><code>takeLast(count: number): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/takeLast.png" alt=""></p>
<p>Emits only the last <code>count</code> values emitted by the source Observable.</p>
<blockquote>
<p>Remembers the latest count values, then emits those only when the source completes.</p>
</blockquote>
<ul>
<li>takeUntil</li>
</ul>
<p><code>public takeUntil(notifier: Observable): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/takeUntil.png" alt=""></p>
<p>Emits the values emitted by the source Observable until a <code>notifier</code> Observable emits a value.</p>
<blockquote>
<p>Let values pass until a second Observable, notifier, emits something. Then, it completes.</p>
</blockquote>
<ul>
<li>takeWhile</li>
</ul>
<p><code>public takeWhile(predicate: function(value: T, index: number): boolean): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/takeWhile.png" alt=""></p>
<p>Emits values emitted by the source Observable so long as each value satisfies the given <code>predicate</code>, and then completes as soon as this <code>predicate</code> is not satisfied.</p>
<blockquote>
<p>Take values from the source only while they pass the condition given, when the first value does not satisfy, it completes.</p>
</blockquote>
<ul>
<li>throttle</li>
</ul>
<p><code>public throttle(durationSelector: function(value: T): SubscribableOrPromise): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/throttle.png" alt=""></p>
<p>Emits a value from the source Observable, then ignores subsequent source values for a duration determined by another Observable, then repeats this process.</p>
<blockquote>
<p>It’s like throttleTime, but the silencing duration is determined by a second Observable.</p>
</blockquote>
<p>Cannot emit more than one values until the second Observable emits a value.</p>
<ul>
<li>throttleTime</li>
</ul>
<p><code>public throttleTime(duration: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/throttleTime.png" alt=""></p>
<p>Emits a value from the source Observable, then ignores subsequent source values for <code>duration</code> milliseconds, then repeats this process.</p>
<blockquote>
<p>Lets a value pass, then ignores source values for the next duration milliseconds.</p>
</blockquote>
<ul>
<li>timeInterval</li>
</ul>
<p><code>public timeInterval(scheduler: *): Observable&lt;TimeInterval&lt;any&gt;&gt;</code></p>
<ul>
<li>timeout</li>
</ul>
<p><code>public timeout(due: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<ul>
<li>timeoutWith</li>
</ul>
<p><code>public timeoutWith(due: *, withObservable: *, scheduler: Scheduler): Observable&lt;R&gt;</code></p>
<ul>
<li>timestamp</li>
</ul>
<p><code>public timestamp(scheduler: *): Observable&lt;Timestamp&lt;&gt;&gt;any</code></p>
<ul>
<li>toArray</li>
</ul>
<p><code>public toArray(): Observable&lt;any[]&gt;</code></p>
<ul>
<li>toPromise</li>
</ul>
<p><code>public toPromise(PromiseCtor: *): Promise&lt;T&gt;</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(<span class="hljs-number">42</span>).toPromise().then(<span class="hljs-built_in">console</span>.log)</span><br></pre></td></tr></table></figure>
<ul>
<li>window</li>
</ul>
<p><code>public window(windowBoundaries: Observable&lt;any&gt;): Observable&lt;Observable&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/window.png" alt=""></p>
<p>Branch out the source Observable values as a nested Observable whenever <code>windowBoundaries</code> emits.</p>
<blockquote>
<p>It’s like buffer, but emits a nested Observable instead of an array.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</span><br><span class="line"><span class="hljs-keyword">let</span> interval = Rx.Observable.interval(<span class="hljs-number">1000</span>)</span><br><span class="line">clicks.window(interval)</span><br></pre></td></tr></table></figure>
<ul>
<li>windowCount</li>
</ul>
<p><code>public windowCount(windowSize: number, startWindowEvery: number): Observable&lt;Observable&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/windowCount.png" alt=""></p>
<p>Branch out the source Observable values as a nested Observable with each nested Observable emitting at most <code>windowSize</code> values.</p>
<blockquote>
<p>It’s like bufferCount, but emits a nested Observable instead of an array.</p>
</blockquote>
<ul>
<li>windowToggle</li>
</ul>
<p><code>public windowToggle(openings: Observable&lt;O&gt;, closingSelectors: function(value: O): Observable): Observable&lt;Observable&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/windowToggle.png" alt=""></p>
<p>Branch out the source Observable values as a nested Observable starting from an emission from <code>openings</code> and ending when the output of <code>closingSelector</code></p>
<ul>
<li>windowWhen(closingSelector: function(): Observable): Observable&lt;Observable<t>&gt;`</t></li>
</ul>
<p>Branch out the source Observable values as a nested Observable using a factory function of closing Observables to determine when to start a new window.</p>
<blockquote>
<p>It’s like bufferWhen, but emits a nested Observable instead of an array.</p>
</blockquote>
<ul>
<li>withLatestFrom</li>
</ul>
<p><code>public withLatestFrom(other: ObservableInput, project: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/withLatestFrom.png" alt=""></p>
<p>Combines the source Observable with other Observables to create an Observable whose values are calculated from the latest values of each, only when the source emit.</p>
<blockquote>
<p>Whenever the source Observable emits a value, it computes a formula using that value plus the latest values from other input Observables, then emits the output of that formula.</p>
</blockquote>
<ul>
<li>zipAll</li>
</ul>
<p><code>public zipAll(project: *): Observable&lt;R&gt;</code></p>
<ul>
<li>zipProto</li>
</ul>
<p><code>public zipProto(observables: *): Observable&lt;R&gt;</code></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-25T02:49:47.000Z">2017-09-25</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 454 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/25/HTTP-Timings-in-Node-js/">HTTP Timings in Node.js</a>
            
        </h1>
        <div class="content">
            <p><a href="https://blog.risingstack.com/measuring-http-timings-node-js/" target="_blank" rel="noopener">Origin</a></p>
<h3 id="Some-Basic-Concepts"><a href="#Some-Basic-Concepts" class="headerlink" title="Some Basic Concepts:"></a>Some Basic Concepts:</h3><ul>
<li><p>IP(Internet Protocol): IP is a network-layer protocol, deals with network addressing and routing. IP is responsible for delivering packets from the source host to the destination host based on the packet headers across one or more IP network. It also defines packet structures that encapsulate the data to be delivered.</p>
</li>
<li><p>DNS(Domain Name Server): DNS is a hierarchical decentralized naming system used to resolve human-readable hostnames into machine-readable IP address.</p>
</li>
<li><p>TCP(Transmission Control Protocol): The TCP standard defines how to establish and maintain a network conversation between applications to exchange data. TCP provides reliable, ordered, and error-checked deliver of a stream of octects between applications running on hosts communicating over an IP network. An HTTP client initiates a request by establishing a TCP connection.</p>
</li>
<li><p>SSL(Secure Sockets Layer)/TLS(Transport Layer Security): TLS is a cryptographic protocol that provides communications security over a computer network. SSL is a deprecated predecessor to TLS. Both TLS and SSL use certificates to establish a secure connection. SSL certificates are not dependent on cryptographic protocols like TLS, a certificate contains a key pair: a public and a private key.</p>
</li>
</ul>
<p><img src="https://blog-assets.risingstack.com/2017/09/http-timing-nodejs.png" alt=""></p>
<p>Timings Explained:</p>
<ul>
<li><p>DNS Lookup: Time spent performing the DNS Lookup. DNS lookup resolves domain names to IP addresses.</p>
</li>
<li><p>TCP Connection: Time it took to establish TCP Connection between a source host and destination host. Connections must be properly established in a multi-step handshake process.</p>
</li>
<li><p>TLS handshake: Time spent completing a TLS handshake. During the handshake process endpoints exchange authentication and keys to establish or resume secure sessions. There is no TLS handshake with a not HTTPS request.</p>
</li>
<li><p>Time To First Byte(TTFB): Time spent waiting for the initial response. This time captures the latency of a round trip to the server in addition to the time spent waiting for the server to process the request and deliver the response.</p>
</li>
<li><p>Content Transfer: Time spent receiving the response data. The size of the response data and the available network bandwidth determinates its duration.</p>
</li>
</ul>
<h3 id="Measuring-HTTP-timings-in-Node-js"><a href="#Measuring-HTTP-timings-in-Node-js" class="headerlink" title="Measuring HTTP timings in Node.js"></a>Measuring HTTP timings in Node.js</h3><p>To measure HTTP timings in Node.js, we need to subscribe to a specific request, response and socket events. Here is a short code snippet how to do this.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> timings = &#123;</span><br><span class="line">  startAt: process.hrtime(),</span><br><span class="line">  dnsLookupAt: <span class="hljs-literal">undefined</span>,</span><br><span class="line">  tcpConnectionAt: <span class="hljs-literal">undefined</span>,</span><br><span class="line">  tlsHandshakeAt: <span class="hljs-literal">undefined</span>,</span><br><span class="line">  firstByteAt: <span class="hljs-literal">undefined</span>,</span><br><span class="line">  endAt: <span class="hljs-literal">undefined</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> req = http.request(&#123;...&#125;, (res) =&gt; &#123;</span><br><span class="line">  res.once(<span class="hljs-string">'readable'</span>, () =&gt; &#123;</span><br><span class="line">    timings.firstByteAt = process.hrtime()</span><br><span class="line">  &#125;)</span><br><span class="line">  res.on(<span class="hljs-string">'data'</span>, (chunk) =&gt; &#123;</span><br><span class="line">    responseBody += chunk</span><br><span class="line">  &#125;)</span><br><span class="line">  res.on(<span class="hljs-string">'end'</span>, () =&gt; &#123;</span><br><span class="line">    timings.endAt = process.hrtime()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">req.on(<span class="hljs-string">'socket'</span>, (socket) =&gt; &#123;</span><br><span class="line">  socket.on(<span class="hljs-string">'lookup'</span>, () =&gt; &#123;</span><br><span class="line">    timings.dnsLookupAt = process.hrtime()</span><br><span class="line">  &#125;)</span><br><span class="line">  socket.(<span class="hljs-string">'connect'</span>, () =&gt; &#123;</span><br><span class="line">    timings.tcpConnectionAt = process.hrtime()</span><br><span class="line">  &#125;)</span><br><span class="line">  socket.on(<span class="hljs-string">'secureConnect, () =&gt; &#123;</span></span><br><span class="line"><span class="hljs-string">    timings.tlsHandshake = process.hrtime()</span></span><br><span class="line"><span class="hljs-string">  &#125;)</span></span><br><span class="line"><span class="hljs-string">&#125;)</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-15T09:42:37.000Z">2017-09-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 657 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/15/graphql-koa-starter/">Graphql-Koa-Starter</a>
            
        </h1>
        <div class="content">
            <h3 id="Init-Project"><a href="#Init-Project" class="headerlink" title="Init Project"></a>Init Project</h3><h3 id="Add-tsconfig"><a href="#Add-tsconfig" class="headerlink" title="Add tsconfig"></a>Add tsconfig</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// tsconfig.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"files"</span>: [</span><br><span class="line">    <span class="hljs-string">"server.ts"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="hljs-string">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="hljs-string">"outDir"</span>: <span class="hljs-string">"./build"</span>,</span><br><span class="line">    <span class="hljs-string">"target"</span>: <span class="hljs-string">"es2015"</span>,</span><br><span class="line">    <span class="hljs-string">"module"</span>: <span class="hljs-string">"commonjs"</span>,</span><br><span class="line">    <span class="hljs-string">"moduleResolution"</span>: <span class="hljs-string">"Node"</span>,</span><br><span class="line">    <span class="hljs-string">"sourceMap"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"pretty"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"strictNullChecks"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"lib"</span>: [</span><br><span class="line">      <span class="hljs-string">"esnext"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-string">"exclude"</span>: [</span><br><span class="line">    <span class="hljs-string">"node_modules"</span>,</span><br><span class="line">    <span class="hljs-string">"build"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Add-tslint"><a href="#Add-tslint" class="headerlink" title="Add tslint"></a>Add tslint</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// tslint.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"rules"</span>: &#123;</span><br><span class="line">    <span class="hljs-string">"align"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"parameters"</span>,</span><br><span class="line">      <span class="hljs-string">"arguments"</span>,</span><br><span class="line">      <span class="hljs-string">"statements"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"ban"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"class-name"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"curly"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"eofline"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"forin"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"indent"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"spaces"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"interface-name"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"jsdoc-format"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"label-position"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"max-line-length"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-number">140</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"member-access"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"member-ordering"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"public-before-private"</span>,</span><br><span class="line">      <span class="hljs-string">"static-before-instance"</span>,</span><br><span class="line">      <span class="hljs-string">"variables-before-functions"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"no-any"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"no-arg"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-bitwise"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-conditional-assignment"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-console"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"debug"</span>,</span><br><span class="line">      <span class="hljs-string">"info"</span>,</span><br><span class="line">      <span class="hljs-string">"time"</span>,</span><br><span class="line">      <span class="hljs-string">"timeEnd"</span>,</span><br><span class="line">      <span class="hljs-string">"trace"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"no-construct"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-debugger"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-shadowed-variable"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-duplicate-variable"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-empty"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"no-eval"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-inferrable-types"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"no-internal-module"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-require-imports"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-string-literal"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"no-switch-case-fall-through"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-trailing-whitespace"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"no-var-keyword"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"no-var-requires"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"one-line"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"check-open-brace"</span>,</span><br><span class="line">      <span class="hljs-string">"check-catch"</span>,</span><br><span class="line">      <span class="hljs-string">"check-else"</span>,</span><br><span class="line">      <span class="hljs-string">"check-whitespace"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"quotemark"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"single"</span>,</span><br><span class="line">      <span class="hljs-string">"jsx-single"</span>,</span><br><span class="line">      <span class="hljs-string">"avoid-escape"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"radix"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"semicolon"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"switch-default"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"triple-equals"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"allow-null-check"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"typedef"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"typedef-whitespace"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="hljs-string">"call-signature"</span>: <span class="hljs-string">"nospace"</span>,</span><br><span class="line">        <span class="hljs-string">"index-signature"</span>: <span class="hljs-string">"nospace"</span>,</span><br><span class="line">        <span class="hljs-string">"parameter"</span>: <span class="hljs-string">"nospace"</span>,</span><br><span class="line">        <span class="hljs-string">"property-declaration"</span>: <span class="hljs-string">"nospace"</span>,</span><br><span class="line">        <span class="hljs-string">"variable-declaration"</span>: <span class="hljs-string">"nospace"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"variable-name"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-string">"whitespace"</span>: [</span><br><span class="line">      <span class="hljs-literal">true</span>,</span><br><span class="line">      <span class="hljs-string">"check-branch"</span>,</span><br><span class="line">      <span class="hljs-string">"check-decl"</span>,</span><br><span class="line">      <span class="hljs-string">"check-operator"</span>,</span><br><span class="line">      <span class="hljs-string">"check-separator"</span>,</span><br><span class="line">      <span class="hljs-string">"check-type"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Add-env"><a href="#Add-env" class="headerlink" title="Add env"></a>Add env</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// env.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> envalid <span class="hljs-keyword">from</span> <span class="hljs-string">'envalid'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> &#123; url, bool, str &#125; = envalid</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> env = envalid.cleanEnv(process.env, &#123;</span><br><span class="line">  SERVICE_URI: str(&#123; <span class="hljs-keyword">default</span>: <span class="hljs-string">'https://reqres.in/api'</span> &#125;),</span><br><span class="line">  NODE_ENV: str(&#123; devDefault: <span class="hljs-string">'development'</span>, <span class="hljs-keyword">default</span>: <span class="hljs-string">'production'</span> &#125;),</span><br><span class="line">  LOG_LEVEL: str(&#123; <span class="hljs-keyword">default</span>: <span class="hljs-string">'info'</span> &#125;),</span><br><span class="line">  CORS: bool(&#123; devDefault: <span class="hljs-literal">true</span>, <span class="hljs-keyword">default</span>: <span class="hljs-literal">false</span> &#125;),</span><br><span class="line">  GRAPHIQL: bool(&#123; devDefault: <span class="hljs-literal">true</span>, <span class="hljs-keyword">default</span>: <span class="hljs-literal">true</span> &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> env</span><br></pre></td></tr></table></figure>
<h3 id="Add-Nodemon"><a href="#Add-Nodemon" class="headerlink" title="Add Nodemon"></a>Add Nodemon</h3><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"watch"</span>: [<span class="hljs-string">"src"</span>],</span><br><span class="line">  <span class="hljs-attr">"ext"</span>: <span class="hljs-string">"ts"</span>,</span><br><span class="line">  <span class="hljs-attr">"ignore"</span>: [<span class="hljs-string">"src/**/*.spec.ts"</span>],</span><br><span class="line">  <span class="hljs-attr">"exec"</span>: <span class="hljs-string">"ts-node ./server.ts"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Create-Koa-APP"><a href="#Create-Koa-APP" class="headerlink" title="Create Koa APP"></a>Create Koa APP</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// src/app.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Koa <span class="hljs-keyword">from</span> <span class="hljs-string">'koa'</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-cors'</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> convert <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-convert'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; apiRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./routers'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> (process.env.CORS) &#123;</span><br><span class="line">  app.use(convert(cors()))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.use(apiRouter.routes()).use(apiRouter.allowedMethods())</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> app</span><br></pre></td></tr></table></figure>
<h3 id="Server-Startup"><a href="#Server-Startup" class="headerlink" title="Server Startup"></a>Server Startup</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// server.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> chalk <span class="hljs-keyword">from</span> <span class="hljs-string">'chalk'</span></span><br><span class="line"><span class="hljs-keyword">import</span> env <span class="hljs-keyword">from</span> <span class="hljs-string">'./env'</span></span><br><span class="line">process.env = env</span><br><span class="line"><span class="hljs-keyword">import</span> app <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/app'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> port = process.env.PORT || <span class="hljs-number">3001</span></span><br><span class="line"></span><br><span class="line">app.listen(port, <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">'development'</span>) &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (process.env.GRAPHIQL) &#123;</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'The GraphiQL App is running at: '</span>)</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(chalk.cyan(<span class="hljs-string">`http://localhost:<span class="hljs-subst">$&#123;port&#125;</span>/api/graphiql`</span>))</span><br><span class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Koa app is running at: '</span>)</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(chalk.cyan(<span class="hljs-string">`http://localhost:<span class="hljs-subst">$&#123;port&#125;</span>`</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Koa App is running'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Add-Router"><a href="#Add-Router" class="headerlink" title="Add Router"></a>Add Router</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/routers/graphql.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Router <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-router'</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> GraphQLHttp <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-graphql'</span></span><br><span class="line"><span class="hljs-keyword">import</span> schema <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphql/schema'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> Router()</span><br><span class="line"><span class="hljs-comment">// console.log(process.env)</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">console</span>.log(process.env)</span><br><span class="line">router.all(<span class="hljs-string">'/'</span>, GraphQLHttp(&#123;</span><br><span class="line">  schema,</span><br><span class="line">  graphiql: process.env.GRAPHIQL,</span><br><span class="line">  pretty: <span class="hljs-literal">true</span>,</span><br><span class="line">  errorFormat: <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> &#123; message, locations, path, stack &#125; = error</span><br><span class="line">    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`GraphQL Error: `</span>, &#123;</span><br><span class="line">      message,</span><br><span class="line">      locations,</span><br><span class="line">      path,</span><br><span class="line">      stack,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/routers/index.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Router <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-router'</span></span><br><span class="line"><span class="hljs-keyword">import</span> graphQLRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphql'</span></span><br><span class="line"><span class="hljs-keyword">import</span> testRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'./test'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> apiRouter = <span class="hljs-keyword">new</span> Router(&#123;</span><br><span class="line">  prefix: <span class="hljs-string">'/api'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">apiRouter.use(<span class="hljs-string">'/graphql'</span>, graphQLRouter.routes(), graphQLRouter.allowedMethods())</span><br><span class="line">apiRouter.use(<span class="hljs-string">'/test'</span>, testRouter.routes(), testRouter.allowedMethods())</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> &#123;</span><br><span class="line">  apiRouter</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Config-Graphql"><a href="#Config-Graphql" class="headerlink" title="Config Graphql"></a>Config Graphql</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/graphql/model.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123;</span><br><span class="line">  GraphQLObjectType,</span><br><span class="line">  GraphQLString,</span><br><span class="line">  GraphQLNonNull,</span><br><span class="line">&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> User = <span class="hljs-keyword">new</span> GraphQLObjectType(&#123;</span><br><span class="line">  name: <span class="hljs-string">'User'</span>,</span><br><span class="line">  description: <span class="hljs-string">'A User'</span>,</span><br><span class="line">  fields: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;</span><br><span class="line">    id: &#123;</span><br><span class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLNonNull(GraphQLString),</span><br><span class="line">      resolve: <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id,</span><br><span class="line">    &#125;,</span><br><span class="line">    firstName: &#123;</span><br><span class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLNonNull(GraphQLString),</span><br><span class="line">      resolve: <span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.first_name</span><br><span class="line">    &#125;,</span><br><span class="line">    lastName: &#123;</span><br><span class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLNonNull(GraphQLString),</span><br><span class="line">      resolve: <span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.last_name</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> &#123;</span><br><span class="line">  User</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/graphql/query.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; GraphQLObjectType, GraphQLList &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql'</span></span><br><span class="line"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; User &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./model'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> GraphQLObjectType(&#123;</span><br><span class="line">  name: <span class="hljs-string">'Query'</span>,</span><br><span class="line">  description: <span class="hljs-string">'Query of GraphQL'</span>,</span><br><span class="line">  fields: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;</span><br><span class="line">    users: &#123;</span><br><span class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLList(User),</span><br><span class="line">      resolve: <span class="hljs-function">(<span class="hljs-params">root, args</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> axios(&#123;</span><br><span class="line">          url: <span class="hljs-string">'https://reqres.in/api/users'</span>,</span><br><span class="line">        &#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.data).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/graphql/schema.ts</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; GraphQLSchema &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql'</span></span><br><span class="line"><span class="hljs-keyword">import</span> query <span class="hljs-keyword">from</span> <span class="hljs-string">'./query'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> GraphQLSchema(&#123;</span><br><span class="line">  query</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-15T02:09:26.000Z">2017-09-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 226 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/15/tag-picture-in-html/">Tag Picture in Html</a>
            
        </h1>
        <div class="content">
            <p>The <code>picture</code> element is a markup pattern that allows developers to declare multiple sources for an image.</p>
<p>This markup is a container used to specify multiple <code>&lt;source&gt;</code> elements for a specific <code>&lt;img&gt;</code> contained in it.</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 40em)"</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">srcset</span>=<span class="hljs-string">"big.jpg 1x, big-hd.jgp 2x"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">source</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">srcset</span>=<span class="hljs-string">"small.jpg 1x, small-hd.jpg 2x"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"fallback.jpg"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Use-the-media-attribute"><a href="#Use-the-media-attribute" class="headerlink" title="Use the media attribute"></a>Use the <code>media</code> attribute</h3><p>The <code>media</code> attribute lets you specify a media query that the user agent will evaluates to select a <code>&lt;source&gt;</code> element. If the media query evaluates to <code>false</code>, the <code>&lt;source&gt;</code> element is skipped.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;picture&gt;</span><br><span class="line">  &lt;source srcset=<span class="hljs-string">"logo-wide.jpg"</span> media=<span class="hljs-string">"(min-width: 600px)"</span>&gt;</span><br><span class="line">  &lt;img src=<span class="hljs-string">"logo-narrow.jpg"</span>&gt;</span><br><span class="line">&lt;<span class="hljs-regexp">/picture&gt;</span></span><br></pre></td></tr></table></figure>
<p>The <code>srcset</code> and <code>sizes</code> attributes extend the <code>img</code> and <code>source</code> elements to provide a list of available image sources and their sizes. Browsers can then use this information to pick the best image source.</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"elva-fairy-320w.jpg 320w,</span></span></span><br><span class="line"><span class="hljs-tag"><span class="hljs-string">    elva-fairy-480w.jpg 480w,</span></span></span><br><span class="line"><span class="hljs-tag"><span class="hljs-string">    elva-fairy-800w.jpg 800w"</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">sizes</span>=<span class="hljs-string">"(max-width: 320px) 280px,</span></span></span><br><span class="line"><span class="hljs-tag"><span class="hljs-string">    (max-width: 480px) 440px,</span></span></span><br><span class="line"><span class="hljs-tag"><span class="hljs-string">    800px"</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">src</span>=<span class="hljs-string">"elva-fairy-800w.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Elva dressed as a fairy"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>srcset</code> defines the set of images we will allow the browser to choose between, and what size each image is.</p>
<p>Before each comma, we write:</p>
<ul>
<li><p>An <strong>Image filename</strong> (elva-fair-320w.jpg)</p>
</li>
<li><p>A space</p>
</li>
<li><p>The image’s inherit width in pixels(480w) – note that this issue the <code>w</code> unit, not <code>px</code> as you might expect.</p>
</li>
</ul>
<p><code>sizes</code> defines a set of media conditions(e.g. screen widths) and indicates what image size would be best to choose, when certain media conditions are true.</p>
<p>Before each comma, we write:</p>
<ul>
<li><p>A <strong>media condition</strong>(max-width: 480px) – when the viewport width is 480 px or less</p>
</li>
<li><p>A space</p>
</li>
<li><p>The <strong>width of the slot</strong> the image will fill when the media condition is true(440px)</p>
</li>
</ul>
<h3 id="Resolution-switching"><a href="#Resolution-switching" class="headerlink" title="Resolution switching"></a>Resolution switching</h3><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">img</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">srcset</span>=<span class="hljs-string">"elva-fairy-320w,jpg,</span></span></span><br><span class="line"><span class="hljs-tag"><span class="hljs-string">          elva-fairy-480w.jpg 1.5x,</span></span></span><br><span class="line"><span class="hljs-tag"><span class="hljs-string">          elva-fairy-640w.jpg 2x"</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">src</span>=<span class="hljs-string">"elva-fairy-640w.jpg"</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">alt</span>=<span class="hljs-string">"elva-fairy"</span></span></span><br><span class="line"><span class="hljs-tag">&gt;</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-13T10:32:58.000Z">2017-09-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 246 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/13/Simple-Example-of-DAPP/">Simple Example of DAPP</a>
            
        </h1>
        <div class="content">
            <h3 id="Use-truffle-to-init-Project"><a href="#Use-truffle-to-init-Project" class="headerlink" title="Use truffle to init Project"></a>Use truffle to init Project</h3><h3 id="Contract-of-Adoption"><a href="#Contract-of-Adoption" class="headerlink" title="Contract of Adoption"></a>Contract of Adoption</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// contracts/Adoption.sol</span></span><br><span class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.4</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">constract Adoption &#123;</span><br><span class="line">    address[<span class="hljs-number">16</span>] public adopters;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adopt</span> (<span class="hljs-params">uint petId</span>) <span class="hljs-title">public</span> <span class="hljs-title">returns</span> (<span class="hljs-params">uint</span>) </span>&#123;</span><br><span class="line">        <span class="hljs-built_in">require</span>(petId &gt;= <span class="hljs-number">0</span> &amp;&amp; petId &lt;= <span class="hljs-number">15</span>);</span><br><span class="line">        adopters[petId] = msg.sender;</span><br><span class="line">        <span class="hljs-keyword">return</span> petId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAdopters</span> (<span class="hljs-params"></span>) <span class="hljs-title">public</span> <span class="hljs-title">returns</span> (<span class="hljs-params">addresss[<span class="hljs-number">16</span>]</span>) </span>&#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> adopters;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// test/TestAdoption.sol</span></span><br><span class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.4</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"truffle/Assert.sol"</span>;</span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"truffle/DeployedAddress.sol"</span>;</span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"../contracts/Adoption.sol"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract TestAdoption &#123;</span><br><span class="line">  Adoption adoption = Adoption(DeployedAddress.Adoption());</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testUserCanAdoptPet</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    uint returnedPetId = adoption.adopt(<span class="hljs-number">8</span>);</span><br><span class="line">    uint expected = <span class="hljs-number">8</span>;</span><br><span class="line">    Assert.equal(returenedPetId, expected, <span class="hljs-string">"Adoption of Pet Id 8 should be recorded"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testGetAdopterAddressByPetId</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    address expected = <span class="hljs-keyword">this</span>;</span><br><span class="line">    address adopter = adoption.adopters(<span class="hljs-number">8</span>);</span><br><span class="line">    Assert.equal(adopter, expected, <span class="hljs-string">"Owner of Pet Id 8 should be recorded"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testGetAdopterAddressByPetIdInArray</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    address expected = <span class="hljs-keyword">this</span>;</span><br><span class="line">    address[<span class="hljs-number">16</span>] memory adopters = adoption.getAdopters();</span><br><span class="line">    Assert(expected, adopters[<span class="hljs-number">8</span>], <span class="hljs-string">"Owner of Pet Id 8 should be recoreded"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a>Compile</h3><h3 id="Migrate"><a href="#Migrate" class="headerlink" title="Migrate"></a>Migrate</h3><h3 id="TestRPC"><a href="#TestRPC" class="headerlink" title="TestRPC"></a>TestRPC</h3><h3 id="MetaMask"><a href="#MetaMask" class="headerlink" title="MetaMask"></a>MetaMask</h3><h3 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h3><h4 id="initWeb3"><a href="#initWeb3" class="headerlink" title="initWeb3"></a>initWeb3</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> web3 !== <span class="hljs-string">'undefined'</span>) &#123;</span><br><span class="line">  App.web3Provider = web3.currentProvider</span><br><span class="line">  web3 = <span class="hljs-keyword">new</span> Web3(App.web3Provider)</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">  App.web3Provider = <span class="hljs-keyword">new</span> web3.providers.HttpProvider(<span class="hljs-string">'http://localhost:8545'</span>)</span><br><span class="line">  web3 = <span class="hljs-keyword">new</span> Web3(App.web3Provider)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="initContract"><a href="#initContract" class="headerlink" title="initContract"></a>initContract</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="hljs-built_in">JSON</span>(<span class="hljs-string">'Adoption.json'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> AdoptionArtifact = data</span><br><span class="line">  App.contracts.Adoption = TruffleContract(AdoptionArtifact)</span><br><span class="line">  App.contracts.Adoption.setProvider(App.web3Provider)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Invoke-Contract"><a href="#Invoke-Contract" class="headerlink" title="Invoke Contract"></a>Invoke Contract</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> adoptionInstance</span><br><span class="line">App.contracts.Adoption.deployed()</span><br><span class="line">.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>) </span>&#123;</span><br><span class="line">  adoptionInstance = instance</span><br><span class="line">  <span class="hljs-keyword">return</span> adoptionInstance.getAdopters.call()</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">adopters</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> petId = <span class="hljs-number">8</span></span><br><span class="line"><span class="hljs-keyword">let</span> adoptionInstance</span><br><span class="line">web3.eth.getAccounts(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, accounts</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.error(error.message)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">const</span> account = accounts[<span class="hljs-number">0</span>]</span><br><span class="line">  App.contracts.Adoption.deployed()</span><br><span class="line">  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>) </span>&#123;</span><br><span class="line">    adoptionInstance = instance</span><br><span class="line">    <span class="hljs-keyword">return</span> adoptionInstance.adopt(petId, &#123; <span class="hljs-attr">from</span>: account &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-12T06:10:18.000Z">2017-09-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 861 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/12/options-of-webpack-dll-plugin/">Options of Webpack Dll Plugin</a>
            
        </h1>
        <div class="content">
            <p>The <code>DllPlugin</code> and <code>DllReferencePlugin</code> provide means to split bundles in a way that can drastically improve build time performance.</p>
<h3 id="DllPlugin"><a href="#DllPlugin" class="headerlink" title="DllPlugin"></a>DllPlugin</h3><p>This plugin used in a separate webpack config exclusively to create a <code>dll-only-bundle</code>.</p>
<p>It creates a <code>manifest.json</code> file, which is used by the <code>DllReferencePlugin</code> to map dependencies.</p>
<ul>
<li><p><code>context</code>: (optional), context of requests in the manifest file(default to the webpack context).</p>
</li>
<li><p><code>name</code>: name of the exposed dll function(<code>TemplatePaths</code>: <code>[hash]</code> &amp; <code>[name]</code>)</p>
</li>
<li><p><code>path</code>: <strong>absolute path</strong> to the manifest json file(output)</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">new</span> webpack.DllPlugin(option)</span><br></pre></td></tr></table></figure>
<p>Creates a <code>manifest.json</code> which is written to the given <strong>absolute</strong> <code>path</code>.</p>
<p>It contains <strong>mappings</strong> from require and import requests, to module ids. It is used by the <code>DllReferencePlugin</code>.</p>
<p><strong>Combine this plugin with <code>output.library</code> option to expose(aka, put into the global scope) the dll function</strong></p>
<blockquote>
<p>output.library expose the name to global scope</p>
</blockquote>
<blockquote>
<p>DllReferencePlugin.name add the name to the mapping file.</p>
</blockquote>
<p>So it’s important to keep <code>output.library</code> and <code>DllReferencePlugin.name</code> same to set a right mapping.</p>
<h3 id="DllReferencePlugin"><a href="#DllReferencePlugin" class="headerlink" title="DllReferencePlugin"></a>DllReferencePlugin</h3><p>This plugin is used in the primary webpack config, it references the <strong>dll-only-bundle</strong> to require the pre-built dependencies.</p>
<ul>
<li><p><code>context</code>: <strong>absolute path</strong>, context of the requests in the manifest(or content property)</p>
</li>
<li><p><code>manifest</code>: an object containing <code>content</code> and <code>name</code> or a string to the <strong>absolute path</strong> of the JSON manifest to be loaded upon compilation.</p>
</li>
<li><p><code>content</code>: (optional), the mappings from request to module id(default to <code>manifest.content</code>)</p>
</li>
<li><p><code>name</code>: (optional), the name where the dll is exposed (default to <code>manifest.name</code>)</p>
</li>
<li><p><code>scope</code>: (optional), prefix which is used for accessing the content of the dll</p>
</li>
<li><p><code>sourceType</code>: (optional), how the dll is exposed.</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">new</span> webpack.DllReferencePlugin(options)</span><br></pre></td></tr></table></figure>
<p>References a dll manifest file to map dependencies names to module ids, then requires them as needed using the internal <code>__webpack_require__</code> function.</p>
<blockquote>
<p>Note: Keep the <code>name</code> consistent with <code>output.library</code></p>
</blockquote>
<h3 id="Modes"><a href="#Modes" class="headerlink" title="Modes"></a>Modes</h3><p>This plugin can be used in two different modes, <em>scoped</em> and <em>mapped</em>.</p>
<h4 id="Scoped-Mode"><a href="#Scoped-Mode" class="headerlink" title="Scoped Mode"></a>Scoped Mode</h4><p>The content of the dll is accessible under a module prefix, i.e. with <code>scope = &#39;xyz&#39;</code> a file named <code>abc</code> in the dll can be access via <code>require(xyz/abc)</code>.</p>
<h4 id="Mapped-Mode"><a href="#Mapped-Mode" class="headerlink" title="Mapped Mode"></a>Mapped Mode</h4><p>The content of the dll is mapped to the current directory. If a required file matches a file in the dll(after resolving), then the file from the dll is usd instead.</p>
<p>Because this happens after resolving every file in the dll bundle, the same paths must be available for the consumer of the dll bundle, i.e. if the dll contains <code>lodash</code> and the file <code>abc</code>, <code>require(&#39;lodash&#39;)</code> and <code>require(&#39;./abc&#39;)</code> will be used from the dll, rather than building them into the main bundle.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.dll.js</span></span><br><span class="line"><span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">  context: __dirname,</span><br><span class="line">  name: <span class="hljs-string">'[name]_[hash]'</span>,</span><br><span class="line">  path: path.join(__dirname<span class="hljs-string">', '</span>manifest.json<span class="hljs-string">'),</span></span><br><span class="line"><span class="hljs-string">&#125;)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.base.js</span></span><br><span class="line"><span class="hljs-keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">  context: __dirname,</span><br><span class="line">  manifest: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./manifest.json'</span>),</span><br><span class="line">  name: <span class="hljs-string">'./my-dll.js'</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h3><h4 id="Output-library-and-DllPlugin-name"><a href="#Output-library-and-DllPlugin-name" class="headerlink" title="Output.library and DllPlugin.name"></a>Output.library and DllPlugin.name</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="hljs-string">'lib'</span>),</span><br><span class="line">    filename: <span class="hljs-string">'[name]_[hash].js'</span>,</span><br><span class="line">    library: <span class="hljs-string">'[name]_[hash]'</span>, <span class="hljs-comment">// this set the exposed function name to [name]_[hash]</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      path: path.resolve(__dirname, <span class="hljs-string">'lib'</span>, <span class="hljs-string">'[name]-manifest.json'</span>), <span class="hljs-comment">// put the manifest file in lib directory</span></span><br><span class="line">      name: <span class="hljs-string">'[name]_[hash]'</span>, <span class="hljs-comment">// be consistent with library name to make the map correct</span></span><br><span class="line">      context: __dirname,</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Context-in-Dev-Config"><a href="#Context-in-Dev-Config" class="headerlink" title="Context in Dev Config"></a>Context in Dev Config</h4><p>Set the DllReferencePlugin.context same as DllPlugin.context so the manifest will bundle and resolve the dll files from the same root directory.</p>
<h4 id="Add-dll-bundle-to-html"><a href="#Add-dll-bundle-to-html" class="headerlink" title="Add dll bundle to html"></a>Add dll bundle to html</h4><p>After bundle the dll, I should insert it betore app.js in the html file to provide the <strong>global</strong> function.</p>
<ul>
<li>Step 1: Copy the dll files to the dist directory</li>
</ul>
<p>I use the <code>copy-webpack-plugin</code> plugin</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.js</span></span><br><span class="line"><span class="hljs-keyword">new</span> CopyPlugin([</span><br><span class="line">  &#123; <span class="hljs-keyword">from</span> <span class="hljs-string">'./lib/*.js'</span> &#125; <span class="hljs-comment">// default to output.path, so the dll file will be copied to output.path/lib/*.js</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<ul>
<li>Generate a manifest of the dll files for html-webpack-plugin to insert to the template</li>
</ul>
<p>I use the <code>webpack-manifest-plugin</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.dll.js</span></span><br><span class="line"><span class="hljs-keyword">new</span> ManifestPlugin()</span><br></pre></td></tr></table></figure>
<p>It will generate the <code>manifest.json</code> in output.path</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"vendor.js"</span>: <span class="hljs-string">"vendor_0642aa84a6959d661519.js"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Insert the Manifest into the html</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//parse the json</span></span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs)</span></span><br><span class="line"><span class="hljs-string">const manifest = JSON.parse(fs.readFileSync(require('</span>./lib/manifest.json<span class="hljs-string">')))</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">// insert</span></span><br><span class="line"><span class="hljs-string">new HtmlPlugin(&#123;</span></span><br><span class="line"><span class="hljs-string">  //...</span></span><br><span class="line"><span class="hljs-string">  dll: `./lib/$&#123;manifest['</span>vendor.js<span class="hljs-string">']&#125;`, // the dll file locates at ./lib/*.js</span></span><br><span class="line"><span class="hljs-string">&#125;)</span></span><br></pre></td></tr></table></figure>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><h3 id="Dll-Config"><a href="#Dll-Config" class="headerlink" title="Dll Config"></a>Dll Config</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> ManifestPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-manifest-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [<span class="hljs-string">'./src/vendor'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="hljs-string">'[name]_[hash].js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="hljs-string">'lib'</span>),</span><br><span class="line">    library: <span class="hljs-string">'[name]_[hash]'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      name: <span class="hljs-string">'[name]_[hash]'</span>,</span><br><span class="line">      path: path.resolve(__dirname, <span class="hljs-string">'lib'</span>, <span class="hljs-string">'[name]-manifest.json'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> ManifestPlugin(),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Dev-Config"><a href="#Dev-Config" class="headerlink" title="Dev Config"></a>Dev Config</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> HtmlPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> CopyPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'copy-webpack-plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> manifest = <span class="hljs-built_in">JSON</span>.parse(fs.readFileSync(<span class="hljs-string">'./lib/manifest.json'</span>))</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: [<span class="hljs-string">'./src/index'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="hljs-string">'scripts/[name].bundle.js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="hljs-string">'dist'</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">      template: path.resolve(__dirname, <span class="hljs-string">'src'</span>, <span class="hljs-string">'templates'</span>, <span class="hljs-string">'index.html'</span>),</span><br><span class="line">      title: <span class="hljs-string">'dev'</span>,</span><br><span class="line">      dll: <span class="hljs-string">`./lib/<span class="hljs-subst">$&#123;manifest[<span class="hljs-string">'vendor.js'</span>]&#125;</span>`</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">      context: <span class="hljs-string">'.'</span>,</span><br><span class="line">      manifest: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/vendor-manifest'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> CopyPlugin([</span><br><span class="line">      &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">'./lib/*.js'</span>&#125;</span><br><span class="line">    ]),</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-07T05:33:23.000Z">2017-09-07</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 684 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/07/optimize-web-app/">Optimize Web App</a>
            
        </h1>
        <div class="content">
            <h3 id="Optimizing-All-Assets"><a href="#Optimizing-All-Assets" class="headerlink" title="Optimizing All Assets"></a>Optimizing All Assets</h3><p>One of the most powerful, but under-utilized ways to significantly improve performance starts with understanding hwo the browser analyzes and serves assets. It turns out that browsers are pretty great at discovering resources while parsing and determing their priority of the fly. Here’s where the <strong>critical Request</strong> comes in:</p>
<blockquote>
<p>A request is critical if it contains assets that are necessary to render the content within the users’ viewport.</p>
</blockquote>
<p>For most sites, it’d be HTML, necessary CSS, a logo, a web font and maybe an image.</p>
<p>We can control this behavior by carefully picking critical resources and adjusting theri priority.</p>
<h4 id="preload"><a href="#preload" class="headerlink" title="preload"></a>preload</h4><p>With <code>&lt;link red=&#39;preload&#39;&gt;</code> we are <strong>able to manually force assets’ priority to <code>High</code> ensuring that desired content will be rendered on time</strong>.</p>
<p>This technique can yield significant improvements in Time to Interactive metric, making optimal user experience possible.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*JT-53LslhwOOqTgv1dGoXg.png" alt=""></p>
<p>Critical requests still seem like a black box for many, and the lack of sharable materials doesn’t help to change that.jj</p>
<h3 id="Optimizing-Images"><a href="#Optimizing-Images" class="headerlink" title="Optimizing Images"></a>Optimizing Images</h3><p>Images often account for most of a web page’s transferred payload.</p>
<h4 id="Choosing-the-right-format"><a href="#Choosing-the-right-format" class="headerlink" title="Choosing the right format"></a>Choosing the right format</h4><p>The initial choice falls between vector and raster graphics:</p>
<ul>
<li><p><strong>Vector</strong>: resolution independent, usually significantly smaller in size. Perfect for logos, iconography and simple assets comprising of basic shapes.</p>
</li>
<li><p><strong>Raster</strong>: offers much more detailed results, ideal for photographs.</p>
</li>
</ul>
<p>After making this decision, there are a fair bit of formats to choose from: <code>JPEG</code>, <code>GIF</code>, <code>PNG-8</code>, <code>PNG-24</code> or newest formats such as <code>WEBP</code> or <code>JPEG-XR</code>, <code>JPEG-2000</code>.</p>
<ul>
<li><p><strong>JPEG</strong>: Imagery with many color(e.g. photos)</p>
</li>
<li><p><strong>PNG-8</strong>: Imagery with a few color</p>
</li>
<li><p><strong>PNG-24</strong>: Imagery with partial transparency</p>
</li>
<li><p><strong>GIF</strong>: Animated imagery</p>
</li>
</ul>
<h3 id="Experimenting-with-new-formats"><a href="#Experimenting-with-new-formats" class="headerlink" title="Experimenting with new formats"></a>Experimenting with new formats</h3><p><strong>WebP</strong> is easily the most popular contender, supporting both lossless and lossy compression, which makes it incredibly versatile. <strong>Lossless WebP is 26% smaller than PNGs and 25-34% smaller than JPGs</strong>. With 74% browser support it can safely be used with fallback. JPGs and PNGs can be converted to WebP in PS and other image processing app as well as through command line interface(<code>brew install webp</code>).</p>
<h3 id="Responsible-and-responsive-Imagery"><a href="#Responsible-and-responsive-Imagery" class="headerlink" title="Responsible and responsive Imagery"></a>Responsible and responsive Imagery</h3><p>W’re perfectly equipped to do so with <code>picture</code> element and <code>srcset</code> attribute(both have 85% support)</p>
<h4 id="The-srcset-attribute"><a href="#The-srcset-attribute" class="headerlink" title="The srcset attribute"></a>The srcset attribute</h4><p><code>srcset</code> works best in the resolution switching scenario – when we want to display imagery based on user’s screen density and size. Baseed on a set of predefined rules in <code>srcset</code> and <code>size</code> attributes the browser will pick the best image to serve accordingly to the viewport.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*87BIfYsjZTh-bikjmp7eow.png" alt=""></p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">img</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">srcset</span>=<span class="hljs-string">"cat-320w.jpg 320w cat-480w.jpg 480w cat-800w.jpg 800w"</span>,</span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">sizes</span>=<span class="hljs-string">"(max-width: 320px) 100vw, (max-width: 480px) 80vw, 800px"</span>,</span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">src</span>=<span class="hljs-string">"cat-800w.jpg"</span></span></span><br><span class="line"><span class="hljs-tag">  <span class="hljs-attr">alt</span>=<span class="hljs-string">"cat"</span></span></span><br><span class="line"><span class="hljs-tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="The-picture-element"><a href="#The-picture-element" class="headerlink" title="The picture element"></a>The picture element</h4><p><code>picture</code> element and the <code>media</code> attribute are designed to make art direction easy. BY providing different sources for varying conditions.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*NeyfH6Vu1xCWE2SY5w1cDQ.png" alt=""></p>
<h4 id="Delivery-with-image-CNDs"><a href="#Delivery-with-image-CNDs" class="headerlink" title="Delivery with image CNDs"></a>Delivery with image CNDs</h4><h3 id="Optimizing-Web-Fonts"><a href="#Optimizing-Web-Fonts" class="headerlink" title="Optimizing Web Fonts"></a>Optimizing Web Fonts</h3><h4 id="Choose-the-right-format"><a href="#Choose-the-right-format" class="headerlink" title="Choose the right format"></a>Choose the right format</h4><p>There are four web font formats: <code>EOT</code>, <code>TTF</code>, <code>WOFF</code> and <code>WOFF2</code>.</p>
<p>TTF and WOFF are most widely adopted, boasting over 90% browser support. Depending on the support you’re targeting <strong>it’s most likely safe to server WOFF2</strong> and fall back to WOFF for older browsers. The advantage of using WOFF2 is a set of custom preprocessing and compression algorithms resulting in approx 30% file-size reduction and impoved parsing capabilities.</p>
<p>When defining the sources of web fonts in <code>@font-face</code> use the <code>format()</code> hint to specify which format should be utilized.</p>
<h4 id="use-Unicode-range-subsetting"><a href="#use-Unicode-range-subsetting" class="headerlink" title="use Unicode-range subsetting"></a>use Unicode-range subsetting</h4><h4 id="Establish-a-font-loading-strategy"><a href="#Establish-a-font-loading-strategy" class="headerlink" title="Establish a font loading strategy"></a>Establish a font loading strategy</h4><p>Fonts are render-blocking – because the browser has to build both the DOM and CSSOM first. Wdb fonts won’t be downloaded before they’re used in a CSS selector that matches an existing node. This behavior significantly delays text rendering, often causing the <strong>Flash of Invisible Text</strong>(FOIT).</p>
<p>Implementing a font strategy prevents users from not being able to access your content.</p>
<p><code>font-display</code> is a new CSS property providing a non-javascript reliant solution.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@font-face &#123;</span><br><span class="line">  font-family: Post Grotesk;</span><br><span class="line">  src: url(<span class="hljs-string">'/fonts/Post-Growtest.woff2'</span>) format(<span class="hljs-string">'woff2'</span>),</span><br><span class="line">       url(<span class="hljs-string">'/fonts/Post-Growtest.woff'</span> format(<span class="hljs-string">'woff'</span>)),</span><br><span class="line">  font-display: swap; <span class="hljs-comment">// show fallback until web font is ready</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Optmizing-JS"><a href="#Optmizing-JS" class="headerlink" title="Optmizing JS"></a>Optmizing JS</h3>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-07T03:57:10.000Z">2017-09-07</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 minutes read (About 1495 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/07/Concept-on-BlockChain/">Concept on BlockChain</a>
            
        </h1>
        <div class="content">
            <p>A Blockchain is</p>
<blockquote>
<p>A distributed database that is used to maintain a continuously growing list of records, called block.</p>
</blockquote>
<p>A Block contains following information:</p>
<ul>
<li><p>Index(Block #) - Which block is it? (Genesis block has index 0)</p>
</li>
<li><p>Hash: Is the block valid?</p>
</li>
<li><p>Previous Hash: It the previous block valid?</p>
</li>
<li><p>Timestamp: When was the block added?</p>
</li>
<li><p>Data: What information is stored on the block?</p>
</li>
<li><p>Nonce: How many iterations did we go through before we found a valid block?</p>
</li>
</ul>
<h3 id="Genesis-Block"><a href="#Genesis-Block" class="headerlink" title="Genesis Block"></a>Genesis Block</h3><p>Every Blockchain will st art with the <code>Genesis Block</code>, each block on the blockchain is dependent on the previous block, so the Genesis Block is needed to mine our first block.</p>
<h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><p>A <strong>hash value</strong> is a numeric value of a fixed length that uniquely identifies data.</p>
<p>The hash is calculated by taking the <strong>index</strong>, <strong>previous block hash</strong>, <strong>timestamp</strong>, <strong>block data</strong>, and <strong>nonce</strong> as input.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CryptoJS.SHA256(index + previousHash + timestamp + data + nonce)</span><br></pre></td></tr></table></figure>
<h3 id="Leading-0-in-the-block-hash"><a href="#Leading-0-in-the-block-hash" class="headerlink" title="Leading 0 in the block hash"></a>Leading 0 in the block hash</h3><p>Specified leading 0 is a minimum requirement for a valid hash. The number of leading 0 required is called <strong>difficulty</strong>.</p>
<p>The is also known as the <strong>Proof-of-Work</strong> system.</p>
<h3 id="Nonce"><a href="#Nonce" class="headerlink" title="Nonce"></a>Nonce</h3><p>A nonce is a number used to find a valid hash</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> nonce = <span class="hljs-number">0</span></span><br><span class="line"><span class="hljs-keyword">let</span> hash</span><br><span class="line"><span class="hljs-keyword">let</span> input</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">while</span> (!isValidHashDifficulty(hash)) &#123;</span><br><span class="line">  nonce += <span class="hljs-number">1</span></span><br><span class="line">  input = index + previousHash + timeStamp + data + nonce</span><br><span class="line">  hash = CryptoJS.SHA256(input)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The nocne iterates until the hash is valid.</p>
<p>The process of finding a nonce that corresponds to a valid hash is <strong>mining</strong>.</p>
<p>As the difficulty <strong>increase</strong>, the number of possible valid hashes <strong>decrese</strong>. With less possible valid hashes, it takes more processing power to find a valid hash.</p>
<h3 id="Ethereum-Virtual-Machine-EVM"><a href="#Ethereum-Virtual-Machine-EVM" class="headerlink" title="Ethereum Virtual Machine (EVM)"></a>Ethereum Virtual Machine (EVM)</h3><p>The Ethereum Virtual Machine or EVM is the runtime environment for smart contracts in Ethereum. It is not only sandboxed but actually completely isolated, which means that code running inside the EVM has no access to network, filesystem or other processes. Smart contract even have limited access to other smart contracts.</p>
<h4 id="Accounts"><a href="#Accounts" class="headerlink" title="Accounts"></a>Accounts</h4><p>There are two kinds of accounts in Ethereum which share the same address space:</p>
<ul>
<li><p><code>External Account</code> that are controlled by public-private key pairs(i.e. humans)</p>
</li>
<li><p><code>Contract Account</code> that are controlled by the code stored together with accounts</p>
</li>
</ul>
<p>The address of an external account is determined from the public key while the address of a contract is determined at the time the contract is created(it is derived from the creator address and the number of transactions sent from the address, the so-called ‘nonce’).</p>
<p>Every account has a <strong>persistent key-value store mapping 256-bit words to 256-bit words</strong> called <strong>storage</strong>.</p>
<p>Every account has a <strong>balance</strong> in Ether(in <em>Wei</em> to be exact) which can be modified by sending transactions that include Ether.</p>
<h4 id="transactions"><a href="#transactions" class="headerlink" title="transactions"></a>transactions</h4><p>A transaction is a message that is sent from one account to another account(which might be the same or the special <strong>zero-account</strong>). It can include binary data(its payload) and Ether.</p>
<p>If the target account contains code, that code is executed and the payload is provided as input data.</p>
<p>If the target account is the <em>zero-account</em>(the account with the address 0), the transaction creates a <strong>new contract</strong>.</p>
<p>As memtioned, the address of that contract is not the zero address but an address derived from the sender and its number of transactions sent(nonce). <strong>The payload of such a contract creation transaction is taken to be EVM bytecode and executed to generate the new contract</strong></p>
<p>The output of the bytecode, namely the new contract, is permenantly stored.</p>
<h4 id="Gas"><a href="#Gas" class="headerlink" title="Gas"></a>Gas</h4><p>Each transaction is charged with a certain with a certain amount of <strong>gas</strong>, whose purpose is to limit the amount of work that is needed to executed the transaction and to pay for this execution.</p>
<p>While the EVM executes the transaction, the gas is gradually depleted according to specific rules.</p>
<p>The <code>gas price</code> is a value set by the creator of the transaction, who has to pay <code>gas_price * gas</code>.</p>
<h4 id="Storage-Memory-and-the-Stack"><a href="#Storage-Memory-and-the-Stack" class="headerlink" title="Storage, Memory and the Stack"></a>Storage, Memory and the Stack</h4><p>Each account has a persistent memory area which is called <strong>storage</strong>. Storage is a <strong>key-value</strong> store taht maps 256-bit word to 256-bit word.</p>
<p>The second memory area is called <strong>memory</strong>, of which a contract obtains a freshly cleared instance for each message call. Memory is linear and can be addressed at byte level, but reads are limited to a width of 256 bits, white writes can be either 8btis or 256bits wide.</p>
<p>Memory is expanded by a word(256-bit), when accessing (either reading or writing) a previously untouched memory word. At the time of expansion, the cost in gas must be paid. Memory is more costly the larger it grows(it scales quadratically).</p>
<p>The EVM is not a register machine but a stack machine, so all computations are performed on an area called the <strong>stack</strong>. It has limited to the top end in the following way:</p>
<ul>
<li><p>it is possible to copy one of the topmost 16 elements to the top of the stack or swap the topmost 2(or 1, or more, depending on the opeartion) element fomr the stack and push the result onto the stack.</p>
</li>
<li><p>All other operation take the topmost 2(or 1, or more, depending on the operation) elements from the stack and push the result onto the stack.</p>
</li>
<li><p>It is possible to move stack elements to storage or memory</p>
</li>
<li><p>It is not possible to just access arbitrary elements deeper in the stack without removing the top of the stack.</p>
</li>
</ul>
<h3 id="Instruction-Set"><a href="#Instruction-Set" class="headerlink" title="Instruction Set"></a>Instruction Set</h3><p>The instruction set of the EVM is kept minimal in order to avoid incorrect implementations which could cuase consensus problem. All instructions operate ont he basic data type, 256-bit words.</p>
<p>The usual arihmetic bit, logical and comparison operations are present. Conditional and unconditional jumps are possible. Furthermore, contracts can access relevant properties of the current block like its number and timestamp.</p>
<h3 id="Message-Calls"><a href="#Message-Calls" class="headerlink" title="Message Calls"></a>Message Calls</h3><p>Contracts can call other contracts or send Ether to non-contract accounts by the means of the message calls.</p>
<p>Message calls are similar to transactions, in that tehy have a <strong>source</strong>, a <strong>target</strong>, <strong>data payload</strong>, <strong>Ether</strong>, <strong>gas</strong>, and return <strong>data</strong>.</p>
<p>In fact, every transaction consists of a top-level message call which in turn can create further message calls.</p>
<p>A contract can decide how much of its remaining <strong>gas</strong> should be sent with the inner message call and how much it wants to retain. If an out-of-gas exception happens in the inner call(or any other exception), this will be signalled by an error value put onto the stack. In this case, only the gas sent together with the call is used up.</p>
<p>Summarily, a called contract(which can be the same as caller) will receive a <strong>freshly cleared instance of memoery</strong>, and has access to the call payload - which will be provided in a separate area called the <strong>calldata</strong>. After it has finished execution, it can return data which will be stored at a location in the caller’s memory preallocated by the caller.</p>
<p>Calls are limited to depth of 1024, which means that for more complex operations, loops should be preferred over recursive calls.</p>
<h3 id="Delegatecall-Callcode-and-Libraries"><a href="#Delegatecall-Callcode-and-Libraries" class="headerlink" title="Delegatecall / Callcode and Libraries"></a>Delegatecall / Callcode and Libraries</h3><p>There exists a special variant of a message call, named <strong>delegatecall</strong> which is identical to a message call apart from the fact taht the code at the target address is executed in the context of the calling contract and <code>msg.sender</code> and <code>msg.value</code> do not change their values.</p>
<p>This means that a contract can dynamically load code from a different address at runtime. Storage, current address and balance still refer to the calling contract, only the code is taken from teh called address.</p>
<p>This makes it possible to implement the ‘library’ feature in Solidity: Reusable library code that can be applied to a contract’s storage to implement a complex data structure.</p>
<h3 id="Logs"><a href="#Logs" class="headerlink" title="Logs"></a>Logs</h3><p>It is possible to store data in a special indexed data structure that maps all the way up to the block level. This feature called <strong>logs</strong> is used by Solidity in order to implement <strong>events</strong>. Contracts cannot access log data after it has been created, but they can efficiently accessed from outside the blockchain.</p>
<p>Since some part of the log data is stored in bloom filters, it is possible to search for this data in an efficient and crypographically secure way, so network peers that do not download the whole blockchain(‘light clients’) can still find these logs.</p>
<h3 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h3><p>Contracts can even create other contract s using a special opcode. The only difference between <strong>create calls</strong> and normal message calls is that the payload data is executed and the result stored as code and the caller/creator receives the address of the new contract on the stack.</p>
<h3 id="Self-destruct"><a href="#Self-destruct" class="headerlink" title="Self-destruct"></a>Self-destruct</h3><p>The only possible that code is removed from the blockchain is when a contract at that address performs the <code>selfdestruct</code> operation. The remaining Ether stored at that address is sent to a designed target and then the storage and code is removed from the state.</p>
<blockquote>
<p>Even if a contract’s code does not contain a call to <code>selfdestruct</code>, it can still perform that operation using <code>delegatecall</code> or <code>callcode</code>.</p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-06T02:04:08.000Z">2017-09-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 292 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/06/Build-Node-CLI/">Build Node CLI</a>
            
        </h1>
        <div class="content">
            <h3 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h3><ul>
<li><p>chalk: colorize the output</p>
</li>
<li><p>clear: clears the terminal screen</p>
</li>
<li><p>clui: draws command line tables, gauges and spinners</p>
</li>
<li><p>figlet: creates ASCII art from text</p>
</li>
<li><p>inquirer - create interactive command line user interface</p>
</li>
<li><p>minimist - parses argument options</p>
</li>
<li><p>preferences - manage CLI application encrypted preferences</p>
</li>
</ul>
<h4 id="chalk"><a href="#chalk" class="headerlink" title="chalk"></a>chalk</h4><ul>
<li><p><code>chalk.&lt;style&gt;[.&lt;style&gt;...](string, [string...])</code></p>
<p>  chalk.red.bold.underline(‘Hello’, ‘World’)</p>
</li>
<li><p>chalk`string {&lt;style&gt; &lt;style&gt;… string} string`</p>
<p>  chalk`There are { bold 5280 feet } in a mile `</p>
</li>
</ul>
<h4 id="clear"><a href="#clear" class="headerlink" title="clear"></a>clear</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> clear = <span class="hljs-built_in">require</span>(<span class="hljs-string">'clear'</span>)</span><br><span class="line">clear()</span><br></pre></td></tr></table></figure>
<h4 id="clui"><a href="#clui" class="headerlink" title="clui"></a>clui</h4><p>Display</p>
<ul>
<li><p>Gauge</p>
</li>
<li><p>PrograssBar</p>
</li>
<li><p>Sparklines</p>
</li>
<li><p>Spinners</p>
</li>
</ul>
<p>on Terminal</p>
<h4 id="figlet"><a href="#figlet" class="headerlink" title="figlet"></a>figlet</h4><p>Display ASCII font on Terminal</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">figlet.text(<span class="hljs-string">'Boo'</span>, &#123;</span><br><span class="line">  font: <span class="hljs-string">'Ghost'</span>,</span><br><span class="line">  horizontalLayout: <span class="hljs-string">'default'</span>,</span><br><span class="line">  verticalLayout: <span class="hljs-string">'default'</span></span><br><span class="line">&#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, data</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">figlet.textSync(<span class="hljs-string">'Boo'</span>, &#123;</span><br><span class="line">  font: <span class="hljs-string">'Ghost'</span>,</span><br><span class="line">  horizontalLayout: <span class="hljs-string">'default'</span>,</span><br><span class="line">  verticalLayout: <span class="hljs-string">'default'</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="inquirer"><a href="#inquirer" class="headerlink" title="inquirer"></a>inquirer</h4><p>A collection of common interactive command line user interface.</p>
<ul>
<li><p><code>inquirer.prompt(questions) =&gt; promise</code></p>
<ul>
<li><p><code>questions</code> an Array containing <code>Question Object</code>(using the reactive interface, you can also pass a Rx.observable instance)</p>
<ul>
<li><code>Question Object</code>:</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// &#123;</span></span><br><span class="line"><span class="hljs-comment">//   type: string, //['input', 'confirm', 'list', 'rawlist', 'expand', 'checkbox', 'password', 'editor']</span></span><br><span class="line"><span class="hljs-comment">//   name: string, // the name to use when storeing the answer in the answer hash</span></span><br><span class="line"><span class="hljs-comment">//   message: string|function,  // The question to print, if defined as a function, the first parameter will be the current inquirer session answer</span></span><br><span class="line"><span class="hljs-comment">//   default: string|number|array|function, // default value to use</span></span><br><span class="line"><span class="hljs-comment">//   choices: array|function,</span></span><br><span class="line"><span class="hljs-comment">//   validate: function, // receive the user input and answers hash, should return true if the value is valid, and an error message(string) otherwise. If a false is returned, a default error message is provided.</span></span><br><span class="line"><span class="hljs-comment">//   filter: function, //</span></span><br><span class="line"><span class="hljs-comment">//   when: function|boolean, //</span></span><br><span class="line"><span class="hljs-comment">//   pageSize: number, //</span></span><br><span class="line"><span class="hljs-comment">// &#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="minimist"><a href="#minimist" class="headerlink" title="minimist"></a>minimist</h4><h4 id="preferences"><a href="#preferences" class="headerlink" title="preferences"></a>preferences</h4><h3 id="Make-CLI-globally-available"><a href="#Make-CLI-globally-available" class="headerlink" title="Make CLI globally available"></a>Make CLI globally available</h3><p>Add a shebang line to the top of <code>index.js</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#!/usr/bin/env node</span></span><br></pre></td></tr></table></figure>
<p>Then add a <code>bin</code> prototype to <code>package.json</code>.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"bin": &#123;</span><br><span class="line">  "cli-init": "./index.js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-05T12:31:15.000Z">2017-09-05</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 0 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/05/Build-a-Node-Command-Line-Interface/">Build a Node Command Line Interface</a>
            
        </h1>
        <div class="content">
            
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-05T07:10:04.000Z">2017-09-05</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    14 minutes read (About 2037 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/05/start-up-with-ts-react-router-redux-rxjs/">Start Up With Ts, React, Router, Redux, Rxjs</a>
            
        </h1>
        <div class="content">
            <p>The <a href="https://github.com/Keith-CY/starter-of-react-redux-router-rxjs.git" target="_blank" rel="noopener">Repo</a></p>
<h3 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h3><figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">"devDependencies": &#123;</span><br><span class="line">  "@types/react": "^16.0.5",</span><br><span class="line">  "@types/react-dom": "^15.5.4",</span><br><span class="line">  "@types/react-redux": "^5.0.6",</span><br><span class="line">  "@types/redux-actions": "^1.2.8",</span><br><span class="line">  "@types/webpack": "^3.0.10",</span><br><span class="line">  "@types/webpack-dev-server": "^2.4.1",</span><br><span class="line">  "autoprefixer": "^7.1.3",</span><br><span class="line">  "babel-core": "^6.26.0",</span><br><span class="line">  "babel-loader": "^7.1.2",</span><br><span class="line">  "babel-preset-env": "^1.6.0",</span><br><span class="line">  "babel-preset-react": "^6.24.1",</span><br><span class="line">  "bundle-loader": "^0.5.5",</span><br><span class="line">  "eslint": "^4.6.1",</span><br><span class="line">  "eslint-config-airbnb": "^15.1.0",</span><br><span class="line">  "eslint-plugin-import": "^2.7.0",</span><br><span class="line">  "eslint-plugin-jsx-a11y": "^6.0.2",</span><br><span class="line">  "eslint-plugin-react": "^7.3.0",</span><br><span class="line">  "html-webpack-plugin": "^2.30.1",</span><br><span class="line">  "node-sass": "^4.5.3",</span><br><span class="line">  "precss": "^2.0.0",</span><br><span class="line">  "redux-devtools": "^3.4.0",</span><br><span class="line">  "redux-devtools-dock-monitor": "^1.1.2",</span><br><span class="line">  "redux-devtools-log-monitor": "^1.3.0",</span><br><span class="line">  "rimraf": "^2.6.1",</span><br><span class="line">  "sass-loader": "^6.0.6",</span><br><span class="line">  "ts-loader": "^2.3.4",</span><br><span class="line">  "typescript": "next",</span><br><span class="line">  "uglifyjs-webpack-plugin": "^0.4.6",</span><br><span class="line">  "webpack": "^3.5.5",</span><br><span class="line">  "webpack-dashboard": "^1.0.0-5",</span><br><span class="line">  "webpack-dev-server": "^2.7.1",</span><br><span class="line">  "webpack-merge": "^4.1.0"</span><br><span class="line">&#125;,</span><br><span class="line">"dependencies": &#123;</span><br><span class="line">  "@types/node": "^8.0.26",</span><br><span class="line">  "@types/react-router-dom": "^4.0.7",</span><br><span class="line">  "babel-plugin-transform-runtime": "^6.23.0",</span><br><span class="line">  "extract-text-webpack-plugin": "^3.0.0",</span><br><span class="line">  "react": "^15.6.1",</span><br><span class="line">  "react-dom": "^15.6.1",</span><br><span class="line">  "react-redux": "^5.0.6",</span><br><span class="line">  "react-router": "^4.2.0",</span><br><span class="line">  "react-router-dom": "^4.2.2",</span><br><span class="line">  "redux": "^3.7.2",</span><br><span class="line">  "redux-actions": "^2.2.1",</span><br><span class="line">  "redux-observable": "^0.16.0",</span><br><span class="line">  "rxjs": "^5.4.3"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h3><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── config</span><br><span class="line">│   ├── webpack.config.base.js</span><br><span class="line">│   ├── webpack.config.dev.js</span><br><span class="line">│   ├── webpack.config.prod.js</span><br><span class="line">├── src</span><br><span class="line">│   ├── actions</span><br><span class="line">│   │   ├── index.tsx</span><br><span class="line">│   │   ├── hello.tsx</span><br><span class="line">│   ├── components</span><br><span class="line">│   │   ├── AsyncRoute.tsx</span><br><span class="line">│   ├── containers</span><br><span class="line">│   │   ├── App.tsx</span><br><span class="line">│   │   ├── Header.tsx</span><br><span class="line">│   │   ├── Body.jsx</span><br><span class="line">│   │   ├── Footer.tsx</span><br><span class="line">│   │   ├── Index.tsx</span><br><span class="line">│   │   ├── Page2.tsx</span><br><span class="line">│   │   ├── DevTools.tsx</span><br><span class="line">│   ├── epics</span><br><span class="line">│   │   ├── index.tsx</span><br><span class="line">│   │   ├── hello.tsx</span><br><span class="line">│   ├── reducers</span><br><span class="line">│   │   ├── index.tsx</span><br><span class="line">│   │   ├── hello.tsx</span><br><span class="line">│   ├── store</span><br><span class="line">│   │   ├── index.tsx</span><br><span class="line">│   │   ├── configureStore.dev.tsx</span><br><span class="line">│   │   ├── configureStore.prod.tsx</span><br><span class="line">│   ├── templates</span><br><span class="line">│   │   ├── index.html</span><br><span class="line">│   ├── utils</span><br><span class="line">│   │   ├── connect.tsx</span><br><span class="line">│   │   ├── nav.tsx</span><br><span class="line">│   ├── app.tsx</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── postcss.config.js</span><br><span class="line">├── .babelrc</span><br><span class="line">├── .eslintrc.js</span><br><span class="line">├── .gitignore</span><br><span class="line">├── yarn.lock</span><br></pre></td></tr></table></figure>
<h3 id="Step-1-Create-Project"><a href="#Step-1-Create-Project" class="headerlink" title="Step 1: Create Project"></a>Step 1: Create Project</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># init project</span></span><br><span class="line">yarn init -y</span><br></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># add eslint</span></span><br><span class="line">yarn add --dev eslint eslint-config-airbnb eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react</span><br><span class="line"></span><br><span class="line">eslint --init</span><br></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># add webpack</span></span><br><span class="line">yarn add --dev webpack webpack-dev-server webpack-dashboard webpack-merge @types/webpack @types/webpack-dev-server</span><br></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># add loader for jsx</span></span><br><span class="line">yarn add --dev babel-core babel-loader babel-preset-env babel-preset-react</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add loader for tsx</span></span><br><span class="line">yarn add --dev ts-loader typescript@next</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add loader for css</span></span><br><span class="line">yarn add --dev style-loader css-loader resolve-url-loader postcss-loader node-sass sass-loader</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add loader for file</span></span><br><span class="line">yarn add --dev url-loader file-loader</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add plugin for js</span></span><br><span class="line">yarn add babel-plugin-transform-runtime</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add plugin for postcss</span></span><br><span class="line">yarn add --dev autoprefixer precss</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add plugin for html</span></span><br><span class="line">yarn add --dev html-webpack-plugin</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add plugin for uglifyjs</span></span><br><span class="line">yarn add --dev uglifyjs-webpack-plugin</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># add plugin for extract css</span></span><br><span class="line">yarn add --dev extract-text-webpack-plugin</span><br></pre></td></tr></table></figure>
<h3 id="set-gitignore"><a href="#set-gitignore" class="headerlink" title="set gitignore"></a>set gitignore</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># Logs</span></span><br><span class="line">*.<span class="hljs-built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># dependencies</span></span><br><span class="line">node_modules</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># build</span></span><br><span class="line">dist</span><br></pre></td></tr></table></figure>
<h3 id="set-typescript-config"><a href="#set-typescript-config" class="headerlink" title="set typescript config"></a>set typescript config</h3><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"outDir"</span>: <span class="hljs-string">"dist"</span>,</span><br><span class="line">    <span class="hljs-attr">"module"</span>: <span class="hljs-string">"commonjs"</span>,</span><br><span class="line">    <span class="hljs-attr">"target"</span>: <span class="hljs-string">"es5"</span>,</span><br><span class="line">    <span class="hljs-attr">"lib"</span>: [<span class="hljs-string">"es6"</span>, <span class="hljs-string">"dom"</span>],</span><br><span class="line">    <span class="hljs-attr">"sourceMap"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-attr">"allowJs"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-attr">"jsx"</span>: <span class="hljs-string">"react"</span>,</span><br><span class="line">    <span class="hljs-attr">"moduleResolution"</span>: <span class="hljs-string">"node"</span>,</span><br><span class="line">    <span class="hljs-attr">"rootDir"</span>: <span class="hljs-string">"src"</span>,</span><br><span class="line">    <span class="hljs-attr">"noImplicitReturns"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-attr">"noImplicitThis"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-attr">"noImplicitAny"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">    <span class="hljs-attr">"strictNullChecks"</span>: <span class="hljs-literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-attr">"exclude"</span>: [</span><br><span class="line">    <span class="hljs-string">"config"</span>,</span><br><span class="line">    <span class="hljs-string">"node_modules"</span>,</span><br><span class="line">    <span class="hljs-string">"dist"</span>,</span><br><span class="line">    <span class="hljs-string">"webpack"</span>,</span><br><span class="line">    <span class="hljs-string">"jest"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="hljs-attr">"types"</span>: [</span><br><span class="line">    <span class="hljs-string">"typePatches"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Set-basic-webpack-config"><a href="#Set-basic-webpack-config" class="headerlink" title="Set basic webpack config"></a>Set basic webpack config</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// /config/webpack.config.base.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="hljs-string">'../dist'</span>),</span><br><span class="line">    filename: <span class="hljs-string">'scripts/[name]-[hash].js'</span>,</span><br><span class="line">    chunkFilename: <span class="hljs-string">'scripts/[name]-[chunkhash].js'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="hljs-regexp">/\.tsx?$/</span>,</span><br><span class="line">        loader: <span class="hljs-string">'ts-loader'</span>,</span><br><span class="line">        exclude: <span class="hljs-regexp">/node_modules/</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="hljs-regexp">/\.jsx?$/</span>,</span><br><span class="line">        loader: <span class="hljs-string">'babel-laoder'</span>,</span><br><span class="line">        exclude: <span class="hljs-regexp">/node_modules/</span>,</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="hljs-regexp">/\.(png|jpg)$/</span>,</span><br><span class="line">        loader: <span class="hljs-string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="hljs-number">8192</span>,</span><br><span class="line">          name: <span class="hljs-string">'[name]-[hash].[ext]'</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    extensions: [<span class="hljs-string">'.tsx'</span>, <span class="hljs-string">'.ts'</span>, <span class="hljs-string">'.jsx'</span>, <span class="hljs-string">'.js'</span>, <span class="hljs-string">'.scss'</span>, <span class="hljs-string">'.css'</span>, <span class="hljs-string">'.json'</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Set-dev-webpack-config"><a href="#Set-dev-webpack-config" class="headerlink" title="Set dev webpack config"></a>Set dev webpack config</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// /config/webpack.config.dev.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> HtmlPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> DashboardPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-dashboard/plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.config.base'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> devConfig = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: [</span><br><span class="line">      <span class="hljs-string">'webpack/hot/only-dev-server'</span>,</span><br><span class="line">      <span class="hljs-string">'webpack-dev-server/client?http://localhost:8080'</span>,</span><br><span class="line">      path.resolve(__dirname, <span class="hljs-string">'../src/app.tsx'</span>),</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="hljs-regexp">/\.scss$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="hljs-string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              modules: <span class="hljs-literal">true</span>,</span><br><span class="line">              name: <span class="hljs-string">'[local]-[name]-[hash]'</span></span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">        <span class="hljs-string">'resolve-url-loader'</span>,</span><br><span class="line">        <span class="hljs-string">'sass-loader'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  devtool: <span class="hljs-string">'source-map'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.NamedModulesPlugin(),</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.DefinePluing(&#123;</span><br><span class="line">      <span class="hljs-string">'process.env'</span>: &#123;</span><br><span class="line">        NODE_ENV: <span class="hljs-string">'development'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> DashboardPlugin(),</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">      title: <span class="hljs-string">'开发'</span>,</span><br><span class="line">      template: path.resolve(__dirname, <span class="hljs-string">'../src/temlates/index.html'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="hljs-literal">true</span>,</span><br><span class="line">    compress: <span class="hljs-literal">true</span>,</span><br><span class="line">    historyApiFallback: <span class="hljs-literal">true</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = merge(baseConfig, devConfig)</span><br></pre></td></tr></table></figure>
<h4 id="Set-prod-webpack-config"><a href="#Set-prod-webpack-config" class="headerlink" title="Set prod webpack config"></a>Set prod webpack config</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// /config/webpack.config.prod.js</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> ExtractTextPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'extract-text-webpack-plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> UglifyJSPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> HtmlPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.config.base.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> prodConfig = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: path.resolve(__dirname, <span class="hljs-string">'../src/app.tsx'</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      test: <span class="hljs-regexp">/\.scss$/</span>,</span><br><span class="line">      use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="hljs-string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              modules: <span class="hljs-literal">true</span>,</span><br><span class="line">              name: <span class="hljs-string">'[local]-[name]-[hash]'</span>,</span><br><span class="line">              importLoaders: <span class="hljs-number">3</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">        exclude: <span class="hljs-regexp">/node_modules/</span>,</span><br><span class="line">      &#125;), &#123;</span><br><span class="line">        loader: <span class="hljs-string">'postcss-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          config: path.resolve(__dirname, <span class="hljs-string">'./config/postcss.config.json'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="hljs-string">'resolve-url-loader'</span>,</span><br><span class="line">      <span class="hljs-string">'sass-loader'</span>,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  devtool: <span class="hljs-string">'inline-source-map'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.DefinePluing(&#123;</span><br><span class="line">      <span class="hljs-string">'process.env.NODE_ENV'</span>: <span class="hljs-string">'production'</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="hljs-string">'app'</span>,</span><br><span class="line">      filename: <span class="hljs-string">'scripts/vendor-[hash].min.js'</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">      title: <span class="hljs-string">'生产'</span>,</span><br><span class="line">      template: path.resolve(__dirnaem, <span class="hljs-string">'../src/templates/index.html'</span>),</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseBooleanAttributes: <span class="hljs-literal">true</span>,</span><br><span class="line">        collapseInlineTagWhitespace: <span class="hljs-literal">true</span>,</span><br><span class="line">        collapseWhitespace: <span class="hljs-literal">true</span>,</span><br><span class="line">        minifyCSS: <span class="hljs-literal">true</span>,</span><br><span class="line">        minifyJS: <span class="hljs-literal">true</span>,</span><br><span class="line">        removeAttributeQuotes: <span class="hljs-literal">true</span>,</span><br><span class="line">        removeComments: <span class="hljs-literal">true</span>,</span><br><span class="line">        removeEmptyAttributes: <span class="hljs-literal">true</span>,</span><br><span class="line">        removeRedundantAttributes: <span class="hljs-literal">true</span>,</span><br><span class="line">        removeTagWhitespace: <span class="hljs-literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> ExtractTextPlugin(&#123;</span><br><span class="line">      filename: <span class="hljs-string">'styles/[name]-[contenthash].css'</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> UglifyJSPlugin(),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Set-config-refered-by-webpack-babelrc-postcss-index-html"><a href="#Set-config-refered-by-webpack-babelrc-postcss-index-html" class="headerlink" title="Set config refered by webpack(babelrc, postcss, index.html)"></a>Set config refered by webpack(babelrc, postcss, index.html)</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// /.babelrc</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"presets"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="hljs-string">"env"</span>, &#123;</span><br><span class="line">        <span class="hljs-string">"targets"</span>: &#123;</span><br><span class="line">          <span class="hljs-string">"browsers"</span>: [<span class="hljs-string">"last 2 versions"</span>, <span class="hljs-string">"safari &gt;= 9"</span>],</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"react"</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="hljs-string">"plugins"</span>: [</span><br><span class="line">    [<span class="hljs-string">"transform-runtime"</span>, &#123;</span><br><span class="line">      <span class="hljs-string">"polyfill"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">      <span class="hljs-string">"regenerator"</span>: <span class="hljs-literal">true</span></span><br><span class="line">    &#125;],</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> precss = <span class="hljs-built_in">require</span>(<span class="hljs-string">'precss'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> autoprefixer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'autoprefixer'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    precss,</span><br><span class="line">    autoprefixer,</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%=</span> <span class="hljs-attr">htmlWebpackPlugin.options.title</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Step-2-Skeleton-of-React-App-React-Router"><a href="#Step-2-Skeleton-of-React-App-React-Router" class="headerlink" title="Step 2: Skeleton of React App(React + Router)"></a>Step 2: Skeleton of React App(React + Router)</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev bundle-laoder @types/react @types/react-dom @types/node @types/react-router-dom</span><br><span class="line"></span><br><span class="line">yarn add react react-dom react-router-dom</span><br></pre></td></tr></table></figure>
<p>In <code>src/app.tsx</code> render the App to html</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; render &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span></span><br><span class="line"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./containers/App'</span></span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;App /&gt;, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>) <span class="hljs-keyword">as</span> HTMLElement</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'./containers/App'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> App = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./containers/App'</span>).default</span><br><span class="line">    render (</span><br><span class="line">      &lt;App /&gt;,</span><br><span class="line">      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Create-App-Represental-Component"><a href="#Create-App-Represental-Component" class="headerlink" title="Create App Represental Component"></a>Create App Represental Component</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// `./src/containers/App.tsx`</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123;</span><br><span class="line">  BrowserRouter <span class="hljs-keyword">as</span> Router,</span><br><span class="line">  Route,</span><br><span class="line">&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">'./Header'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Body <span class="hljs-keyword">from</span> <span class="hljs-string">'./Body'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Footer <span class="hljs-keyword">from</span> <span class="hljs-string">'./Footer'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span> ()</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;Router&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">         &lt;Route path=<span class="hljs-string">"/"</span> component=&#123;Header&#125; /&gt;</span><br><span class="line">         &lt;Route path=<span class="hljs-string">"/"</span> component=&#123;Body&#125; /&gt;</span><br><span class="line">         &lt;Route path=<span class="hljs-string">"/"</span> component=&#123;Footer&#125; /&gt;</span><br><span class="line">        &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;/</span>Router&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Create-Header-Body-Footer-Containers"><a href="#Create-Header-Body-Footer-Containers" class="headerlink" title="Create Header, Body, Footer Containers"></a>Create Header, Body, Footer Containers</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/containers/Header.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; goTo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'..utils/nav'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Header</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  protected goTo = goTo.bind(<span class="hljs-keyword">this</span>)</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.state = &#123;</span><br><span class="line">      navs: [</span><br><span class="line">        &#123; <span class="hljs-attr">label</span>: <span class="hljs-string">'首页'</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">'index'</span> &#125;,</span><br><span class="line">        &#123; <span class="hljs-attr">label</span>: <span class="hljs-string">'第二页'</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">'page2'</span> &#125;,</span><br><span class="line">        &#123; <span class="hljs-attr">label</span>: <span class="hljs-string">'第三页'</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">'page3'</span> &#125;,</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> &#123; navs &#125; = <span class="hljs-keyword">this</span>.state</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          navs.map(</span><br><span class="line">            (nav: &#123;<span class="hljs-attr">label</span>: string, <span class="hljs-attr">url</span>: string&#125;) =&gt; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;nav.url&#125;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.goTo(nav.url)&#125;</span>&gt;</span>&#123;nav.label&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span></span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">    )</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">export default Header</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/utils/nav.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goTo</span>(<span class="hljs-params">url: string</span>) </span>&#123;</span><br><span class="line">  retrn () =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.props.history.push(url)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Same structure in Body and Footer.</p>
<h4 id="Add-AsyncRoute"><a href="#Add-AsyncRoute" class="headerlink" title="Add AsyncRoute"></a>Add AsyncRoute</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"></span><br><span class="line">interface PassedProps extends React.Props&lt;any&gt; &#123;</span><br><span class="line">  load: any;</span><br><span class="line">  children: any;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bundle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">PassedProps</span>, <span class="hljs-title">any</span>&gt; </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.state = &#123;</span><br><span class="line">      mod: <span class="hljs-literal">null</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillMount () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.load(<span class="hljs-keyword">this</span>.props)</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillReceiveProps (nextProps) &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (nextProps.load !== <span class="hljs-keyword">this</span>.props.load) &#123;</span><br><span class="line">      <span class="hljs-keyword">this</span>.load(nextProps)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  load (props) &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.setState(&#123;</span><br><span class="line">      mod: <span class="hljs-literal">null</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    props.load(<span class="hljs-function">(<span class="hljs-params">mod</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">this</span>.setState(&#123;</span><br><span class="line">        mod: mod.default || mod,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state.mod ? <span class="hljs-keyword">this</span>.props.children(<span class="hljs-keyword">this</span>.state.mod) : <span class="hljs-literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-built_in">module</span> =&gt; <span class="hljs-function"><span class="hljs-params">routerProps</span> =&gt;</span> (<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Bundle</span> <span class="hljs-attr">load</span>=<span class="hljs-string">&#123;module&#125;</span>&gt;</span></span></span><br><span class="line">  &#123; Comp =&gt; Comp ? &lt;Comp &#123;...routerProps&#125; /&gt; : null&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>And use it in body container</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Route &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> Index <span class="hljs-keyword">from</span> <span class="hljs-string">'bundle-loader?lazy!./Index'</span></span><br><span class="line"><span class="hljs-keyword">import</span> AsyncRoute <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/AsyncRoute'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> () =&gt; (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">   &lt;Route path=<span class="hljs-string">"/index"</span> component=&#123;AsyncRoute(Index)&#125;</span><br><span class="line">  &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">)</span></span><br></pre></td></tr></table></figure>
<h3 id="Add-Redux"><a href="#Add-Redux" class="headerlink" title="Add Redux"></a>Add Redux</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev redux-devtools redux-devtools-dock-monitor redux-devtools-log-monitor</span><br><span class="line"></span><br><span class="line">yarn add redux redux-actions react-redux</span><br></pre></td></tr></table></figure>
<h4 id="Create-Actions"><a href="#Create-Actions" class="headerlink" title="Create Actions"></a>Create Actions</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/actions/hello.tsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; createActions &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-actions'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createActions(&#123;</span><br><span class="line">  SAY_HELLO: <span class="hljs-function"><span class="hljs-params">text</span> =&gt;</span> (&#123; text &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// export</span></span><br><span class="line"><span class="hljs-comment">// &#123;</span></span><br><span class="line"><span class="hljs-comment">//   sayHello: (text: string) =&gt; (&#123; text: string &#125;)</span></span><br><span class="line"><span class="hljs-comment">// &#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/actions/index.tsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> helloActions <span class="hljs-keyword">from</span> <span class="hljs-string">'./hello'</span></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="line">  ...helloActions</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Create-Reducers"><a href="#Create-Reducers" class="headerlink" title="Create Reducers"></a>Create Reducers</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/reducers/hello.tsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; handleActions &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-actions'</span></span><br><span class="line"><span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">'../actions'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> handleActions(&#123;</span><br><span class="line">  [actions.sayHello.toString()]: <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> &#123; ...state, ...action.payload &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  text: <span class="hljs-string">''</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/reducers/index.tsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; combineReducers &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> helloReducer <span class="hljs-keyword">from</span> <span class="hljs-string">'./hello'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> combineReducers(&#123;</span><br><span class="line">  hello: helloReducer,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Create-Store"><a href="#Create-Store" class="headerlink" title="Create Store"></a>Create Store</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/store/configureStore.dev.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; createStore, applyMiddleware, compose, GenericStoreEnhancer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">'../reducers'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> enhancer = compose(</span><br><span class="line">  <span class="hljs-comment">// applyMiddleware(...middlewares)</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-built_in">window</span>.devToolsExtension ? <span class="hljs-built_in">window</span>.devToolsExtension() : <span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> f,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureStoreDev</span>(<span class="hljs-params">initState: any</span>): <span class="hljs-title">any</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> store = createStore(reducer, initState, enhancer)</span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</span><br><span class="line">    <span class="hljs-built_in">module</span>.hot.accpet(<span class="hljs-string">'../reducers'</span>, () =&gt; &#123;</span><br><span class="line">      store.replaceReducer(<span class="hljs-built_in">require</span>(<span class="hljs-string">'../reducers'</span>).default)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> store</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = configureStoreDev</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/store/configureStoreProd</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">'../reducers'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureStoreProd</span> (<span class="hljs-params">initState: any</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> createStore(reducer, initState)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = configureStoreProd</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/store/index.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> (process.env.NODE_ENV == <span class="hljs-string">'development'</span>) &#123;</span><br><span class="line">  <span class="hljs-built_in">module</span>.exports = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./configureStore.dev'</span>)</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">module</span>.exports = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./configureStore.prod'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Add-Provider-to-Main-Container"><a href="#Add-Provider-to-Main-Container" class="headerlink" title="Add Provider to Main Container"></a>Add Provider to Main Container</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./container/App.tsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123;</span><br><span class="line">  BrowserRouter <span class="hljs-keyword">as</span> Router,</span><br><span class="line">  Route,</span><br><span class="line">&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Provider &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">'./Header'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Body <span class="hljs-keyword">from</span> <span class="hljs-string">'./Body'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Footer <span class="hljs-keyword">from</span> <span class="hljs-string">'./Footer'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> configureStore = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../store'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> store = configureStore(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    returun (</span><br><span class="line">      &lt;Router&gt;</span><br><span class="line">        &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">          &lt;Route path=<span class="hljs-string">"/"</span> component=&#123;Header&#125; /&gt;</span><br><span class="line">          &lt;Route path=<span class="hljs-string">"/"</span> component=&#123;Body&#125; /&gt;</span><br><span class="line">          &lt;Route path=<span class="hljs-string">"/"</span> component=&#123;Body&#125; /&gt;</span><br><span class="line">        &lt;<span class="hljs-regexp">/Provider&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;/</span>Router&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="custom-connect-to-cache-mapStateToProps-and-mapDispatchToProps"><a href="#custom-connect-to-cache-mapStateToProps-and-mapDispatchToProps" class="headerlink" title="custom connect to cache mapStateToProps and mapDispatchToProps"></a>custom connect to cache mapStateToProps and mapDispatchToProps</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; connect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; bindActionCreators &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">'../actions'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> mapStateToProps = <span class="hljs-function">(<span class="hljs-params">state: any</span>) =&gt;</span> state</span><br><span class="line"><span class="hljs-keyword">const</span> mapDispatchToProps = <span class="hljs-function">(<span class="hljs-params">dispatch: any</span>) =&gt;</span> (bindActionCreators(actions, dispatch))</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> (Comp: any) =&gt; connect(mapStateToProps, mapDispatchToProps)(Comp)</span><br></pre></td></tr></table></figure>
<h4 id="Connect-the-Presentational-Container"><a href="#Connect-the-Presentational-Container" class="headerlink" title="Connect the Presentational Container"></a>Connect the Presentational Container</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> connect <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/connect'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; goTo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/nav'</span></span><br><span class="line"></span><br><span class="line">interface PassedProps extends React.Props&lt;any&gt; &#123;</span><br><span class="line">  sayHello: any;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Header</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">PassedProps</span>, <span class="hljs-title">any</span>&gt; </span>&#123;</span><br><span class="line">  protected goTo = goTo.bind(<span class="hljs-keyword">this</span>)</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.state = &#123;</span><br><span class="line">      navs: [</span><br><span class="line">        &#123; <span class="hljs-attr">label</span>: <span class="hljs-string">'首页'</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">'index'</span> &#125;,</span><br><span class="line">        &#123; <span class="hljs-attr">label</span>: <span class="hljs-string">'第二页'</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">'page2'</span> &#125;,</span><br><span class="line">        &#123; <span class="hljs-attr">label</span>: <span class="hljs-string">'第三页'</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">'page3'</span> &#125;,</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.props.sayHello(<span class="hljs-string">'world'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> &#123; navs &#125; = <span class="hljs-keyword">this</span>.state</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;navs.map(<span class="hljs-function">(<span class="hljs-params">nav: &#123; label: string, url: string&#125;</span>) =&gt;</span> &lt;span</span><br><span class="line">          key=&#123;nav.url&#125;</span><br><span class="line">          onClick=&#123;<span class="hljs-keyword">this</span>.goTo(nav.url)&#125;</span><br><span class="line">        &gt;&#123;nav.label&#125;&lt;<span class="hljs-regexp">/span&gt;)&#125;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(Header)</span><br></pre></td></tr></table></figure>
<h3 id="Add-Rxjs"><a href="#Add-Rxjs" class="headerlink" title="Add Rxjs"></a>Add Rxjs</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add rxjs redux-observable</span><br></pre></td></tr></table></figure>
<h4 id="Create-Epics"><a href="#Create-Epics" class="headerlink" title="Create Epics"></a>Create Epics</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/epics/hello.tsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">'rxjs'</span></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> sayHello = <span class="hljs-function">(<span class="hljs-params">action$, store</span>) =&gt;</span></span><br><span class="line">  .action$.ofType(<span class="hljs-string">'SAY_HELLO'</span>)</span><br><span class="line">  .delay(<span class="hljs-number">1000</span>)</span><br><span class="line">  .map(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;</span><br><span class="line">    type: <span class="hljs-string">'SAY_HELLO'</span>,</span><br><span class="line">    payload: &#123;</span><br><span class="line">      text: <span class="hljs-string">'got hello'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;))</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ./src/epcis/index.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; combineEpics &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-observable'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; sayHello &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./hello'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> combineEpics(</span><br><span class="line">  sayHello,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="Add-Epic-to-Enhancer"><a href="#Add-Epic-to-Enhancer" class="headerlink" title="Add Epic to Enhancer"></a>Add Epic to Enhancer</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; createStore, applyMiddleware, compose, GenericStoreEnhancer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; createEpicMiddleware &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-observable'</span></span><br><span class="line"><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">'../reducers'</span></span><br><span class="line"><span class="hljs-keyword">import</span> epics <span class="hljs-keyword">from</span> <span class="hljs-string">'../epics'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> epicMiddleware = createEpicMiddleware(epics)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> enhancer = compose(</span><br><span class="line">  applyMiddleware(epicMiddleware),</span><br><span class="line">  <span class="hljs-built_in">window</span>.devToolsExtension ? <span class="hljs-built_in">window</span>.devToolsExtension() : <span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> f</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureStoreDev</span> (<span class="hljs-params">initState: any</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> store = createStore(reducer, initState, enhancer)</span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</span><br><span class="line">    <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'../reducers'</span>, () =&gt; &#123;</span><br><span class="line">      store.replaceReducer(<span class="hljs-built_in">require</span>(<span class="hljs-string">'../reducers'</span>).default)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> store</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = configureStoreDev</span><br></pre></td></tr></table></figure>
<h3 id="Add-Service-Worker"><a href="#Add-Service-Worker" class="headerlink" title="Add Service Worker"></a>Add Service Worker</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add sw-precache-webpack-plugin</span><br></pre></td></tr></table></figure>
<h4 id="Add-the-Plugin-in-webpack-config-prod-js"><a href="#Add-the-Plugin-in-webpack-config-prod-js" class="headerlink" title="Add the Plugin in webpack.config.prod.js"></a>Add the Plugin in webpack.config.prod.js</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> SWPrecachePluing = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sw-precache-webpack-plugin'</span>)</span><br><span class="line">plugins: [</span><br><span class="line">  <span class="hljs-keyword">new</span> SWPrecachePluing()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="Add-Bundle-Analyzer"><a href="#Add-Bundle-Analyzer" class="headerlink" title="Add Bundle Analyzer"></a>Add Bundle Analyzer</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev webpack-bundle-anaylzer</span><br></pre></td></tr></table></figure>
<h3 id="Add-the-Plugin-in-webpack-config-dev-js"><a href="#Add-the-Plugin-in-webpack-config-dev-js" class="headerlink" title="Add the Plugin in webpack.config.dev.js"></a>Add the Plugin in webpack.config.dev.js</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> BundleAnalyzer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">  <span class="hljs-keyword">new</span> BundleAnalyzer()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="Add-Dll"><a href="#Add-Dll" class="headerlink" title="Add Dll"></a>Add Dll</h3><h4 id="Add-webpack-config-dll-js"><a href="#Add-webpack-config-dll-js" class="headerlink" title="Add webpack.config.dll.js"></a>Add webpack.config.dll.js</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.dll.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> ManifestPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-manifest-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [<span class="hljs-comment">/* ... */</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="hljs-string">'../lib'</span>),</span><br><span class="line">    filename: <span class="hljs-string">'[name]_[hash:5].js'</span>,</span><br><span class="line">    library: <span class="hljs-string">'[name]_[hash:5]'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      name: <span class="hljs-string">'[name]_[hash:5]'</span>,</span><br><span class="line">      path: path.resolve(__dirname, <span class="hljs-string">'../lib'</span>, <span class="hljs-string">'[name]-manifest.json'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> ManifestPlugin(),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Copy-dll-to-dist-and-refer"><a href="#Copy-dll-to-dist-and-refer" class="headerlink" title="Copy dll to dist and refer"></a>Copy dll to dist and refer</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.base.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> vendorManifest = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../lib/vendor-manifest.json'</span>)</span><br><span class="line">plugins: [</span><br><span class="line">  <span class="hljs-keyword">new</span> CopyPlugin([</span><br><span class="line">    &#123; <span class="hljs-attr">from</span>: path.resolve(__dirname, <span class="hljs-string">'../lib/*.js'</span>) &#125;,</span><br><span class="line">  ]),</span><br><span class="line">  <span class="hljs-keyword">new</span> webpack.DllReference(&#123;</span><br><span class="line">    manifest: vendorManifest,</span><br><span class="line">  &#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="Insert-Dll-files-in-html"><a href="#Insert-Dll-files-in-html" class="headerlink" title="Insert Dll files in html"></a>Insert Dll files in html</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// webpack.config.dev.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> manifest = <span class="hljs-built_in">JSON</span>.parse(fs.readFileSync(path.resolve(__dirname, <span class="hljs-string">'../lib/manifest.json'</span>)))</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlPlugin(&#123;</span><br><span class="line">      <span class="hljs-comment">// ...</span></span><br><span class="line">      dll: <span class="hljs-string">`./lib/<span class="hljs-subst">$&#123;manifest[<span class="hljs-string">'vendor.js'</span>]&#125;</span>`</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-05T01:41:10.000Z">2017-09-05</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 172 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/05/Notes-on-TS-React-Redux/">Notes on TS + React + Redux</a>
            
        </h1>
        <div class="content">
            <h3 id="Add-Explicit-Props-Interface-from-Store"><a href="#Add-Explicit-Props-Interface-from-Store" class="headerlink" title="Add Explicit Props Interface from Store"></a>Add Explicit Props Interface from Store</h3><p>When I use <code>react-redux</code>, the TS Compiler always throw an error:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TS2339: Property <span class="hljs-string">'...'</span> does not exist on <span class="hljs-built_in">type</span> <span class="hljs-string">'Readonly&lt;children?: ReactNode; &#125;&gt; &amp; Readonly&lt;&#123;&#125;&gt;'</span>.</span><br></pre></td></tr></table></figure>
<p>That’s because Connect was not supplying an explicit interface to the container component, so it was confused by the prop that it was trying to pass.</p>
<p>So you can add an explicit interface on child component.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface PropsFromStore extends React.Props&lt;any&gt; &#123;</span><br><span class="line">  propsFromStore: any;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChildComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">PropsFromStore</span>, <span class="hljs-title">React</span>.<span class="hljs-title">State</span>&gt; </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(ChildComponent)</span><br></pre></td></tr></table></figure>
<h3 id="Add-Enhancer-to-Store-with-TS"><a href="#Add-Enhancer-to-Store-with-TS" class="headerlink" title="Add Enhancer to Store with TS"></a>Add Enhancer to Store with TS</h3><p>When I use an enhancer like:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> enhancer = compose(</span><br><span class="line">  applyMiddleware(...middlewares),</span><br><span class="line">  DevTools.instrument(),</span><br><span class="line">  persistState(</span><br><span class="line">    <span class="hljs-built_in">window</span>.location.href.match(</span><br><span class="line">      /[?&amp;]debug_session=([^&amp;#]+)\b/</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>I got an error like:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ts] Argument of <span class="hljs-built_in">type</span> <span class="hljs-string">'Function'</span> is not assignable to parameter of <span class="hljs-built_in">type</span> <span class="hljs-string">'Func3&lt;&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, StoreEnhancerStoreCreator&lt;&#123;&#125;&gt;&gt;'</span>.</span><br><span class="line">Type <span class="hljs-string">'Function'</span> provides no match <span class="hljs-keyword">for</span> the signature <span class="hljs-string">'(a1: &#123;&#125;, a2: &#123;&#125;, a3: &#123;&#125;, ...args: any[]): &#123;&#125;'</span></span><br></pre></td></tr></table></figure>
<p>To resolve this, just:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; GenericStoreEnhancer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span></span><br><span class="line"><span class="hljs-keyword">const</span> enhancer = compose(</span><br><span class="line">  applyMiddleware(...middlewares),</span><br><span class="line">  DevTools.instrument <span class="hljs-keyword">as</span> GenericStoreEnhancer,</span><br><span class="line">  persistState(</span><br><span class="line">    <span class="hljs-built_in">window</span>.location.href.match(</span><br><span class="line">      /[?&amp;]debug_session=([^&amp;#]+)\b/</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-04T10:08:45.000Z">2017-09-04</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 88 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/04/AsyncRoute-with-React-Router-v4/">AsyncRoute With React-Router-V4</a>
            
        </h1>
        <div class="content">
            <figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// AsyncRoute.jsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> React, &#123; Component &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bundle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  constructur () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.state = &#123;</span><br><span class="line">      mod: <span class="hljs-literal">null</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillMount () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.load(<span class="hljs-keyword">this</span>.props)</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillReceiveProps (nextProps) &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (nextProps.load !== <span class="hljs-keyword">this</span>.props.load) &#123;</span><br><span class="line">      <span class="hljs-keyword">this</span>.load(nextProps)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  load (props) &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.setState(&#123;</span><br><span class="line">      mod: <span class="hljs-literal">null</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    props.load(<span class="hljs-function">(<span class="hljs-params">mod</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">this</span>.setState(&#123;</span><br><span class="line">        mod: mod.default || mod,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state.mod ? <span class="hljs-keyword">this</span>.props.children(<span class="hljs-keyword">this</span>.state.mod) : <span class="hljs-literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-built_in">module</span> =&gt; <span class="hljs-function"><span class="hljs-params">routerProps</span> =&gt;</span> (&lt;Bundle load=&#123;module&#125;&gt;</span><br><span class="line">  &#123;Comp =&gt; Comp ? &lt;Comp &#123;...routerProps&#125; /&gt; : null&#125;</span><br><span class="line">&lt;/Bundle&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Body.jsx</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Route &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span></span><br><span class="line"><span class="hljs-keyword">import</span> AsyncRoute <span class="hljs-keyword">from</span> <span class="hljs-string">'./AsyncRoute'</span></span><br><span class="line"><span class="hljs-keyword">import</span> Page <span class="hljs-keyword">from</span> <span class="hljs-string">'bundle-loader?lazy!./Page'</span></span><br><span class="line"></span><br><span class="line">&lt;Route component=&#123;AsyncRoute(Page)&#125; /&gt;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/4/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><a class="pagination-link is-current" href="/page/3/">3</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/4/">4</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/16/">16</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.jpg" alt="Keith Chen">
                    
                    
                    <p class="is-size-4 is-block">
                        Keith Chen
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        FE Engineer on Blockchain
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>30°17&#39;37N, 120°9&#39;41E</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        304
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        7
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        89
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/keith-CY" target="_blank">
                Follow</a>
        </div>
        
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/keith-CY" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Keith CY</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.linkedin.com/in/宇-陈-644b61ba" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Yu Chen</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.linkedin.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Soup/">
            <span class="level-start">
                <span class="level-item">Soup</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Uncategorized/">
            <span class="level-start">
                <span class="level-item">Uncategorized</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/github/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">141</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/note/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AJAX/" style="font-size: 10.91px;">AJAX</a> <a href="/tags/BOOTSTRAP/" style="font-size: 10px;">BOOTSTRAP</a> <a href="/tags/Bash/" style="font-size: 11.82px;">Bash</a> <a href="/tags/BlockChain/" style="font-size: 10px;">BlockChain</a> <a href="/tags/Blockchain/" style="font-size: 10px;">Blockchain</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/CSS/" style="font-size: 10.91px;">CSS</a> <a href="/tags/CSS3/" style="font-size: 20px;">CSS3</a> <a href="/tags/Closure/" style="font-size: 10px;">Closure</a> <a href="/tags/CommonJS/" style="font-size: 10px;">CommonJS</a> <a href="/tags/Contract-Ethereum-Web3/" style="font-size: 10px;">Contract, Ethereum, Web3</a> <a href="/tags/Contract-Solidity/" style="font-size: 10px;">Contract, Solidity</a> <a href="/tags/D3-Example/" style="font-size: 10px;">D3, Example</a> <a href="/tags/DAPP-Solidity/" style="font-size: 10px;">DAPP, Solidity</a> <a href="/tags/DApp-Solidity/" style="font-size: 10px;">DApp, Solidity</a> <a href="/tags/DOM/" style="font-size: 12.73px;">DOM</a> <a href="/tags/DevTools/" style="font-size: 10px;">DevTools</a> <a href="/tags/Drizzle-Ethereum-BlockChain/" style="font-size: 10px;">Drizzle, Ethereum, BlockChain</a> <a href="/tags/ES6/" style="font-size: 10.91px;">ES6</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/ETH-Wallet/" style="font-size: 10px;">ETH, Wallet</a> <a href="/tags/Elixir-Phoenix-SCSS/" style="font-size: 10px;">Elixir, Phoenix, SCSS</a> <a href="/tags/Erlang-Elixir-GenServer/" style="font-size: 10px;">Erlang, Elixir, GenServer</a> <a href="/tags/Ethereum/" style="font-size: 10px;">Ethereum</a> <a href="/tags/Ethereum-IPFS/" style="font-size: 10px;">Ethereum, IPFS</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Go-Http-Web/" style="font-size: 10px;">Go, Http, Web</a> <a href="/tags/GraphQL-Apollo-TypeScript/" style="font-size: 10px;">GraphQL, Apollo, TypeScript</a> <a href="/tags/Gulp/" style="font-size: 11.82px;">Gulp</a> <a href="/tags/HTML5/" style="font-size: 15.45px;">HTML5</a> <a href="/tags/HTTP2-Node/" style="font-size: 10px;">HTTP2, Node</a> <a href="/tags/Html-Picture/" style="font-size: 10px;">Html, Picture</a> <a href="/tags/Immutable/" style="font-size: 10px;">Immutable</a> <a href="/tags/Int8Array/" style="font-size: 10px;">Int8Array</a> <a href="/tags/JSON-RPC/" style="font-size: 10px;">JSON-RPC</a> <a href="/tags/Javascript/" style="font-size: 19.09px;">Javascript</a> <a href="/tags/Koa/" style="font-size: 10.91px;">Koa</a> <a href="/tags/Koa-NPM-Package/" style="font-size: 10px;">Koa, NPM, Package</a> <a href="/tags/MDL/" style="font-size: 16.36px;">MDL</a> <a href="/tags/Material-Design/" style="font-size: 17.27px;">Material Design</a> <a href="/tags/Mock-JavaScript/" style="font-size: 10px;">Mock, JavaScript</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/NODE/" style="font-size: 13.64px;">NODE</a> <a href="/tags/NPM/" style="font-size: 10.91px;">NPM</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Nock/" style="font-size: 10px;">Nock</a> <a href="/tags/Node-CLI/" style="font-size: 10.91px;">Node, CLI</a> <a href="/tags/Node-Fastify/" style="font-size: 10.91px;">Node, Fastify</a> <a href="/tags/Node-Graphql-Koa/" style="font-size: 10px;">Node, Graphql, Koa</a> <a href="/tags/Node-js/" style="font-size: 10.91px;">Node.js</a> <a href="/tags/Phoenix-Elixir-Ecto/" style="font-size: 10px;">Phoenix, Elixir, Ecto</a> <a href="/tags/Promise/" style="font-size: 11.82px;">Promise</a> <a href="/tags/Protobuf/" style="font-size: 10px;">Protobuf</a> <a href="/tags/Pug-HTML/" style="font-size: 10px;">Pug, HTML</a> <a href="/tags/React/" style="font-size: 18.18px;">React</a> <a href="/tags/React-Docker/" style="font-size: 10px;">React, Docker</a> <a href="/tags/React-Router-Code-splitting/" style="font-size: 10px;">React, Router, Code-splitting</a> <a href="/tags/React-Native/" style="font-size: 10px;">React-Native</a> <a href="/tags/React-Redux/" style="font-size: 10px;">React-Redux</a> <a href="/tags/React-Router/" style="font-size: 10.91px;">React-Router</a> <a href="/tags/Redux/" style="font-size: 14.55px;">Redux</a> <a href="/tags/RegExp/" style="font-size: 10px;">RegExp</a> <a href="/tags/Ruby-Rails/" style="font-size: 10px;">Ruby, Rails</a> <a href="/tags/Ruby-Rails-RoR-Mina/" style="font-size: 10px;">Ruby, Rails, RoR, Mina</a> <a href="/tags/Rust-Rocket/" style="font-size: 10px;">Rust, Rocket</a> <a href="/tags/RxJS/" style="font-size: 10px;">RxJS</a> <a href="/tags/Smart-Contract-Web3/" style="font-size: 10px;">Smart Contract, Web3</a> <a href="/tags/Solidity/" style="font-size: 12.73px;">Solidity</a> <a href="/tags/Solidity-Error-Handling/" style="font-size: 10px;">Solidity, Error Handling</a> <a href="/tags/Solidity-Public-External/" style="font-size: 10px;">Solidity, Public, External</a> <a href="/tags/Solidity-Smart-Contract/" style="font-size: 10px;">Solidity, Smart Contract</a> <a href="/tags/Thunk/" style="font-size: 10.91px;">Thunk</a> <a href="/tags/Trick/" style="font-size: 11.82px;">Trick</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Webpack-DLL/" style="font-size: 10px;">Webpack, DLL</a> <a href="/tags/automatic/" style="font-size: 10px;">automatic</a> <a href="/tags/babel/" style="font-size: 10px;">babel</a> <a href="/tags/babel-polyfill/" style="font-size: 10px;">babel-polyfill</a> <a href="/tags/blockchain-bitcoin-bip/" style="font-size: 10px;">blockchain, bitcoin, bip</a> <a href="/tags/commandline/" style="font-size: 10px;">commandline</a> <a href="/tags/github/" style="font-size: 10.91px;">github</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/precache/" style="font-size: 10px;">precache</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/webpack/" style="font-size: 17.27px;">webpack</a> <a href="/tags/webpack2/" style="font-size: 11.82px;">webpack2</a> <a href="/tags/测试/" style="font-size: 11.82px;">测试</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/16/keystore/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time></div>
                    <a href="/2019/03/16/keystore/" class="has-link-black-ter is-size-6">Keystore</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="5 Tips in CRA@2.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time></div>
                    <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="has-link-black-ter is-size-6">5 Tips in CRA@2.0</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/08/Assembly-in-Solidity/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Assembly in Solidity">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time></div>
                    <a href="/2018/11/08/Assembly-in-Solidity/" class="has-link-black-ter is-size-6">Assembly in Solidity</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/16/keystore/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time></div>
                    <a href="/2019/03/16/keystore/" class="has-link-black-ter is-size-6">Keystore</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="5 Tips in CRA@2.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time></div>
                    <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="has-link-black-ter is-size-6">5 Tips in CRA@2.0</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/08/Assembly-in-Solidity/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Assembly in Solidity">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time></div>
                    <a href="/2018/11/08/Assembly-in-Solidity/" class="has-link-black-ter is-size-6">Assembly in Solidity</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="EzCook" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Chen Yu&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>