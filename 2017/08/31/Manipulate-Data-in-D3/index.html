<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>Manipulate Data in D3 | EzCook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Use data imported from a csv file with spaces in the headerWhen importing data from a csv file(dataSpace.csv) that has headers with spaces in the middle of some of the fields there is need to address">
<meta property="og:type" content="article">
<meta property="og:title" content="Manipulate Data in D3">
<meta property="og:url" content="http://yoursite.com/2017/08/31/Manipulate-Data-in-D3/index.html">
<meta property="og:site_name" content="EzCook">
<meta property="og:description" content="Use data imported from a csv file with spaces in the headerWhen importing data from a csv file(dataSpace.csv) that has headers with spaces in the middle of some of the fields there is need to address">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://leanpub.com/site_images/d3-t-and-t-v4/htree-02.png">
<meta property="og:image" content="https://leanpub.com/site_images/d3-t-and-t-v4/htree-03.png">
<meta property="og:updated_time" content="2017-08-31T07:45:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Manipulate Data in D3">
<meta name="twitter:description" content="Use data imported from a csv file with spaces in the headerWhen importing data from a csv file(dataSpace.csv) that has headers with spaces in the middle of some of the fields there is need to address">
<meta name="twitter:image" content="https://leanpub.com/site_images/d3-t-and-t-v4/htree-02.png">
  
    <link rel="alternate" href="/atom.xml" title="EzCook" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>

  
    
      <body class="dark">
    
  
      <div id="container" class="container">
        <article id="post-Manipulate-Data-in-D3" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Manipulate Data in D3
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <h3 id="Use-data-imported-from-a-csv-file-with-spaces-in-the-header"><a href="#Use-data-imported-from-a-csv-file-with-spaces-in-the-header" class="headerlink" title="Use data imported from a csv file with spaces in the header"></a>Use data imported from a csv file with spaces in the header</h3><p>When importing data from a csv file(dataSpace.csv) that has headers with spaces in the middle of some of the fields there is need to address the data slightly differently in order for it to be used easily in your JavaScript.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Date Purchased,close</div><div class="line">1-May-12,58.13</div></pre></td></tr></table></figure>
<p>When we go to import the data using the d3.csv function, we need to reference the <code>Data Purchased</code> column in a way that makes allowances for the space. The following piece of script appears to be the most basic solution.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">d3.csv(<span class="string">'dataSpace.csv'</span>, (err, data) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line">  data.forEach(<span class="function"><span class="params">d</span> =&gt;</span> &#123;</div><div class="line">    d.date = parseTime(d[<span class="string">'Date Purchased'</span>])</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Histogram"><a href="#Histogram" class="headerlink" title="Histogram"></a>Histogram</h3><p>The <code>d3.histogram</code> function allows us to form our data into ‘bins’ that form <em>‘discrete samples into continous, non-overlapping intervals’</em>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// dtg,value</span></div><div class="line"><span class="comment">// 01-08-2010,3</span></div><div class="line"><span class="comment">// 01-08-2010,3</span></div><div class="line"><span class="comment">// 01-08-2010,3</span></div><div class="line"><span class="comment">// 01-08-2010,3</span></div><div class="line"><span class="comment">// 01-08-2010,3.1</span></div><div class="line"><span class="comment">// 01-08-2010,3.2</span></div><div class="line"><span class="comment">// 01-08-2010,3.2</span></div><div class="line"><span class="comment">// .</span></div><div class="line"><span class="comment">// .</span></div><div class="line"><span class="comment">// .</span></div><div class="line"><span class="comment">// 31-12-2011,3.2</span></div><div class="line"><span class="comment">// 31-12-2011,3.3</span></div><div class="line"><span class="comment">// 31-12-2011,3.4</span></div><div class="line"><span class="comment">// 31-12-2011,3.5</span></div><div class="line"><span class="comment">// 31-12-2011,3.5</span></div><div class="line"><span class="comment">// 31-12-2011,4.1</span></div><div class="line"><span class="comment">// 31-12-2011,4.9</span></div><div class="line"></div><div class="line"><span class="comment">// core code</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> parseDate = d3.timeParser(<span class="string">'%d-%m-%Y'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> xScale = d3.scaleTime()</div><div class="line">    .domain([<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2010</span>, <span class="number">6</span>, <span class="number">3</span>), <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2012</span>, <span class="number">0</span>, <span class="number">1</span>)])</div><div class="line">    .rangeRound([, width])</div><div class="line"></div><div class="line"><span class="keyword">const</span> yScale = d3.scaleLinear()</div><div class="line">    .range([height, <span class="number">0</span>])</div><div class="line"></div><div class="line"><span class="keyword">const</span> histogram = h3.histogram()</div><div class="line">    .value(<span class="function"><span class="params">d</span> =&gt;</span> d.date)</div><div class="line">    .domain(xScale.domain())</div><div class="line">    .thresholds(x.ticks.timeMonth)</div><div class="line"></div><div class="line"><span class="keyword">const</span> _data = data.map(<span class="function"><span class="params">d</span> =&gt;</span> (&#123;</div><div class="line">  <span class="attr">date</span>: parseDate(d.dtg),</div><div class="line">  <span class="attr">value</span>: d.value,</div><div class="line">&#125;))</div><div class="line"></div><div class="line"><span class="keyword">const</span> bins = histogram(_data)</div><div class="line"></div><div class="line">holder.selectAll(<span class="string">'rect'</span>)</div><div class="line">    .data(bins)</div><div class="line">  .enter().append(<span class="string">'rect'</span>)</div><div class="line">    .attr(<span class="string">'class'</span>, <span class="string">'bar'</span>)</div><div class="line">    .attr(<span class="string">'x'</span>, <span class="number">1</span>)</div><div class="line">    .attr(<span class="string">'transform'</span>, d =&gt; <span class="string">`translate(<span class="subst">$&#123;xScale(d.x0)&#125;</span>, <span class="subst">$&#123;yScale(d.length)&#125;</span>)`</span>)</div><div class="line">    .attr(<span class="string">'width'</span>, d =&gt; (xScale(d.x1 - d.x0) - <span class="number">1</span>))</div><div class="line">    .attr(<span class="string">'height'</span>, d =&gt; (height - yScale(d.length)))</div></pre></td></tr></table></figure>
<p>The key line</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> bins = histogram(_data)</div></pre></td></tr></table></figure>
<p>groups the data for the bars.</p>
<h3 id="Tree-Diagram"><a href="#Tree-Diagram" class="headerlink" title="Tree Diagram"></a>Tree Diagram</h3><p>The data requied to produce this type of layout needs to describe the relationships, but this is not necessary an onerous task.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"Top Node"</span>,</div><div class="line">    <span class="attr">"children"</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Bob: Child of Top Node"</span>,</div><div class="line">        <span class="attr">"children"</span>: [</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"name"</span>: <span class="string">"Son of Bob"</span></div><div class="line">          &#125;,</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"name"</span>: <span class="string">"Daughter of Bob"</span></div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"Sally: Child of Top Node"</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// core code</span></div><div class="line"><span class="keyword">const</span> treeData = &#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"Top Level"</span>,</div><div class="line">  <span class="string">"children"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="string">"name"</span>: <span class="string">"Level 2: A"</span>,</div><div class="line">      <span class="string">"children"</span>: [</div><div class="line">        &#123; <span class="string">"name"</span>: <span class="string">"Son of A"</span> &#125;,</div><div class="line">        &#123; <span class="string">"name"</span>: <span class="string">"Daughter of A"</span> &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    &#123; <span class="string">"name"</span>, <span class="string">"Leve 2: B"</span>&#125;</div><div class="line">  ]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> margin = &#123;</div><div class="line">  <span class="attr">top</span>: <span class="number">40</span>,</div><div class="line">  <span class="attr">right</span>: <span class="number">30</span>,</div><div class="line">  <span class="attr">bottom</span>: <span class="number">50</span>,</div><div class="line">  <span class="attr">left</span>: <span class="number">30</span>,</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> width = <span class="number">660</span> - margin.left - margin.right</div><div class="line"><span class="keyword">const</span> height = <span class="number">500</span> - margin.top - margin.bottom</div><div class="line"></div><div class="line"><span class="comment">// declare a tree layout and assigns the size</span></div><div class="line"><span class="keyword">const</span> treemap = d3.tree()</div><div class="line">    .size([width, height])</div><div class="line"></div><div class="line"><span class="comment">// assigns the node data to the tree layout</span></div><div class="line"><span class="keyword">let</span> nodes = d3.hierarchy(treeData)</div><div class="line"></div><div class="line"><span class="comment">// map the node data to the tree layout</span></div><div class="line">nodes = treemap(nodes)</div><div class="line"></div><div class="line"><span class="comment">// append the svg object to the body of the page</span></div><div class="line"><span class="comment">// append a 'group' element to 'svg'</span></div><div class="line"><span class="comment">// move the 'groupd' element to the top left margin</span></div><div class="line"><span class="keyword">const</span> svg = d3.select(<span class="string">'body'</span>).append(<span class="string">'svg'</span>)</div><div class="line">    .attr(<span class="string">'width'</span>, width + margin.left + margin.right)</div><div class="line">    .attr(<span class="string">'height'</span>, height + margin.top + margin.bottom)</div><div class="line"><span class="keyword">const</span> g = svg.append(<span class="string">'g'</span>)</div><div class="line">    .attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>, <span class="subst">$&#123;margin.top&#125;</span>)`</span>)</div><div class="line"></div><div class="line"><span class="comment">// add links between nodes</span></div><div class="line"><span class="keyword">const</span> link = g.selectAll(<span class="string">'.link'</span>)</div><div class="line">    .data(nodes.descendants().slice(<span class="number">1</span>))</div><div class="line">  .enter().append(<span class="string">'path'</span>)</div><div class="line">    .attr(<span class="string">'class'</span>, <span class="string">'link'</span>)</div><div class="line">    .attr(<span class="string">'d'</span>, d =&gt; &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">`M<span class="subst">$&#123;d.x&#125;</span>,<span class="subst">$&#123;d.y&#125;</span>C<span class="subst">$&#123;d.x&#125;</span>,<span class="subst">$&#123;(d.y + d.parent.y) <span class="regexp">/ 2&#125; $&#123;d.parent.x&#125;,$&#123;(d.y + d.parent.y) /</span> <span class="number">2</span>&#125;</span> <span class="subst">$&#123;d.parent.x&#125;</span>,<span class="subst">$&#123;d.parent.y&#125;</span>`</span></div><div class="line">    &#125;)</div><div class="line"></div><div class="line"><span class="comment">// add each node as a group</span></div><div class="line"><span class="keyword">const</span> node = g.selectAll(<span class="string">'.node'</span>)</div><div class="line">    .data(nodes.descendants())</div><div class="line">  .enter().append(<span class="string">'circle'</span>)</div><div class="line">    .attr(<span class="string">'class'</span>, d =&gt; &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">`node <span class="subst">$&#123;d.children ? <span class="string">'node--internal'</span> : <span class="string">'node--leaf'</span>&#125;</span>`</span></div><div class="line">    &#125;)</div><div class="line">    .attr(<span class="string">'transform'</span>, d =&gt; &#123;</div><div class="line">      <span class="string">`translate(<span class="subst">$&#123;d.x&#125;</span>, <span class="subst">$&#123;d.y&#125;</span>)`</span></div><div class="line">    &#125;)</div><div class="line"></div><div class="line"><span class="comment">// add the circle to node</span></div><div class="line">node.append(<span class="string">'circle'</span>)</div><div class="line">    .attr(<span class="string">'r'</span>, <span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="comment">// add the text to the node</span></div><div class="line">node.append(<span class="string">'text'</span>)</div><div class="line">    .attr(<span class="string">'dy'</span>, <span class="string">'0.35em'</span>)</div><div class="line">    .attr(<span class="string">'y'</span>, d =&gt; (d.children ? <span class="number">-20</span> : <span class="number">20</span>))</div><div class="line">    .style(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>)</div><div class="line">    .text(<span class="function"><span class="params">d</span> =&gt;</span> d.data.name)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// declare a tree layout and assign the size</span></div><div class="line"><span class="keyword">const</span> treemap = d3.tree()</div><div class="line">    .size([width, height])</div><div class="line"></div><div class="line"><span class="comment">// assign the data to a hierarchy using parent-child relationships</span></div><div class="line"><span class="keyword">let</span> nodes = d3.hierarchy(treeData)</div><div class="line"></div><div class="line"><span class="comment">// maps the node data to the tree layout</span></div><div class="line">nodes = treemap(nodes)</div></pre></td></tr></table></figure>
<h5 id="d3-hierarchy"><a href="#d3-hierarchy" class="headerlink" title="d3.hierarchy"></a>d3.hierarchy</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> nodes = d3.hierarchy(treeData, d =&gt; d.children)</div></pre></td></tr></table></figure>
<p>This assigns a range of properties to each node including:</p>
<ul>
<li><p><code>node.data</code> - the data assocaited with the node(in our case it will include the name accessible as <code>node.data.name</code>).</p>
</li>
<li><p><code>node.depth</code> - a representation of the depth or number of hops from the initial root node.</p>
</li>
<li><p><code>node.height</code> - the greatest distance from any descendants leaf nodes.</p>
</li>
<li><p><code>node.parent</code> - the parent node, or null if it’s the root node.</p>
</li>
<li><p><code>node.children</code> - child nodes or undefined for any leaf nodes.</p>
</li>
</ul>
<p>Above is the vertical tree map code.</p>
<p>If you want a horizontal tree map, you can make a transform like this.</p>
<p><img src="https://leanpub.com/site_images/d3-t-and-t-v4/htree-02.png" alt=""></p>
<p><img src="https://leanpub.com/site_images/d3-t-and-t-v4/htree-03.png" alt=""></p>
<p>Or</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">.attr('d', d =&gt; &#123;</div><div class="line">  return `</div><div class="line">  M$&#123;d.y&#125;,$&#123;d.x&#125;</div><div class="line">  C$&#123;(d.y + d.parent.y)/2&#125;,$&#123;d.x&#125;</div><div class="line">  $&#123;(d.y + d.parent.y)/2&#125;,$&#123;d.parent.x&#125;</div><div class="line">  $&#123;d.parent.y&#125;,$&#123;d.parent.x&#125;</div><div class="line">  `</div><div class="line">&#125;)</div><div class="line"></div><div class="line">.attr('transform', d =&gt; `translate($&#123;d.y&#125;, $&#123;d.x&#125;)`)</div></pre></td></tr></table></figure>
<p>Add Images as Node</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">node.append(<span class="string">'image'</span>)</div><div class="line">    .attr(<span class="string">'xlink:href'</span>, d =&gt; d.data.icon)</div><div class="line">    .attr(<span class="string">'x'</span>, <span class="string">'-12px'</span>)</div><div class="line">    .attr(<span class="string">'y'</span>, <span class="string">'-12px'</span>)</div><div class="line">    .attr(<span class="string">'width'</span>, <span class="string">'24px'</span>)</div><div class="line">    .attr(<span class="string">'height'</span>, <span class="string">'24px'</span>)</div></pre></td></tr></table></figure>
<p>Add Interaction on Node</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">click</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (d.children) &#123;</div><div class="line">    d._children = d.children</div><div class="line">    d.chilren = <span class="literal">null</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    d.children = d._children</div><div class="line">    d._children = <span class="literal">null</span></div><div class="line">  &#125;</div><div class="line">  upate(d)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Sankey-Diagrams"><a href="#Sankey-Diagrams" class="headerlink" title="Sankey Diagrams"></a>Sankey Diagrams</h3><p>// Todo</p>
<h3 id="Assorted-Tips-and-Tricks"><a href="#Assorted-Tips-and-Tricks" class="headerlink" title="Assorted Tips and Tricks"></a>Assorted Tips and Tricks</h3><h4 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h4><ul>
<li><p><code>mousedown</code></p>
</li>
<li><p><code>mouseup</code></p>
</li>
<li><p><code>mouseover</code></p>
</li>
<li><p><code>mouseout</code></p>
</li>
<li><p><code>mousemove</code></p>
</li>
<li><p><code>click</code></p>
</li>
<li><p><code>contextmenu</code></p>
</li>
<li><p><code>dblclick</code></p>
</li>
</ul>
<h4 id="Add-Tooltips"><a href="#Add-Tooltips" class="headerlink" title="Add Tooltips"></a>Add Tooltips</h4><p>Tooltips have a marvellous duality. They are on one hand a pretty darned useful thing that aids in giving context and information where required and on the other hand, if done with a bit of care they can look stylish.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span><span class="selector-class">.tooltip</span> &#123;</div><div class="line">  <span class="attribute">position</span>: absolute;</div><div class="line">  <span class="attribute">text-align</span>: center;</div><div class="line">  <span class="attribute">width</span>: <span class="number">60px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">28px</span>;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">2px</span>;</div><div class="line">  <span class="attribute">font</span>: <span class="number">12px</span> sans-serif;</div><div class="line">  <span class="attribute">background</span>: lightsteelblue;</div><div class="line">  <span class="attribute">border</span>: <span class="number">0px</span>;</div><div class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</div><div class="line">  <span class="attribute">pointer-events</span>: none;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> div = d3.select(<span class="string">'body'</span>).append(<span class="string">'div'</span>).attr(<span class="string">'class'</span>, <span class="string">'tooltip'</span>)</div><div class="line">.style(<span class="string">'opacity'</span>, <span class="number">0</span>)</div><div class="line"></div><div class="line">svg.selectAll(<span class="string">"circle"</span>)</div><div class="line">   .data(data)</div><div class="line"> .enter().append(<span class="string">"circle"</span>)</div><div class="line">   .attr(<span class="string">"r"</span>, <span class="number">5</span>)</div><div class="line">   .attr(<span class="string">"cx"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> x(d.date); &#125;)</div><div class="line">   .attr(<span class="string">"cy"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123; <span class="keyword">return</span> y(d.close); &#125;)</div><div class="line">   .on(<span class="string">"mouseover"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">     div.transition()</div><div class="line">       .duration(<span class="number">200</span>)</div><div class="line">       .style(<span class="string">"opacity"</span>, <span class="number">.9</span>);</div><div class="line">     div.html(formatTime(d.date) + <span class="string">"&lt;br/&gt;"</span> + d.close)</div><div class="line">       .style(<span class="string">"left"</span>, (d3.event.pageX) + <span class="string">"px"</span>)</div><div class="line">       .style(<span class="string">"top"</span>, (d3.event.pageY - <span class="number">28</span>) + <span class="string">"px"</span>);</div><div class="line">     &#125;)</div><div class="line">   .on(<span class="string">"mouseout"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">     div.transition()</div><div class="line">       .duration(<span class="number">500</span>)</div><div class="line">       .style(<span class="string">"opacity"</span>, <span class="number">0</span>);</div><div class="line">     &#125;)</div></pre></td></tr></table></figure>
<p>Notice there is only one tooltip exist in the page.</p>
<h3 id="Selecting-Filtering-a-subset-of-objects"><a href="#Selecting-Filtering-a-subset-of-objects" class="headerlink" title="Selecting/Filtering a subset of objects"></a>Selecting/Filtering a subset of objects</h3><p>Filtering is fairly simple.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">svg.selectAll(<span class="string">'circle'</span>)</div><div class="line">    .data(data)</div><div class="line">  .enter().append(<span class="string">'circle'</span>)</div><div class="line">    .filter(<span class="function"><span class="params">d</span> =&gt;</span> d.close &lt; <span class="number">400</span>)</div><div class="line">    .style(<span class="string">'fill'</span>, <span class="string">'red'</span>)</div><div class="line">    .attr(<span class="string">'r'</span>, <span class="number">5</span>)</div><div class="line">    .attr(<span class="string">'cx'</span>, d =&gt; xScale(d.date))</div><div class="line">    .attr(<span class="string">'cy'</span>, d =&gt; yScale(d.close))</div></pre></td></tr></table></figure>
<h4 id="Select-Items-with-an-IF-statement"><a href="#Select-Items-with-an-IF-statement" class="headerlink" title="Select Items with an IF statement"></a>Select Items with an IF statement</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">.style(<span class="string">"fill"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;   </div><div class="line">  <span class="keyword">if</span> (d.close &lt;= <span class="number">400</span>) &#123;<span class="keyword">return</span> <span class="string">"red"</span>&#125;  </div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (d.close &gt;= <span class="number">620</span>) &#123;<span class="keyword">return</span> <span class="string">"lawngreen"</span>&#125; <span class="comment">// &lt;== Right here</span></div><div class="line">  <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="string">"black"</span> &#125;  </div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Applying-a-color-gradient-to-a-line-based-on-value"><a href="#Applying-a-color-gradient-to-a-line-based-on-value" class="headerlink" title="Applying a color gradient to a line based on value"></a>Applying a color gradient to a line based on value</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.line</span> &#123;</div><div class="line">  <span class="attribute">fill</span>: none;</div><div class="line">  <span class="attribute">stroke</span>: <span class="built_in">url</span>(#line-gradient);</div><div class="line">  <span class="attribute">stroke-width</span>: <span class="number">2px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// set the gradient</span></div><div class="line"></div><div class="line"><span class="comment">// add linear gradient element</span></div><div class="line">svg.append(<span class="string">'linearGradent'</span>)</div><div class="line"><span class="comment">// add id for css anchor</span></div><div class="line">    .attr(<span class="string">'id'</span>, <span class="string">'line-gradient'</span>)</div><div class="line">    .attr(<span class="string">'gradientUnits'</span>, <span class="string">'userSpaceOnUse'</span>)</div><div class="line"><span class="comment">// use x1, y1, x2, y2 to define the bounds of the area over which the gradient will act.</span></div><div class="line"><span class="comment">// here we set x1, x2 to the same value so the gradient won't act on x direction.</span></div><div class="line">    .attr(<span class="string">'x1'</span>, <span class="number">0</span>).attr(<span class="string">'y1'</span>, yScale(<span class="number">0</span>))</div><div class="line">    .attr(<span class="string">'x2'</span>, <span class="number">0</span>).attr(<span class="string">'y2'</span>, yScale(<span class="number">1000</span>))</div><div class="line"><span class="comment">// select all 'stop' elements for the gradients, these 'stop' elements define where on the range covered by our coordinates the color start and stop(percent or decimal)</span></div><div class="line">  .selectAll(<span class="string">'stop'</span>)</div><div class="line">    .data([</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'0%'</span>, <span class="attr">color</span>: <span class="string">'red'</span>&#125;,</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'40%'</span>, <span class="attr">color</span>: <span class="string">'red'</span>&#125;,</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'40%'</span>, <span class="attr">color</span>: <span class="string">'black'</span>&#125;,</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'62%'</span>, <span class="attr">color</span>: <span class="string">'black'</span>&#125;,</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'62%'</span>, <span class="attr">color</span>: <span class="string">'lawngreen'</span>&#125;,</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'62%'</span>, <span class="attr">color</span>: <span class="string">'lawngreen'</span>&#125;,</div><div class="line">      &#123;<span class="attr">offset</span>: <span class="string">'100%'</span>, <span class="attr">color</span>: <span class="string">'lawngreen'</span>&#125;,</div><div class="line">    ])</div><div class="line">  .enter().append(<span class="string">'stop'</span>)</div><div class="line">    .attr(<span class="string">'offset'</span>, d =&gt; d.offset)</div><div class="line">    .attr(<span class="string">'stop-color'</span>, d =&gt; d.color)</div></pre></td></tr></table></figure>
<p>There is our anchor on the third line.</p>
<p>If you want to apply the gradient on area, simply change the css</p>
<p>```css<br>.area {<br>  fill: url(#area-gradient);<br>  stroke-width: 0px;<br>}</p>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2017/08/31/Manipulate-Data-in-D3/" class="article-date">
  <time datetime="2017-08-31T01:43:20.000Z" itemprop="datePublished">2017-08-31</time>
</a>

        </li>
        
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2017/09/03/snippets-of-Nginx/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          snippets of Nginx
        
      </div>
    </a>
  
  
    <a href="/2017/08/31/Styles-in-D3/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Styles in D3</div>
    </a>
  
</nav>


  
</article>




      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>Write for Archive</p>


      </div>
    </footer>

      

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







    </div>
  </body>
</html>
