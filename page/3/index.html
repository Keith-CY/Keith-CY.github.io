<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8">
<title>EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">

<link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre|DM+Serif+Text&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">




    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    



    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">







<link rel="stylesheet" href="/css/back-to-top.css">




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>




<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>



    



    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    




<link rel="stylesheet" href="/css/style.css">

</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="EzCook" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
                <a class="navbar-item"
                href="/resume">Resume</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-23T01:53:34.000Z">2017-11-23</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 779 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/23/react-lodable/">React-Lodable</a>
            
        </h1>
        <div class="content">
            <p><code>react-lodable</code> is a higher order component for loading components with dynamic<br>imports.</p>
<p>Code-splitting is the process of taking one large bundle containing your entire<br>app, and splitting them up into multiple smaller bundles which contain seperate<br>parts of your app.</p>
<p>This might seem difficult to do, but tools like Webpack have this built in, and<br>React Loadable is designed to make is super simple.</p>
<h4 id="Route-based-splitting-vs-Component-based-splitting"><a href="#Route-based-splitting-vs-Component-based-splitting" class="headerlink" title="Route-based splitting vs. Component-based splitting"></a>Route-based splitting vs. Component-based splitting</h4><p>A common piece of advice you will see is to break your app into seperate routes<br>and load each one asynchronously. This seems to work well enough for many apps<br>– a a user, clicking a link and waiting for a page to load is a familiar<br>experience on the web.</p>
<p>Namely, a route is simple a component.</p>
<p>But in fact there are more places than just routes where you can pretty easily<br>split apart your app: Modals, Tabs, and many more UI Components hide content<br>until the user has done something to reveal it.</p>
<p><img src="http://thejameskyle.com/img/react-loadable-component-splitting.png" alt=""></p>
<blockquote>
<p>Example: Maybe your app ahs a map buried inside of a tab component. Why would<br>you load a massive mapping library for the parent route every time the user<br>never to to that tab.</p>
</blockquote>
<p>React Loadable is a small library that makes component-centric code splitting<br>incredibly easy in React.</p>
<p><code>Loadable</code> is a higher-order component(a function that returns a component)<br>which lets you dynamically load any module before rendering it into your app.</p>
<p>We can make it by <code>dynamic import</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> Bar <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Bar'</span></div><div class="line"></div><div class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Bar</span> /&gt;</span></span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>=&gt;</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</div><div class="line">  state = &#123;</div><div class="line">    <span class="hljs-attr">Bar</span>: <span class="hljs-literal">null</span>,</div><div class="line">  &#125;</div><div class="line">  componentWillMount() &#123;</div><div class="line">    <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/Bar'</span>).then(<span class="hljs-function"><span class="hljs-params">Bar</span> =&gt;</span> <span class="hljs-keyword">this</span>.setState(&#123; Bar &#125;))</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="hljs-keyword">let</span> &#123; Bar &#125; = <span class="hljs-keyword">this</span>.state</div><div class="line">    <span class="hljs-keyword">if</span> (!Bar) &#123;</div><div class="line">      <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">      <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Bar</span> /&gt;</span></span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>But that’s whole bunch of work, and it doesn’t even handle a bunch of caess.<br>What about when <code>import()</code> fails? What about server-side rendering?</p>
<p><code>react-loadable</code> considers the unexpected cases.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">import Loadable from 'react-loadable'</div><div class="line"></div><div class="line">const LoadableBar = Loadable(&#123;</div><div class="line">  loader: () =&gt; import('./components/Bar'),</div><div class="line">  loading: () =&gt; &lt;div&gt;Loading&lt;/div&gt;,</div><div class="line">&#125;)</div><div class="line"></div><div class="line">class Foo extends React.Component &#123;</div><div class="line">  render() &#123;</div><div class="line">    return &lt;LoadableBar /&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>When you use <code>import()</code> with webpack2, it will<br><a href="https://webpack.js.org/guides/code-splitting/" target="_blank" rel="noopener">automatically code-split</a> for<br>you with no additional configuration.</p>
<p>Define your Loading Component</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Loading</span>(<span class="hljs-params"></span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>When your loader fails, your Loading component will receive an error prop which<br>will be <code>true</code>(otherwise it will be <code>false</code>).</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Loading</span>(<span class="hljs-params">props</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (props.error) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">  &#125;</div><div class="line">  <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Sometimes components load really quickly(&lt;200ms) and the loading screen only<br>quickly flashes on the screen.</p>
<p>Your loading component will get a <code>pastDelay</code> props which will only be <code>true</code><br>once the component has taken longer to load than a set <code>delay</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Loading</span>(<span class="hljs-params">props</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (props.error) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (props.pastDelay) &#123;</div><div class="line">    <span class="hljs-comment">// only show loading when it takes longer than 200ms</span></div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This delay defaults to 200ms, but you can customize the delay in Loadable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Loadable(&#123;</div><div class="line">  <span class="hljs-attr">loader</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/Bar'</span>),</div><div class="line">  <span class="hljs-attr">loading</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> Loading,</div><div class="line">  <span class="hljs-attr">delay</span>: <span class="hljs-number">300</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Timing out when the loader is taking too long</p>
<p>Sometimes network connections suck and never resolve or fail, they just hang<br>there forever. This sucks for the user because they won’t know if it should<br>always take this long, or if they should try refreshing.</p>
<p>The Loading component will receive a <code>timeOut</code> prop which will be set to <code>true</code><br>when the loader has timed out.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Loading</span>(<span class="hljs-params">props</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (props.error) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (props.timedOut) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Timed out<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (props.pastDelay) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This feature is disabled by default, you can pass a <code>timeout</code> option to<br><code>Loadable</code> to enable it.</p>
<p>By default <code>Loadable</code> will render the <code>default</code> export of the returned module.<br>If you want to customize this behavior you can use the <code>render</code> option.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Loadable(&#123;</div><div class="line">  <span class="hljs-attr">loader</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./myComponent'</span>),</div><div class="line">  render(loaded, props) &#123;</div><div class="line">    <span class="hljs-keyword">let</span> Component = loaded.namedExport</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> &#123;<span class="hljs-attr">...props</span>&#125; /&gt;</span></span></div><div class="line">  &#125;,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>You can do whatever you want within <code>loader()</code> as long as it returns a promise<br>and you are able to render everything</p>
<p>You can load multiple resources in parallel with <code>Loadable.Map</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Loadable.Map(&#123;</div><div class="line">  <span class="hljs-attr">loader</span>: &#123;</div><div class="line">    <span class="hljs-attr">Bar</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./Bar'</span>),</div><div class="line">    <span class="hljs-attr">i18n</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> fetch(<span class="hljs-string">'./i18n/bar.json'</span>).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.json()),</div><div class="line">  &#125;,</div><div class="line">  render(loaded, props) &#123;</div><div class="line">    <span class="hljs-keyword">let</span> Bar = loaded.Bar.default</div><div class="line">    <span class="hljs-keyword">let</span> i18n = loaded.i18n</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Bar</span> &#123;<span class="hljs-attr">...props</span>&#125; <span class="hljs-attr">i18n</span>=<span class="hljs-string">&#123;i18n&#125;</span> /&gt;</span></span></div><div class="line">  &#125;,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>As an optimization, you can also decide to preload a component before it gets<br>rendered.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> LoadableBar = Loadable(&#123;</div><div class="line">  <span class="hljs-attr">loader</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./Bar'</span>),</div><div class="line">  <span class="hljs-attr">loading</span>: Loading,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</div><div class="line">  state = &#123;</div><div class="line">    <span class="hljs-attr">showBar</span>: <span class="hljs-literal">false</span>,</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  onClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="hljs-keyword">this</span>.setState(&#123; <span class="hljs-attr">showBar</span>: <span class="hljs-literal">true</span> &#125;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  onMouseOver = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">    LoadableBar.preload()</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="hljs-keyword">return</span> (</div><div class="line">      <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span></div><div class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.onClick&#125;</span> <span class="hljs-attr">onMouseOver</span>=<span class="hljs-string">&#123;this.onMouseOver&#125;</span>&gt;</span></div><div class="line">          showbar</div><div class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="line">        &#123;this.state.showBar &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">LoadableBar</span> /&gt;</span>&#125;</div><div class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Server-side-rendering-to-see-Github"><a href="#Server-side-rendering-to-see-Github" class="headerlink" title="Server-side rendering to see Github"></a>Server-side rendering to see <a href="https://github.com/thejameskyle/react-loadable" target="_blank" rel="noopener">Github</a></h3>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-21T09:47:01.000Z">2017-11-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 96 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/21/Difference-between-Contract-Calling-in-Web3/">Difference Between Contract Calling in Web3</a>
            
        </h1>
        <div class="content">
            <p>After we get the instance of Contract(<code>testInstance</code>), we can invoke its method by three ways:</p>
<ul>
<li><p><code>testInstance.testFunc.sendTransaction()</code></p>
<ul>
<li>It will make a transaction which will be broadcasted into the net, use gas and return the <code>txHash</code></li>
</ul>
</li>
<li><p><code>testInstance.testFunc.call()</code></p>
<ul>
<li>Call the contract function in VM, no broadcast and no gas used, return the response from method</li>
</ul>
</li>
<li><p><code>testInstance.testFunc()</code></p>
<ul>
<li>If the testFunc is signified <code>constant</code>, which means it won’t change the state on chain, it won’t be executed(web3 will invoke it by <code>.call()</code>). If the testFunc is not <code>constant</code>, <code>sendTransaction()</code> will be invoked.</li>
</ul>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-21T03:44:40.000Z">2017-11-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 0 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/21/JSON-PRC/">JSON-PRC</a>
            
        </h1>
        <div class="content">
            <iframe width="100%" height="800px" src="https://embed.coggle.it/diagram/WhOeZuojMQABUzIo/99b086bdc0ebfc435ab27512cc9484dfe4d5352dc2ff34812c64d3706efe7066" frameborder="0" allowfullscreen></iframe>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-14T09:35:34.000Z">2017-11-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 593 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/14/Common-Patterns-in-Contract/">Common Patterns in Contract</a>
            
        </h1>
        <div class="content">
            <h3 id="Withdrawal-from-Contract"><a href="#Withdrawal-from-Contract" class="headerlink" title="Withdrawal from Contract"></a>Withdrawal from Contract</h3><p>The recommended method of sending funds after an effect is using the withdrawal pattern.</p>
<p>Although the most intuitive method of sending Ether, as a result of an effect, is a direct <code>send</code> call, this is not recommended as it introduces a potential security risk.</p>
<p>This is an example of the withdrawal pattern in practice in a contract where the goal is to send the most money to the contract in order to become the “richest”.</p>
<p>In the following contract, if you are usurped as the richest, you will receive the funds of the person who has gone on to be the new richest:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract WithdrawalContract &#123;</div><div class="line">  address public richest;</div><div class="line">  uint public mostSent;</div><div class="line"></div><div class="line">  mapping(<span class="hljs-function"><span class="hljs-params">address</span> =&gt;</span> uint) public pendingWithdrawals;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WithdrawalContract</span>(<span class="hljs-params"></span>) <span class="hljs-title">payable</span> </span>&#123;</div><div class="line">    richest = msg.sender;</div><div class="line">    mostSent = msg.value;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">becomeRichest</span>(<span class="hljs-params"></span>) <span class="hljs-title">payable</span> <span class="hljs-title">returns</span> (<span class="hljs-params">bool</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">if</span> (msg.value &gt; mostSent) &#123;</div><div class="line">      pendingWithdrawals[msg.sender] += msg.value;</div><div class="line">      richest = msg.sender;</div><div class="line">      mostSent = msg.value;</div><div class="line">      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</div><div class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withdraw</span>(<span class="hljs-params"></span>) </span>&#123;</div><div class="line">    uint amount = pendingWithdrawals[msg.sender];</div><div class="line">    pendingWithdrawals[msg.sender] = <span class="hljs-number">0</span>;</div><div class="line">    msg.sender.transfer(amount);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>In the example above, if the Contract is attacked and the withdraw method stuck(for example, msg.sender.transfer(amount) fails), the Contract will keep working.</p>
<h3 id="Restricting-Access"><a href="#Restricting-Access" class="headerlink" title="Restricting Access"></a>Restricting Access</h3><p>Restricting access is a common pattern for contract.</p>
<p>Note that you can never restrict any human or computer from reading the content of your transactions or your contract’s state. You can make it a bit harder by using encryption, but if your contract is supposed to read the data, so will everyone else.</p>
<p>You can restrict read access to your contract’s state by <strong>other contract</strong>. This is actually the default unless you declare make your state variables <code>public</code>.</p>
<p>Furthermore, you can restrict who can make modifications to your contract’s state or call your contract’s functions.</p>
<p>The use of <strong>function modifier</strong> makes thse restrictions highly readable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract AccessRestriction &#123;</div><div class="line">    address public owner = msg.sender;</div><div class="line">    uint public creationTime = now;</div><div class="line"></div><div class="line">    modifier onlyBy(address _account) &#123;</div><div class="line">        <span class="hljs-built_in">require</span>(msg.sender == _account);</div><div class="line">        _;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeOwner</span>(<span class="hljs-params">address _newOwner</span>) <span class="hljs-title">onlyBy</span>(<span class="hljs-params">owner</span>) </span>&#123;</div><div class="line">        owner = _newOwner;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    modifier onlyAfter(uint _time) &#123;</div><div class="line">        <span class="hljs-built_in">require</span>(now &gt; _time);</div><div class="line">        _;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disown</span>(<span class="hljs-params"></span>) <span class="hljs-title">onlyBy</span>(<span class="hljs-params">owner</span>) <span class="hljs-title">onlyAfter</span>(<span class="hljs-params">creationTime + <span class="hljs-number">6</span> weeks</span>) </span>&#123;</div><div class="line">        <span class="hljs-keyword">delete</span> owner;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    modifier costs(uint _amount) &#123;</div><div class="line">        <span class="hljs-built_in">require</span>(msg.value &gt; _amount);</div><div class="line">        _;</div><div class="line">        <span class="hljs-keyword">if</span> (msg.value &gt; _amount)</div><div class="line">            msg.sender.send(msg.value - _amount);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forceOwnerChange</span>(<span class="hljs-params">address _newOwner</span>) <span class="hljs-title">costs</span>(<span class="hljs-params"><span class="hljs-number">200</span> ether</span>) </span>&#123;</div><div class="line">        owner = _newOwner;</div><div class="line">        <span class="hljs-keyword">if</span> (uint(owner) &amp; <span class="hljs-number">0</span> == <span class="hljs-number">1</span>)</div><div class="line">            <span class="hljs-keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="State-Machine"><a href="#State-Machine" class="headerlink" title="State Machine"></a>State Machine</h3><p>Contracts often act as a state machine, which means that they have certain <strong>stage</strong> in which they behave differently or in which different functions can be called.</p>
<p>A function call often ends a stage and transitions the contract into the next stage.</p>
<p>Function modifiers can be used in this situation to model the states and guard against incorrect usage of the contract.</p>
<p>In the following example, the modifier <code>atStage</code> ensures that the function can only be called at a certain stage, automatic timed transitions are handled by the modifier <code>timeTransitions</code>, which should be used for all functions.</p>
<blockquote>
<p>Modifier Order Matters: If <code>atStage</code> is combined with <code>timedTransitions</code>, make sure that you mention it after the latter, so that the new stage is taken into account.</p>
</blockquote>
<p>Finally, the modifier <code>transitionNext</code> can be used to automatically go to the next stage when the function finishes.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract StateMachine &#123;</div><div class="line">    enum Stages &#123;</div><div class="line">        AcceptingBlindedBids,</div><div class="line">        RevealBids,</div><div class="line">        AnotherStage,</div><div class="line">        AreWeDoneYet,</div><div class="line">        Finished</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    Stages public stage = Stages.AcceptingBlindedBids;</div><div class="line"></div><div class="line">    uint public creationTime = now;</div><div class="line"></div><div class="line">    modifier atStage(Stages _stage) &#123;</div><div class="line">        <span class="hljs-built_in">require</span>(stage == _stage);</div><div class="line">        _;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nextStage</span>(<span class="hljs-params"></span>) <span class="hljs-title">internal</span> </span>&#123;</div><div class="line">        stage = Stages(uint(stage) + <span class="hljs-number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    modifier timedTransitions() &#123;</div><div class="line">      <span class="hljs-keyword">if</span> (stage == Stages.AcceptingBlindedBids &amp;&amp; now &gt;= creationTime + <span class="hljs-number">10</span> days)</div><div class="line">          nextStage();</div><div class="line">      <span class="hljs-keyword">if</span> (stage == Stages.RevealBids &amp;&amp; now &gt;= creationTime + <span class="hljs-number">12</span> days)</div><div class="line">          nextStage();</div><div class="line">      _;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bid</span>(<span class="hljs-params"></span>)</span></div><div class="line">        <span class="hljs-title">payable</span></div><div class="line">        <span class="hljs-title">timedTransitions</span></div><div class="line">        <span class="hljs-title">atStage</span>(<span class="hljs-params">Stages.AcceptingBlindedBids</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="hljs-comment">//</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reveal</span>(<span class="hljs-params"></span>)</span></div><div class="line">        <span class="hljs-title">timedTransitions</span></div><div class="line">        <span class="hljs-title">atStage</span>(<span class="hljs-params">Stages.RevealBids</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="hljs-comment">//</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-14T08:51:49.000Z">2017-11-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 286 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/14/Solidity-Style-Guide/">Solidity Style Guide</a>
            
        </h1>
        <div class="content">
            <h3 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h3><p>4 spaces per indentation level</p>
<p>Use spaces for indentation</p>
<p>Use blank lines</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">contract A &#123;</div><div class="line">  <span class="hljs-comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">contract B &#123;</div><div class="line">  <span class="hljs-comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Blank lines may be omitted between groups of related one-liners</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">contract A &#123;</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">spam</span>(<span class="hljs-params"></span>);</span></div><div class="line">  <span class="hljs-title">function</span> <span class="hljs-title">ham</span>(<span class="hljs-params"></span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Use <code>UTF-8</code> or <code>ASCII</code> encoding</p>
<p>Place import statements at the top of the file</p>
<p>Functions should be be grouped according to their visibility and ordered:</p>
<ul>
<li><p>constructor</p>
</li>
<li><p>fallback function (if exists)</p>
</li>
<li><p>external</p>
</li>
<li><p>public</p>
</li>
<li><p>internal</p>
</li>
<li><p>private</p>
</li>
</ul>
<p>Within a grouping, place the <code>constant</code> functions last.</p>
<p>Use white spaces in expressions</p>
<p>Avoid extraneous whitespaces inthe following situations: immediately inside parenthesis, brackets or braces, with the exception of single line function declaration.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">spam(ham[<span class="hljs-number">1</span>], Coin(&#123;<span class="hljs-attr">name</span>: <span class="hljs-string">"han"</span>&#125;)):</div><div class="line"></div><div class="line"><span class="hljs-comment">// exception</span></div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">singleLine</span>(<span class="hljs-params"></span>) </span>&#123; spam() &#125;</div></pre></td></tr></table></figure>
<p>More than one space around an assignment or other operator to align with</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x = <span class="hljs-number">1</span>;</div><div class="line">y = <span class="hljs-number">2</span>;</div><div class="line">long_variable = <span class="hljs-number">3</span>;</div></pre></td></tr></table></figure>
<p>Don’t include a whitespace in the fallback function</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</div><div class="line">  <span class="hljs-comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="hljs-comment">// not </span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</div><div class="line">  <span class="hljs-comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>For control structure whose body contains a single statement, omitting the braces is ok if the statement is contained on a single line</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">10</span>)</div><div class="line">    x += <span class="hljs-number">1</span>;</div><div class="line"><span class="hljs-keyword">else</span></div><div class="line">    x -= <span class="hljs-number">1</span>;</div></pre></td></tr></table></figure>
<p>Function declaration</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">increment</span>(<span class="hljs-params">uint x</span>) <span class="hljs-title">returns</span> (<span class="hljs-params">uint</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">return</span> x + <span class="hljs-number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="hljs-comment">// visibility precedes custom modifier</span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">increment</span>(<span class="hljs-params">uint x</span>) <span class="hljs-title">public</span> <span class="hljs-title">onlyOwner</span> <span class="hljs-title">returns</span> (<span class="hljs-params">uint</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">return</span> x + <span class="hljs-number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="hljs-comment">// long parameters list</span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">increment</span>(<span class="hljs-params"></span></span></div><div class="line">    uint x1,</div><div class="line">    uint x2,</div><div class="line">    uint x3,</div><div class="line">    uint x4,</div><div class="line">    uint x5,</div><div class="line">    uint x6,</div><div class="line">) &#123;</div><div class="line">  <span class="hljs-comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="hljs-comment">// long visibility modifier list</span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">increment</span> (<span class="hljs-params">uint x</span>)</span></div><div class="line">    <span class="hljs-title">public</span></div><div class="line">    <span class="hljs-title">onlyOwner</span></div><div class="line">    <span class="hljs-title">priced</span></div><div class="line">&#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Stirng should be quoted with double-quotes.</p>
<p>Contract and Library Names should be named using the CapWords style.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SimpleToken,</div><div class="line">SmartBank,</div></pre></td></tr></table></figure>
<p>Event Names should use CapWords</p>
<p>Function Names should use CamelCase</p>
<p>Function Arguments should use CamelCase</p>
<p>Local and State Variables should use CamelCase</p>
<p>Constants should be named with all captial letters with underscores seperating words: <code>MAX_BLOCKS</code></p>
<p>Modifier should use CamelCase</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-10T08:33:02.000Z">2017-11-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 minutes read (About 2404 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/10/Notes-on-Solidity-in-Depth/">Notes on Solidity in Depth</a>
            
        </h1>
        <div class="content">
            <h3 id="Layout-of-a-Solidity-Source-File"><a href="#Layout-of-a-Solidity-Source-File" class="headerlink" title="Layout of a Solidity Source File"></a>Layout of a Solidity Source File</h3><h4 id="Version-Pragma"><a href="#Version-Pragma" class="headerlink" title="Version Pragma"></a>Version Pragma</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div></pre></td></tr></table></figure>
<h4 id="Importing-other-Source-File"><a href="#Importing-other-Source-File" class="headerlink" title="Importing other Source File"></a>Importing other Source File</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"filename"</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> symbolName <span class="hljs-keyword">from</span> <span class="hljs-string">"filename"</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> &#123; symbol <span class="hljs-keyword">as</span> alias, symbol2 &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"filename"</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"filename"</span> <span class="hljs-keyword">as</span> symbolName;</div></pre></td></tr></table></figure>
<p>In the above, <code>filename</code> is always treated as a path with <code>/</code> as directory seperator.</p>
<p>All path names are treated as absolute paths unless thay start with <code>.</code> or <code>..</code>.</p>
<h5 id="Remapping"><a href="#Remapping" class="headerlink" title="Remapping"></a>Remapping</h5><p>For example, remap <code>github.com/ethereum/dapp-bin/library</code> to <code>/usr/local/dapp-bin/library</code></p>
<p><strong>solc</strong></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/ethereum/dapp-bin/library/iterable_mapping.sol` as it_mapping;</span></div></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">solc github.com/ethereum/dapp-bin/=/usr/<span class="hljs-built_in">local</span>/dapp-bin/ source.sol</div></pre></td></tr></table></figure>
<h4 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h4><p>Single Line Comments: <code>//</code></p>
<p>Multi-line Comments: <code>/* ... */</code></p>
<p>Natspec Comments: <code>///</code> or <code>/** ... */</code></p>
<p>Natspec should be used directly above function declarations or statements.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line"><span class="hljs-comment">/** @title Shape calculator */</span></div><div class="line">contract shapeCaculator &#123;</div><div class="line">  <span class="hljs-comment">/** @dev Calculates a rectangle's surface and perimeter.</span></div><div class="line">    * @param w Width of the rectangle.</div><div class="line">    * @param h Height of the rectangle.</div><div class="line">    * @param s The calculated surface.</div><div class="line">    * @param p The calculated perimeter.</div><div class="line">    */</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rectangle</span>(<span class="hljs-params">uint w, uint h</span>) <span class="hljs-title">returns</span> (<span class="hljs-params">uint s, uint p</span>) </span>&#123;</div><div class="line">    s = w * h;</div><div class="line">    p = <span class="hljs-number">2</span> * (w + h);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Structure-of-Contract"><a href="#Structure-of-Contract" class="headerlink" title="Structure of Contract"></a>Structure of Contract</h3><p>Contracts in Solidity are similar to classes in object-oriented languages. Each contract can contain declarations of <strong>State Variables</strong>, <strong>Functions</strong>, <strong>Function Modifiers</strong>, <strong>Events</strong>, <strong>Struct Types</strong> and <strong>Enum Types</strong>.</p>
<h4 id="State-Variables"><a href="#State-Variables" class="headerlink" title="State Variables"></a>State Variables</h4><p>State variables are values which are permanently stored in contract storage.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract SimpleStorage &#123;</div><div class="line">  uint storedData; <span class="hljs-comment">// state variable</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h4><p>Functions are executable units of code within a contract.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract SimpleAuction &#123;</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bid</span>(<span class="hljs-params"></span>) <span class="hljs-title">payable</span> </span>&#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Function-Modifiers"><a href="#Function-Modifiers" class="headerlink" title="Function Modifiers"></a>Function Modifiers</h4><p>Function modifiers can be used to amend the semantics of functions in a declarative way.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract Purchase &#123;</div><div class="line">  address public seller;</div><div class="line"></div><div class="line">  modifier onlySeller () &#123; <span class="hljs-comment">// Modifier</span></div><div class="line">    <span class="hljs-built_in">require</span>(msg.sender == seller);</div><div class="line">    _;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abort</span>(<span class="hljs-params"></span>) <span class="hljs-title">onlySeller</span> </span>&#123; <span class="hljs-comment">// Modifier usage</span></div><div class="line">    <span class="hljs-comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h4><p>Events are convenience interfaces with the EVM logging facilities.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract SimpleAuction &#123;</div><div class="line">  event HighestBidIncreased(address bidder, uint amount);</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bid</span>(<span class="hljs-params"></span>) <span class="hljs-title">payable</span> </span>&#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">    HighestBidIncreased(msg.sender, msg.value);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Struct-Types"><a href="#Struct-Types" class="headerlink" title="Struct Types"></a>Struct Types</h4><p>Structs are custom defined types that can group several variables.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract Ballot &#123;</div><div class="line">  struct Voter &#123;</div><div class="line">    uint weight;</div><div class="line">    bool voted;</div><div class="line">    address delegate;</div><div class="line">    uint vote;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Enum-Types"><a href="#Enum-Types" class="headerlink" title="Enum Types"></a>Enum Types</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.0</span>;</div><div class="line"></div><div class="line">contract Purchase &#123;</div><div class="line">  enum State &#123;</div><div class="line">    Created,</div><div class="line">    Locked,</div><div class="line">    Inactive</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h4><ul>
<li><p><code>bool</code>: <code>true</code> or <code>false</code></p>
<ul>
<li><p><code>!</code> logical negation</p>
</li>
<li><p><code>&amp;&amp;</code> logical and</p>
</li>
<li><p><code>||</code> logical or</p>
</li>
<li><p><code>==</code> logical equality</p>
</li>
<li><p><code>!=</code> logical inequality</p>
</li>
</ul>
</li>
<li><p><code>int/uint</code>: <code>uint8</code> to <code>uint256</code>, <code>int8</code> to <code>int256</code></p>
<ul>
<li><p><code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code></p>
</li>
<li><p><code>&amp;</code>, <code>|</code>, <code>^</code>, <code>~</code>, bit operators</p>
</li>
<li><p><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>**</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code></p>
</li>
</ul>
</li>
<li><p><code>address</code>: holds a 20 bytes value(size of an Ethereum address)</p>
<ul>
<li><code>&lt;=</code>, <code>=&gt;</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>Starting with version 0.5.0 contracts do not derive from the <code>address</code> type, but can still be explicitly converted to address.</p>
</blockquote>
<h4 id="Members-of-Address"><a href="#Members-of-Address" class="headerlink" title="Members of Address"></a>Members of Address</h4><ul>
<li><p><code>balance</code></p>
</li>
<li><p><code>transfer</code>, address.transfer(value), send value Wei to the address.</p>
</li>
<li><p><code>send</code>: Send is the low-level counterpart of <code>transfer</code>. If the execution fails, the current contract will not stop with an exception, but <code>send</code> will return <code>false</code></p>
</li>
</ul>
<blockquote>
<p>There are some dangers in using <code>send</code>: The transfer fails if the call stack depth is 1024 and it also fails if the recipient runs out of gas. So in order to make safe Ether transfers, always check the return value of <code>send</code>, use <code>transfer</code> or even better.</p>
</blockquote>
<ul>
<li><code>call</code>, <code>callcode</code>, and <code>delegatecall</code></li>
</ul>
<p>Furthermore, to interface with contracts that do not adhere to the ABI, the function <code>call</code> is provided which takes an arbitrary number of arguments of any type. The arguments are padding to 32 bytes and concatenated. One exception is the case where the first argument is encoded to exactly four bytes. In this case, it is not padding to allow the use of function signatures here.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">address nameReg = <span class="hljs-string">'0x72ba7d8e73fe8eb666ea66babc8116a41bfb10e2'</span>;</div><div class="line">nameReg.call(<span class="hljs-string">'register'</span>, <span class="hljs-string">'MyName'</span>);</div><div class="line">nameReg.call(bytes4(keccak256(<span class="hljs-string">"fun(uint256))), );</span></div></pre></td></tr></table></figure>
<p><code>call</code> returns a boolean indicating whether the invoked function terminated (true) or caused an EVM exception (false). It is not possible to access the actual data returned.</p>
<p>It is possible to adjust the supplied gas with the <code>.gas()</code> modifier:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nameReg.call.gas(<span class="hljs-number">1000000000</span>)(<span class="hljs-string">'register'</span>, <span class="hljs-string">'myName'</span>);</div></pre></td></tr></table></figure>
<p>and supplied Ether value can be controlled too:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nameReg.call.value(<span class="hljs-number">1</span> ether)(<span class="hljs-string">'regiter'</span>, <span class="hljs-string">'myName'</span>);</div></pre></td></tr></table></figure>
<p>Chained</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nameReg.call.value(<span class="hljs-number">1</span> ether).gas(<span class="hljs-number">100000000</span>)(<span class="hljs-string">'register'</span>, <span class="hljs-string">'myName'</span>);</div></pre></td></tr></table></figure>
<p>In a similar way, the function <code>delegatecall</code> can be used: the difference is that only the code of the given address is used, all other aspects(storage, balance, …) are taken from the current contract. The purpose of <code>delegatecall</code> is to use library code which is stored in another contract. The user has to ensure that the layout of storage in both contracts is suitable for delegatecall to be used. Prior to homestead, only a limited variant called <code>callcode</code> was available that did not provide access to the original <code>msg.sender</code> and <code>msg.value</code>.</p>
<p>All three functions <code>call</code>, <code>delegatecall</code>, and <code>callcode</code> are very low-level functions and should only be used as a <em>last resort</em> as they break the type-safety of Solidity.</p>
<p>The <code>.gas()</code> option is available on all three methods, while the <code>.value()</code> option is not supported for <code>delegatecall</code>.</p>
<blockquote>
<p>All Contracts inherit the members of address, so it is possible to query the balance of the current contract using <code>this.balance</code>.</p>
<p>The use of <code>callcode</code> is discouraged and will be removed in the future.</p>
</blockquote>
<h4 id="Fixed-size-byte-array"><a href="#Fixed-size-byte-array" class="headerlink" title="Fixed-size byte array"></a>Fixed-size byte array</h4><ul>
<li><code>.length</code> yields the fixed length of the byte array(read-only)</li>
</ul>
<blockquote>
<p>It is possible to use an array of bytes as <code>byte[]</code>, but it is wasting a lot of space, 21 bytes every element, to be exact, when passing in calls. It is better to use <code>bytes</code>.</p>
</blockquote>
<h4 id="Dynamically-sized-byte-array"><a href="#Dynamically-sized-byte-array" class="headerlink" title="Dynamically-sized byte array"></a>Dynamically-sized byte array</h4><p><code>bytes</code>: dynamically-sized array, see Array, not a value-type.</p>
<p><code>string</code>: dynamically-sized UTF-8-encoded string, see Array, not a value-type.</p>
<h4 id="Address-Liberals"><a href="#Address-Liberals" class="headerlink" title="Address Liberals"></a>Address Liberals</h4><p>Hexadecimal literals that pass the address checksum test, for example <code>0xdCad3a6d3569DF655070DEd06cb7A1b2Ccd1D3AF</code> are of <code>address</code> type. Hexadecimal literals that are between 39 and 41 digits long and do not pass the checksum test produce a warning and are treated as regular rational number literals</p>
<h4 id="Rational-and-Integer-Literals"><a href="#Rational-and-Integer-Literals" class="headerlink" title="Rational and Integer Literals"></a>Rational and Integer Literals</h4><p>Integer literal are formed form a sequence of numbers in the range 0-9. They are interpreted as decimals, for example, <code>69</code> means sixty nine. Octal literals do not exist in Solidity and leading zeros are invalid.</p>
<p>Decimal fraction literals are formed by a <code>.</code> with at least one number on one side(<code>1.</code>, <code>.2</code>, <code>1.3</code>)</p>
<p>Scientific notation is also supported, where the base can have fractions, white the exponent cannot(2e10, -2e10, 2e-10, 2.5e10)</p>
<p>Number literal expressions retains arbitrary precision until they are converted to a non-literal type.</p>
<p>For example <code>(2**800 + 1) - 2**800</code> result in the constant <code>1</code>, <code>.5 * 8</code> results in the integer <code>4</code></p>
<blockquote>
<p>Number literal expressions are converted into a non-literal type as soon as they are used with non-literal expressions. Even though we know that the value of the expression assigned to <code>b</code> in the following example evaluates to an integer, but the partial expression <code>2.5 + a</code> does not type check so the code does not compile.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uint128 a = <span class="hljs-number">1</span>;</div><div class="line">uint128 b = <span class="hljs-number">2.5</span> + a + <span class="hljs-number">0.5</span>;</div></pre></td></tr></table></figure>
<h4 id="String-Literals"><a href="#String-Literals" class="headerlink" title="String Literals"></a>String Literals</h4><p>String literals are written with either double or sinlge-quotes. They do not imply trailing zeros as in C, <code>&quot;foo&quot;</code> represents three bytes not four.</p>
<p>String Literal supports escape characters, such as <code>\n</code>, <code>\xNN</code> and <code>\uNNNN</code>.</p>
<h4 id="Hexadecimal-Literals"><a href="#Hexadecimal-Literals" class="headerlink" title="Hexadecimal Literals"></a>Hexadecimal Literals</h4><p><code>hex&quot;001122FF&quot;</code></p>
<h4 id="Enums"><a href="#Enums" class="headerlink" title="Enums"></a>Enums</h4><p>Enums are one way to create a user-defined type in Solidity. They are explicitly convertable to and from all integer types but implicit conversion is not allowed. The explicit conversions check the value ranges at runtime, and a failure causes an exception.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract test &#123;</div><div class="line">  enum ActionChoices &#123;</div><div class="line">    GoLeft,</div><div class="line">    GoRight,</div><div class="line">    GoStraight,</div><div class="line">    GoStill</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  ActionChoices choice;</div><div class="line">  ActionChoices constant defaultChoice = ActionChoices.GoStraight;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setGoStraight</span>(<span class="hljs-params"></span>) </span>&#123;</div><div class="line">    choice = ActionChoices.GoStraight;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getChoice</span>(<span class="hljs-params"></span>) <span class="hljs-title">returns</span> (<span class="hljs-params">ActionChoices</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">return</span> choice;</div><div class="line">  &#125;</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDefaultChoice</span>(<span class="hljs-params"></span>) <span class="hljs-title">returns</span> (<span class="hljs-params">uint</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">return</span> uint(defaultChoice);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Function-Types"><a href="#Function-Types" class="headerlink" title="Function Types"></a>Function Types</h4><p>Function types are notated as follows:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">&lt;parameter types&gt;</span>) </span>&#123;internal|external&#125; [pure|constant|view|payable] [returns (<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">return</span> <span class="hljs-attr">types</span>&gt;</span>)]</span></div></pre></td></tr></table></figure>
<p>In contrast to the parameter types, the return types cannot be empty - if the function type should not return anything, the whole <code>returns (&lt;return type&gt;)</code> part has to be omitted.</p>
<p>Public (or external) functions have a special member called <code>selector</code>, which returns the <code>ABI function selector</code>:</p>
<h4 id="Reference-Types"><a href="#Reference-Types" class="headerlink" title="Reference Types"></a>Reference Types</h4><p>Complex types, i.e. types which do not always fit into 256 bits have to be handled more carefully than than the value-types we have already seen. Since copying them can be quite expensive, we have to think about whether we want them to be store in <strong>memory</strong>(which is not persisting) or <strong>storage</strong>(where the state variables are held).</p>
<h4 id="Data-location"><a href="#Data-location" class="headerlink" title="Data location"></a>Data location</h4><p>Every complex type, i.e. <em>arrays</em> and <em>structs</em> has an additional annotation, the “data location” about where it is stored in <strong>memory</strong> or in <strong>storage</strong>. Depending on the context, there is always a default, but it can be overrideen by appeding either <code>storage</code> or <code>memory</code> to the type. The default for function parameters(including return parameters) is <strong>memory</strong> the default for local variable is <strong>storage</strong> and the location is forced to <strong>storage</strong> for state variables</p>
<p>There is also a third data location, <strong>calldata</strong>, which is a non-modificable, non-persistent area where function arguments are stored. Function parameter(not return parameters) of external functions are forced to <strong>calldata</strong> and behave mostly like <strong>memory</strong>.</p>
<p>Data locations are imortant because they change how assignment behave: assignments between storage and memory and also to a state variable always create an independent copy. Assignments to local storage variables only assign a reference though, and this reference always points to the state variable even if the latter is changed in the meantime. On the other hand, assignments from a memory stoted reference type to another memory-stored reference type do not create a copy.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract C &#123;</div><div class="line">  uint[] x; <span class="hljs-comment">// the data location of x is storage</span></div><div class="line"></div><div class="line">  <span class="hljs-comment">// the data location of memoryArray is memory</span></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">uint[] memoryArray</span>) </span>&#123;</div><div class="line">    x = memoryArray; <span class="hljs-comment">// works, copy the whole array to storage</span></div><div class="line">    <span class="hljs-keyword">var</span> y = x; <span class="hljs-comment">// works, assigns a pointer, data location of y is storage</span></div><div class="line">    y[<span class="hljs-number">7</span>]; <span class="hljs-comment">// fine, returns the 8th element</span></div><div class="line">    y.length = <span class="hljs-number">2</span>; <span class="hljs-comment">// fine, modifies x through y</span></div><div class="line">    <span class="hljs-keyword">delete</span> x; <span class="hljs-comment">// fine, clears the array, also modifies y</span></div><div class="line">    <span class="hljs-comment">// the following does not work; it would need to create a new temporary / unamed array in storage, but storage is 'statically' allocated</span></div><div class="line">    <span class="hljs-comment">// y = memoryArray;</span></div><div class="line">    <span class="hljs-comment">// This does not work either, since it would 'reset' the pointer, but there is not sensible location it could point to.</span></div><div class="line">    <span class="hljs-comment">// delete y;</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h5><ul>
<li><p>Forced data location:</p>
<ul>
<li><p>parameters(not return) of external functions: calldata</p>
</li>
<li><p>state variables: storage</p>
</li>
</ul>
</li>
<li><p>Default data location:</p>
<ul>
<li><p>parameters(also return) of functions: memory</p>
</li>
<li><p>all other local variables: storage</p>
</li>
</ul>
</li>
</ul>
<h4 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h4><p>An array of fixed size <code>k</code> and element type <code>T</code> is written as <code>T[k]</code></p>
<p>An array of dynamic size as <code>T[]</code></p>
<p>An array of 5 dynamic arrays of <code>uint</code> is <code>uint[][5]</code>. (note that the notation is reversed when compared to some other language). To access the second uint in the third dynamic array, you use <code>x[2][1]</code></p>
<p>Variables of type <code>bytes</code> and <code>string</code> are special arrays. A <code>bytes</code> is similar to <code>byte[]</code>, but it is packed tightly in calldata. <code>string</code> is equal to <code>bytes</code> but does not allow length or index access(for now).</p>
<p>So <code>bytes</code> should always be preferred over <code>byte[]</code> because it is cheaper.</p>
<h4 id="Structs"><a href="#Structs" class="headerlink" title="Structs"></a>Structs</h4><p>Solidity provides a way to define new types in the form of structs, which is shown in the following example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.11</span>;</div><div class="line"></div><div class="line">contract CrowdFunding &#123;</div><div class="line">  struct Funder &#123;</div><div class="line">    address addr;</div><div class="line">    uint amount;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  struct Campaign &#123;</div><div class="line">    address beneficiary;</div><div class="line">    uint fundingGoal;</div><div class="line">    uint numFunders;</div><div class="line">    uint amount;</div><div class="line">    mapping(<span class="hljs-function"><span class="hljs-params">uint</span> =&gt;</span> Funder) funders;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It is not possible for a struct to contain a member of its own type, although the struct itself can be the value type of a mapping member. This restriction is necessary, as the size of the struct has to be finite.</p>
<h4 id="Mappings"><a href="#Mappings" class="headerlink" title="Mappings"></a>Mappings</h4><p>Mapping types are declared as <code>mapping(_keyType =&gt; _valueType)</code>. Here <code>_keyType</code> can be almost any type except for a mapping, a dynamically sized array, a contract, an enum, and a struct. <code>_valueType</code> can actually be any type, including mappings.</p>
<p>Mappings can be seen as hash tables which are virtually initialized such that every possible key exists and is mapped to a value whose byte-representation is all zeros: a type’s default value.</p>
<p>Mappings are only allowed for state variables( or as storage reference types in internal function).</p>
<p>It is possible to mark mapping <code>public</code> and have Solidity create a getter. The <code>_keyType</code> will become a required parameter for the getter and it will return <code>_valueType</code>.</p>
<p>Mappings are not iterable, but it is possible to implement a data structure on top of them.</p>
<h4 id="Operators-Involving-LValues"><a href="#Operators-Involving-LValues" class="headerlink" title="Operators Involving LValues"></a>Operators Involving LValues</h4><p>LValue, i.e. a variable or something that can be assigned to.</p>
<h5 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h5><p><code>delete a</code> assigns the initial value for the type to a. I.e., for integers, it is equivalent to <code>a = 0</code>.</p>
<p><code>delete</code> has no effect on whole mappints. So if you delete a struct, it will reset all members that are not mappings and also recurse into the memebers unless they are mappings. However, individual keys and what they map to can be deleted.</p>
<p>It’s really important to note that <code>delete a</code> really behaves like an assignment to <code>a</code>, it stores a new object in <code>a</code>.</p>
<h4 id="Conversions-between-Elementary-Types"><a href="#Conversions-between-Elementary-Types" class="headerlink" title="Conversions between Elementary Types."></a>Conversions between Elementary Types.</h4><h5 id="Implicit-Conversions"><a href="#Implicit-Conversions" class="headerlink" title="Implicit Conversions"></a>Implicit Conversions</h5><p>In general, an implicit conversion between value-types is possible if it makes sense semantically and no information is lost: <code>uint8</code> is convertible to <code>uint16</code>, but <code>uint16</code> is not convertible to <code>uint8</code>. And <code>int8</code> is not convertible to <code>uint256</code>(because <code>uint256</code> cannot hold hold e.g. <code>-1</code>).</p>
<h5 id="Explicit-Conversions"><a href="#Explicit-Conversions" class="headerlink" title="Explicit Conversions"></a>Explicit Conversions</h5><p>If the compiler does not allow implicit conversion but you know what you are doing, an explicit type conversion is sometimes possible.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">int8 y = <span class="hljs-number">-3</span>;</div><div class="line">uint x = uint(y);</div></pre></td></tr></table></figure>
<h4 id="Type-Deduction"><a href="#Type-Deduction" class="headerlink" title="Type Deduction"></a>Type Deduction</h4><p>For convenience, it is not always necessary to explicitly specify the type of a variable, the compiler automatically infers it from the type of the first expression that is assigned to the variable:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uint24 x = <span class="hljs-number">0x123</span>;</div><div class="line"><span class="hljs-keyword">var</span> y = x;</div></pre></td></tr></table></figure>
<h3 id="Units-and-Globally-Available-Variables"><a href="#Units-and-Globally-Available-Variables" class="headerlink" title="Units and Globally Available Variables"></a>Units and Globally Available Variables</h3><h4 id="Ether-Units"><a href="#Ether-Units" class="headerlink" title="Ether Units"></a>Ether Units</h4><p>A literal number can take a suffix of <code>wei</code>, <code>finney</code>, <code>szabo</code>, or <code>ether</code> to convert between the subdenominations of Ether, where Ether currency numbers without a postfix are assumed to be Wei.</p>
<p><code>2 ether === 2000 finney</code> evaluates to <code>true</code></p>
<h4 id="Time-Units"><a href="#Time-Units" class="headerlink" title="Time Units"></a>Time Units</h4><p>Suffixes like <code>seconds</code>, <code>minutes</code>, <code>hours</code>, <code>days</code>, <code>weeks</code> and <code>years</code> after literal numbers can be used to convert between units of time where seconds are the base unit.</p>
<p>Take care if you perform calendar calculations using these units, because not every year equals 365 days and not even every day has 24 hours because of leap seconds. Due to the fact that leap seconds cannot be predicted, an exact calendar library has to be updated by an external oracle.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">unit start, unit dayAfter</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (now &gt;= start + dayAfter + <span class="hljs-number">1</span> days) &#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Other Global Variables and Functions:</p>
<p><a href="http://ezcook.de/2017/11/10/Solidity-CheatSheet/" target="_blank" rel="noopener">Post</a></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-10T07:02:45.000Z">2017-11-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 477 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/10/Solidity-CheatSheet/">Solidity CheatSheet</a>
            
        </h1>
        <div class="content">
            <h3 id="Global-Variables"><a href="#Global-Variables" class="headerlink" title="Global Variables"></a>Global Variables</h3><h4 id="Block"><a href="#Block" class="headerlink" title="Block"></a>Block</h4><ul>
<li><p>block.coinbase: address - current block miner’s address</p>
</li>
<li><p>block.difficulty: uint - current block difficulty</p>
</li>
<li><p>block.gaslimit: uint - current block gaslimit</p>
</li>
<li><p>block.number: uint - current block number</p>
</li>
<li><p>block.timestamp: uint - current block timestamp</p>
</li>
</ul>
<h4 id="Msg"><a href="#Msg" class="headerlink" title="Msg"></a>Msg</h4><ul>
<li><p>msg.data: bytes - complete calldata</p>
</li>
<li><p>msg.gas: uint - remaining gas</p>
</li>
<li><p>msg.sender: address - sender of the message(current call)</p>
</li>
<li><p>msg.value: uint - number of wei sent with the message</p>
</li>
</ul>
<h4 id="Now"><a href="#Now" class="headerlink" title="Now"></a>Now</h4><ul>
<li>now: uint - current block timestamp(alias for block.timestamp)</li>
</ul>
<h4 id="Tx"><a href="#Tx" class="headerlink" title="Tx"></a>Tx</h4><ul>
<li><p>tx.gasprice: uint - gas price of the transaction</p>
</li>
<li><p>tx.origin: address - sender of the transaction (full call chain)</p>
</li>
</ul>
<h3 id="Global-Functions"><a href="#Global-Functions" class="headerlink" title="Global Functions"></a>Global Functions</h3><ul>
<li><p>assert(bool condition): abort execution and revert state changes if condition is <code>false</code>(use for internal error)</p>
</li>
<li><p>require(bool condition): abort execution and revert state changes if condition is <code>false</code>(use for malformed input or error in external component)</p>
</li>
<li><p>revert(): abort execution and revert state changes</p>
</li>
<li><p>block.blockhash(uint blockNumber) returns (bytes32): hash of the given block - only works for 256 most recent blocks</p>
</li>
<li><p>sha256(…) returns (bytes32): compute the SHA-256 hash of the (tightly packed) arguments</p>
</li>
<li><p>keccak256(…) returns (bytes32): compute the Ethereum-SHA-3(Keccak-256) hash of the (tightly packed) arguments</p>
</li>
<li><p>sha3(…) returns (bytes32): alias for keccak256</p>
</li>
<li><p>ecrecover(bytes32 hash, uint8 v, bytes32 r, bytes32 s) returns (address): recover address associated with the public key from elliptic curve signature</p>
</li>
<li><p>addmod(uint x, uint y, uint k) returns (uint): compute <code>(x + y) % k</code> where the addition is performed with arbitrary precision and does not wrap around at 2 ** 256</p>
</li>
<li><p>mulmod(uint x, uint y, uint k) returns (uint): compute <code>(x * y) % k</code> where the addition is performed with arbitrary precision and does not wrap around 2 ** 256</p>
</li>
<li><p>selfdestruct(address recipient): destroy the current contract, sending its funds to the given address</p>
</li>
<li><p>suicide(address recipient): alias for selfdestruct</p>
</li>
<li><p><address>.balance: uint256: balance of the Address in Wei</address></p>
</li>
<li><p><address>.send(uint256 amount) returns (bool): send given amount of Wei to Address, returns <code>false</code> on failure</address></p>
</li>
<li><p><address>.transfer(uint256 amount): send given amount of Wei to Address, throws on failure.</address></p>
</li>
</ul>
<h3 id="Scope-Variables"><a href="#Scope-Variables" class="headerlink" title="Scope Variables"></a>Scope Variables</h3><ul>
<li><p>this: current contract’s type - the current contract, explicitly convertable to address</p>
</li>
<li><p>super: the contract one level higher in the inheritance hierarchy</p>
</li>
</ul>
<h3 id="Function-Visibility-Specifier"><a href="#Function-Visibility-Specifier" class="headerlink" title="Function Visibility Specifier"></a>Function Visibility Specifier</h3><ul>
<li><p>public: visible externally and internally(creates accessor function for storage/state variables)</p>
</li>
<li><p>private: only visible in the current contract</p>
</li>
<li><p>external: only visible externally(only for functions) - i.e. can only be message-called)</p>
</li>
<li><p>internal: only visible internally</p>
</li>
</ul>
<h3 id="Modifiers"><a href="#Modifiers" class="headerlink" title="Modifiers"></a>Modifiers</h3><ul>
<li><p>pure: for function - disallows modification or access of state - this is not enforced yet</p>
</li>
<li><p>view: for function - disallows modifiction of state - this is not enforced yet</p>
</li>
<li><p>payable: for function - allows them to receive Ether together with a call</p>
</li>
<li><p>constant: for state variable - disallow assignment(except initialization), does not occupy storage slot</p>
</li>
<li><p>contant: for function - same as view</p>
</li>
<li><p>anonymous: for events - does not store event signature as topic</p>
</li>
<li><p>indexed: for event parameters - store the parameter as topic</p>
</li>
</ul>
<p><img src="https://s3-eu-west-1.amazonaws.com/b9-academy-assets/public/solidity-cheatsheet.png" alt=""></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-07T01:43:53.000Z">2017-11-07</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 772 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/07/HTTP-2-by-Node-js/">HTTP/2 by Node.js</a>
            
        </h1>
        <div class="content">
            <p><a href="https://dexecure.com/blog/how-to-create-http2-static-file-server-nodejs-with-examples/" target="_blank" rel="noopener">Original</a></p>
<p>Websites delivered using HTTP/2 enjoys a wide range of new features including -</p>
<ul>
<li><p>fully multiplexed connections: all requests and responses to a domain are fully multiplexed via a single connection, making best use of available bandwidth.</p>
</li>
<li><p>header compression: repeated headers are compressed with HPACK compression so that they are not resent with every request and response.</p>
</li>
<li><p>PUSH: resources can be pre-emptively pushed by the server to the client, speeding up page load times.</p>
</li>
</ul>
<p>Node.js just launched support(v8.8.1) for HTTP/2 as part of their core. In this post, we will create a simple HTTP/2 server to serve static files and then demonstrate some cool features like HTTP/2 PUSH.</p>
<h3 id="Get-an-SSL-certificate"><a href="#Get-an-SSL-certificate" class="headerlink" title="Get an SSL certificate"></a>Get an SSL certificate</h3><p>Even though the HTTP/2 spec does not mandate HTTPS, browsers have decided that they will only support HTTP/2 on a HTTPS connection. This would also mitigate interference from older proxies which may not understand newer protocol.</p>
<p>For your local server, a self-signed certificate will work. You can find how to setup a self-signed certificate <a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-in-ubuntu-16-04" target="_blank" rel="noopener">here</a></p>
<h3 id="Building-a-Static-File-Server"><a href="#Building-a-Static-File-Server" class="headerlink" title="Building a Static File Server"></a>Building a Static File Server</h3><p>Let us start with a simple server which just serves static files. Note that if you are using node.js 8.7.0, you need to run node with the <code>--expose-http2</code> flag.</p>
<p>We will be listening to the <code>stream</code> event and responding to it with the corresponding file from the server root(public, in this case) using the <code>respondWithFile</code> API. We are using the <code>mime-type</code> module to look up the correct mime type to send along with the response.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> http2 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http2'</span>)</div><div class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</div><div class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</div><div class="line"><span class="hljs-keyword">const</span> mime = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mime-types'</span>)</div><div class="line"></div><div class="line">cosnt &#123;</div><div class="line">  HTTP2_HEADER_PATH,</div><div class="line">  HTTP2_HEADER_METHOD,</div><div class="line">  HTTP_STATUS_NOT_FOUND,</div><div class="line">  HTTP_STATUS_INTERNAL_SERVER_ERROR</div><div class="line">&#125; = http2.constants</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> options = &#123;</div><div class="line">  <span class="hljs-attr">key</span>: fs.readFileSync(<span class="hljs-string">'./selfsigned.key'</span>),</div><div class="line">  <span class="hljs-attr">cert</span>: fs.readFileSync(<span class="hljs-string">'./selfsigned.crt'</span>),</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> server = http2.createSecureServer(options)</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> serverRoot = <span class="hljs-string">'./public'</span></div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">respondToStreamError</span>(<span class="hljs-params">err, stream</span>) </span>&#123;</div><div class="line">  <span class="hljs-built_in">console</span>.log(err)</div><div class="line">  <span class="hljs-keyword">if</span> (err.code === <span class="hljs-string">'ENOENT'</span>) &#123;</div><div class="line">    stream.respond(&#123;</div><div class="line">      <span class="hljs-string">':stats'</span>: HTTPS_STATUS_NOT_FOUND,</div><div class="line">    &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    stream.respond(&#123;</div><div class="line">      <span class="hljs-string">':status'</span>: HTTP_STATUS_INTERNAL_SERVER_ERROR,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  stream.end()</div><div class="line">&#125;</div><div class="line"></div><div class="line">server.on(<span class="hljs-string">'stream'</span>, (stream, headers) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">const</span> reqPath = headers[HTTP2_HEADER_PATH]</div><div class="line">  <span class="hljs-keyword">const</span> reqMethod = headers[HTTP2_METHOD]</div><div class="line"></div><div class="line">  <span class="hljs-keyword">const</span> fullPath = path.join(serverRoot, reqPath)</div><div class="line">  <span class="hljs-keyword">const</span> responseMimeType = mime.lookup(fullPath)</div><div class="line"></div><div class="line">  stream.respondWithFile(fullPath, &#123;</div><div class="line">    <span class="hljs-string">'content-type'</span>: responseMimeType</div><div class="line">  &#125;, &#123;</div><div class="line">    <span class="hljs-attr">onError</span>: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> respondToStreamError(err, stream)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">server.listen(<span class="hljs-number">443</span>)</div></pre></td></tr></table></figure>
<h3 id="Server-PUSH-Example"><a href="#Server-PUSH-Example" class="headerlink" title="Server PUSH Example"></a>Server PUSH Example</h3><p>Now we have simpel HTTP/2 server running, lets try to use one of the new featues in HTTP/2 - HTTP/2 PUSH. This can lead to significant performance improvements in high latency environments, if done correctly.</p>
<p>We are loading a simple HTML file pointing to style.css which references to our font file. The request to the font file is only made after css file is discovered in the HTML, downloaded and then parsed. This is how the waterfall would have usually looked like:</p>
<p><img src="https://dexecure.com//images/blog/waterfall-without-http2.53b722f2.png" alt=""></p>
<p>You can initate a new PUSH with the <code>pushStream</code> API. Since we know that the browser is going to be requesting the font file in the future, we can PUSH the font file as soon as the server receives the request for the HTML file.</p>
<p>When the actual request for the font file takes place, it is claimed from the PUSH cache, instead of making a network request then.</p>
<p><img src="https://dexecure.com//images/blog/waterfall-with-http2.b47218ea.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> http2 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http2'</span>)</div><div class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</div><div class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</div><div class="line"><span class="hljs-keyword">const</span> mime = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mime-types'</span>)</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> &#123;</div><div class="line">  HTTP2_HEADER_PATH,</div><div class="line">  HTTP2_HEADER_METHOD,</div><div class="line">  HTTP_STATUS_NOT_FOUND,</div><div class="line">  HTTP_STATUS_INTERNAL_SERVER_ERROR,</div><div class="line">&#125; = http2.constants</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> options = &#123;</div><div class="line">  <span class="hljs-attr">key</span>: fs.readFileSync(<span class="hljs-string">'./selfsigned.key'</span>),</div><div class="line">  <span class="hljs-attr">cert</span>: fs.readFileSync(<span class="hljs-string">'./selfsigned.crt'</span>),</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> server = http2.createSecureServer(options)</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> serverRoot = <span class="hljs-string">'./public'</span></div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">respondToStreamError</span> (<span class="hljs-params">err, stream</span>) </span>&#123;</div><div class="line">  <span class="hljs-built_in">console</span>.log(err)</div><div class="line">  <span class="hljs-keyword">if</span> (err.code === <span class="hljs-string">'ENOENT'</span>) &#123;</div><div class="line">    stream.respond(&#123;</div><div class="line">      <span class="hljs-string">':status'</span>: HTTP_STATUS_NOT_FOUND,</div><div class="line">    &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    stream.respond(&#123;</div><div class="line">      <span class="hljs-string">':status'</span>: HTTP_STATUS_INTERNAL_SERVER_ERROR,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  stream.end()</div><div class="line">&#125;</div><div class="line"></div><div class="line">server.on(<span class="hljs-string">'stream'</span>, (stream, headers) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">const</span> reqPath = headers[HTTP2_HEADER_PATH]</div><div class="line">  <span class="hljs-keyword">const</span> reqMethod = headers[HTTP2_HEADER_METHOD]</div><div class="line">  <span class="hljs-keyword">const</span> fullPath = path.join(serverRoot, reqPath)</div><div class="line">  <span class="hljs-keyword">const</span> responseMimeType = mime.lookup(fullPath)</div><div class="line"></div><div class="line">  <span class="hljs-keyword">if</span> (fullPath.endsWith(<span class="hljs-string">'.html'</span>)) &#123;</div><div class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'html'</span>)</div><div class="line">    <span class="hljs-comment">// handle the html file</span></div><div class="line">    stream.respondWithFile(fullPath, &#123;</div><div class="line">      <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'text/html'</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;</div><div class="line">        respondToStreamError(err, stream)</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">    stream.pushStream(&#123;</div><div class="line">      <span class="hljs-string">':path'</span>: <span class="hljs-string">'/font.woff'</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="hljs-attr">parent</span>: stream.id,</div><div class="line">    &#125;, pushStream =&gt; &#123;</div><div class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'pushing'</span>)</div><div class="line">      pushStream.respondWithFile(path.join(serverRoot, <span class="hljs-string">'/font.woff'</span>), &#123;</div><div class="line">        <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'text/css'</span>,</div><div class="line">      &#125;, &#123;</div><div class="line">        <span class="hljs-attr">onError</span>: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</div><div class="line">          respondToStreamError(err, pushStream)</div><div class="line">        &#125;</div><div class="line">      &#125;)</div><div class="line">    &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    <span class="hljs-comment">// handle the static file</span></div><div class="line">    <span class="hljs-built_in">console</span>.log(fullPath)</div><div class="line">    stream.respondWithFile(fullPath, &#123;</div><div class="line">      <span class="hljs-string">'content-type'</span>: responseMimeType,</div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="hljs-attr">onError</span>: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> respondToStreamError(err, stream)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">server.listen(<span class="hljs-number">443</span>)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-06T06:10:05.000Z">2017-11-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 927 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/06/Rocket-of-Rust/">Rocket of Rust</a>
            
        </h1>
        <div class="content">
            <h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>Rocket’s design is centered around three core philosophies:</p>
<ul>
<li><p><strong>Function declaration and parameter type should contain all necessary information to validate and process a request</strong>. This immediately prohibits APIs where request state is retrieved from a global context. As a result, request handling is <strong>self-contained</strong> in Rocket: handlers are regular functions with regular arguments.</p>
</li>
<li><p><strong>All request handling information should be typed</strong>. Because the web and HTTP are themselves untyped(or stringly typed, as some call it), this means that something or someone has to convert strings to native types. Rocket does this for you with zero programming overhead.</p>
</li>
<li><p><strong>Decisions should not be forced</strong>. Templates, serialization, sessions and just about everything else are all pluggable, optional components. While Rocket has official support and libraries for each of these, they are completely optional and swappable.</p>
</li>
</ul>
<h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cargo new hello-rocket --bin</div></pre></td></tr></table></figure>
<p>Add Dependencies</p>
<figure class="highlight toml hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-section">[dependencies]</span></div><div class="line"><span class="hljs-attr">rocket</span> = <span class="hljs-string">"0.3.3"</span></div><div class="line"><span class="hljs-attr">rocket_codegen</span> = <span class="hljs-string">"0.3.3"</span></div></pre></td></tr></table></figure>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-meta">#![feature(plugin)]</span></div><div class="line"><span class="hljs-meta">#![plugin(rocket_codegen)]</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> rocket;</div><div class="line"></div><div class="line"><span class="hljs-meta">#[get(<span class="hljs-meta-string">"/"</span>)]</span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">index</span></span>() -&gt; &amp;<span class="hljs-symbol">'static</span> <span class="hljs-built_in">str</span> &#123;</div><div class="line">  <span class="hljs-string">"Hello World"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</div><div class="line">  rocket::ignite().mount(<span class="hljs-string">"/"</span>, routes![index]).launch();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It creates an <code>index</code> route, <em>mount</em> the route at the <code>/</code> path, and launches the application. Compile and run the program with <code>cargo run</code>, you should see the following:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">🔧  Configured <span class="hljs-keyword">for</span> development.</div><div class="line">    =&gt; address: localhost</div><div class="line">    =&gt; port: 8000</div><div class="line">    =&gt; <span class="hljs-built_in">log</span>: normal</div><div class="line">    =&gt; workers: [core count * 2]</div><div class="line">    =&gt; secret key: generated</div><div class="line">    =&gt; limits: forms = 32KiB</div><div class="line">    =&gt; tls: disabled</div><div class="line">🛰  Mounting <span class="hljs-string">'/'</span>:</div><div class="line">    =&gt; GET /</div><div class="line">🚀  Rocket has launched from http://localhost:8000</div></pre></td></tr></table></figure>
<h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>Rocket provides primitives to build web servers and applications with Rust: the rest is up to you. In short, Rocket provides <strong>routing, pre-processing of requests and psot-processing of response</strong>. Your application code instructs Rocket what to pre-process and post-process and fills the gaps between pre-processing and post-processing.</p>
<h4 id="LifeCycle"><a href="#LifeCycle" class="headerlink" title="LifeCycle"></a>LifeCycle</h4><p>Rocket’s main task is to listen for incoming web prequests, dispatch the request to the application code, and retur a response to the client. We call the process that goes form request to response the ‘lifecycle’. The lifecycle can be summarized as following sequence of steps:</p>
<ul>
<li><p><strong>Routing</strong></p>
<p>Rocket parse an incoming HTTP request into native structure that your code operates on indirectly. Rocket determines which request handler to invoke by matching against route attributes declared in your application.</p>
</li>
<li><p><strong>Validation</strong></p>
<p>Rocket validates the incoming request against types and guards present in the matched route. If validation fails, Rocket <em>forwards</em> the request to the next matching route or calls an <em>error handler</em>.</p>
</li>
<li><p><strong>Processing</strong></p>
<p>The request handler associated with the route is invoked with validated arguments. This is the main business logic of an application. Processing completes by returning a <code>Response</code>.</p>
</li>
<li><p><strong>Response</strong></p>
<p>The returned <code>Response</code> is processed. Rocket generates the appropriate HTTP response and sends it to the client. This completes the lifecycle. Rocket continues listening for requesting, restarting the lifecycle for each incoming request.</p>
</li>
</ul>
<h4 id="Routing"><a href="#Routing" class="headerlink" title="Routing"></a>Routing</h4><p>Rocket applications are centered around routes and handlers. A <em>route</em> is a combination of: </p>
<ul>
<li><p>A set of parameters to match an incoming request against.</p>
</li>
<li><p>A handler to process the request and return a response.</p>
</li>
</ul>
<p>A handler is simply a function that takes an arbirary number of arguments and returns any arbitrary type.</p>
<p>The parameters to match against include static paths, dynamic paths, path segments, forms, query string, request format specifiers and body data. Rocket uses attributes, which look like function decoration in other languages to make declaring routes easy. Routes are declared by annotating a function, the handler, with a set of parameters to match against. A complete route declaration looks like this:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-meta">#[get(<span class="hljs-meta-string">"/world"</span>)]</span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">world</span></span>() -&gt; &amp;<span class="hljs-symbol">'static</span> <span class="hljs-built_in">str</span> &#123;</div><div class="line">  <span class="hljs-string">"Hello World"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This declare the <code>world</code> route to match against the static path <code>/world</code> on incoming <code>GET</code> requests. The <code>world</code> route is simple, but additional route parameters are necessary when building more interesting application.</p>
<h4 id="Mounting"><a href="#Mounting" class="headerlink" title="Mounting"></a>Mounting</h4><p>Before Rocket can dispatch requests to a route, the route needs to be <em>mounted</em>. Mounting a route is like namespacing it. Routes are mounted via the <code>mount</code> method on a <code>Rocket</code> instance. A <code>Rocket</code> instance is typically created with the <code>racket::ignite()</code> static method.</p>
<p>The <code>mount</code> method takes:</p>
<ul>
<li><p>A path to namespace a list of routes under.</p>
</li>
<li><p>A list of route handlers through the <code>routes!</code> macro, typing Rocket’s code generation to your application.</p>
</li>
</ul>
<p>For instance, to mount the <code>world</code> route we declared above, we can write the following:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![world]);</div></pre></td></tr></table></figure>
<p>This create a new <code>Rocket</code> instance via the <code>ignite</code> function and mounts the <code>world</code> route to the <code>/hello</code> path. As a result, <code>GET</code> requests to the <code>/hello/world</code> path will be directed to the <code>world</code> function.</p>
<h4 id="Namespacing"><a href="#Namespacing" class="headerlink" title="Namespacing"></a>Namespacing</h4><p>When a route is declared inside a module other than the root, you may find yourself with unexpected errors when mounting: </p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">mod</span> other &#123;</div><div class="line">  <span class="hljs-meta">#[get(<span class="hljs-meta-string">"/world"</span>)]</span></div><div class="line">  <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">world</span></span>() -&gt; <span class="hljs-built_in">String</span> &#123;</div><div class="line">    <span class="hljs-string">"Hello World"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</div><div class="line">  rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![world]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This occurs because the <code>routes!</code> macro implicitly converts the route’s name into the name of a structure generated by Rocket’s code generation. The solution is to name the route by a module path instead:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![other::world]);</div></pre></td></tr></table></figure>
<h4 id="Launching"><a href="#Launching" class="headerlink" title="Launching"></a>Launching</h4><p>Now that Rocket knows about the route, you can tell Rocket to start accepting requests via the <code>launch</code> method. The method starts up the server and wait for incoming requests. When a request arrives, Rocket finds the matching route and dispatches the requests to the route’s handler.</p>
<p>We typically call <code>launch</code> from the <code>main</code> function. Our complete <em>Hello World</em> application thus looks like:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-meta">#![feature(plugin)]</span></div><div class="line"><span class="hljs-meta">#![plugin(rocket_codegen)]</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> rocket;</div><div class="line"></div><div class="line"><span class="hljs-meta">#[get(<span class="hljs-meta-string">"/world"</span>)]</span></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">world</span></span>() -&gt; <span class="hljs-built_in">String</span> &#123;</div><div class="line">  <span class="hljs-string">"Hello World"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</div><div class="line">  rocket::ignite().mount(<span class="hljs-string">"/hello"</span>, routes![world]).launch();</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-26T03:05:07.000Z">2017-10-26</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 216 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/26/Fastify-Plugin-Guide/">Fastify Plugin Guide</a>
            
        </h1>
        <div class="content">
            <p>In Fastify everything is a plugin, your routes, your utilities and so on are all plugins. And to add a new plugin, whatever its functionality is, in Fastify</p>
<h3 id="Registers"><a href="#Registers" class="headerlink" title="Registers"></a>Registers</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastify.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./my-plugin'</span>, opts, callback))</div></pre></td></tr></table></figure>
<p>Register creates a new Fastify context, this means that if you do any change to the Fastify instance, that change will not be reflected into the context’s ancestors. In other words, encapsulated!</p>
<p>Required Plugins must expose a single function with the following signature:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">instance, opts, next</span>) </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>The Fastify’s plugin module is fully reentrant and graph-based, it handles without any kind of problem asynchronous code and it guarantees the load order of the plugins, even the close order.</p>
<h3 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h3><p>Fastify offers you a way nice and elegant to wrote an utility: decorator.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastify.decorate(<span class="hljs-string">'util'</span>, (a, b) =&gt; a + b)</div></pre></td></tr></table></figure>
<p>Now you can access your utility by doing <code>fastify.util</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fastify.register(<span class="hljs-function">(<span class="hljs-params">instance, opts, next</span>)=&gt;</span> &#123;</div><div class="line">  instance.decorate(<span class="hljs-string">'util'</span>, (a, b) =&gt; a + b)</div><div class="line">  next()</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><p>Execute your utility.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">fastify.register(<span class="hljs-function">(<span class="hljs-params">instance, opts, next</span>) =&gt;</span> &#123;</div><div class="line">  instance.decorate(<span class="hljs-string">'util'</span>, (req, key, value) =&gt; &#123; req.key = value &#125;)</div><div class="line"></div><div class="line">  instance.addHook(<span class="hljs-string">'preHandler'</span>, (req, reply, done) =&gt; &#123;</div><div class="line">    instance.util(req, <span class="hljs-string">'timestamp'</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>())</div><div class="line">    done()</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">  instance.get(<span class="hljs-string">'/plugin1'</span>, (req, reply) =&gt; &#123;</div><div class="line">    reply.send(req)</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">  next()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.get(<span class="hljs-string">'/plugin2'</span>, (req, reply) =&gt; &#123;</div><div class="line">  reply.send(req)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-23T06:50:14.000Z">2017-10-23</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    19 minutes read (About 2782 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/23/Time-to-start-fastify/">Time to Start Fastify</a>
            
        </h1>
        <div class="content">
            <h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><h4 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yarn add fastify</div></pre></td></tr></table></figure>
<h4 id="First-Server"><a href="#First-Server" class="headerlink" title="First Server"></a>First Server</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// Require the framework and instantiate it</span></div><div class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</div><div class="line"></div><div class="line"><span class="hljs-comment">// Declare a route</span></div><div class="line">fastify.get(<span class="hljs-string">'/'</span>, (req, reply) =&gt; &#123;</div><div class="line">  reply.send(&#123;</div><div class="line">    <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="hljs-comment">// Run the server</span></div><div class="line">fastify.listen(<span class="hljs-number">3000</span>, (err) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</div><div class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server is running on <span class="hljs-subst">$&#123;fastify.server.address().port&#125;</span>`</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Schema-Serialization"><a href="#Schema-Serialization" class="headerlink" title="Schema Serialization"></a>Schema Serialization</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> opts = &#123;</div><div class="line">  <span class="hljs-attr">schema</span>: &#123;</div><div class="line">    <span class="hljs-attr">response</span>: &#123;</div><div class="line">      <span class="hljs-number">200</span>: &#123;</div><div class="line">        <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">        <span class="hljs-attr">properties</span>: &#123;</div><div class="line">          <span class="hljs-attr">hello</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-comment">// Declare a route with an output shcema</span></div><div class="line">fastify.get(<span class="hljs-string">'/'</span>, opts, (req, reply) =&gt; &#123;</div><div class="line">  replysend(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.listen(<span class="hljs-number">3000</span>, (err) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</div><div class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server is running on <span class="hljs-subst">$&#123;fastify.server.address().port&#125;</span>`</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Register"><a href="#Register" class="headerlink" title="Register"></a>Register</h4><p>Register routes in seperate files</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// server.js</span></div><div class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</div><div class="line"></div><div class="line">fastify.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./route'</span>))</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> opts = &#123;</div><div class="line">  <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span>,</div><div class="line">  <span class="hljs-attr">something</span>: <span class="hljs-literal">true</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line">fastify.register([</div><div class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./another-route'</span>),</div><div class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./yet-another-route'</span>),</div><div class="line">], opts, (err) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.listen(<span class="hljs-number">3000</span>, (err) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</div><div class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server is running on <span class="hljs-subst">$&#123;fastify.server.address().port&#125;</span>`</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// route.js</span></div><div class="line"><span class="hljs-built_in">module</span>.exports = (fastify, options, next) &#123;</div><div class="line">  fastify.get(<span class="hljs-string">'/'</span>, (req, reply) =&gt; &#123;</div><div class="line">    replysend(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</div><div class="line">  &#125;)</div><div class="line">  next()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>or <code>async/await</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> (fastify, options) =&gt; &#123;</div><div class="line">  fastify.get(<span class="hljs-string">'/'</span>, (req, reply) =&gt; &#123;</div><div class="line">    replysend(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Server-Methods"><a href="#Server-Methods" class="headerlink" title="Server Methods"></a>Server Methods</h3><h4 id="server"><a href="#server" class="headerlink" title="server"></a>server</h4><p><code>fastify.server</code>: The Node Core <code>server</code> object.</p>
<h4 id="ready"><a href="#ready" class="headerlink" title="ready"></a>ready</h4><p>Function  called when all the plugins has been loaded. It takes an error parameter if something went wrong.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastify.ready(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123; <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err &#125;)</div></pre></td></tr></table></figure>
<h4 id="listen"><a href="#listen" class="headerlink" title="listen"></a>listen</h4><p>Starts the server on the given port after all the plugins loaded, internally waits for the <code>.ready()</code> event. The callback is the same as the Node Core.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastify.listen(<span class="hljs-number">3000</span>, err =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Specifying an address is also supported:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastify.listen(<span class="hljs-number">3000</span>, <span class="hljs-string">'127.0.0.1'</span>, err =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="route"><a href="#route" class="headerlink" title="route"></a>route</h4><p>Method to add routes to the server, it also have shorthands.</p>
<h4 id="routes-iterator"><a href="#routes-iterator" class="headerlink" title="routes iterator"></a>routes iterator</h4><p>The fastify instance is an Iterable object with all the registered routes. The route properties are the same the developer has declared.</p>
<h4 id="close"><a href="#close" class="headerlink" title="close"></a>close</h4><p><code>fastify.close(callback)</code>, call this function to close the server instance and run the <code>onClose</code> hook.</p>
<h4 id="decorate"><a href="#decorate" class="headerlink" title="decorate*"></a>decorate*</h4><p>Function useful if you need to decorate the fastify instance, Reply or Request.</p>
<h4 id="register"><a href="#register" class="headerlink" title="register"></a>register</h4><p>Fastify allows the user to extends its functionalities with plugins. A plugin can be a set of routes, a server decorator or whatever.</p>
<h4 id="use"><a href="#use" class="headerlink" title="use"></a>use</h4><p>Function to add middlewares to Fastify.</p>
<h4 id="addHook"><a href="#addHook" class="headerlink" title="addHook"></a>addHook</h4><p>Function to add a specific hook in the lifecycle of Fastify.</p>
<h4 id="logger"><a href="#logger" class="headerlink" title="logger"></a>logger</h4><p>The logger instance.</p>
<h4 id="Inject"><a href="#Inject" class="headerlink" title="Inject"></a>Inject</h4><p>Fake http injection(for testing purpose).</p>
<h4 id="setSchemaCompiler"><a href="#setSchemaCompiler" class="headerlink" title="setSchemaCompiler"></a>setSchemaCompiler</h4><p>Set the schema compiler for all routes.</p>
<h4 id="setNotFoundHandler"><a href="#setNotFoundHandler" class="headerlink" title="setNotFoundHandler"></a>setNotFoundHandler</h4><p><code>fastify.setNotFoundHandler(handler(req, reply))</code>: set the 404 handler. This call is fully encapsulated, so different plugins can set different not found handlers.</p>
<h4 id="setErrorHandler"><a href="#setErrorHandler" class="headerlink" title="setErrorHandler"></a>setErrorHandler</h4><p><code>fastify.setErrorHandler(handler(err, reply))</code>: set a function that will be called whenever an error happens. The handler is fully encapsulated, so different plugins can set different error handlers.</p>
<h3 id="Routes"><a href="#Routes" class="headerlink" title="Routes"></a>Routes</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastify.route(options)</div></pre></td></tr></table></figure>
<ul>
<li><p><code>method</code>: currently it supports <code>DELETE</code>, <code>GET</code>, <code>HEAD</code>, <code>PATCH</code>, <code>POST</code>, <code>PUT</code>, and <code>OPTIONS</code>, it could be an array of methods.</p>
</li>
<li><p><code>url</code>: the path of the url to match this route (alias: <code>path</code>)</p>
</li>
<li><p><code>schema</code>: an object containing the schemas for the request and response. They need to be in <code>JSON Schema</code> format.</p>
<ul>
<li><p><code>body</code>: validates the body of the request if it is a POST or PUT.</p>
</li>
<li><p><code>querystring</code>: validates the querystring. This can be a complete JSON Schema Object, with the property <code>type</code> of <code>object</code> and <code>properties</code> object of parameters, or simply the values of what would be contained in the properties object as shown below.</p>
</li>
<li><p><code>params</code>: validates the params.</p>
</li>
<li><p><code>response</code>: fitler and generate a schema for the response, setting a schema allows us to have 10-20% more throughput.</p>
</li>
</ul>
</li>
<li><p><code>beforeHandler(req, res, done)</code>: a function called just before the request handler, useful if you need to perform authentication at route level for example, it could also be and array of functions.</p>
</li>
<li><p><code>handler(req, reply)</code>: the function that will handle this request.</p>
</li>
<li><p><code>request</code> if defined in <code>Request</code>.</p>
</li>
<li><p><code>reply</code> is defined in <code>Reply</code>.</p>
</li>
</ul>
<p>Exmaple</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">fastify.route(&#123;</div><div class="line">  <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,</div><div class="line">  <span class="hljs-attr">url</span>: <span class="hljs-string">'/'</span>,</div><div class="line">  <span class="hljs-attr">schema</span>: &#123;</div><div class="line">    <span class="hljs-attr">querystring</span>: &#123;</div><div class="line">      <span class="hljs-attr">name</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</div><div class="line">      <span class="hljs-attr">excitement</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'integer'</span> &#125;,</div><div class="line">    &#125;,</div><div class="line">    <span class="hljs-attr">response</span>: &#123;</div><div class="line">      <span class="hljs-number">200</span>: &#123;</div><div class="line">        <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">        <span class="hljs-attr">properties</span>: &#123;</div><div class="line">          <span class="hljs-attr">hello</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">handler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, reply</span>) </span>&#123;</div><div class="line">    reply.send(&#123;</div><div class="line">      <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span>,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.route(&#123;</div><div class="line">  <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,</div><div class="line">  <span class="hljs-attr">url</span>: <span class="hljs-string">'/'</span>,</div><div class="line">  <span class="hljs-attr">schema</span>: &#123;<span class="hljs-comment">/*..*/</span>&#125;,</div><div class="line">  <span class="hljs-attr">beforeHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, reply, done</span>) </span>&#123;</div><div class="line">    <span class="hljs-comment">// auth</span></div><div class="line">    done()</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">handler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, reply</span>) </span>&#123;</div><div class="line">    reply.send(&#123;</div><div class="line">      <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span>,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="ShortHands"><a href="#ShortHands" class="headerlink" title="ShortHands"></a>ShortHands</h4><p><code>fastify.method(path, [options], handler)</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> opts = &#123;</div><div class="line">  <span class="hljs-attr">schema</span>: &#123;</div><div class="line">    <span class="hljs-attr">response</span>: &#123;</div><div class="line">      <span class="hljs-number">200</span>: &#123;</div><div class="line">        <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">        <span class="hljs-attr">properites</span>: &#123;</div><div class="line">          <span class="hljs-attr">hello</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">fastify.get(<span class="hljs-string">'/'</span>, opts, (req, reply) =&gt; &#123;</div><div class="line">  reply.send(&#123;</div><div class="line">    <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p><code>fastify.all(path, [options], handler)</code> will add the same handler to all the supported methods.</p>
<h4 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fastify.get(<span class="hljs-string">'/'</span>, options, <span class="hljs-keyword">async</span> (req, reply) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">var</span> data = <span class="hljs-keyword">await</span> getData()</div><div class="line">  <span class="hljs-keyword">var</span> processed = <span class="hljs-keyword">await</span> processData(data)</div><div class="line">  <span class="hljs-keyword">return</span> processed</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Route-Prefixing"><a href="#Route-Prefixing" class="headerlink" title="Route Prefixing"></a>Route Prefixing</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// server.js</span></div><div class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)()</div><div class="line"></div><div class="line">fastify.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./routes/v1/users'</span>), &#123;</div><div class="line">  <span class="hljs-attr">prefix</span>: <span class="hljs-string">'/v1'</span>,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="hljs-comment">// routes/v1/users</span></div><div class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">fastify, opts, next</span>) </span>&#123;</div><div class="line">  fastify.get(<span class="hljs-string">'/user'</span>, handler_v1)</div><div class="line">  next()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now your client can access to <code>/v1/user</code>.</p>
<p>Be aware that if you use <code>fastify-plugin</code> this option won’t work.</p>
<h3 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h3><p>Logging is disabled by default, and you can enable it by passing <code>{ logger: true }</code> or <code>{ logger: { level: &#39;info&#39; } }</code> when you create the fastify instance.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> fastify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify'</span>)(&#123;</div><div class="line">  <span class="hljs-attr">logger</span>: <span class="hljs-literal">true</span>,</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.get(<span class="hljs-string">'/'</span>, options, (req, reply) =&gt; &#123;</div><div class="line">  req.log.info(<span class="hljs-string">'Some info about the current request'</span>)</div><div class="line">  reply.send(&#123;</div><div class="line">    <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Middlewares"><a href="#Middlewares" class="headerlink" title="Middlewares"></a>Middlewares</h3><p>Fastify provides out of the box an asynchronous middleare engine compatible with Express and Restify middlewares.</p>
<p>Fastify middleware don’t support the full syntax <code>middleware(err, req, res, next)</code> because error handling is done inside Fastify.</p>
<p>Also if you are using a middleware taht bundles different, smaller middlewares such as helmet, we recommand to use the single module to get better performances.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)())</div><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'dns-prefetch-control'</span>)())</div><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'frameguard'</span>)())</div><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'hide-powered-by'</span>)())</div><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'hsts'</span>)())</div><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'ienoopen'</span>)())</div><div class="line">fastify.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'x-xss-protection'</span>)())</div></pre></td></tr></table></figure>
<p>If you need to run a middleware only under certain path, just pass the path as first parameter to <code>use</code> and you are done.</p>
<p>Note that this does not support routes with parameters, (eg: <code>/users/:id/comments</code>) and wildcard is not supported in multiple paths.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> serveStatic = <span class="hljs-built_in">require</span>(<span class="hljs-string">'serve-static'</span>)</div><div class="line"></div><div class="line"><span class="hljs-comment">// single path</span></div><div class="line">fastify.use(<span class="hljs-string">'/css'</span>, servveStatic(<span class="hljs-string">'/asserts'</span>))</div><div class="line"><span class="hljs-comment">// wildcard path</span></div><div class="line">fastify.use(<span class="hljs-string">'/css/*'</span>, servveStatic(<span class="hljs-string">'/asserts'</span>))</div><div class="line"><span class="hljs-comment">// multiple paths</span></div><div class="line">fastify.use([<span class="hljs-string">'/css'</span>, <span class="hljs-string">'/js'</span>], servveStatic(<span class="hljs-string">'/asserts'</span>))</div></pre></td></tr></table></figure>
<h3 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h3><p>By using the hook you can interact directly inside the lifecycle of Fastify, there are three different Hooks that you can use(in order of execution):</p>
<ul>
<li><p><code>onRequest</code></p>
</li>
<li><p><code>preHandler</code></p>
</li>
<li><p><code>onResponse</code></p>
</li>
<li><p><code>onClose</code></p>
</li>
</ul>
<p>Example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">fastify.addHook(<span class="hljs-string">'onRequest'</span>, (req, res, next) =&gt; &#123;</div><div class="line">  <span class="hljs-comment">// some code</span></div><div class="line">  next()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.addHook(<span class="hljs-string">'preHandler'</span>, (req, res, next) =&gt; &#123;</div><div class="line">  <span class="hljs-comment">// some code</span></div><div class="line">  next()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.addHook(<span class="hljs-string">'onResponse'</span>, (res, next) =&gt; &#123;</div><div class="line">  <span class="hljs-comment">// some code</span></div><div class="line">  next()</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>If you want to pass a custom error code to the user, just use the <code>reply.code()</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fastify.addHook(<span class="hljs-string">'onRequest'</span>, (req, res, next) =&gt; &#123;</div><div class="line">  <span class="hljs-comment">// some code</span></div><div class="line">  reply.code(<span class="hljs-number">400</span>)</div><div class="line">  next(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'some error'</span>))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>The error will be handled by <code>Reply</code></p>
<p>The unique hook that is not inside the lifecycle is <code>&#39;onClose&#39;</code>, this one is triggered when you call <code>fastify.close()</code> to stop the server, and it is useful if you have some plugins that need a ‘shutdown’ part, such as a connection to database.</p>
<p>Only for this hook the parameters of the functions changes.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fastify.addHook(<span class="hljs-string">'onClose'</span>, (instance, done) =&gt; &#123;</div><div class="line">  <span class="hljs-comment">// some code</span></div><div class="line">  done()</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h4><p>Except for <code>onClose</code> all the hooks are encapsulated this means that you can decide where your hooks should run by using <code>register</code>.</p>
<h4 id="beforeHandler"><a href="#beforeHandler" class="headerlink" title="beforeHandler"></a>beforeHandler</h4><p><code>beforeHandler</code> is not a standard hook like <code>preHandler</code>, but is a function that your register right in the route option that will be executed only in the specified route.</p>
<p><code>beforeHandler</code> is executed always after the <code>preHandler</code> hook.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">fastify.addHook(<span class="hljs-string">'preHander'</span>, (req, reply, done) =&gt; &#123;</div><div class="line">  <span class="hljs-comment">//  your code</span></div><div class="line">  done()</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.route(&#123;</div><div class="line">  <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,</div><div class="line">  <span class="hljs-attr">url</span>: <span class="hljs-string">'/'</span>,</div><div class="line">  <span class="hljs-attr">schema</span>: &#123;<span class="hljs-comment">/*...*/</span>&#125;,</div><div class="line">  <span class="hljs-attr">beforeHandler</span>: <span class="hljs-function">(<span class="hljs-params">req, reply, done</span>) =&gt;</span> &#123;<span class="hljs-comment">/*...*/</span> ;done()&#125;</div><div class="line">  handler: <span class="hljs-function">(<span class="hljs-params">req, reply</span>) =&gt;</span> &#123; reply.send(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;) &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.route(&#123;</div><div class="line">  <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,</div><div class="line">  <span class="hljs-attr">url</span>: <span class="hljs-string">'/'</span>,</div><div class="line">  <span class="hljs-attr">shcema</span>: &#123;<span class="hljs-comment">/*...*/</span>&#125;,</div><div class="line">  <span class="hljs-attr">beforeHandler</span>: [</div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">first</span> (<span class="hljs-params">req, reply, done</span>) </span>&#123;</div><div class="line">      done()</div><div class="line">    &#125;,</div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">second</span> (<span class="hljs-params">req, reply, done</span>) </span>&#123;</div><div class="line">      done()</div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  <span class="hljs-attr">handler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, reply</span>) </span>&#123;</div><div class="line">    reply.send(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h3><p>If you need to add functionalities to the Fastify instance, the <code>decorator</code> api is what you need.</p>
<p>This api allows you to add new properties to the Fastify instance, a property value is not restricted to be a function, could also be an object or a string for example.</p>
<h4 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h4><h5 id="decorate-1"><a href="#decorate-1" class="headerlink" title="decorate"></a>decorate</h5><p>Just call the <code>decorate</code> api and pass the name of the new property and its value.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastify.decorate(<span class="hljs-string">'utility'</span>, () =&gt; &#123;</div><div class="line">  <span class="hljs-comment">// something very useful</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>As said above, you can decorate the instance with other values and not only functions:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fastify.decorate(<span class="hljs-string">'conf'</span>, &#123;</div><div class="line">  <span class="hljs-attr">db</span>: <span class="hljs-string">'some db'</span>,</div><div class="line">  <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Once you decorate the instance you can access the value every time you need by using the name you passed as parameter:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fastify.utility()</div><div class="line"><span class="hljs-built_in">console</span>.log(fastify.conf.db)</div></pre></td></tr></table></figure>
<p>Decorators are not <em>overwritable</em>, if you try to declare a decorator already declared, <code>decorate</code> will throw an exception.</p>
<h5 id="decorateReply"><a href="#decorateReply" class="headerlink" title="decorateReply"></a>decorateReply</h5><p>As the name suggest, this api is needed if you want to add new methods to the <code>Reply</code> core object. Just call the <code>decorateReply</code> api and pass the name of the new property and its value.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastify.decorateReply(<span class="hljs-string">'utility'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</div><div class="line">  <span class="hljs-comment">// something very useful</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Note: using an arrow function will break the binding of <code>this</code> to the Fastify <code>reply</code> instance.</p>
<h5 id="decorateRequest"><a href="#decorateRequest" class="headerlink" title="decorateRequest"></a>decorateRequest</h5><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastify.decorateRequest(<span class="hljs-string">'utility'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</div><div class="line">  <span class="hljs-comment">// something very useful</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Note: using an arrow function will break the binding of <code>this</code> to the Fastify <code>request</code> instance.</p>
<h5 id="extendServerError"><a href="#extendServerError" class="headerlink" title="extendServerError"></a>extendServerError</h5><p>If you need to extend the standard <code>server error</code>, this api is what you need.</p>
<p>You must pass a function that returns an Object, Fastify will extend the server error with the returned object of your function. The function will receive the original error object.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">fastify.extendServerError(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">return</span> &#123;</div><div class="line">    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="hljs-comment">/*</span></div><div class="line">  The resulting object will be: &#123;</div><div class="line">    error: string,</div><div class="line">    message: string,</div><div class="line">    statusCode: number,</div><div class="line">    timestamp: date,</div><div class="line">  &#125;</div><div class="line">*/</div></pre></td></tr></table></figure>
<h4 id="Sync-and-Async"><a href="#Sync-and-Async" class="headerlink" title="Sync and Async"></a>Sync and Async</h4><p><code>decorate</code> is synchronous API, if you need to add a decorator that has an asynchronous bootstrap, could happen that Fastify boots up before your decorator is ready. To avoid this issue you must use <code>register</code> api in combination with <code>fastify-plugin</code>.</p>
<h4 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h4><p>If your decorator depends on another decorator, you can declare the dependencies of your function, it’s pretty easy, you just need to add an array of strings(representing the names of the decorators your are depending on) as third parameter.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastify.decorate(<span class="hljs-string">'utility'</span>, fn, [<span class="hljs-string">'greet'</span>, <span class="hljs-string">'log'</span>])</div></pre></td></tr></table></figure>
<p>If a dependency is not satisfied, <code>decorate</code> will throw an exception.</p>
<h4 id="hasDecorator"><a href="#hasDecorator" class="headerlink" title="hasDecorator"></a>hasDecorator</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastify.hasDecorator(<span class="hljs-string">'utility'</span>)</div></pre></td></tr></table></figure>
<h3 id="Validation-and-Serialize"><a href="#Validation-and-Serialize" class="headerlink" title="Validation and Serialize"></a>Validation and Serialize</h3><p>Fastify uses a schema based approach and even if it is not mandatory we recommend to use JSON Schema to validate you routes and serialize your output, internally Fastify compiles the schema in a highly performance function.</p>
<h4 id="Validation"><a href="#Validation" class="headerlink" title="Validation"></a>Validation</h4><p>The route validation internally uses <code>Ajv</code>, which is highly performant JSON validator. Validate the input is very easy, just add the fields that you need inside the route schema and you are done.</p>
<p>The supported validations are</p>
<ul>
<li><p>body: Validates the body of the request if it is a POST or PUT</p>
</li>
<li><p>querystring: Validates the querystring. This can be a complete JSON Schema object, with the property type of object and properties object of parameters, or simply the values of what would be contained in the properties object as shown below.</p>
</li>
<li><p>params: Validates teh route params.</p>
</li>
<li><p>headers: Validates teh request headers.</p>
</li>
</ul>
<p>Example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> schema = &#123;</div><div class="line">  <span class="hljs-attr">body</span>: &#123;</div><div class="line">    <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">    <span class="hljs-attr">properties</span>: &#123;</div><div class="line">      <span class="hljs-attr">someKey</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>&#125;,</div><div class="line">      <span class="hljs-attr">someOtherKey</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span> &#125;,</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">querystring</span>: &#123;</div><div class="line">    <span class="hljs-attr">name</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</div><div class="line">    <span class="hljs-attr">excitement</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'integer'</span> &#125;,</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">params</span>: &#123;</div><div class="line">    <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">    <span class="hljs-attr">properties</span>: &#123;</div><div class="line">      <span class="hljs-attr">par1</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</div><div class="line">      <span class="hljs-attr">par2</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span> &#125;,</div><div class="line">    &#125;,</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">headers</span>: &#123;</div><div class="line">    <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">    <span class="hljs-attr">properties</span>: &#123;</div><div class="line">      <span class="hljs-string">'x-foo'</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</div><div class="line">    &#125;,</div><div class="line">    <span class="hljs-attr">required</span>: [<span class="hljs-string">'x-foo'</span>],</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Schema-Compiler"><a href="#Schema-Compiler" class="headerlink" title="Schema Compiler"></a>Schema Compiler</h4><p>The <code>schemaCompiler</code> is a function that returns a function that validates the body, url parameters, headers and query string.</p>
<p>The default <code>schemaCompiler</code> returns a function that implements the <code>ajv</code> validation interface. <code>fastify</code> use it internally to speed the valiation up.</p>
<h4 id="Serialize"><a href="#Serialize" class="headerlink" title="Serialize"></a>Serialize</h4><p>Usually you will send your data to the clients via JSON, and Fastify has a powerful tools to help you: <code>fast-json-stringify</code>, which is used if you have provided an output schema in the route options.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> schema = &#123;</div><div class="line">  <span class="hljs-attr">response</span>: &#123;</div><div class="line">    <span class="hljs-number">200</span>: &#123;</div><div class="line">      <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">      <span class="hljs-attr">properties</span>: &#123;</div><div class="line">        <span class="hljs-attr">value</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</div><div class="line">        <span class="hljs-attr">otherValue</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span> &#125;,</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>As you can see the response schema is based on the status code, if you want to use the same schema for mutliple status code, you can use <code>2xx</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> schema = &#123;</div><div class="line">  <span class="hljs-attr">response</span>: &#123;</div><div class="line">    <span class="hljs-string">'2xx'</span>: &#123;</div><div class="line">      <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">      <span class="hljs-attr">properties</span>: &#123;</div><div class="line">        <span class="hljs-attr">value</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;,</div><div class="line">        <span class="hljs-attr">otherValue</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span> &#125;,</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="hljs-number">201</span>: &#123;</div><div class="line">      <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,</div><div class="line">      <span class="hljs-attr">properties</span>: &#123;</div><div class="line">        <span class="hljs-attr">value</span>: &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span> &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h3><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">Incoming Request</div><div class="line">  │</div><div class="line">  └─▶ Instance Logger</div><div class="line">        │</div><div class="line">        └─▶ Routing</div><div class="line">             │</div><div class="line">       404 ◀─┴─▶ onRequest Hook</div><div class="line">                  │</div><div class="line">        4**/5** ◀─┴─▶ run Middlewares</div><div class="line">                        │</div><div class="line">              4**/5** ◀─┴─▶ Parsing</div><div class="line">                             │</div><div class="line">                       415 ◀─┴─▶ Validation</div><div class="line">                                   │</div><div class="line">                             400 ◀─┴─▶ preHandler Hook</div><div class="line">                                         │</div><div class="line">                               4**/5** ◀─┴─▶ beforeHandler</div><div class="line">                                               │</div><div class="line">                                     4**/5** ◀─┴─▶ User Handler</div><div class="line">                                                     │</div><div class="line">                                                     └─▶ Reply</div><div class="line">                                                          │ │</div><div class="line">                                                          │ └─▶ Outgoing Response</div><div class="line">                                                          │</div><div class="line">                                                          └─▶ onResponse Hook</div></pre></td></tr></table></figure>
<h3 id="Reply"><a href="#Reply" class="headerlink" title="Reply"></a>Reply</h3><p>The second parameter of the handler function is <code>Reply</code>.</p>
<p>Reply is a core Fastify object that exposes the following functions:</p>
<ul>
<li><p>.code(statusCode)</p>
</li>
<li><p>.header(name, value)</p>
</li>
<li><p>.type(value): Set the header <code>Content-Type</code></p>
</li>
<li><p>.redirect([code, ] url): default code 302</p>
</li>
<li><p>.serializer(function): Set a custom serializer for the payload</p>
</li>
<li><p>.send(payload)</p>
</li>
<li><p>.sent: A boolean value that you can use if you need to know it <code>send</code> has already been called.</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">fastify.get(<span class="hljs-string">'/'</span>, options, (request, reply) =&gt; &#123;</div><div class="line">  reply</div><div class="line">    .code(<span class="hljs-number">200</span>)</div><div class="line">    .type(<span class="hljs-string">'application/json'</span>)</div><div class="line">    .send(&#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><p>If not set via <code>reply.code</code>, the resulting <code>statusCode</code> will be <code>200</code></p>
<h4 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h4><p>Sets a custom header to the response.</p>
<p>If you not set a <code>Content-Type</code> header, Fastify assumes that you are using <code>application/json</code>, unless you are send a stream, in that case Fastify recognize it and sets the <code>Content-Type</code> at <code>application/octet-stream</code>.</p>
<h4 id="Redirect"><a href="#Redirect" class="headerlink" title="Redirect"></a>Redirect</h4><p>Redirects a request to the specified url, the status code is optional, default to <code>302</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reply.redirect(<span class="hljs-string">'/home'</span>)</div></pre></td></tr></table></figure>
<h4 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h4><p>Sets the content type for the response.</p>
<p>It’s the shortcut for <code>reply.header(&#39;Content-Type&#39;, &#39;application/json&#39;)</code></p>
<h4 id="Serializer"><a href="#Serializer" class="headerlink" title="Serializer"></a>Serializer</h4><h4 id="Send"><a href="#Send" class="headerlink" title="Send"></a>Send</h4><h4 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h4><p>If you are sending JSON Objects, send will serialize the object with <code>fast-json-stringify</code> if you setted an output schema, otherwise <code>fast-safe-stringify</code></p>
<h4 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h4><p>Send handle natively the promsies and supports out of the box async-await:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">fastify.get(<span class="hljs-string">'/promises'</span>, options, (req, reply) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> Prmise(<span class="hljs-comment">/*...*/</span>)</div><div class="line">  reply</div><div class="line">    .code(<span class="hljs-number">200</span>)</div><div class="line">    .send(promise)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">fastify.get(<span class="hljs-string">'/async-await'</span>, options, <span class="hljs-keyword">async</span> (req, reply) =&gt; &#123;</div><div class="line">  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</div><div class="line">    setTimeout(resolve, <span class="hljs-number">200</span>, &#123; <span class="hljs-attr">hello</span>: <span class="hljs-string">'world'</span> &#125;)</div><div class="line">  &#125;)</div><div class="line">  <span class="hljs-keyword">return</span> res</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h4><p>Send can also handle streams out of box, internally uses <code>pump</code> to avoid leaks of file description. If you are sneding a stream and you have not setted a <code>Content-Type</code> header, send will set it at <code>application/octet-stream</code>.</p>
<h4 id="Errors"><a href="#Errors" class="headerlink" title="Errors"></a>Errors</h4><p>If you pass to send an object that is an instance of Error, Fastify will automatically create error structured as the following:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="hljs-attr">error</span>: string, <span class="hljs-comment">// the http error message</span></div><div class="line">  message: string, <span class="hljs-comment">// the user error message</span></div><div class="line">  statusCode: number, <span class="hljs-comment">// the http status code</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h3><p>The first parameter of the handler function is <code>Request</code>.</p>
<p>Request is a core Fastify object containing the following fields: </p>
<ul>
<li><p>query</p>
</li>
<li><p>body</p>
</li>
<li><p>params: the params matching the URL</p>
</li>
<li><p>headers</p>
</li>
<li><p>req: the incoming HTTP request from Node core</p>
</li>
<li><p>log</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fastify.post(<span class="hljs-string">'/:params'</span>, options, (req, reply) =&gt; &#123;</div><div class="line">  <span class="hljs-built_in">console</span>.log(request.body)</div><div class="line">  <span class="hljs-built_in">console</span>.log(request.query)</div><div class="line">  <span class="hljs-built_in">console</span>.log(request.params)</div><div class="line">  <span class="hljs-built_in">console</span>.log(request.headers)</div><div class="line">  <span class="hljs-built_in">console</span>.log(request.req)</div><div class="line">  request.log.info(<span class="hljs-string">'some info'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Content-Type-Parser"><a href="#Content-Type-Parser" class="headerlink" title="Content Type Parser"></a>Content Type Parser</h3><p>Natively Fastify supports only <code>application/json</code> content-type. If you need to support different content types you can use the <code>addContentTypeParser</code> api.</p>
<h4 id="Catch-All"><a href="#Catch-All" class="headerlink" title="Catch All"></a>Catch All</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fastify.addContentTypeParser(<span class="hljs-string">'*'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, done</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">var</span> data = <span class="hljs-string">''</span></div><div class="line">  req.on(<span class="hljs-string">'data'</span>, chunk =&gt; &#123;data += chunk&#125;)</div><div class="line">  req.on(<span class="hljs-string">'end'</span>, () =&gt; done(data))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h3><p>Fastify allows the user to extend its functionalities with plugins. A plugin can be a set of routes, a server decorator or whatever.</p>
<p>The API you will need for one or more plugins is <code>register</code>.</p>
<p>By default, <code>register</code> creates a <strong>new scope</strong>, this means that if you do some changes to the Fastify instance(via decorate), this change will not be reflected to the current context ancestors, but only to its sons.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">fastify.register(plugin, [options])</div><div class="line"></div><div class="line">fastify.register([</div><div class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./another-route'</span>),</div><div class="line">  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./yet-another-route'</span>),</div><div class="line">], opts)</div></pre></td></tr></table></figure>
<h3 id="Craete-a-Plugin"><a href="#Craete-a-Plugin" class="headerlink" title="Craete a Plugin"></a>Craete a Plugin</h3><p>Create a plugin is very easy, you just need to create a function that takes three paremters, the <code>fastify</code> instance, an options object and the next callback.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">fastify, opts, next</span>) =&gt;</span> &#123;</div><div class="line">  fastify.decorate(<span class="hljs-string">'utility'</span>, () =&gt; &#123;&#125;)</div><div class="line">  fastify.get(<span class="hljs-string">'/'</span>, handler)</div><div class="line">  next()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Handle-the-Scope"><a href="#Handle-the-Scope" class="headerlink" title="Handle the Scope"></a>Handle the Scope</h4><p>You have two ways to tell Fastify to avoid the creation of a new context:</p>
<ul>
<li><p>Use the <code>fastify-plugin</code> module</p>
</li>
<li><p>Use the <code>skip-override</code> hidden property</p>
</li>
</ul>
<p>We recomended to use the <code>fastify-plugin</code> module, because it solves this problem for you, and you can pass as parameter a version range of Fastify taht your plguin support.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> fp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fastify-plguin'</span>)</div><div class="line"></div><div class="line"><span class="hljs-built_in">module</span>.exports = fp(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fastify, opts, next</span>) </span>&#123;</div><div class="line">  fastify.decorate(<span class="hljs-string">'utility'</span>, () =&gt; &#123;&#125;)</div><div class="line">  next()</div><div class="line">&#125;, <span class="hljs-string">'0.x'</span>)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-03T14:04:53.000Z">2017-10-03</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 386 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/03/Apollo-with-TypeScript/">Apollo With TypeScript</a>
            
        </h1>
        <div class="content">
            <p><a href="https://dev-blog.apollodata.com/getting-started-with-typescript-and-apollo-a9aa2c7dcf87" target="_blank" rel="noopener">Original</a></p>
<p>Start with a simple React Component wrapped with the <code>graphql</code> higher order component from React Apollo.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">import React from 'react'</div><div class="line">import gql from 'graphql-tag'</div><div class="line">import &#123; graphql &#125; from 'react-apollo'</div><div class="line"></div><div class="line">export const HERO_QUERY = gql`</div><div class="line">  query GetCharacter($episode: Episodi!) &#123;</div><div class="line">    hero(episode: $episode) &#123;</div><div class="line">      name</div><div class="line">      id</div><div class="line">      friends &#123;</div><div class="line">        name</div><div class="line">        id</div><div class="line">        appearsIn</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">`</div><div class="line"></div><div class="line">export const withCharacter = graphql(HERO_QUER, &#123;</div><div class="line">  options: () =&gt; (&#123;</div><div class="line">    variables: &#123; episode: 'JEDI' &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">export const withCharacter((&#123; data: &#123; loading, hero, error &#125;&#125;) =&gt; &#123;</div><div class="line">  if (loading) &#123;</div><div class="line">    return &lt;div&gt;Loading&lt;/div&gt;</div><div class="line">  &#125;</div><div class="line">  if (error) &#123;</div><div class="line">    return &lt;div&gt;Error&lt;/div&gt;</div><div class="line">  &#125;</div><div class="line">  return (</div><div class="line">    &lt;div&gt;</div><div class="line">      &#123;hero &amp;&amp;</div><div class="line">        &lt;div&gt;</div><div class="line">          &lt;h3&gt;&#123;hero.name&#125;&lt;/h3&gt;</div><div class="line">          &#123;hero.friends.map(friend =&gt; &lt;h6 key=&#123;friend.i&#125;&gt;&#123;friend.name&#125;&lt;/h6&gt;&#125;&gt;&lt;/h6&gt;)&#125;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &#125;</div><div class="line">    &lt;/div&gt;</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>The above code pulls some data from a GraphQL API using a query and includes lifecycle information, such as loading and error information.</p>
<p>With a few minor changes, we can tell TypeScript how to support us in writing code within this render function.</p>
<ul>
<li>We need to tell TS what the shape of our data from our graphql server will look like. We manually write the types for our response data.</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">export</span> type Hero &#123;</div><div class="line">  <span class="hljs-attr">name</span>: string</div><div class="line">  id: string</div><div class="line">  appearsIn: string[]</div><div class="line">  friends: Hero[]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> type Response &#123;</div><div class="line">  <span class="hljs-attr">hero</span>: Hero</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> withCharacter = graphql&lt;Response&gt;(HERO_QUERY, &#123;</div><div class="line">  <span class="hljs-attr">options</span>: <span class="hljs-function">(<span class="hljs-params">&#123;episode&#125;</span>) =&gt;</span> (&#123;</div><div class="line">    <span class="hljs-attr">variables</span>: &#123; episode &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>The last line is where the magic happens. We tell TS what the shape of the result will look like from the server when the graphql enhancer wraps a component.</li>
</ul>
<p>If you already had your project set up with TS, and have already typed your response data, all you have to do is add the type to the <code>graphql</code> HOC and you are off!</p>
<h3 id="Take-Control-of-Your-Tree"><a href="#Take-Control-of-Your-Tree" class="headerlink" title="Take Control of Your Tree"></a>Take Control of Your Tree</h3><p>Wrapped components are almost always exported and used by a component somewhere else in your tree, so if your exported component has prop requirements, we need to tell TS so it can help prevent errors elsewhere in our tree. Since the <code>graphql</code> wrapper suppors polymorphic types, we can use the second type parameter of it to do just that.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">export</span> type InputProps = &#123;</div><div class="line">  <span class="hljs-attr">episode</span>: string</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> withCharacter = graphql&lt;Response, InputProps&gt;(HERO_QUERY, &#123;</div><div class="line">  <span class="hljs-attr">options</span>: <span class="hljs-function">(<span class="hljs-params">&#123; episode &#125;</span>) =&gt;</span> (&#123;</div><div class="line">    <span class="hljs-attr">variables</span>: &#123; episode &#125;,</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Then the code looks like:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></div><div class="line"><span class="hljs-keyword">import</span> ApolloClient, &#123; createNetworkInterface &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'apollo-client'</span></div><div class="line"><span class="hljs-keyword">import</span> &#123; ApolloProvider &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-apollo'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> Character <span class="hljs-keyword">from</span> <span class="hljs-string">'./Character'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> networkInterface = createNetworkInterface(&#123;</div><div class="line">  <span class="hljs-attr">uri</span>: <span class="hljs-string">'https://mpjk0plp9.lp.gql,zone/graphql'</span>,</div><div class="line">&#125;)</div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> ApolloClient(&#123;</div><div class="line">  networkInterface,</div><div class="line">&#125;)</div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> () =&gt; (</div><div class="line">  <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ApolloProvider</span> <span class="hljs-attr">client</span>=<span class="hljs-string">&#123;client&#125;</span>&gt;</span></span></div><div class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">Character</span> /&gt;</span></div><div class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">ApolloProvider</span>&gt;</span></div><div class="line">)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-30T02:12:20.000Z">2017-09-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 230 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/30/source-code-of-koa-static/">Source Code of Koa-Static</a>
            
        </h1>
        <div class="content">
            <h3 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="hljs-comment">/**</span></div><div class="line"> * Module Dependencies</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> debug = <span class="hljs-built_in">require</span>(<span class="hljs-string">'debug'</span>)(<span class="hljs-string">'koa-static'</span>)</div><div class="line"><span class="hljs-keyword">const</span> &#123; resolve &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</div><div class="line"><span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">'assert'</span>)</div><div class="line"><span class="hljs-keyword">const</span> send = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-send'</span>)</div><div class="line"></div><div class="line"><span class="hljs-comment">/**</span></div><div class="line"> * Expose `serve()`</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="hljs-built_in">module</span>.exports = serve</div><div class="line"></div><div class="line"><span class="hljs-comment">/**</span></div><div class="line"> * Serve static files from `root`</div><div class="line"> *</div><div class="line"> * @param &#123;String&#125; root</div><div class="line"> * @param &#123;Object&#125; [opts]</div><div class="line"> * @return &#123;Function&#125;</div><div class="line"> * @api public</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serve</span> (<span class="hljs-params">root, opts</span>) </span>&#123;</div><div class="line">  opts = opts || &#123;&#125;</div><div class="line">  </div><div class="line">  <span class="hljs-comment">// ensure `root`</span></div><div class="line">  assert(root, <span class="hljs-string">'root directory is required to serve files'</span>)</div><div class="line"></div><div class="line">  <span class="hljs-comment">// options</span></div><div class="line">  debug(<span class="hljs-string">'static %s %j'</span>, root, opts)</div><div class="line">  <span class="hljs-comment">// set opts.root to absolute one</span></div><div class="line">  opts.root = resolve(root)</div><div class="line"></div><div class="line">  <span class="hljs-comment">// set default static file</span></div><div class="line">  <span class="hljs-keyword">if</span> (opts.index !== <span class="hljs-literal">false</span>) opts.index = opts.index || <span class="hljs-string">'index.html'</span></div><div class="line"></div><div class="line">  <span class="hljs-comment">// if defer is supported</span></div><div class="line">  <span class="hljs-keyword">if</span> (!opts.defer) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serve</span> (<span class="hljs-params">ctx, next</span>) </span>&#123;</div><div class="line">      <span class="hljs-keyword">let</span> done = <span class="hljs-literal">false</span></div><div class="line"></div><div class="line">      <span class="hljs-keyword">if</span> (ctx.method === <span class="hljs-string">'HEAD'</span> || ctx.method === <span class="hljs-string">'GET'</span>) &#123;</div><div class="line">        <span class="hljs-keyword">try</span> &#123;</div><div class="line">          done = <span class="hljs-keyword">await</span> send(ctx, ctx.path, opts)</div><div class="line">        &#125; <span class="hljs-keyword">catch</span> (err) &#123;</div><div class="line">          <span class="hljs-keyword">if</span> (err.status !== <span class="hljs-number">404</span>) &#123;</div><div class="line">            <span class="hljs-keyword">throw</span> err</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="hljs-keyword">if</span> (!done) &#123;</div><div class="line">        <span class="hljs-keyword">await</span> next()</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  retrun <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serve</span> (<span class="hljs-params">ctx, next</span>) </span>&#123;</div><div class="line">    <span class="hljs-keyword">await</span> next()</div><div class="line">    <span class="hljs-keyword">if</span>(ctx.method !== <span class="hljs-string">'HEAD'</span> &amp;&amp; ctx.method !== <span class="hljs-string">'GET'</span>) <span class="hljs-keyword">return</span></div><div class="line">    <span class="hljs-comment">// response is already handled</span></div><div class="line">    <span class="hljs-keyword">if</span> (ctx.body != <span class="hljs-literal">null</span> || ctx.status !== <span class="hljs-number">404</span>) <span class="hljs-keyword">return</span></div><div class="line">  </div><div class="line">    <span class="hljs-keyword">try</span> &#123;</div><div class="line">      <span class="hljs-keyword">await</span> send(ctx, ctx.path, opts)</div><div class="line">    &#125; <span class="hljs-keyword">catch</span> (err) &#123;</div><div class="line">      <span class="hljs-keyword">if</span> (err.status !== <span class="hljs-number">404</span>) &#123;</div><div class="line">        <span class="hljs-keyword">throw</span> err</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> Koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</div><div class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</div><div class="line">app.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-static'</span>)(root, opts))</div></pre></td></tr></table></figure>
<h3 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h3><ul>
<li><p>maxage: default to 0.</p>
</li>
<li><p>hidden: Allow transfer of hidden files, detault to false.</p>
</li>
<li><p>index: Default file name, detault to ‘index.html’.</p>
</li>
<li><p>defer: If true, serves after <code>return next()</code>.</p>
</li>
<li><p>gzip: default to true.</p>
</li>
<li><p>extensions: default to false.</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-29T06:30:53.000Z">2017-09-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 187 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/29/react-hot-loader-in-with-ts-loader/">React-Hot-Loader in Webpack With Ts-Loader</a>
            
        </h1>
        <div class="content">
            <p>It’s very easy to integrate <code>react-hot-loader</code> into webpack with <code>ts-loader</code>.</p>
<h3 id="Config-the-webpack"><a href="#Config-the-webpack" class="headerlink" title="Config the webpack"></a>Config the webpack</h3><h4 id="Add-Hot-Module-Replacement"><a href="#Add-Hot-Module-Replacement" class="headerlink" title="Add Hot Module Replacement"></a>Add Hot Module Replacement</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// webpack.entry</span></div><div class="line">app: [</div><div class="line">  <span class="hljs-string">'webpack/hot/only-dev-server'</span>,</div><div class="line">  <span class="hljs-string">'webpack-dev-server/client?http://localhost:8080'</span>,</div><div class="line">  path.resolve(__dirname, <span class="hljs-string">'./src'</span>),</div><div class="line">],</div><div class="line"></div><div class="line"><span class="hljs-attr">plugins</span>: [</div><div class="line">  <span class="hljs-keyword">new</span> webpack.HotModuleReplacementPlugin()</div><div class="line">],</div><div class="line"></div><div class="line"><span class="hljs-attr">devServer</span>: &#123;</div><div class="line">  <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Add-React-Hot-Loader-into-webpack"><a href="#Add-React-Hot-Loader-into-webpack" class="headerlink" title="Add React-Hot-Loader into webpack"></a>Add React-Hot-Loader into webpack</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// add react-hot-loader to entry point</span></div><div class="line"></div><div class="line">entry: [</div><div class="line">  <span class="hljs-string">'webpack/hot/only-dev-server'</span>,</div><div class="line">  <span class="hljs-string">'webpack-dev-server/client?http://localhost:8080'</span>,</div><div class="line">  <span class="hljs-string">'react-hot-loader/patch'</span>,</div><div class="line">  path.resolve(__dirname, <span class="hljs-string">'./src/'</span>),</div><div class="line">],</div><div class="line"><span class="hljs-comment">// add loader</span></div><div class="line"><span class="hljs-built_in">module</span>: &#123;</div><div class="line">  <span class="hljs-attr">rules</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.tsx$/</span>,</div><div class="line">      <span class="hljs-attr">use</span>: [<span class="hljs-string">'react-hot-loader/webpack/'</span>, <span class="hljs-string">'ts-loader'</span>],</div><div class="line">      <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,</div><div class="line">      <span class="hljs-attr">include</span>: path.resolve(__dirname, <span class="hljs-string">'./src'</span>),</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Wrap-Root-Container-into-module-hot-accept"><a href="#Wrap-Root-Container-into-module-hot-accept" class="headerlink" title="Wrap Root Container into module.hot.accept"></a>Wrap Root Container into <code>module.hot.accept</code></h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</div><div class="line">  <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'./router'</span>, () =&gt; &#123;</div><div class="line">    <span class="hljs-keyword">const</span> Root = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./router'</span>).default</div><div class="line">    render(<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Root</span> /&gt;</span>, htmlDOM)</span></div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Note, if you are using ts with babel-preset-es2015, you can set babel to ignore <code>es2015</code> module transform by</p>
</blockquote>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="hljs-attr">"presets"</span>: [[<span class="hljs-string">"es2015"</span>, &#123;<span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span>&#125;]]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>because webpack 3 has built-in support for ES2015 modules. You won’t need to re-require you root module.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.hot) &#123;</div><div class="line">  <span class="hljs-built_in">module</span>.hot.accept(<span class="hljs-string">'./router'</span>, () =&gt; &#123;</div><div class="line">    render(<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Root</span> /&gt;</span>, htmlDOM)</span></div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Same treatment in ts if your target is es6</p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-25T07:14:53.000Z">2017-09-25</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    33 minutes read (About 5017 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/25/Methods-of-Observable/">Methods of Observable</a>
            
        </h1>
        <div class="content">
            <p><a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-switchMap" target="_blank" rel="noopener">Original</a><br><a href="https://rxviz.com" target="_blank" rel="noopener">Playground</a></p>
<h3 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h3><h5 id="Direct-Subclass"><a href="#Direct-Subclass" class="headerlink" title="Direct Subclass"></a>Direct Subclass</h5><ul>
<li><p>ConnectableObservable</p>
</li>
<li><p>GroupedObservable</p>
</li>
<li><p>Subject</p>
</li>
</ul>
<h5 id="Indirect-Subclass"><a href="#Indirect-Subclass" class="headerlink" title="Indirect Subclass"></a>Indirect Subclass</h5><ul>
<li><p>AnonymousSubject</p>
</li>
<li><p>AsyncSubject</p>
</li>
<li><p>BehaviorSubject</p>
</li>
<li><p>ReplaySubject</p>
</li>
</ul>
<h4 id="Static-Public-Methods"><a href="#Static-Public-Methods" class="headerlink" title="Static Public Methods"></a>Static Public Methods</h4><ul>
<li>bindCallback</li>
</ul>
<p><code>public static bindCallback(func: function, selector: function, schedular: Schedular): function(...params: *): Observable</code></p>
<p>Convert a callback API to a function that returns an Observable</p>
<blockquote>
<p>Give it a function f of type f(x, callback) and it will return a function g taht when called as g(x) will output an Observable.</p>
</blockquote>
<p><code>bindCallback</code> is not an operator because its input and output are not Observables.</p>
<p>The input is a function with some parameters, but the last parameter must be a callback function.</p>
<p>The output of the <code>bindCallback</code> is a function that takes the <strong>same</strong> parameters as original function takes, except the last one(the callback). When the output function is called with arguments, it will return an Observable.</p>
<p>If the original function’s callback takes one argument, the Observable will emit that value. If on the other hand callback is called with multiple values, resulting Observable will emit an array with these argumetns.</p>
<h5 id="More-in-Origin-Article"><a href="#More-in-Origin-Article" class="headerlink" title="More in Origin Article"></a>More in Origin Article</h5><ul>
<li>bindNodeCallback</li>
</ul>
<p><code>public static bindNodeCallback(func: function, scheduler: Schedular): function(...param: *): Observable</code></p>
<ul>
<li>combineLatest</li>
</ul>
<p><code>public static combineLatest(observable1: ObservableInput, observable2: ObservableInput, project: function, schedular: Schedular): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/combineLatest.png" alt=""></p>
<p>Combines multiple Observables to create an Observable whose values are calculated from the latest values of each of its input Observables.</p>
<blockquote>
<p><strong>Whenever</strong> any input Observable emits a value, it computes a formula using the latest values from all the inputs, then emits the output of the formula.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// combine two timer Observable</span></div><div class="line"><span class="hljs-keyword">const</span> firstTimer = Rx.Observable.timer(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)</div><div class="line"><span class="hljs-keyword">const</span> secondTimer = Rx.Observable.timer(<span class="hljs-number">500</span>, <span class="hljs-number">1000</span>)</div><div class="line"><span class="hljs-keyword">const</span> combineTimers = Rx.Observable.combineLatest(firstTimer, secondTimer)</div><div class="line">combineTimers.subscribe(<span class="hljs-built_in">console</span>.log)</div><div class="line"><span class="hljs-comment">// logs</span></div><div class="line"><span class="hljs-comment">// [0, 0] after 0.5s, triggered by secondTimer</span></div><div class="line"><span class="hljs-comment">// [1, 0] after 1s, triggered by firstTimer</span></div><div class="line"><span class="hljs-comment">// [1, 1.5] after 1.5s, triggered by secondTimer</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="hljs-comment">// combine an array of observable</span></div><div class="line"><span class="hljs-keyword">const</span> observables = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>].map(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> Rx.Observable.of(n).delay(n * <span class="hljs-number">1000</span>).startWith(<span class="hljs-number">0</span>))</div><div class="line"><span class="hljs-keyword">const</span> combined = Rx.Observable.combineLatest(observables)</div><div class="line">combined.subscribe(<span class="hljs-built_in">console</span>.log)</div><div class="line"><span class="hljs-comment">// logs</span></div><div class="line"><span class="hljs-comment">// [0, 0, 0] immediately</span></div><div class="line"><span class="hljs-comment">// [1, 0, 0] after 1s triggered by observables[0]</span></div><div class="line"><span class="hljs-comment">// [1, 2, 0] after 2s triggered by observables[1]</span></div><div class="line"><span class="hljs-comment">// [1, 2, 4] after 4s triggered by observables[2]</span></div><div class="line"></div><div class="line"><span class="hljs-comment">// use project function to dynamically calculate the body-mass index</span></div><div class="line"><span class="hljs-keyword">const</span> weight = Rx.Observable.of(<span class="hljs-number">70</span>, <span class="hljs-number">72</span>, <span class="hljs-number">76</span>, <span class="hljs-number">79</span>, <span class="hljs-number">75</span>)</div><div class="line"><span class="hljs-keyword">const</span> height = Rx.Observable.of(<span class="hljs-number">1.76</span>, <span class="hljs-number">1.77</span>, <span class="hljs-number">1.78</span>)</div><div class="line"><span class="hljs-keyword">const</span> bmi = Rx.Observable.combineLatest(weight, height, (w, h) =&gt; w/(h*h))</div><div class="line">bmi.subscribe(<span class="hljs-built_in">console</span>.log)</div><div class="line"><span class="hljs-comment">// With output to console:</span></div><div class="line"><span class="hljs-comment">// BMI is 24.212293388429753</span></div><div class="line"><span class="hljs-comment">// BMI is 23.93948099205209</span></div><div class="line"><span class="hljs-comment">// BMI is 23.671253629592222</span></div></pre></td></tr></table></figure>
<ul>
<li>concat</li>
</ul>
<p><code>public static concat(input1: ObservableInput, input2: ObservableInput, scheduler: Schedular): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/concat.png" alt=""></p>
<p>Creates an output Observable which sequentially emits all values from given Observable and then moves on to the next.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// Concatenate a timer counting form 0 to 3 with a synchronous sequence from 1 to 10</span></div><div class="line"><span class="hljs-keyword">var</span> timer = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">4</span>)</div><div class="line"><span class="hljs-keyword">var</span> sequence = Rx.Observable.range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)</div><div class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.concat(timer, sequence)</div><div class="line"></div><div class="line"><span class="hljs-comment">// concatenate an array of 3 Observables, different from the one above</span></div><div class="line"><span class="hljs-keyword">var</span> timer1 = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">10</span>)</div><div class="line"><span class="hljs-keyword">var</span> timer2 = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">6</span>)</div><div class="line"><span class="hljs-keyword">var</span> timer3 = Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">10</span>)</div><div class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.concat([timer1, timer2, timer3])</div></pre></td></tr></table></figure>
<ul>
<li>create</li>
</ul>
<p><code>public static create(onSubscription: function(observer: Observer): TearDownLogic): Observable</code></p>
<p>Creates a new Observable, that will execute the specified function when an Observer subscribes to it.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> observable = Rx.Observable.create(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">observer</span>) </span>&#123;</div><div class="line">  observer.next(<span class="hljs-number">1</span>)</div><div class="line">  observer.next(<span class="hljs-number">2</span>)</div><div class="line">  observer.next(<span class="hljs-number">3</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>defer</li>
</ul>
<p><code>public static defer(observableFactory: function(): SubscribableOrPromise): Observable</code></p>
<p>Creates an Observable that, on subscribe, calls an Observable factory to make an Observable for each new Observer</p>
<blockquote>
<p>Creates the Observable lazily, that is, only when it is subscribed.</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/defer.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// when defer is called, it returns an Observable</span></div><div class="line"><span class="hljs-keyword">var</span> clicksOrInterval = Rx.Observable.defer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.5</span>) &#123;</div><div class="line">    <span class="hljs-keyword">return</span> Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    <span class="hljs-keyword">return</span> Rx.Observable.interval(<span class="hljs-number">1000</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>empty</li>
</ul>
<p><code>public static empty(scheduler: Scheduler): Observable</code></p>
<p>Creates an Observable that emits no items to the Observer and immediately emits a completion notification.</p>
<blockquote>
<p>Just emits ‘complete’ and nothing else</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/empty.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.empty().startWith(<span class="hljs-number">8</span>)</div></pre></td></tr></table></figure>
<ul>
<li>from</li>
</ul>
<p><code>public static from(ish: ObservableInput&lt;T&gt;, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p>Creates an Observable from an Array, an array-like Object, a Promise, an iterable object, or an Observable-like Object</p>
<blockquote>
<p>Convert almost anything to an Observable</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/from.png" alt=""></p>
<ul>
<li>fromEvent</li>
</ul>
<p><code>public static fromEvent(target: EventTargetLike, eventName: string, options: EventListenerOptions, selector: SelectorMethodSignature&lt;T&gt;): Observable&lt;T&gt;</code></p>
<blockquote>
<p>Creates an Observable from DOM events, or Node EventEmitter events or others</p>
</blockquote>
<p><img src="http://reactivex.io/rxjs/img/fromEvent.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div></pre></td></tr></table></figure>
<ul>
<li>fromEventPattern</li>
</ul>
<p><code>public static fromEventPattern(addHandler: function(handler: Function): any, removeHandler: function(handler: Function, signal?: any): void, selector: function(...args: any): T): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/fromEventPattern.png" alt=""></p>
<blockquote>
<p>Converts any addHandler/removeHandler API to an Observable</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addClickHandler</span>(<span class="hljs-params">handler</span>) </span>&#123;</div><div class="line">  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'click'</span>, handler)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeClick</span>(<span class="hljs-params">handler</span>) </span>&#123;</div><div class="line">  <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">'click'</span>, handler)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEventPattern(</div><div class="line">  addClickHandler,</div><div class="line">  removeClickHandler,</div><div class="line">)</div></pre></td></tr></table></figure>
<ul>
<li>fromPromise</li>
</ul>
<p><code>public static fromPromise(promise: Promise&lt;T&gt;, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<blockquote>
<p>Returns an Observable that just emit the Promise’s resolved value, then complete</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> result = Rx.Observable.fromPromise(fetch(<span class="hljs-string">'reqres.in/api/users'</span>))</div></pre></td></tr></table></figure>
<ul>
<li>interval</li>
</ul>
<p><code>public static interval(period: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/interval.png" alt=""></p>
<blockquote>
<p>Emits incremental numbers periodically in time</p>
</blockquote>
<ul>
<li>merge</li>
</ul>
<p><code>public static merge(observables: ...ObservableInput, concurrent: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/merge.png" alt=""></p>
<p>Creates an output Observable which concurrently emits all values from every given input Observable</p>
<blockquote>
<p>Flatten multiple Observables together by blending their values into one Observable</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> timer = Rx.Observable.interval(<span class="hljs-number">1000</span>)</div><div class="line"><span class="hljs-keyword">var</span> clicksOrTimer = Rx.Observable.merge(clicks, timer)</div></pre></td></tr></table></figure>
<ul>
<li>never</li>
</ul>
<p><code>public static never(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/never.png" alt=""></p>
<p>Creates an Observable that emits no items to the Observer</p>
<blockquote>
<p>An Observable that never emits anything</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Rx.Observable.never().startWith(<span class="hljs-number">7</span>).subscribe(<span class="hljs-built_in">console</span>.log)</div><div class="line"><span class="hljs-comment">// won't console 7</span></div></pre></td></tr></table></figure>
<ul>
<li>of</li>
</ul>
<p><code>public static of(values: ...T, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/of.png" alt=""></p>
<p>Creates an Observbale that emits some values you specify as arguments, immediately one after the other, and then emits a complete notification.</p>
<blockquote>
<p>Emits the arguments you provide, then complete.</p>
</blockquote>
<ul>
<li>range</li>
</ul>
<p><code>public static range(start: number, count: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/range.png" alt=""></p>
<p>Creates an Observable that emits a sequence of numbers within a specified range.</p>
<blockquote>
<p>Emits a sequence of numbers in a range</p>
</blockquote>
<ul>
<li>throw</li>
</ul>
<p><code>public static throw(error: any, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/throw.png" alt=""></p>
<blockquote>
<p>Just emit ‘error’ and nothing else.</p>
</blockquote>
<ul>
<li>timer</li>
</ul>
<p><code>public static timer(initialDelay: number|Date, period: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/timer.png" alt=""></p>
<p>Creates an Observable that starts emitting after an <code>initialDelay</code> and emits ever increasing numbers after each <code>period</code> of time thereafter.</p>
<blockquote>
<p>It’s like interval, but you can specify when should the emissions start.</p>
</blockquote>
<ul>
<li>webSocket</li>
</ul>
<p><code>public static webSocket(urlConfigOrSource: string | WebSocketSubjectConfig): Observable</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">let</span> subject = Rx.Observable.webSocket(<span class="hljs-string">'ws://localhost:8001'</span>)</div></pre></td></tr></table></figure>
<ul>
<li>zip</li>
</ul>
<p><code>public static zip(observables: *): Observable&lt;R&gt;</code></p>
<p>Combines multiple Observables to create an Observable whose values are calculated from the valeus, in order, of each of its input Observables.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">let</span> age$ = Rx.Observable.of(<span class="hljs-number">27</span>, <span class="hljs-number">25</span>, <span class="hljs-number">29</span>)</div><div class="line"><span class="hljs-keyword">let</span> name$ = Rx.Observable.of(<span class="hljs-string">'Foo'</span>, <span class="hljs-string">'Bar'</span>, <span class="hljs-string">'Beer'</span>)</div><div class="line"><span class="hljs-keyword">let</span> isDev$ = Rx.Observable.of(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>)</div><div class="line"></div><div class="line">Rx.Observable.zip(age$, name$, isDev$, (age, name, isDev) =&gt; (&#123;age, name, isDev&#125;))</div><div class="line"><span class="hljs-comment">// outputs</span></div><div class="line"><span class="hljs-comment">// &#123; age: 27, name: 'Foo', isDev: true &#125;</span></div><div class="line"><span class="hljs-comment">// &#123; age: 25, name: 'Bar', isDev: true &#125;</span></div><div class="line"><span class="hljs-comment">// &#123; age: 29, name: 'Beer', isDev: false &#125;</span></div></pre></td></tr></table></figure>
<ul>
<li>constructor</li>
</ul>
<p><code>public constructor (subsribe: Function)</code></p>
<ul>
<li>audit</li>
</ul>
<p><code>public audit(durationSelector: function(value: T): SubscribableOrPromise): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/audit.png" alt=""></p>
<p>Ignores source value for a duration determined by another Observable, then emis the most recent value from the source Observable, then repeats this process.</p>
<blockquote>
<p>It’s like auditTime, but the silencing duration is determined by a second Observable.</p>
</blockquote>
<p><code>audit</code> is similar to <code>throttle</code>, but emits the last value from the silenced time window.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> result = clicks.audit(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>))</div></pre></td></tr></table></figure>
<ul>
<li>auditTime</li>
</ul>
<p><code>public auditTime(duration: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/auditTime.png" alt=""></p>
<p>Ignores source values for <code>duration</code> milliseconds, then emits the most recent value from the source Observable, then repeats this process.</p>
<p>Similar to <code>throttleTime</code></p>
<ul>
<li>buffer</li>
</ul>
<p><code>public buffer(closingNotifier: Observable&lt;any&gt;): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/buffer.png" alt=""></p>
<p>Buffers the source Observable values until <code>closingNotifier</code> emits.</p>
<blockquote>
<p>Collect values from the past as an array, and emits that array when another Observable emits.</p>
</blockquote>
<ul>
<li>bufferCount</li>
</ul>
<p><code>public bufferCount(bufferSize: number, startBufferEvery: number): Observable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferCount.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> interval = Rx.Observable.interval(<span class="hljs-number">1000</span>)</div><div class="line">interval.bufferCount(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>)</div></pre></td></tr></table></figure>
<ul>
<li>bufferTime</li>
</ul>
<p><code>public bufferTime(bufferTimeSpan: number, bufferCreationIntervel: number, maxBufferSize: number, scheduler: Scheduler): Observable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferTime.png" alt=""></p>
<p>Buffers the source Observable values for a specific time period.</p>
<blockquote>
<p>Collect values from the past as an array, and emits those array periodically in time.</p>
</blockquote>
<ul>
<li>bufferToggle</li>
</ul>
<p><code>public bufferToggle(openings: SubscribableOrPromise&lt;O&gt;, closingSelector: function(value: O): SubscribableOrPromise): Observable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferToggle.png" alt=""></p>
<ul>
<li>bufferWhen</li>
</ul>
<p><code>public bufferWhen(closingSelector: function(): Obversable): Obversable&lt;T[]&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/bufferWhen.png" alt=""></p>
<p>Buffers the source Observable values, using a factory function of closing Observables to determine when to close, emit and reset the buffer.</p>
<ul>
<li>catch</li>
</ul>
<p><code>public catch(selector: function): Obversable</code></p>
<p><img src="http://reactivex.io/rxjs/img/catch.png" alt=""></p>
<p>Catches errors on the observable to be handled by returning a new obversable or throwing an error.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Rx.Observable.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)</div><div class="line">.map(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (n === <span class="hljs-number">4</span>) <span class="hljs-keyword">throw</span> <span class="hljs-string">'four'</span></div><div class="line">  <span class="hljs-keyword">return</span> n</div><div class="line">&#125;).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> Rx.Observable.of(<span class="hljs-string">'I'</span> , <span class="hljs-string">'II'</span>, <span class="hljs-string">'III'</span>, <span class="hljs-string">'IV'</span>, <span class="hljs-string">'V'</span>))</div></pre></td></tr></table></figure>
<ul>
<li>combineAll</li>
</ul>
<p><code>public combineAll(project: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/combineAll.png" alt=""></p>
<p>Convert a higher-order Observable into a first-order Observable by waiting for the outer Observable to complete, then applying <code>combineLatest</code></p>
<p>Similar to CombineLatest</p>
<blockquote>
<p>Flatten an Observable-of-Observables by applying combineLatest when the Observable-of-Observable completes</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>);</div><div class="line"><span class="hljs-keyword">var</span> higherOrder = clicks.map(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span></div><div class="line">  Rx.Observable.interval(<span class="hljs-built_in">Math</span>.random()*<span class="hljs-number">2000</span>).take(<span class="hljs-number">13</span>)</div><div class="line">).take(<span class="hljs-number">3</span>);</div><div class="line"><span class="hljs-keyword">var</span> result = higherOrder.combineAll();</div></pre></td></tr></table></figure>
<ul>
<li>combineLatest</li>
</ul>
<p><code>public combineLatest(other: ObservableInput, project: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/combineLatest.png" alt=""></p>
<p>Combines multiple Observables to create an Observable whose values are calculated from the latest values of each of its input Observable.</p>
<ul>
<li>concat</li>
</ul>
<p><code>public concat(other: ObservableInput, scheduler: Scheduler): Observable</code></p>
<ul>
<li>concatAll</li>
</ul>
<p><code>public concatAll(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/concatAll.png" alt=""></p>
<p>Converts a higher-order Observable into a first-order Observable by concatenating the inner Observable in order.</p>
<blockquote>
<p>Flatten an Observable-of-Observable by putting one inner Observable after the other</p>
</blockquote>
<ul>
<li>concatMap</li>
</ul>
<p><code>public concatMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/concatMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable, in a serialized fashion waiting for each one to complete before merging the next.</p>
<p>Map =&gt; Concat</p>
<blockquote>
<p>Map each value to an Observable, then flatten all of these inner Observables using concatAll</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> result = clicks.concatMap(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">return</span> Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">4</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>concatMaoTo</li>
</ul>
<p><code>public concatMapTo(innerObservable: ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observer</code></p>
<p><img src="http://reactivex.io/rxjs/img/concatMapTo.png" alt=""></p>
<blockquote>
<p>It’s like concatMap, but maps each value always to the same inner Observable</p>
</blockquote>
<ul>
<li>count</li>
</ul>
<p><code>public count(predicate: function(value: T, i: number, source: Observable&lt;T&gt;): boolean): Observable</code></p>
<p>Counts the number of emissions on the source and emits the number when the source completes.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// count how many seconds have passed before the first click</span></div><div class="line"><span class="hljs-keyword">var</span> seconds = Rx.Observable.interval(<span class="hljs-number">1000</span>)</div><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> secondsBeforeClick = seconds.takeUntil(clicks)</div><div class="line">secondsBeforeClick.count()</div><div class="line"></div><div class="line"><span class="hljs-comment">// count how many odd numbers are there between 1 and 7</span></div><div class="line"><span class="hljs-keyword">var</span> numbers = Rx.Observable.range(<span class="hljs-number">1</span>, <span class="hljs-number">7</span>)</div><div class="line">numbers.count(<span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> i % <span class="hljs-number">2</span>)</div></pre></td></tr></table></figure>
<ul>
<li>debounce</li>
</ul>
<p><code>public debounce(durationSelector: function(value: T): SubscribableOrPromise): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/debounce.png" alt=""></p>
<p>Emits a value from the source Observable only after a particular time span determined by another Observable has passes without another source emission.</p>
<blockquote>
<p>It’s like debounceTime, but the time span of emission silence is determined by a second Observable.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> result = clicks.debounce(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>))</div></pre></td></tr></table></figure>
<ul>
<li>debounceTime</li>
</ul>
<p><code>public debounceTime(dueTime: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/debounceTime.png" alt=""></p>
<p>Emits a value from the source Observable only after a particular time span has passed without another source emission.</p>
<blockquote>
<p>It’s like delay, but passes only the most recent value from each burst of emissions.</p>
</blockquote>
<ul>
<li>defaultEmpty</li>
</ul>
<p><img src="http://reactivex.io/rxjs/img/defaultIfEmpty.png" alt=""></p>
<p><code>public defaultIfEmpty(defaultValue: any): Observable</code></p>
<p>Emits a given value if the source Observable completes without emitting any <code>next</code> value, otherwise mirrors the source Observable.</p>
<blockquote>
<p>If the source Observable turns out to be empty, then this operator will emit a default value.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> clicksBeforeFive = clicks.takeUntil(Rx.Observable.interval(<span class="hljs-number">5000</span>))</div><div class="line">clicksBeforeFive.defaultIfEmpty(<span class="hljs-string">'no click'</span>)</div></pre></td></tr></table></figure>
<ul>
<li>delay</li>
</ul>
<p><code>public delay(delay: number|Date, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/delay.png" alt=""></p>
<p>Delays the emission of items from the source Observable by a given timeout or until a given Date.</p>
<ul>
<li>delayWhen</li>
</ul>
<p><code>public delayWhen(delayDurationSelector: function(value: T): Observable): Observable</code></p>
<blockquote>
<p>It’s like delay, but the time span of the delay duration is determined by a second Observable.</p>
</blockquote>
<ul>
<li>dematerialize</li>
</ul>
<p><code>public dematerialize(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/dematerialize.png" alt=""></p>
<p>Convert an Observable of Notification objects into the emissions that they represent.</p>
<blockquote>
<p>Unwraps Notification objects as actual next, error, and complete emissions. The opposite of materialize.</p>
</blockquote>
<p><code>dematerialize</code> is assumed to operate an Observable that only emits <code>Notification</code> objects as <code>next</code> emission, and does not emit any <code>error</code>. Such Observable is the output of a <code>materialize</code> operation. Those notifications are then unwrapped using the metadata they contain, and emitted as <code>next</code>, <code>error</code>and <code>complete</code> on the output Observable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> notiA = <span class="hljs-keyword">new</span> Rx.Notification(<span class="hljs-string">'N'</span>, <span class="hljs-string">'A'</span>)</div><div class="line"><span class="hljs-keyword">var</span> notiB = <span class="hljs-keyword">new</span> Rx.Notification(<span class="hljs-string">'N'</span>, <span class="hljs-string">'B'</span>)</div><div class="line"><span class="hljs-keyword">var</span> notiE = <span class="hljs-keyword">new</span> Rx.Notification(<span class="hljs-string">'E'</span>, <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'x.toUpperCase is not a function'</span>))</div><div class="line"><span class="hljs-keyword">var</span> materialized = Rx.Observable.of(notiA, notiB, notiE)</div><div class="line"><span class="hljs-keyword">var</span> upperCase = materialized.dematerialize()</div></pre></td></tr></table></figure>
<ul>
<li>distinct</li>
</ul>
<p><code>public distinct(keySelector: function, flushes: Observable): Observable</code></p>
<p>Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from previous item<strong>s</strong>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Rx.Observable.of(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">67</span>,<span class="hljs-number">6</span>,<span class="hljs-number">6</span>,).distinct()</div><div class="line"><span class="hljs-comment">// 1,2,3,4,5,67,6</span></div><div class="line"><span class="hljs-comment">// repeated 1 omitted</span></div><div class="line"></div><div class="line"><span class="hljs-comment">// keySelector</span></div><div class="line">interface Person &#123;</div><div class="line">  <span class="hljs-attr">age</span>: number</div><div class="line">  name: string</div><div class="line">&#125;</div><div class="line"></div><div class="line">Rx.Observable.of&lt;Person&gt;(</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bar'</span> &#125;,</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</div><div class="line">).distinct(<span class="hljs-function">(<span class="hljs-params">p: Person</span>) =&gt;</span> p.name)</div></pre></td></tr></table></figure>
<blockquote>
<p>Note: ‘1’ is different from 1</p>
</blockquote>
<ul>
<li>distinctUntilChanged</li>
</ul>
<p><code>public distinctUntilChanged(compare: function): Observable</code></p>
<p>Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from the previous item. (not items)</p>
<ul>
<li>distinctUntilKeyChanged</li>
</ul>
<p><code>public distinctUntilKeyChanged(key: string, compare: function): Observable</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">interface Person &#123;</div><div class="line">  <span class="hljs-attr">age</span>: number</div><div class="line">  name: string</div><div class="line">&#125;</div><div class="line"></div><div class="line">Rx.Observable.of&lt;Person&gt;(</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bar'</span> &#125;,</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">naem</span>: <span class="hljs-string">'For'</span> &#125;,</div><div class="line">).distinctUntilKeyChanged(<span class="hljs-string">'name'</span>, (x: string, <span class="hljs-attr">y</span>: string) =&gt; x.substring(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) === y.substring(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>))</div></pre></td></tr></table></figure>
<ul>
<li>do</li>
</ul>
<p><code>public do(nextOrObserver: Observer|function, error: function, complete: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/do.png" alt=""></p>
<p>Perform a <strong>side effect</strong> for every emission on the source Observable, but return an Observable that is <strong>identical</strong> to the source.</p>
<blockquote>
<p>Intercepts each emission on the source and runs a function, but returns an output which is identical to the source.</p>
</blockquote>
<ul>
<li>elemetnAt</li>
</ul>
<p><code>public elementAt(index: number, defaultValue: T): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/elementAt.png" alt=""></p>
<p>Emits the single value at the specified <code>index</code> in a sequence of emissions from the source Observable.</p>
<blockquote>
<p>Emits only the i-th value , then completes.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line">clicks.elementAt(<span class="hljs-number">2</span>)</div></pre></td></tr></table></figure>
<ul>
<li>every</li>
</ul>
<p><code>public every(predicate: function, thisArg: any): Observable</code></p>
<p>Returns an Observable that emits whether or not every item of the source satisfies the condition specified.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// all elements are less than 5, otherwise false</span></div><div class="line">Observable.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)</div><div class="line">  .every(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x &lt; <span class="hljs-number">5</span>)</div><div class="line">  .subscribe(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(x)); <span class="hljs-comment">// -&gt; false</span></div></pre></td></tr></table></figure>
<ul>
<li>exhaust</li>
</ul>
<p><code>public exhaust(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/exhaust.png" alt=""></p>
<p>Convert a higher-order Observable into a first-order Observable by dropping inner Observables while the previoud inner Observable has not yet completed.</p>
<blockquote>
<p>Flatten an Observable-of-Observables by dropping the next inner Observable while the current inner is still executing.</p>
</blockquote>
<p><code>exhaust</code> ingores every new inner Observable if the previous Observable has not yet completed.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">var</span> higherOrder = clicks.map(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>).take(<span class="hljs-number">3</span>))</div><div class="line">higherOrder.exhaust()</div></pre></td></tr></table></figure>
<ul>
<li>exhaustMap</li>
</ul>
<p><code>public exhaustMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/exhaustMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable only if the previous projected Observable has completed.</p>
<ul>
<li>expand</li>
</ul>
<p><code>public expand(project: function(value: T, index: number), concurrent: number, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/expand.png" alt=""></p>
<p>Recursively projects each source value to an Observable which is merged in the output Observable.</p>
<blockquote>
<p>It’s similar to mergeMap, but applies the projection function to every source value as well as every output value. It’s recursive.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line">clicks.mapTo(<span class="hljs-number">1</span>).expand(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> Rx.Observable.of(<span class="hljs-number">2</span>*x).delay(<span class="hljs-number">1000</span>)).take(<span class="hljs-number">10</span>)</div></pre></td></tr></table></figure>
<ul>
<li>filter</li>
</ul>
<p><code>public filter(predicate: function(value T, index: number): boolean, thisArg: any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/filter.png" alt=""></p>
<p>Filter items emitted by the source Observable by only emitting those that satisfy a specified predicate.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line">clicks.filter(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> <span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.4</span>)</div></pre></td></tr></table></figure>
<ul>
<li>find</li>
</ul>
<p><code>public find(predicate: function(value: T, index: number, source: Observable&lt;T&gt;): boolean, thisArg: any): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/find.png" alt=""></p>
<p>Emits only the first value emitted by the source Observable that meets some condition.</p>
<ul>
<li>findIndex</li>
</ul>
<p><code>public findIndex(predicate: function(value: T, index: number, source: Observable&lt;T&gt;): boolean, thisArg: any): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/findIndex.png" alt=""></p>
<blockquote>
<p>It’s like find, but emits the index of the found value, not the value itself.</p>
</blockquote>
<ul>
<li>first</li>
</ul>
<p><code>public first(predicate: function(value: T, index: number, source: Obsevable&lt;T&gt;): boolean, resultSelector: function(value: T, index: number): R, defaultValue: R): Observable&lt;T|R&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/first.png" alt=""></p>
<p>Emits only the first value (or the fisrt value that meets some condition) emitted by the source Obsevable</p>
<ul>
<li>forEach</li>
</ul>
<p><code>public forEach(next: Function, PromiseCtor: PromiseConstructor): Promise</code></p>
<ul>
<li>groupBy</li>
</ul>
<p><code>public groupBy(keySelector: function(value: T): K, elementSelector: functioN(value: T): R, durationSelector: function(grouped: GroupedObservable&lt;K|R&gt;): Observable&lt;any&gt;): Observable&lt;GroupedObservable&lt;K, R&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/groupBy.png" alt=""></p>
<ul>
<li>ignoreElements</li>
</ul>
<p><code>public ignoreElements(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/ignoreElements.png" alt=""></p>
<p>Iggnores all items emitted by the source Observable and only pass calls of <code>complete</code> or <code>error</code></p>
<ul>
<li>isEmpty()</li>
</ul>
<p><code>public isEmpty(): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/isEmpty.png" alt=""></p>
<ul>
<li>last</li>
</ul>
<p><code>public last(predicate: function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/last.png" alt=""></p>
<ul>
<li>letProto</li>
</ul>
<p><code>public letProto(func: *): Observable&lt;T&gt;</code></p>
<ul>
<li>lift</li>
</ul>
<p><code>public lift(operator: Operator): Observable</code></p>
<p>Creates a new Observable, with this Observable as the source, and the passed operator defined as the new observable’s operator.</p>
<blockquote>
<p>Return a new Observable with the Operator applied.</p>
</blockquote>
<ul>
<li>map</li>
</ul>
<p><code>public map(project: function(value: T, index: number): R, thisArg: any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/map.png" alt=""></p>
<p>Applies a given <code>project</code> function to each value emitted by the source Observable, and emits the resulting values as an Observable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line">clicks.map(<span class="hljs-function"><span class="hljs-params">ev</span> =&gt;</span> ev.clientX)</div></pre></td></tr></table></figure>
<ul>
<li>mapTo</li>
</ul>
<p><code>public mapTo(value: any): Observbale</code></p>
<p><img src="http://reactivex.io/rxjs/img/mapTo.png" alt=""></p>
<p>Emits the given constant value on the output Observable every time the source Observable emits a value.</p>
<ul>
<li>materialize</li>
</ul>
<p><code>public materialize(): Observable&lt;Notification&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/materialize.png" alt=""></p>
<p>Represents all of the notifications from the source Observable as <code>next</code> emission marked with their orignal types within <code>Notification</code> objects.</p>
<ul>
<li>max</li>
</ul>
<p><code>public max(comparer: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/max.png" alt=""></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Rx.Observable.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>).max()</div><div class="line"></div><div class="line">interface Person &#123;</div><div class="line">  <span class="hljs-attr">name</span>: string</div><div class="line">  age: number</div><div class="line">&#125;</div><div class="line"></div><div class="line">Rx.Observable.of&lt;Person&gt;(</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Foo'</span> &#125;,</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bar'</span> &#125;,</div><div class="line">  &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'For'</span> &#125;,</div><div class="line">)</div><div class="line">.max&lt;Person&gt;<span class="hljs-function">(<span class="hljs-params">(a, b</span>) =&gt;</span> a.age - b.age)</div></pre></td></tr></table></figure>
<ul>
<li>merge</li>
</ul>
<p><code>public merge(other: ObservableInpt, concurrent: number, scheduler: Scheduer): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/merge.png" alt=""></p>
<p>Creates an output Observable which concurrently emits all values from every given input Observable.</p>
<blockquote>
<p>Flatten multiple Observable together by blending their values into one Observable.</p>
</blockquote>
<ul>
<li>mergeAll</li>
</ul>
<p><code>public mergeAll(concurrent: number): Obsevable</code></p>
<p><img src="http://reactivex.io/rxjs/img/mergeAll.png" alt=""></p>
<p>Converts a higher-order Observable into a first-order Observable which concurrently delivers all values that are emitted on the inner Observables.</p>
<ul>
<li>mergeMap</li>
</ul>
<p><code>public mergeMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any, concurrent: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/mergeMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable.</p>
<blockquote>
<p>Map each value to an Observable, then flattn all of these inner Observable using mergeAll</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">var</span> letters = Rx.Observable.of(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>)</div><div class="line">letters.mergeMap(<span class="hljs-function"><span class="hljs-params">letter</span> =&gt;</span> Rx.Observable.interval(<span class="hljs-number">1000</span>).map(<span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> i+letter))</div></pre></td></tr></table></figure>
<ul>
<li>mergeMapTo</li>
</ul>
<p><code>public mergeMapTo(innerObservable: ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any, concurrent: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/mergeMapTo.png" alt=""></p>
<p>Projects each source value to the same Observable which is merged multiple times in the output Observable.</p>
<ul>
<li>mergeScan</li>
</ul>
<p><code>public mergeScan(accumulator: function(acc: R, value: T): Observable&lt;R&gt;, seed: *, concurrent: number): Observable&lt;R&gt;</code></p>
<p>Applies an accumulator function over the source Observable where the accumulator function itself retunrs an Observable, then each intermediate Observable is merged into the output Obsevable.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> click$ = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">const</span> one$ = click$.mapTo(<span class="hljs-number">1</span>)</div><div class="line"><span class="hljs-keyword">const</span> seed = <span class="hljs-number">0</span></div><div class="line"><span class="hljs-keyword">const</span> count$ = one$.mergeScan(<span class="hljs-function">(<span class="hljs-params">acc, one</span>) =&gt;</span> Rx.Observable.of(acc + one), seed)</div></pre></td></tr></table></figure>
<ul>
<li>min</li>
</ul>
<p><code>public min(comparer: Function): Observable&lt;R&gt;</code></p>
<ul>
<li>multicast</li>
</ul>
<p><code>public multicast(subjectOrSubjectFactory: Function | Subject, selector: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/multicast.png" alt=""></p>
<p>Returns an Observable tghat emits the results of invoking a specified selector on items emitted by a ConnectableObservable that shares a single subscription to the underlying stream.</p>
<ul>
<li>observeOn</li>
</ul>
<p><code>public observeOn(scheduler: *, delay: *): Observable&lt;R&gt;</code></p>
<ul>
<li>pairwise</li>
</ul>
<p><code>public pairwise(): Observable&lt;Array&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/pairwise.png" alt=""></p>
<p>Groups pairs of consecutive emissions together and emits them as an array of two values.</p>
<blockquote>
<p>Puts the current value and previous value together as an array, and emits that.</p>
</blockquote>
<ul>
<li>partition</li>
</ul>
<p>`public partition(predicate: function(value: T, index: number): Boolean, thisArg: this): [Observable<t>, Observable<t>]</t></t></p>
<p><img src="http://reactivex.io/rxjs/img/partition.png" alt=""></p>
<p>Splits the source Observable into two, one with values that satisfy a predicate, and another values that don’t satisfy the predicate.</p>
<blockquote>
<p>It’s like filter, but returns two Observable, one like the output of filter, and the other with values that did not pass the condition.</p>
</blockquote>
<ul>
<li>pluck</li>
</ul>
<p><code>public pluck(properties: ...string): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/pluck.png" alt=""></p>
<p>Maps each source value (an object) to its specified nested property</p>
<blockquote>
<p>Like map, but meant only for picking on eof the nested properties of every emitted object.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> clicks$ = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line">clicks$.pluck(<span class="hljs-string">'target'</span>, <span class="hljs-string">'tagName'</span>)</div></pre></td></tr></table></figure>
<ul>
<li>publish</li>
</ul>
<p><code>public publish(selector: Function): *</code></p>
<p>Returns a ConnectableObservable, which is a variety of Observable that waits until connect method is called before it begins emitting items to those Observers that have subscribed to it.</p>
<ul>
<li><p>publishBehavior</p>
</li>
<li><p>publishLast</p>
</li>
<li><p>publishReplay</p>
</li>
<li><p>race</p>
</li>
</ul>
<p><code>public race(...observables): Observable</code></p>
<p>Returns an Observable that mirrors the first source Observable to emit an item from the combination of this Observable and supplied Observables.</p>
<ul>
<li>reduce</li>
</ul>
<p><code>public reduce(accumulator: function(acc: R, value: T, index: number): R, seed: R): Observable&lt;R&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/reduce.png" alt=""></p>
<ul>
<li>repeat</li>
</ul>
<p><code>public repeat(count: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/repeat.png" alt=""></p>
<ul>
<li>repeatWhen</li>
</ul>
<p><code>public repeatWhen(notifier: functioN(notification: Observable): Observable): Observable</code></p>
<p>1<a href="http://reactivex.io/rxjs/img/repeatWhen.png" target="_blank" rel="noopener"></a></p>
<ul>
<li>retry</li>
</ul>
<p><code>public retry(count: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/retry.png" alt=""></p>
<p>Returns an Observable that mirrors the source Observable with the exception of an <code>error</code>, if the source Observable calls <code>error</code>, this method will resubscribe to the source Observable for a maximum of <code>count</code> resubscriptions rather than propagating the <code>error</code> call.</p>
<ul>
<li>retryWhen</li>
</ul>
<p><code>public retryWhen(notifier: function(errors: Observable): Observable): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/retryWhen.png" alt=""></p>
<ul>
<li>sample</li>
</ul>
<p><code>public sample(notifier: Observable&lt;any&gt;): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/sample.png" alt=""></p>
<p>Emits the most recently emitted value from the source Observable whenever another Observable, the <code>notifier</code> emits.</p>
<blockquote>
<p>It’s like sampleTime, but sampels whenever the notifier Observable emits.</p>
</blockquote>
<ul>
<li>sampleTime</li>
</ul>
<p><code>public sampleTime(period: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/sampleTime.png" alt=""></p>
<ul>
<li>scan</li>
</ul>
<p><code>public scan(accumulate: function(acc: R, value: T, index: number): R, seed: T|R): Observable&lt;R&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/scan.png" alt=""></p>
<p>Applies an accumulator function over the source Observable, and returns each intermediate result, with an optional seed value.</p>
<blockquote>
<p>It’s like reduce, but emits the current accumulation whenever the source emits a value</p>
</blockquote>
<ul>
<li>sequenceEqual(compareTo: Observbale, comparor: function): Observable`</li>
</ul>
<p><img src="http://reactivex.io/rxjs/img/sequenceEqual.png" alt=""></p>
<p>Compares all values of two observbales in sequence using an optional comparor function and returns an observable of a single boolean value representing whether or not the two sequences are equal.</p>
<blockquote>
<p>Checks to see of all values emitted by both observables are equal in order.</p>
</blockquote>
<ul>
<li>share</li>
</ul>
<p><code>public share(): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/share.png" alt=""></p>
<p>Returns a new Observable that multicasts (shares) the original Observable. As long as there is at least one Subscriber this Observable will be subscribed and emitting data. When all subscribers have unsubscribed it will unsubscribe from the source Observable. Because the Observable is multicasting it makes the stream hot. This is an alias for .publish().refCount().</p>
<ul>
<li>single</li>
</ul>
<p><code>public single(predicate: Function): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/single.png" alt=""></p>
<ul>
<li>skip</li>
</ul>
<p><code>public skip(count: number): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/skip.png" alt=""></p>
<ul>
<li>skipUntil</li>
</ul>
<p><code>public skipUntil(notifier: Observable): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/skipUntil.png" alt=""></p>
<p>Returns an Observable that skips items emitted by the source Observable until a second Observable emits an item.</p>
<ul>
<li>skipWhile</li>
</ul>
<p><code>public skipWhile(predicate: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/skipWhile.png" alt=""></p>
<p>Returns an Observable that skips all items emitted by the source Observable as long as a specified condition holds true, but emits all further source items as soon as the condition becomes false.</p>
<ul>
<li>startWith</li>
</ul>
<p><code>public startWith(values: ...T, scheduler: Scheduler): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/startWith.png" alt=""></p>
<p>Returns an Observable that emits the items you specified before it begins to emit items by the source Observable.</p>
<ul>
<li>subscribeOn</li>
</ul>
<p><code>public subscribeOn(scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/subscribeOn.png" alt=""></p>
<p>Asynchornously subscribes Observables to this Observable on the specified Scheduler.</p>
<ul>
<li>switch</li>
</ul>
<p><code>public switch(): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/switch.png" alt=""></p>
<p>Converts a higher-order Observable into a first-order Observable by subscribing to only the most recently emitted of those inner Observables.</p>
<blockquote>
<p>Flatten an Observable-of-Observables by dropping the previous inner Obsevable once a new one appears.</p>
</blockquote>
<ul>
<li>switchMap</li>
</ul>
<p><code>public switchMap(project: function(value: T, ?index: number): ObservableInput, resultSelector: function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/switchMap.png" alt=""></p>
<p>Projects each source value to an Observable which is merged in the output Observable, emitting values only from the most recent projected Observable.</p>
<blockquote>
<p>Map each value to an Observable, then flatten all of these Observable using switch.</p>
</blockquote>
<ul>
<li>take</li>
</ul>
<p><code>public take(count: number): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/take.png" alt=""></p>
<p>Emits only the first <code>count</code> values emitted by the source Observable.</p>
<blockquote>
<p>Take the first count value from the source, then complete.</p>
</blockquote>
<ul>
<li>takeLast</li>
</ul>
<p><code>takeLast(count: number): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/takeLast.png" alt=""></p>
<p>Emits only the last <code>count</code> values emitted by the source Observable.</p>
<blockquote>
<p>Remembers the latest count values, then emits those only when the source completes.</p>
</blockquote>
<ul>
<li>takeUntil</li>
</ul>
<p><code>public takeUntil(notifier: Observable): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/takeUntil.png" alt=""></p>
<p>Emits the values emitted by the source Observable until a <code>notifier</code> Observable emits a value.</p>
<blockquote>
<p>Let values pass until a second Observable, notifier, emits something. Then, it completes.</p>
</blockquote>
<ul>
<li>takeWhile</li>
</ul>
<p><code>public takeWhile(predicate: function(value: T, index: number): boolean): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/takeWhile.png" alt=""></p>
<p>Emits values emitted by the source Observable so long as each value satisfies the given <code>predicate</code>, and then completes as soon as this <code>predicate</code> is not satisfied.</p>
<blockquote>
<p>Take values from the source only while they pass the condition given, when the first value does not satisfy, it completes.</p>
</blockquote>
<ul>
<li>throttle</li>
</ul>
<p><code>public throttle(durationSelector: function(value: T): SubscribableOrPromise): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/throttle.png" alt=""></p>
<p>Emits a value from the source Observable, then ignores subsequent source values for a duration determined by another Observable, then repeats this process.</p>
<blockquote>
<p>It’s like throttleTime, but the silencing duration is determined by a second Observable.</p>
</blockquote>
<p>Cannot emit more than one values until the second Observable emits a value.</p>
<ul>
<li>throttleTime</li>
</ul>
<p><code>public throttleTime(duration: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/throttleTime.png" alt=""></p>
<p>Emits a value from the source Observable, then ignores subsequent source values for <code>duration</code> milliseconds, then repeats this process.</p>
<blockquote>
<p>Lets a value pass, then ignores source values for the next duration milliseconds.</p>
</blockquote>
<ul>
<li>timeInterval</li>
</ul>
<p><code>public timeInterval(scheduler: *): Observable&lt;TimeInterval&lt;any&gt;&gt;</code></p>
<ul>
<li>timeout</li>
</ul>
<p><code>public timeout(due: number, scheduler: Scheduler): Observable&lt;T&gt;</code></p>
<ul>
<li>timeoutWith</li>
</ul>
<p><code>public timeoutWith(due: *, withObservable: *, scheduler: Scheduler): Observable&lt;R&gt;</code></p>
<ul>
<li>timestamp</li>
</ul>
<p><code>public timestamp(scheduler: *): Observable&lt;Timestamp&lt;&gt;&gt;any</code></p>
<ul>
<li>toArray</li>
</ul>
<p><code>public toArray(): Observable&lt;any[]&gt;</code></p>
<ul>
<li>toPromise</li>
</ul>
<p><code>public toPromise(PromiseCtor: *): Promise&lt;T&gt;</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Rx.Observable.of(<span class="hljs-number">42</span>).toPromise().then(<span class="hljs-built_in">console</span>.log)</div></pre></td></tr></table></figure>
<ul>
<li>window</li>
</ul>
<p><code>public window(windowBoundaries: Observable&lt;any&gt;): Observable&lt;Observable&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/window.png" alt=""></p>
<p>Branch out the source Observable values as a nested Observable whenever <code>windowBoundaries</code> emits.</p>
<blockquote>
<p>It’s like buffer, but emits a nested Observable instead of an array.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">let</span> clicks = Rx.Observable.fromEvent(<span class="hljs-built_in">document</span>, <span class="hljs-string">'click'</span>)</div><div class="line"><span class="hljs-keyword">let</span> interval = Rx.Observable.interval(<span class="hljs-number">1000</span>)</div><div class="line">clicks.window(interval)</div></pre></td></tr></table></figure>
<ul>
<li>windowCount</li>
</ul>
<p><code>public windowCount(windowSize: number, startWindowEvery: number): Observable&lt;Observable&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/windowCount.png" alt=""></p>
<p>Branch out the source Observable values as a nested Observable with each nested Observable emitting at most <code>windowSize</code> values.</p>
<blockquote>
<p>It’s like bufferCount, but emits a nested Observable instead of an array.</p>
</blockquote>
<ul>
<li>windowToggle</li>
</ul>
<p><code>public windowToggle(openings: Observable&lt;O&gt;, closingSelectors: function(value: O): Observable): Observable&lt;Observable&lt;T&gt;&gt;</code></p>
<p><img src="http://reactivex.io/rxjs/img/windowToggle.png" alt=""></p>
<p>Branch out the source Observable values as a nested Observable starting from an emission from <code>openings</code> and ending when the output of <code>closingSelector</code></p>
<ul>
<li>windowWhen(closingSelector: function(): Observable): Observable<observable<t>&gt;`</observable<t></li>
</ul>
<p>Branch out the source Observable values as a nested Observable using a factory function of closing Observables to determine when to start a new window.</p>
<blockquote>
<p>It’s like bufferWhen, but emits a nested Observable instead of an array.</p>
</blockquote>
<ul>
<li>withLatestFrom</li>
</ul>
<p><code>public withLatestFrom(other: ObservableInput, project: Function): Observable</code></p>
<p><img src="http://reactivex.io/rxjs/img/withLatestFrom.png" alt=""></p>
<p>Combines the source Observable with other Observables to create an Observable whose values are calculated from the latest values of each, only when the source emit.</p>
<blockquote>
<p>Whenever the source Observable emits a value, it computes a formula using that value plus the latest values from other input Observables, then emits the output of that formula.</p>
</blockquote>
<ul>
<li>zipAll</li>
</ul>
<p><code>public zipAll(project: *): Observable&lt;R&gt;</code></p>
<ul>
<li>zipProto</li>
</ul>
<p><code>public zipProto(observables: *): Observable&lt;R&gt;</code></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-25T02:49:47.000Z">2017-09-25</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 454 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/25/HTTP-Timings-in-Node-js/">HTTP Timings in Node.js</a>
            
        </h1>
        <div class="content">
            <p><a href="https://blog.risingstack.com/measuring-http-timings-node-js/" target="_blank" rel="noopener">Original</a></p>
<h3 id="Some-Basic-Concepts"><a href="#Some-Basic-Concepts" class="headerlink" title="Some Basic Concepts:"></a>Some Basic Concepts:</h3><ul>
<li><p>IP(Internet Protocol): IP is a network-layer protocol, deals with network addressing and routing. IP is responsible for delivering packets from the source host to the destination host based on the packet headers across one or more IP network. It also defines packet structures that encapsulate the data to be delivered.</p>
</li>
<li><p>DNS(Domain Name Server): DNS is a hierarchical decentralized naming system used to resolve human-readable hostnames into machine-readable IP address.</p>
</li>
<li><p>TCP(Transmission Control Protocol): The TCP standard defines how to establish and maintain a network conversation between applications to exchange data. TCP provides reliable, ordered, and error-checked deliver of a stream of octects between applications running on hosts communicating over an IP network. An HTTP client initiates a request by establishing a TCP connection.</p>
</li>
<li><p>SSL(Secure Sockets Layer)/TLS(Transport Layer Security): TLS is a cryptographic protocol that provides communications security over a computer network. SSL is a deprecated predecessor to TLS. Both TLS and SSL use certificates to establish a secure connection. SSL certificates are not dependent on cryptographic protocols like TLS, a certificate contains a key pair: a public and a private key.</p>
</li>
</ul>
<p><img src="https://blog-assets.risingstack.com/2017/09/http-timing-nodejs.png" alt=""></p>
<p>Timings Explained:</p>
<ul>
<li><p>DNS Lookup: Time spent performing the DNS Lookup. DNS lookup resolves domain names to IP addresses.</p>
</li>
<li><p>TCP Connection: Time it took to establish TCP Connection between a source host and destination host. Connections must be properly established in a multi-step handshake process.</p>
</li>
<li><p>TLS handshake: Time spent completing a TLS handshake. During the handshake process endpoints exchange authentication and keys to establish or resume secure sessions. There is no TLS handshake with a not HTTPS request.</p>
</li>
<li><p>Time To First Byte(TTFB): Time spent waiting for the initial response. This time captures the latency of a round trip to the server in addition to the time spent waiting for the server to process the request and deliver the response.</p>
</li>
<li><p>Content Transfer: Time spent receiving the response data. The size of the response data and the available network bandwidth determinates its duration.</p>
</li>
</ul>
<h3 id="Measuring-HTTP-timings-in-Node-js"><a href="#Measuring-HTTP-timings-in-Node-js" class="headerlink" title="Measuring HTTP timings in Node.js"></a>Measuring HTTP timings in Node.js</h3><p>To measure HTTP timings in Node.js, we need to subscribe to a specific request, response and socket events. Here is a short code snippet how to do this.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">const timings = &#123;</div><div class="line">  startAt: process.hrtime(),</div><div class="line">  dnsLookupAt: undefined,</div><div class="line">  tcpConnectionAt: undefined,</div><div class="line">  tlsHandshakeAt: undefined,</div><div class="line">  firstByteAt: undefined,</div><div class="line">  endAt: undefined,</div><div class="line">&#125;</div><div class="line"></div><div class="line">const req = http.request(&#123;...&#125;, (res) =&gt; &#123;</div><div class="line">  res.once('readable', () =&gt; &#123;</div><div class="line">    timings.firstByteAt = process.hrtime()</div><div class="line">  &#125;)</div><div class="line">  res.on('data', (chunk) =&gt; &#123;</div><div class="line">    responseBody += chunk</div><div class="line">  &#125;)</div><div class="line">  res.on('end', () =&gt; &#123;</div><div class="line">    timings.endAt = process.hrtime()</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">req.on('socket', (socket) =&gt; &#123;</div><div class="line">  socket.on('lookup', () =&gt; &#123;</div><div class="line">    timings.dnsLookupAt = process.hrtime()</div><div class="line">  &#125;)</div><div class="line">  socket.('connect', () =&gt; &#123;</div><div class="line">    timings.tcpConnectionAt = process.hrtime()</div><div class="line">  &#125;)</div><div class="line">  socket.on('secureConnect, () =&gt; &#123;</div><div class="line">    timings.tlsHandshake = process.hrtime()</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-15T09:42:37.000Z">2017-09-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 657 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/15/graphql-koa-starter/">Graphql-Koa-Starter</a>
            
        </h1>
        <div class="content">
            <h3 id="Init-Project"><a href="#Init-Project" class="headerlink" title="Init Project"></a>Init Project</h3><h3 id="Add-tsconfig"><a href="#Add-tsconfig" class="headerlink" title="Add tsconfig"></a>Add tsconfig</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// tsconfig.json</span></div><div class="line">&#123;</div><div class="line">  <span class="hljs-string">"files"</span>: [</div><div class="line">    <span class="hljs-string">"server.ts"</span></div><div class="line">  ],</div><div class="line">  <span class="hljs-string">"compilerOptions"</span>: &#123;</div><div class="line">    <span class="hljs-string">"outDir"</span>: <span class="hljs-string">"./build"</span>,</div><div class="line">    <span class="hljs-string">"target"</span>: <span class="hljs-string">"es2015"</span>,</div><div class="line">    <span class="hljs-string">"module"</span>: <span class="hljs-string">"commonjs"</span>,</div><div class="line">    <span class="hljs-string">"moduleResolution"</span>: <span class="hljs-string">"Node"</span>,</div><div class="line">    <span class="hljs-string">"sourceMap"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"pretty"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"strictNullChecks"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"lib"</span>: [</div><div class="line">      <span class="hljs-string">"esnext"</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-string">"exclude"</span>: [</div><div class="line">    <span class="hljs-string">"node_modules"</span>,</div><div class="line">    <span class="hljs-string">"build"</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Add-tslint"><a href="#Add-tslint" class="headerlink" title="Add tslint"></a>Add tslint</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// tslint.json</span></div><div class="line">&#123;</div><div class="line">  <span class="hljs-string">"rules"</span>: &#123;</div><div class="line">    <span class="hljs-string">"align"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"parameters"</span>,</div><div class="line">      <span class="hljs-string">"arguments"</span>,</div><div class="line">      <span class="hljs-string">"statements"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"ban"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"class-name"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"curly"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"eofline"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"forin"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"indent"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"spaces"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"interface-name"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"jsdoc-format"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"label-position"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"max-line-length"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-number">140</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"member-access"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"member-ordering"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"public-before-private"</span>,</div><div class="line">      <span class="hljs-string">"static-before-instance"</span>,</div><div class="line">      <span class="hljs-string">"variables-before-functions"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"no-any"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"no-arg"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-bitwise"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-conditional-assignment"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-console"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"debug"</span>,</div><div class="line">      <span class="hljs-string">"info"</span>,</div><div class="line">      <span class="hljs-string">"time"</span>,</div><div class="line">      <span class="hljs-string">"timeEnd"</span>,</div><div class="line">      <span class="hljs-string">"trace"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"no-construct"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-debugger"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-shadowed-variable"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-duplicate-variable"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-empty"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"no-eval"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-inferrable-types"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"no-internal-module"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-require-imports"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-string-literal"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"no-switch-case-fall-through"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-trailing-whitespace"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"no-var-keyword"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"no-var-requires"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"one-line"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"check-open-brace"</span>,</div><div class="line">      <span class="hljs-string">"check-catch"</span>,</div><div class="line">      <span class="hljs-string">"check-else"</span>,</div><div class="line">      <span class="hljs-string">"check-whitespace"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"quotemark"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"single"</span>,</div><div class="line">      <span class="hljs-string">"jsx-single"</span>,</div><div class="line">      <span class="hljs-string">"avoid-escape"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"radix"</span>: <span class="hljs-literal">true</span>,</div><div class="line">    <span class="hljs-string">"semicolon"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"switch-default"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"triple-equals"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"allow-null-check"</span></div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"typedef"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"typedef-whitespace"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      &#123;</div><div class="line">        <span class="hljs-string">"call-signature"</span>: <span class="hljs-string">"nospace"</span>,</div><div class="line">        <span class="hljs-string">"index-signature"</span>: <span class="hljs-string">"nospace"</span>,</div><div class="line">        <span class="hljs-string">"parameter"</span>: <span class="hljs-string">"nospace"</span>,</div><div class="line">        <span class="hljs-string">"property-declaration"</span>: <span class="hljs-string">"nospace"</span>,</div><div class="line">        <span class="hljs-string">"variable-declaration"</span>: <span class="hljs-string">"nospace"</span></div><div class="line">      &#125;</div><div class="line">    ],</div><div class="line">    <span class="hljs-string">"variable-name"</span>: <span class="hljs-literal">false</span>,</div><div class="line">    <span class="hljs-string">"whitespace"</span>: [</div><div class="line">      <span class="hljs-literal">true</span>,</div><div class="line">      <span class="hljs-string">"check-branch"</span>,</div><div class="line">      <span class="hljs-string">"check-decl"</span>,</div><div class="line">      <span class="hljs-string">"check-operator"</span>,</div><div class="line">      <span class="hljs-string">"check-separator"</span>,</div><div class="line">      <span class="hljs-string">"check-type"</span></div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Add-env"><a href="#Add-env" class="headerlink" title="Add env"></a>Add env</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// env.ts</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> envalid <span class="hljs-keyword">from</span> <span class="hljs-string">'envalid'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> &#123; url, bool, str &#125; = envalid</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> env = envalid.cleanEnv(process.env, &#123;</div><div class="line">  SERVICE_URI: str(&#123; <span class="hljs-keyword">default</span>: <span class="hljs-string">'https://reqres.in/api'</span> &#125;),</div><div class="line">  NODE_ENV: str(&#123; devDefault: <span class="hljs-string">'development'</span>, <span class="hljs-keyword">default</span>: <span class="hljs-string">'production'</span> &#125;),</div><div class="line">  LOG_LEVEL: str(&#123; <span class="hljs-keyword">default</span>: <span class="hljs-string">'info'</span> &#125;),</div><div class="line">  CORS: bool(&#123; devDefault: <span class="hljs-literal">true</span>, <span class="hljs-keyword">default</span>: <span class="hljs-literal">false</span> &#125;),</div><div class="line">  GRAPHIQL: bool(&#123; devDefault: <span class="hljs-literal">true</span>, <span class="hljs-keyword">default</span>: <span class="hljs-literal">true</span> &#125;),</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> env</div></pre></td></tr></table></figure>
<h3 id="Add-Nodemon"><a href="#Add-Nodemon" class="headerlink" title="Add Nodemon"></a>Add Nodemon</h3><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="hljs-attr">"watch"</span>: [<span class="hljs-string">"src"</span>],</div><div class="line">  <span class="hljs-attr">"ext"</span>: <span class="hljs-string">"ts"</span>,</div><div class="line">  <span class="hljs-attr">"ignore"</span>: [<span class="hljs-string">"src/**/*.spec.ts"</span>],</div><div class="line">  <span class="hljs-attr">"exec"</span>: <span class="hljs-string">"ts-node ./server.ts"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Create-Koa-APP"><a href="#Create-Koa-APP" class="headerlink" title="Create Koa APP"></a>Create Koa APP</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// src/app.ts</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Koa <span class="hljs-keyword">from</span> <span class="hljs-string">'koa'</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-cors'</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> convert <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-convert'</span></div><div class="line"><span class="hljs-keyword">import</span> &#123; apiRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./routers'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</div><div class="line"></div><div class="line"><span class="hljs-keyword">if</span> (process.env.CORS) &#123;</div><div class="line">  app.use(convert(cors()))</div><div class="line">&#125;</div><div class="line"></div><div class="line">app.use(apiRouter.routes()).use(apiRouter.allowedMethods())</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> app</div></pre></td></tr></table></figure>
<h3 id="Server-Startup"><a href="#Server-Startup" class="headerlink" title="Server Startup"></a>Server Startup</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// server.ts</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> chalk <span class="hljs-keyword">from</span> <span class="hljs-string">'chalk'</span></div><div class="line"><span class="hljs-keyword">import</span> env <span class="hljs-keyword">from</span> <span class="hljs-string">'./env'</span></div><div class="line">process.env = env</div><div class="line"><span class="hljs-keyword">import</span> app <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/app'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> port = process.env.PORT || <span class="hljs-number">3001</span></div><div class="line"></div><div class="line">app.listen(port, <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">'development'</span>) &#123;</div><div class="line">    <span class="hljs-keyword">if</span> (process.env.GRAPHIQL) &#123;</div><div class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'The GraphiQL App is running at: '</span>)</div><div class="line">      <span class="hljs-built_in">console</span>.log(chalk.cyan(<span class="hljs-string">`http://localhost:<span class="hljs-subst">$&#123;port&#125;</span>/api/graphiql`</span>))</div><div class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Koa app is running at: '</span>)</div><div class="line">      <span class="hljs-built_in">console</span>.log(chalk.cyan(<span class="hljs-string">`http://localhost:<span class="hljs-subst">$&#123;port&#125;</span>`</span>))</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Koa App is running'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Add-Router"><a href="#Add-Router" class="headerlink" title="Add Router"></a>Add Router</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// ./src/routers/graphql.ts</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Router <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-router'</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> GraphQLHttp <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-graphql'</span></div><div class="line"><span class="hljs-keyword">import</span> schema <span class="hljs-keyword">from</span> <span class="hljs-string">'../graphql/schema'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> Router()</div><div class="line"><span class="hljs-comment">// console.log(process.env)</span></div><div class="line"></div><div class="line"><span class="hljs-built_in">console</span>.log(process.env)</div><div class="line">router.all(<span class="hljs-string">'/'</span>, GraphQLHttp(&#123;</div><div class="line">  schema,</div><div class="line">  graphiql: process.env.GRAPHIQL,</div><div class="line">  pretty: <span class="hljs-literal">true</span>,</div><div class="line">  errorFormat: <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;</div><div class="line">    <span class="hljs-keyword">const</span> &#123; message, locations, path, stack &#125; = error</div><div class="line">    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`GraphQL Error: `</span>, &#123;</div><div class="line">      message,</div><div class="line">      locations,</div><div class="line">      path,</div><div class="line">      stack,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;))</div><div class="line"></div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router</div></pre></td></tr></table></figure>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// ./src/routers/index.ts</span></div><div class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Router <span class="hljs-keyword">from</span> <span class="hljs-string">'koa-router'</span></div><div class="line"><span class="hljs-keyword">import</span> graphQLRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'./graphql'</span></div><div class="line"><span class="hljs-keyword">import</span> testRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'./test'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> apiRouter = <span class="hljs-keyword">new</span> Router(&#123;</div><div class="line">  prefix: <span class="hljs-string">'/api'</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">apiRouter.use(<span class="hljs-string">'/graphql'</span>, graphQLRouter.routes(), graphQLRouter.allowedMethods())</div><div class="line">apiRouter.use(<span class="hljs-string">'/test'</span>, testRouter.routes(), testRouter.allowedMethods())</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> &#123;</div><div class="line">  apiRouter</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Config-Graphql"><a href="#Config-Graphql" class="headerlink" title="Config Graphql"></a>Config Graphql</h3><figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// ./src/graphql/model.ts</span></div><div class="line"><span class="hljs-keyword">import</span> &#123;</div><div class="line">  GraphQLObjectType,</div><div class="line">  GraphQLString,</div><div class="line">  GraphQLNonNull,</div><div class="line">&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> User = <span class="hljs-keyword">new</span> GraphQLObjectType(&#123;</div><div class="line">  name: <span class="hljs-string">'User'</span>,</div><div class="line">  description: <span class="hljs-string">'A User'</span>,</div><div class="line">  fields: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;</div><div class="line">    id: &#123;</div><div class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLNonNull(GraphQLString),</div><div class="line">      resolve: <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id,</div><div class="line">    &#125;,</div><div class="line">    firstName: &#123;</div><div class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLNonNull(GraphQLString),</div><div class="line">      resolve: <span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.first_name</div><div class="line">    &#125;,</div><div class="line">    lastName: &#123;</div><div class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLNonNull(GraphQLString),</div><div class="line">      resolve: <span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.last_name</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> &#123;</div><div class="line">  User</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// ./src/graphql/query.ts</span></div><div class="line"><span class="hljs-keyword">import</span> &#123; GraphQLObjectType, GraphQLList &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql'</span></div><div class="line"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span></div><div class="line"><span class="hljs-keyword">import</span> &#123; User &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./model'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> GraphQLObjectType(&#123;</div><div class="line">  name: <span class="hljs-string">'Query'</span>,</div><div class="line">  description: <span class="hljs-string">'Query of GraphQL'</span>,</div><div class="line">  fields: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;</div><div class="line">    users: &#123;</div><div class="line">      <span class="hljs-keyword">type</span>: <span class="hljs-keyword">new</span> GraphQLList(User),</div><div class="line">      resolve: <span class="hljs-function">(<span class="hljs-params">root, args</span>) =&gt;</span> &#123;</div><div class="line">        <span class="hljs-keyword">return</span> axios(&#123;</div><div class="line">          url: <span class="hljs-string">'https://reqres.in/api/users'</span>,</div><div class="line">        &#125;).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.data).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.data)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// ./src/graphql/schema.ts</span></div><div class="line"><span class="hljs-keyword">import</span> &#123; GraphQLSchema &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql'</span></div><div class="line"><span class="hljs-keyword">import</span> query <span class="hljs-keyword">from</span> <span class="hljs-string">'./query'</span></div><div class="line"></div><div class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> GraphQLSchema(&#123;</div><div class="line">  query</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-15T02:09:26.000Z">2017-09-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 226 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/15/tag-picture-in-html/">Tag Picture in Html</a>
            
        </h1>
        <div class="content">
            <p>The <code>picture</code> element is a markup pattern that allows developers to declare multiple sources for an image.</p>
<p>This markup is a container used to specify multiple <code>&lt;source&gt;</code> elements for a specific <code>&lt;img&gt;</code> contained in it.</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span></div><div class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 40em)"</span></span></div><div class="line">    <span class="hljs-attr">srcset</span>=<span class="hljs-string">"big.jpg 1x, big-hd.jgp 2x"</span>&gt;</div><div class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">source</span></span></div><div class="line">    <span class="hljs-attr">srcset</span>=<span class="hljs-string">"small.jpg 1x, small-hd.jpg 2x"</span>&gt;</div><div class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"fallback.jpg"</span>&gt;</span></div><div class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="Use-the-media-attribute"><a href="#Use-the-media-attribute" class="headerlink" title="Use the media attribute"></a>Use the <code>media</code> attribute</h3><p>The <code>media</code> attribute lets you specify a media query that the user agent will evaluates to select a <code>&lt;source&gt;</code> element. If the media query evaluates to <code>false</code>, the <code>&lt;source&gt;</code> element is skipped.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;picture&gt;</div><div class="line">  <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"logo-wide.jpg"</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 600px)"</span>&gt;</span></span></div><div class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"logo-narrow.jpg"</span>&gt;</span></div><div class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span></div></pre></td></tr></table></figure>
<p>The <code>srcset</code> and <code>sizes</code> attributes extend the <code>img</code> and <code>source</code> elements to provide a list of available image sources and their sizes. Browsers can then use this information to pick the best image source.</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"elva-fairy-320w.jpg 320w,</span></span></div><div class="line">    elva-fairy-480w.jpg 480w,</div><div class="line">    elva-fairy-800w.jpg 800w"</div><div class="line">  <span class="hljs-attr">sizes</span>=<span class="hljs-string">"(max-width: 320px) 280px,</span></div><div class="line">    (max-width: 480px) 440px,</div><div class="line">    800px"</div><div class="line">  <span class="hljs-attr">src</span>=<span class="hljs-string">"elva-fairy-800w.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Elva dressed as a fairy"</span>&gt;</div></pre></td></tr></table></figure>
<p><code>srcset</code> defines the set of images we will allow the browser to choose between, and what size each image is.</p>
<p>Before each comma, we write:</p>
<ul>
<li><p>An <strong>Image filename</strong> (elva-fair-320w.jpg)</p>
</li>
<li><p>A space</p>
</li>
<li><p>The image’s inherit width in pixels(480w) – note that this issue the <code>w</code> unit, not <code>px</code> as you might expect.</p>
</li>
</ul>
<p><code>sizes</code> defines a set of media conditions(e.g. screen widths) and indicates what image size would be best to choose, when certain media conditions are true.</p>
<p>Before each comma, we write:</p>
<ul>
<li><p>A <strong>media condition</strong>(max-width: 480px) – when the viewport width is 480 px or less</p>
</li>
<li><p>A space</p>
</li>
<li><p>The <strong>width of the slot</strong> the image will fill when the media condition is true(440px)</p>
</li>
</ul>
<h3 id="Resolution-switching"><a href="#Resolution-switching" class="headerlink" title="Resolution switching"></a>Resolution switching</h3><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-tag">&lt;<span class="hljs-name">img</span></span></div><div class="line">  <span class="hljs-attr">srcset</span>=<span class="hljs-string">"elva-fairy-320w,jpg,</span></div><div class="line">          elva-fairy-480w.jpg 1.5x,</div><div class="line">          elva-fairy-640w.jpg 2x"</div><div class="line">  <span class="hljs-attr">src</span>=<span class="hljs-string">"elva-fairy-640w.jpg"</span></div><div class="line">  <span class="hljs-attr">alt</span>=<span class="hljs-string">"elva-fairy"</span></div><div class="line">&gt;</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-13T10:32:58.000Z">2017-09-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 246 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/13/Simple-Example-of-DAPP/">Simple Example of DAPP</a>
            
        </h1>
        <div class="content">
            <h3 id="Use-truffle-to-init-Project"><a href="#Use-truffle-to-init-Project" class="headerlink" title="Use truffle to init Project"></a>Use truffle to init Project</h3><h3 id="Contract-of-Adoption"><a href="#Contract-of-Adoption" class="headerlink" title="Contract of Adoption"></a>Contract of Adoption</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// contracts/Adoption.sol</span></div><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.4</span>;</div><div class="line"></div><div class="line"></div><div class="line">constract Adoption &#123;</div><div class="line">    address[<span class="hljs-number">16</span>] public adopters;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adopt</span> (<span class="hljs-params">uint petId</span>) <span class="hljs-title">public</span> <span class="hljs-title">returns</span> (<span class="hljs-params">uint</span>) </span>&#123;</div><div class="line">        <span class="hljs-built_in">require</span>(petId &gt;= <span class="hljs-number">0</span> &amp;&amp; petId &lt;= <span class="hljs-number">15</span>);</div><div class="line">        adopters[petId] = msg.sender;</div><div class="line">        <span class="hljs-keyword">return</span> petId;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAdopters</span> (<span class="hljs-params"></span>) <span class="hljs-title">public</span> <span class="hljs-title">returns</span> (<span class="hljs-params">addresss[<span class="hljs-number">16</span>]</span>) </span>&#123;</div><div class="line">      <span class="hljs-keyword">return</span> adopters;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// test/TestAdoption.sol</span></div><div class="line">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.4</span>;</div><div class="line"></div><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"truffle/Assert.sol"</span>;</div><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"truffle/DeployedAddress.sol"</span>;</div><div class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"../contracts/Adoption.sol"</span>;</div><div class="line"></div><div class="line"></div><div class="line">contract TestAdoption &#123;</div><div class="line">  Adoption adoption = Adoption(DeployedAddress.Adoption());</div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testUserCanAdoptPet</span> (<span class="hljs-params"></span>) </span>&#123;</div><div class="line">    uint returnedPetId = adoption.adopt(<span class="hljs-number">8</span>);</div><div class="line">    uint expected = <span class="hljs-number">8</span>;</div><div class="line">    Assert.equal(returenedPetId, expected, <span class="hljs-string">"Adoption of Pet Id 8 should be recorded"</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testGetAdopterAddressByPetId</span> (<span class="hljs-params"></span>) </span>&#123;</div><div class="line">    address expected = <span class="hljs-keyword">this</span>;</div><div class="line">    address adopter = adoption.adopters(<span class="hljs-number">8</span>);</div><div class="line">    Assert.equal(adopter, expected, <span class="hljs-string">"Owner of Pet Id 8 should be recorded"</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testGetAdopterAddressByPetIdInArray</span> (<span class="hljs-params"></span>) </span>&#123;</div><div class="line">    address expected = <span class="hljs-keyword">this</span>;</div><div class="line">    address[<span class="hljs-number">16</span>] memory adopters = adoption.getAdopters();</div><div class="line">    Assert(expected, adopters[<span class="hljs-number">8</span>], <span class="hljs-string">"Owner of Pet Id 8 should be recoreded"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a>Compile</h3><h3 id="Migrate"><a href="#Migrate" class="headerlink" title="Migrate"></a>Migrate</h3><h3 id="TestRPC"><a href="#TestRPC" class="headerlink" title="TestRPC"></a>TestRPC</h3><h3 id="MetaMask"><a href="#MetaMask" class="headerlink" title="MetaMask"></a>MetaMask</h3><h3 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h3><h4 id="initWeb3"><a href="#initWeb3" class="headerlink" title="initWeb3"></a>initWeb3</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> web3 !== <span class="hljs-string">'undefined'</span>) &#123;</div><div class="line">  App.web3Provider = web3.currentProvider</div><div class="line">  web3 = <span class="hljs-keyword">new</span> Web3(App.web3Provider)</div><div class="line">&#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">  App.web3Provider = <span class="hljs-keyword">new</span> web3.providers.HttpProvider(<span class="hljs-string">'http://localhost:8545'</span>)</div><div class="line">  web3 = <span class="hljs-keyword">new</span> Web3(App.web3Provider)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="initContract"><a href="#initContract" class="headerlink" title="initContract"></a>initContract</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$.<span class="hljs-built_in">JSON</span>(<span class="hljs-string">'Adoption.json'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">const</span> AdoptionArtifact = data</div><div class="line">  App.contracts.Adoption = TruffleContract(AdoptionArtifact)</div><div class="line">  App.contracts.Adoption.setProvider(App.web3Provider)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Invoke-Contract"><a href="#Invoke-Contract" class="headerlink" title="Invoke Contract"></a>Invoke Contract</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">let</span> adoptionInstance</div><div class="line">App.contracts.Adoption.deployed()</div><div class="line">.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>) </span>&#123;</div><div class="line">  adoptionInstance = instance</div><div class="line">  <span class="hljs-keyword">return</span> adoptionInstance.getAdopters.call()</div><div class="line">&#125;)</div><div class="line">.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">adopters</span>) </span>&#123;</div><div class="line">  <span class="hljs-comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> petId = <span class="hljs-number">8</span></div><div class="line"><span class="hljs-keyword">let</span> adoptionInstance</div><div class="line">web3.eth.getAccounts(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error, accounts</span>) </span>&#123;</div><div class="line">  <span class="hljs-keyword">if</span> (error) &#123;</div><div class="line">    <span class="hljs-built_in">console</span>.error(error.message)</div><div class="line">  &#125;</div><div class="line">  <span class="hljs-keyword">const</span> account = accounts[<span class="hljs-number">0</span>]</div><div class="line">  App.contracts.Adoption.deployed()</div><div class="line">  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>) </span>&#123;</div><div class="line">    adoptionInstance = instance</div><div class="line">    <span class="hljs-keyword">return</span> adoptionInstance.adopt(petId, &#123; <span class="hljs-attr">from</span>: account &#125;)</div><div class="line">  &#125;)</div><div class="line">  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) </span>&#123;</div><div class="line">    <span class="hljs-comment">// ...</span></div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-12T06:10:18.000Z">2017-09-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 861 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/12/options-of-webpack-dll-plugin/">Options of Webpack Dll Plugin</a>
            
        </h1>
        <div class="content">
            <p>The <code>DllPlugin</code> and <code>DllReferencePlugin</code> provide means to split bundles in a way that can drastically improve build time performance.</p>
<h3 id="DllPlugin"><a href="#DllPlugin" class="headerlink" title="DllPlugin"></a>DllPlugin</h3><p>This plugin used in a separate webpack config exclusively to create a <code>dll-only-bundle</code>.</p>
<p>It creates a <code>manifest.json</code> file, which is used by the <code>DllReferencePlugin</code> to map dependencies.</p>
<ul>
<li><p><code>context</code>: (optional), context of requests in the manifest file(default to the webpack context).</p>
</li>
<li><p><code>name</code>: name of the exposed dll function(<code>TemplatePaths</code>: <code>[hash]</code> &amp; <code>[name]</code>)</p>
</li>
<li><p><code>path</code>: <strong>absolute path</strong> to the manifest json file(output)</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">new</span> webpack.DllPlugin(option)</div></pre></td></tr></table></figure>
<p>Creates a <code>manifest.json</code> which is written to the given <strong>absolute</strong> <code>path</code>.</p>
<p>It contains <strong>mappings</strong> from require and import requests, to module ids. It is used by the <code>DllReferencePlugin</code>.</p>
<p><strong>Combine this plugin with <code>output.library</code> option to expose(aka, put into the global scope) the dll function</strong></p>
<blockquote>
<p>output.library expose the name to global scope</p>
<p>DllReferencePlugin.name add the name to the mapping file.</p>
</blockquote>
<p>So it’s important to keep <code>output.library</code> and <code>DllReferencePlugin.name</code> same to set a right mapping.</p>
<h3 id="DllReferencePlugin"><a href="#DllReferencePlugin" class="headerlink" title="DllReferencePlugin"></a>DllReferencePlugin</h3><p>This plugin is used in the primary webpack config, it references the <strong>dll-only-bundle</strong> to require the pre-built dependencies.</p>
<ul>
<li><p><code>context</code>: <strong>absolute path</strong>, context of the requests in the manifest(or content property)</p>
</li>
<li><p><code>manifest</code>: an object containing <code>content</code> and <code>name</code> or a string to the <strong>absolute path</strong> of the JSON manifest to be loaded upon compilation.</p>
</li>
<li><p><code>content</code>: (optional), the mappings from request to module id(default to <code>manifest.content</code>)</p>
</li>
<li><p><code>name</code>: (optional), the name where the dll is exposed (default to <code>manifest.name</code>)</p>
</li>
<li><p><code>scope</code>: (optional), prefix which is used for accessing the content of the dll</p>
</li>
<li><p><code>sourceType</code>: (optional), how the dll is exposed.</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">new</span> webpack.DllReferencePlugin(options)</div></pre></td></tr></table></figure>
<p>References a dll manifest file to map dependencies names to module ids, then requires them as needed using the internal <code>__webpack_require__</code> function.</p>
<blockquote>
<p>Note: Keep the <code>name</code> consistent with <code>output.library</code></p>
</blockquote>
<h3 id="Modes"><a href="#Modes" class="headerlink" title="Modes"></a>Modes</h3><p>This plugin can be used in two different modes, <em>scoped</em> and <em>mapped</em>.</p>
<h4 id="Scoped-Mode"><a href="#Scoped-Mode" class="headerlink" title="Scoped Mode"></a>Scoped Mode</h4><p>The content of the dll is accessible under a module prefix, i.e. with <code>scope = &#39;xyz&#39;</code> a file named <code>abc</code> in the dll can be access via <code>require(xyz/abc)</code>.</p>
<h4 id="Mapped-Mode"><a href="#Mapped-Mode" class="headerlink" title="Mapped Mode"></a>Mapped Mode</h4><p>The content of the dll is mapped to the current directory. If a required file matches a file in the dll(after resolving), then the file from the dll is usd instead.</p>
<p>Because this happens after resolving every file in the dll bundle, the same paths must be available for the consumer of the dll bundle, i.e. if the dll contains <code>lodash</code> and the file <code>abc</code>, <code>require(&#39;lodash&#39;)</code> and <code>require(&#39;./abc&#39;)</code> will be used from the dll, rather than building them into the main bundle.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// webpack.config.dll.js</div><div class="line">new webpack.DllPlugin(&#123;</div><div class="line">  context: __dirname,</div><div class="line">  name: '[name]_[hash]',</div><div class="line">  path: path.join(__dirname', 'manifest.json'),</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// webpack.config.base.js</span></div><div class="line"><span class="hljs-keyword">new</span> webpack.DllReferencePlugin(&#123;</div><div class="line">  <span class="hljs-attr">context</span>: __dirname,</div><div class="line">  <span class="hljs-attr">manifest</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./manifest.json'</span>),</div><div class="line">  <span class="hljs-attr">name</span>: <span class="hljs-string">'./my-dll.js'</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h3><h4 id="Output-library-and-DllPlugin-name"><a href="#Output-library-and-DllPlugin-name" class="headerlink" title="Output.library and DllPlugin.name"></a>Output.library and DllPlugin.name</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-built_in">module</span>.exports = &#123;</div><div class="line">  <span class="hljs-attr">output</span>: &#123;</div><div class="line">    <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'lib'</span>),</div><div class="line">    <span class="hljs-attr">filename</span>: <span class="hljs-string">'[name]_[hash].js'</span>,</div><div class="line">    <span class="hljs-attr">library</span>: <span class="hljs-string">'[name]_[hash]'</span>, <span class="hljs-comment">// this set the exposed function name to [name]_[hash]</span></div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">plugins</span>: [</div><div class="line">    <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;</div><div class="line">      <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'lib'</span>, <span class="hljs-string">'[name]-manifest.json'</span>), <span class="hljs-comment">// put the manifest file in lib directory</span></div><div class="line">      name: <span class="hljs-string">'[name]_[hash]'</span>, <span class="hljs-comment">// be consistent with library name to make the map correct</span></div><div class="line">      context: __dirname,</div><div class="line">    &#125;)</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Context-in-Dev-Config"><a href="#Context-in-Dev-Config" class="headerlink" title="Context in Dev Config"></a>Context in Dev Config</h4><p>Set the DllReferencePlugin.context same as DllPlugin.context so the manifest will bundle and resolve the dll files from the same root directory.</p>
<h4 id="Add-dll-bundle-to-html"><a href="#Add-dll-bundle-to-html" class="headerlink" title="Add dll bundle to html"></a>Add dll bundle to html</h4><p>After bundle the dll, I should insert it betore app.js in the html file to provide the <strong>global</strong> function.</p>
<ul>
<li>Step 1: Copy the dll files to the dist directory</li>
</ul>
<p>I use the <code>copy-webpack-plugin</code> plugin</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// webpack.config.js</span></div><div class="line"><span class="hljs-keyword">new</span> CopyPlugin([</div><div class="line">  &#123; <span class="hljs-keyword">from</span> <span class="hljs-string">'./lib/*.js'</span> &#125; <span class="hljs-comment">// default to output.path, so the dll file will be copied to output.path/lib/*.js</span></div><div class="line">])</div></pre></td></tr></table></figure>
<ul>
<li>Generate a manifest of the dll files for html-webpack-plugin to insert to the template</li>
</ul>
<p>I use the <code>webpack-manifest-plugin</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// webpack.config.dll.js</span></div><div class="line"><span class="hljs-keyword">new</span> ManifestPlugin()</div></pre></td></tr></table></figure>
<p>It will generate the <code>manifest.json</code> in output.path</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="hljs-attr">"vendor.js"</span>: <span class="hljs-string">"vendor_0642aa84a6959d661519.js"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Insert the Manifest into the html</li>
</ul>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//parse the json</div><div class="line">const fs = require('fs)</div><div class="line">const manifest = JSON.parse(fs.readFileSync(require('./lib/manifest.json')))</div><div class="line"></div><div class="line">// insert</div><div class="line">new HtmlPlugin(&#123;</div><div class="line">  //...</div><div class="line">  dll: `./lib/$&#123;manifest['vendor.js']&#125;`, // the dll file locates at ./lib/*.js</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><h3 id="Dll-Config"><a href="#Dll-Config" class="headerlink" title="Dll Config"></a>Dll Config</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</div><div class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</div><div class="line"><span class="hljs-keyword">const</span> ManifestPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-manifest-plugin'</span>)</div><div class="line"></div><div class="line"><span class="hljs-built_in">module</span>.exports = &#123;</div><div class="line">  <span class="hljs-attr">entry</span>: &#123;</div><div class="line">    <span class="hljs-attr">vendor</span>: [<span class="hljs-string">'./src/vendor'</span>],</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">output</span>: &#123;</div><div class="line">    <span class="hljs-attr">filename</span>: <span class="hljs-string">'[name]_[hash].js'</span>,</div><div class="line">    <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'lib'</span>),</div><div class="line">    <span class="hljs-attr">library</span>: <span class="hljs-string">'[name]_[hash]'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">plugins</span>: [</div><div class="line">    <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;</div><div class="line">      <span class="hljs-attr">name</span>: <span class="hljs-string">'[name]_[hash]'</span>,</div><div class="line">      <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'lib'</span>, <span class="hljs-string">'[name]-manifest.json'</span>),</div><div class="line">    &#125;),</div><div class="line">    <span class="hljs-keyword">new</span> ManifestPlugin(),</div><div class="line">  ],</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Dev-Config"><a href="#Dev-Config" class="headerlink" title="Dev Config"></a>Dev Config</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)</div><div class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</div><div class="line"><span class="hljs-keyword">const</span> HtmlPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>)</div><div class="line"><span class="hljs-keyword">const</span> CopyPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'copy-webpack-plugin'</span>)</div><div class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</div><div class="line"></div><div class="line"><span class="hljs-keyword">const</span> manifest = <span class="hljs-built_in">JSON</span>.parse(fs.readFileSync(<span class="hljs-string">'./lib/manifest.json'</span>))</div><div class="line"></div><div class="line"><span class="hljs-built_in">module</span>.exports = &#123;</div><div class="line">  <span class="hljs-attr">entry</span>: &#123;</div><div class="line">    <span class="hljs-attr">app</span>: [<span class="hljs-string">'./src/index'</span>],</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">output</span>: &#123;</div><div class="line">    <span class="hljs-attr">filename</span>: <span class="hljs-string">'scripts/[name].bundle.js'</span>,</div><div class="line">    <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'dist'</span>),</div><div class="line">  &#125;,</div><div class="line">  <span class="hljs-attr">plugins</span>: [</div><div class="line">    <span class="hljs-keyword">new</span> HtmlPlugin(&#123;</div><div class="line">      <span class="hljs-attr">template</span>: path.resolve(__dirname, <span class="hljs-string">'src'</span>, <span class="hljs-string">'templates'</span>, <span class="hljs-string">'index.html'</span>),</div><div class="line">      <span class="hljs-attr">title</span>: <span class="hljs-string">'dev'</span>,</div><div class="line">      <span class="hljs-attr">dll</span>: <span class="hljs-string">`./lib/<span class="hljs-subst">$&#123;manifest[<span class="hljs-string">'vendor.js'</span>]&#125;</span>`</span>,</div><div class="line">    &#125;),</div><div class="line">    <span class="hljs-keyword">new</span> webpack.DllReferencePlugin(&#123;</div><div class="line">      <span class="hljs-attr">context</span>: <span class="hljs-string">'.'</span>,</div><div class="line">      <span class="hljs-attr">manifest</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/vendor-manifest'</span>),</div><div class="line">    &#125;),</div><div class="line">    <span class="hljs-keyword">new</span> CopyPlugin([</div><div class="line">      &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">'./lib/*.js'</span>&#125;</div><div class="line">    ]),</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/4/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><a class="pagination-link is-current" href="/page/3/">3</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/4/">4</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/16/">16</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.jpg" alt="Keith Chen">
                    
                    
                    <p class="is-size-4 is-block">
                        Keith Chen
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        FE Engineer on Blockchain
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>30°17&#39;37N, 120°9&#39;41E</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        311
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        7
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        95
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/keith-CY" target="_blank">
                Follow</a>
        </div>
        
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/keith-CY" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Keith CY</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.linkedin.com/in/宇-陈-644b61ba" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Yu Chen</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.linkedin.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Soup/">
            <span class="level-start">
                <span class="level-item">Soup</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Uncategorized/">
            <span class="level-start">
                <span class="level-item">Uncategorized</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/github/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">141</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/note/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AJAX/" style="font-size: 10.91px;">AJAX</a> <a href="/tags/BOOTSTRAP/" style="font-size: 10px;">BOOTSTRAP</a> <a href="/tags/Bash/" style="font-size: 11.82px;">Bash</a> <a href="/tags/BlockChain/" style="font-size: 10px;">BlockChain</a> <a href="/tags/Blockchain/" style="font-size: 10px;">Blockchain</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/CSS/" style="font-size: 10.91px;">CSS</a> <a href="/tags/CSS3/" style="font-size: 20px;">CSS3</a> <a href="/tags/Chrome-Extensions/" style="font-size: 10px;">Chrome, Extensions</a> <a href="/tags/Closure/" style="font-size: 10px;">Closure</a> <a href="/tags/CommonJS/" style="font-size: 10px;">CommonJS</a> <a href="/tags/Contract-Ethereum-Web3/" style="font-size: 10px;">Contract, Ethereum, Web3</a> <a href="/tags/Contract-Solidity/" style="font-size: 10px;">Contract, Solidity</a> <a href="/tags/D3-Example/" style="font-size: 10px;">D3, Example</a> <a href="/tags/DAPP-Solidity/" style="font-size: 10px;">DAPP, Solidity</a> <a href="/tags/DApp-Solidity/" style="font-size: 10px;">DApp, Solidity</a> <a href="/tags/DOM/" style="font-size: 12.73px;">DOM</a> <a href="/tags/DevTools/" style="font-size: 10px;">DevTools</a> <a href="/tags/Drizzle-Ethereum-BlockChain/" style="font-size: 10px;">Drizzle, Ethereum, BlockChain</a> <a href="/tags/ES6/" style="font-size: 10.91px;">ES6</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/ETH-Wallet/" style="font-size: 10px;">ETH, Wallet</a> <a href="/tags/Economics/" style="font-size: 10px;">Economics</a> <a href="/tags/Elixir-Phoenix-SCSS/" style="font-size: 10px;">Elixir, Phoenix, SCSS</a> <a href="/tags/Erlang-Elixir-GenServer/" style="font-size: 10px;">Erlang, Elixir, GenServer</a> <a href="/tags/Ethereum/" style="font-size: 10px;">Ethereum</a> <a href="/tags/Ethereum-IPFS/" style="font-size: 10px;">Ethereum, IPFS</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/GitHub-Workflow/" style="font-size: 10px;">GitHub, Workflow</a> <a href="/tags/Go-Http-Web/" style="font-size: 10px;">Go, Http, Web</a> <a href="/tags/GraphQL-Apollo-TypeScript/" style="font-size: 10px;">GraphQL, Apollo, TypeScript</a> <a href="/tags/Gulp/" style="font-size: 11.82px;">Gulp</a> <a href="/tags/HTML5/" style="font-size: 15.45px;">HTML5</a> <a href="/tags/HTTP2-Node/" style="font-size: 10px;">HTTP2, Node</a> <a href="/tags/Html-Picture/" style="font-size: 10px;">Html, Picture</a> <a href="/tags/Immutable/" style="font-size: 10px;">Immutable</a> <a href="/tags/Int8Array/" style="font-size: 10px;">Int8Array</a> <a href="/tags/JSON-RPC/" style="font-size: 10px;">JSON-RPC</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Javascript/" style="font-size: 19.09px;">Javascript</a> <a href="/tags/Koa/" style="font-size: 10.91px;">Koa</a> <a href="/tags/Koa-NPM-Package/" style="font-size: 10px;">Koa, NPM, Package</a> <a href="/tags/MDL/" style="font-size: 16.36px;">MDL</a> <a href="/tags/Material-Design/" style="font-size: 17.27px;">Material Design</a> <a href="/tags/Mock-JavaScript/" style="font-size: 10px;">Mock, JavaScript</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/NODE/" style="font-size: 13.64px;">NODE</a> <a href="/tags/NPM/" style="font-size: 10.91px;">NPM</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Nock/" style="font-size: 10px;">Nock</a> <a href="/tags/Node-CLI/" style="font-size: 10.91px;">Node, CLI</a> <a href="/tags/Node-Fastify/" style="font-size: 10.91px;">Node, Fastify</a> <a href="/tags/Node-Graphql-Koa/" style="font-size: 10px;">Node, Graphql, Koa</a> <a href="/tags/Node-js/" style="font-size: 10.91px;">Node.js</a> <a href="/tags/Node-js-Nest-js/" style="font-size: 10px;">Node.js, Nest.js</a> <a href="/tags/Phoenix-Elixir-Ecto/" style="font-size: 10px;">Phoenix, Elixir, Ecto</a> <a href="/tags/Promise/" style="font-size: 11.82px;">Promise</a> <a href="/tags/Protobuf/" style="font-size: 10px;">Protobuf</a> <a href="/tags/Pug-HTML/" style="font-size: 10px;">Pug, HTML</a> <a href="/tags/React/" style="font-size: 18.18px;">React</a> <a href="/tags/React-Docker/" style="font-size: 10px;">React, Docker</a> <a href="/tags/React-Router-Code-splitting/" style="font-size: 10px;">React, Router, Code-splitting</a> <a href="/tags/React-Native/" style="font-size: 10px;">React-Native</a> <a href="/tags/React-Redux/" style="font-size: 10px;">React-Redux</a> <a href="/tags/React-Router/" style="font-size: 10.91px;">React-Router</a> <a href="/tags/Redux/" style="font-size: 14.55px;">Redux</a> <a href="/tags/RegExp/" style="font-size: 10px;">RegExp</a> <a href="/tags/Ruby-Rails/" style="font-size: 10px;">Ruby, Rails</a> <a href="/tags/Ruby-Rails-RoR-Mina/" style="font-size: 10px;">Ruby, Rails, RoR, Mina</a> <a href="/tags/Rust-Rocket/" style="font-size: 10px;">Rust, Rocket</a> <a href="/tags/RxJS/" style="font-size: 10px;">RxJS</a> <a href="/tags/Smart-Contract-Web3/" style="font-size: 10px;">Smart Contract, Web3</a> <a href="/tags/Solidity/" style="font-size: 12.73px;">Solidity</a> <a href="/tags/Solidity-Error-Handling/" style="font-size: 10px;">Solidity, Error Handling</a> <a href="/tags/Solidity-Public-External/" style="font-size: 10px;">Solidity, Public, External</a> <a href="/tags/Solidity-Smart-Contract/" style="font-size: 10px;">Solidity, Smart Contract</a> <a href="/tags/Thunk/" style="font-size: 10.91px;">Thunk</a> <a href="/tags/Trick/" style="font-size: 11.82px;">Trick</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Webpack-DLL/" style="font-size: 10px;">Webpack, DLL</a> <a href="/tags/automatic/" style="font-size: 10px;">automatic</a> <a href="/tags/babel/" style="font-size: 10px;">babel</a> <a href="/tags/babel-polyfill/" style="font-size: 10px;">babel-polyfill</a> <a href="/tags/blockchain-bitcoin-bip/" style="font-size: 10.91px;">blockchain, bitcoin, bip</a> <a href="/tags/commandline/" style="font-size: 10px;">commandline</a> <a href="/tags/github/" style="font-size: 10.91px;">github</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/lecture-yc/" style="font-size: 10px;">lecture, yc</a> <a href="/tags/precache/" style="font-size: 10px;">precache</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/webpack/" style="font-size: 17.27px;">webpack</a> <a href="/tags/webpack2/" style="font-size: 11.82px;">webpack2</a> <a href="/tags/测试/" style="font-size: 11.82px;">测试</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/01/06/crx-config/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Crx-Config">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-05T17:10:11.000Z">2020-01-06</time></div>
                    <a href="/2020/01/06/crx-config/" class="has-link-black-ter is-size-6">Crx-Config</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/12/03/Introduction-to-MACD/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/macd-indicator.png" alt="Introduction to MACD">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-02T17:43:39.000Z">2019-12-03</time></div>
                    <a href="/2019/12/03/Introduction-to-MACD/" class="has-link-black-ter is-size-6">Introduction to MACD</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/10/10/Basic-components-in-nest-js/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/nestjs_components.png" alt="Basic Components in nest.js">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-10-10T06:26:41.000Z">2019-10-10</time></div>
                    <a href="/2019/10/10/Basic-components-in-nest-js/" class="has-link-black-ter is-size-6">Basic Components in nest.js</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/16/Snippet-of-GitHub-Actions/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/github_actions.png" alt="Snippet of GitHub Actions">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-16T07:14:02.000Z">2019-09-16</time></div>
                    <a href="/2019/09/16/Snippet-of-GitHub-Actions/" class="has-link-black-ter is-size-6">Snippet of GitHub Actions</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/30/Methods-of-the-String-in-JavaScript/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Methods of the String in JavaScript ">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-30T06:26:54.000Z">2019-08-30</time></div>
                    <a href="/2019/08/30/Methods-of-the-String-in-JavaScript/" class="has-link-black-ter is-size-6">Methods of the String in JavaScript </a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">December 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">October 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">September 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">August 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">April 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/01/06/crx-config/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Crx-Config">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-05T17:10:11.000Z">2020-01-06</time></div>
                    <a href="/2020/01/06/crx-config/" class="has-link-black-ter is-size-6">Crx-Config</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/12/03/Introduction-to-MACD/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/macd-indicator.png" alt="Introduction to MACD">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-02T17:43:39.000Z">2019-12-03</time></div>
                    <a href="/2019/12/03/Introduction-to-MACD/" class="has-link-black-ter is-size-6">Introduction to MACD</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/10/10/Basic-components-in-nest-js/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/nestjs_components.png" alt="Basic Components in nest.js">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-10-10T06:26:41.000Z">2019-10-10</time></div>
                    <a href="/2019/10/10/Basic-components-in-nest-js/" class="has-link-black-ter is-size-6">Basic Components in nest.js</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/16/Snippet-of-GitHub-Actions/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/github_actions.png" alt="Snippet of GitHub Actions">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-16T07:14:02.000Z">2019-09-16</time></div>
                    <a href="/2019/09/16/Snippet-of-GitHub-Actions/" class="has-link-black-ter is-size-6">Snippet of GitHub Actions</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/30/Methods-of-the-String-in-JavaScript/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Methods of the String in JavaScript ">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-30T06:26:54.000Z">2019-08-30</time></div>
                    <a href="/2019/08/30/Methods-of-the-String-in-JavaScript/" class="has-link-black-ter is-size-6">Methods of the String in JavaScript </a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">December 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">October 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">September 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">August 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">April 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="EzCook" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Chen Yu&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>