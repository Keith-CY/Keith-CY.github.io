<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8">
<title>EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>


    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="EzCook" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-14T02:32:30.000Z">2017-07-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 949 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/14/Tutorial-Part-4-of-Parity/">Tutorial Part 4 of Dapp</a>
            
        </h1>
        <div class="content">
            <h1 id="Calling-Contracts"><a href="#Calling-Contracts" class="headerlink" title="Calling Contracts"></a>Calling Contracts</h1><p>Contract API basically comes in three pieces.</p>
<ul>
<li><p>Firstly, there’s state-changing transaction like tranferring tokens to a counter-party.</p>
</li>
<li><p>Secondly, there’s event reception and reporting that happen when such a state change occurs.</p>
</li>
<li><p>Finally, there is inspection of the contract state through calling <code>constant</code> function.</p>
</li>
</ul>
<h2 id="Our-first-contract"><a href="#Our-first-contract" class="headerlink" title="Our first contract"></a>Our first contract</h2><p>The first contract we will deal with is the global(name) registry. If you are not yet familiar, this is a registry that exists on all sensible blockchain which records fields of information for any desired name.</p>
<p>The registry records onwership information so that names can be registered and their information changed at a later date.</p>
<p>The registry contract has a fairly simple API for inspecting. We only need to worry about two functions:</p>
<ul>
<li><p><code>getOwner(bytes32) -&gt; address</code>, given the Keccak hash of name, this returns the address of its owner, if it has been reserved.</p>
</li>
<li><p><code>getData(bytes32, bytes32) -&gt; bytes32</code>, given the Keccak hash of a name and a second field key, this returns the associated data.</p>
</li>
</ul>
<p>There are subordinate functions to the latter such as <code>getAddress</code> and <code>getUint</code> which coerce the data into some other type. It is important to note that amongst the standardised field keys are:</p>
<ul>
<li><p><code>A</code> the <code>address</code> primarily associated with the name; if you’re wanting to send funds to the name, this is where to send them(assuming it’s not null)</p>
</li>
<li><p><code>CONTENT</code> the <code>bytes32</code> which equals the Keccak hash of any content associated with this name. e.g. If the name represents a dapp, then this would be the hash of the dapp’s content.</p>
</li>
<li><p><code>IMG</code> the <code>bytes32</code> which equals the Keccak hash of an associated image; this might be a person’s avatar or the dapp icon, depending on what is being named.</p>
</li>
</ul>
<p>Let’s begin by displaying the address associated with the name <code>gavofyork</code>. To do this we will need to create a special <code>Bond</code>-API contract object. The function to do this is <code>bonds.makeContract</code>; It takes the address and the ABI of the contract and returns an object with <code>Bond</code> – returning functions for each of the contract’s functions.</p>
<p>The address is easy enough to find; this can be determined via the <code>parity.api.parity.registry</code> call. The ABI spec is rather long and can be derived from the contract code available at the ethcode/contracts repository. Since there is only a single canonical registry, Parity, conveniently constructs this for you and provides it at the <code>bonds.registry</code> object.</p>
<p>To figure out the primary associated address of the <code>gavofyork</code> name, we can use the <code>getAddress</code> call, together with the <code>parity.api.util.sha3</code> call to take the Keccak hash of our name. The full expression would be:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bonds.registry.getAddress(parity.api.util.sha3(<span class="hljs-string">'gavofyork'</span>))</span><br></pre></td></tr></table></figure>
<p>Typing <code>parity.api.util.sha3(...)</code> every time you want to look up a name in the registry gets tedious fast. Happily, Parity provides a number of derivative helper functions as part of the <code>bonds&#39;registry</code> object: <code>lookupDate</code>, <code>lookupAddress</code>, <code>lookupUint</code> and <code>lookupOwner</code>. They are all just like the <code>get-</code> prefixed brethren, but do the hashing for you. Our expression therefore can become:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bonds.registry.lookupAddress(<span class="hljs-string">'gavofyork'</span>, <span class="hljs-string">'A'</span>)</span><br></pre></td></tr></table></figure>
<p>Let’s get this in to our dapp, Change the <code>render()</code>ed HTML to:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  gavofyorks address is:</span><br><span class="line">  &lt;Rspan&gt;&#123;bonds.registry.lookupAddress(<span class="hljs-string">'gavofyork'</span>, <span class="hljs-string">'A'</span>)&#125;&lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br><span class="line"><span class="hljs-regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Dynamic-lookups"><a href="#Dynamic-lookups" class="headerlink" title="Dynamic lookups"></a>Dynamic lookups</h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.bond = <span class="hljs-keyword">new</span> Bond()</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        Address <span class="hljs-keyword">of</span> &lt;InputBond bond=&#123;<span class="hljs-keyword">this</span>.bond&#125; placeholder=<span class="hljs-string">"Lookup a name"</span> /&gt; is:<span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span></span></span><br><span class="line"><span class="hljs-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Rspan</span>&gt;</span>&#123;bonds.registry.lookupAddress(this.bond, 'A')&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Rspan</span>&gt;</span></span></span><br><span class="line"><span class="hljs-xml">        Its balance is</span></span><br><span class="line">        &lt;Rspan&gt;</span><br><span class="line">          &#123;bonds.balance(bonds.registry.lookupAddress(this.bond, 'A')).map(formatBalance)&#125;</span><br><span class="line"><span class="hljs-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">Rspan</span>&gt;</span></span></span><br><span class="line"><span class="hljs-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Derivative-contracts"><a href="#Derivative-contracts" class="headerlink" title="Derivative contracts"></a>Derivative contracts</h2><p>Typically the registry is used to lookup the address of a second contract that you would actucally like to use.</p>
<p>Let’s suppose that second contract is the GithubHint contract; if you’re not already familiar, the GithubHint contract allows you to suggest which URLs might serve content for a particular hash.It’s a semi-centralized, hacky alternative to content-addressable-delivery systems like BitTorrent/Kademlia, Swarm and IPFS. We use it widely in Parity as a means of content dissemination.</p>
<p>Since is a ‘standard’ contract in Parity, the ABI for it is available in <code>oo7-parity</code> as <code>GitHubHintABI</code>. The address changes per chain, but can be discovered via the registry under the name ‘githubhint’. The expression would therefore be <code>bonds.registry.lookupAddress(&#39;githubhint&#39;, &#39;A&#39;)</code>.</p>
<p>Though we mustn’t forget to import <code>GitHubHint</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; GitHubHintABI &#125; form <span class="hljs-string">'oo7-parity'</span></span><br></pre></td></tr></table></figure>
<p>The GithubHint contract has only a single inspection method: <code>entries</code>. This takes a <code>bytes32</code> and returns three items(via an array). There are three kinds of entry: Github repository entries, whereby the first and second items form the addresss of a particular commit of a particular repository; general URLs, where the first item is a URL and the second is the null hash; and empty entries where both items are null. The third item is always the owner (if any) of the entry and the only account capable of changing the hint information.</p>
<p>In this small demo, we’ll assume that we are looking up only URLs and so are only interested in the first item. We therefore want an expression like:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GitHubHint.entries(hash)[<span class="hljs-number">0</span>]</span><br></pre></td></tr></table></figure>
<p>Where <code>hash</code> is some content hash and <code>GitHubHint</code> is the contract object.</p>
<p>Putting this all together we can change our dapp to:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.bond = <span class="hljs-keyword">new</span> Bond()</span><br><span class="line">    <span class="hljs-keyword">this</span>.GitHubHint = bonds.makeContract(bonds.registry.lookupAddress(<span class="hljs-string">'githubhint'</span>, <span class="hljs-string">'A'</span>), GitHubHintABI)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        URL <span class="hljs-keyword">for</span> content &lt;HashBond bond=&#123;<span class="hljs-keyword">this</span>.bond&#125; floatingLabelText=<span class="hljs-string">"Content-Hash"</span> /&gt; is:</span><br><span class="line">        &lt;Rspan&gt;&#123;<span class="hljs-keyword">this</span>.GithubHint.entries(<span class="hljs-keyword">this</span>.bond)[<span class="hljs-number">0</span>]&#125;&lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note that we are using <code>HashBond</code> from <code>oo7-react</code> rather than <code>InputBond</code>. This just ensures that we enter only valid 32-byte hashes. Ensure that the import line is changed to:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; InputBond, HashBond &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'parity-reactive-ui'</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-13T14:54:24.000Z">2017-07-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 591 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/13/Tutorial-Part-3-of-Dapp/">Tutorial Part 3 of Dapp</a>
            
        </h1>
        <div class="content">
            <h1 id="Parity-Bonds"><a href="#Parity-Bonds" class="headerlink" title="Parity Bonds"></a>Parity Bonds</h1><p>It’s time to get down and dirty with the blockchain.</p>
<p>For this we will introduce the <code>oo7-parity</code> package, which provides a high-level reactive <code>Bond</code> API.</p>
<p>To set this up, all we need do is import <code>bonds</code> from the <code>oo7-parity</code> module, so ensure you have this at the top of your file:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; bonds &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'oo7-parity'</span></span><br></pre></td></tr></table></figure>
<h2 id="Watch-the-block"><a href="#Watch-the-block" class="headerlink" title="Watch the block"></a>Watch the block</h2><p>For our first task, we will introduce the simplest of all bonds: <code>bonds.height</code>. This evaluates to <code>the number of the latest block</code>, expressed as a simple number.</p>
<p>In <code>app.jsx</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;Rspan&gt;&#123;bonds.height&#125;&lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br><span class="line"><span class="hljs-regexp">    )</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>It’s not especially pretty so you can add some style on it.</p>
<p>We also provide the <code>formatBlockNumber</code> function:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> formatBlockNumber = <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> <span class="hljs-string">'#'</span> + (<span class="hljs-string">''</span> + n).replace(<span class="hljs-regexp">/(\d)(?=(\d&#123;3&#125;)+$)/g</span>, <span class="hljs-string">'$1,'</span>)</span><br></pre></td></tr></table></figure>
<p>You can use it through</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; bonds, formatBlockNumber &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'oo7-parity'</span></span><br></pre></td></tr></table></figure>
<h2 id="Blocks"><a href="#Blocks" class="headerlink" title="Blocks"></a>Blocks</h2><p>The block number is great and all, but perhaps we’re more intereseted in the latest block itself. Parity can help us there with the <code>bonds.blocks</code> object. This is a lazy-evaluated ‘array’ of bonds which can subscribe to. To give yourself an idea of its capabilities, let’s try it out in the console. First we will expose the <code>bonds</code> object to the environment by adding this at the end of our obejct’s constructor:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.bonds = bonds</span><br></pre></td></tr></table></figure>
<p>Having reloaded, quickly open the Chrome JS console, alter the environment to 127.0.0.1 and evaluate the block at number 69 with <code>bonds.blocks[69].log()</code></p>
<p>Note that since it’s all asynchronous, we must use the <code>.log()</code> trick to feed the result into the console (it’s exactly equivalent to <code>.map(console.log)</code>) The result is, of course, the block object representing the 69th mined block on this chain.</p>
<p>Naturally, <code>bonds.blocks</code> is able to accept any number, even a bond, as its subscript. Let’s make our dapp always give us the timestamp of the latest block.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  Latest block timestamp is:</span><br><span class="line">  &lt;Rspan&gt;&#123;bonds.blocks[bonds.blocks.height].map(<span class="hljs-function"><span class="hljs-params">b</span> =&gt;</span> b.timestamp).map(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> _.toString())&#125;&lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br><span class="line"><span class="hljs-regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p>That map is a bit cumbersome, the <code>bond</code> API knows about subscripting, which means the <code>.timestamp</code> can be moved out of the <code>map</code></p>
<p>Furthermore, <code>bonds.blocks[bonds.height]</code> is a fairly common expression. So much so that it has a shorter alias: <code>bonds.head</code>, so in fact the simplest means of expressing this becomes:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; bonds.head.timestamp.map(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> _.toString())&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Composing-expressions"><a href="#Composing-expressions" class="headerlink" title="Composing expressions"></a>Composing expressions</h2><p>These expressios are sometimes very useful, but often you want to do some blockchain based computation on this information.</p>
<p>Parity puts various means at your disposal to help you here:</p>
<ul>
<li><p><code>bonds.balance(address)</code>: evaluates to the current balanece of account at <code>address</code></p>
</li>
<li><p><code>bonds.transactionCount(address)</code>: evaluates to the current transaction count (‘nonce’) of account at <code>address</code></p>
</li>
<li><p><code>bonds.code(address)</code>: evaluates to the current ‘contract’ code of account at <code>address</code></p>
</li>
<li><p><code>bonds.storageAt(address, location)</code>: evaluates to the value in storage <code>location</code> of account at <code>address</code></p>
</li>
</ul>
<p>Use the first one:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  Current block authors balance is:</span><br><span class="line">  &lt;Rspan&gt;</span><br><span class="line">    &#123;bonds.balance(bonds.head.author).map(formatBalance)&#125;</span><br><span class="line">  &lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br><span class="line"><span class="hljs-regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Our-balance"><a href="#Our-balance" class="headerlink" title="Our balance"></a>Our balance</h2><p>Parity can help us get information about our own accounts in a reactive manner.</p>
<p>Some apis like:</p>
<ul>
<li><p><code>bonds.coinbase</code>: evaluates to the node’s current block authoring address.</p>
</li>
<li><p><code>bonds.accounts</code>: evaluates to the list of accounts available for the dapp to use.</p>
</li>
<li><p><code>bonds.me</code>: evaluates to the preferred account for this dapp to use. In parity, this is the account visible in the Parity Signer at the bottom right of the page.</p>
</li>
<li><p><code>bonds.accountsInfo</code>: evaluates to the mapping between dapp-visible addresses and account metadata.</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-13T08:21:12.000Z">2017-07-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 485 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/13/Tutorial-Part2-of-Dapp/">Tutorial Part 2 of Dapp</a>
            
        </h1>
        <div class="content">
            <h1 id="oo7-Bonds"><a href="#oo7-Bonds" class="headerlink" title="oo7 Bonds"></a>oo7 Bonds</h1><p>Now we have our basic dapp harness, we can start introducing more interesting functionality. Without too much ado, let’s get started. Head in to <code>src/client/scripts/app.jsx</code>. You will see our basic file:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;div&gt;Hello World&lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">    )</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>This is a JSX file. Baiscally means that can handle embedded HTML when describing how React components should be rendered.</p>
<h2 id="Your-first-Bond"><a href="#Your-first-Bond" class="headerlink" title="Your first Bond"></a>Your first <code>Bond</code></h2><p>The first thing we’ll do is introduce the <code>oo7 library</code>. This introduces into Javascript the notion of reactive value known as ‘bonds’. Reactive values are similar to normal variables, except that any places in which they are used will automatically upate themselves as the value changes.</p>
<p>The oo7 package is still very much in development, as such there might be one or two rough edges in this tutorial.</p>
<p>Our first example will just demonstrate how <code>Bond</code> can introduce effortless reactivity by dynamically replicating the contents of an editable text field into a <code>&lt;span&gt;</code>.</p>
<p>Import the needed components by placing three lines at the top of <code>app.jsx</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; Bond &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'oo7'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Rspan &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'oo7-react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; InputBond &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'parity-reactive-ui'</span></span><br></pre></td></tr></table></figure>
<p>Next we need to introduce a new instance of a <code>Bond</code>. It will represent the current contents of a text field. We will initialize it in our class’s contructor. Insert these lines directly into the <code>App</code> class decalration.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">  <span class="hljs-keyword">super</span> ()</span><br><span class="line">  <span class="hljs-keyword">this</span>.bond = <span class="hljs-keyword">new</span> Bond()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Your code should now look like this:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Bond &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'oo7'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Rspan &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'oo7-react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; InputBond &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'parity-reactive-ui'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span> ()</span><br><span class="line">    <span class="hljs-keyword">this</span>.bond = <span class="hljs-keyword">new</span> Bond()</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (</span><br><span class="line">      &lt;div&gt;Hello World&lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">    )</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>Next we need to create the text entry field and the <code>&lt;span&gt;</code> element(in which the text field’s contents will be reflected). We will use a version of Semantic UI’s <code>Input</code> element which has been specially modified to propagate the value into a named <code>Bond</code>. This is called <code>InputBond</code>.</p>
<p>Similarly, for the <code>span</code> we will use a special ‘reactive’ version of the <code>span</code> element which is able to accept <code>Bond</code>s as children and values of certain properties. This is known as <code>Rspan</code>.</p>
<p>Change the <code>&lt;div&gt;Hello World&lt;/div&gt;</code> line to:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;InputBond bond=&#123;<span class="hljs-keyword">this</span>.bond&#125; placeholder=<span class="hljs-string">"Go ahead and type some text"</span> /&gt;</span><br><span class="line">  &lt;Rspan&gt;&#123;<span class="hljs-keyword">this</span>.bond&#125;&lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br><span class="line"><span class="hljs-regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p>As you see there’s not all that much here, we just tell the text field input <code>InputBond</code> to place its value into <code>this.bond</code> and conversely tell <code>Rspan</code> to display that value from <code>this.bond</code>.</p>
<p>Run webpack and let it watch your files to ensure your dapp is continuously rebuilt.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h2 id="Transforming-Bonds"><a href="#Transforming-Bonds" class="headerlink" title="Transforming Bonds"></a>Transforming Bonds</h2><p><code>Bond</code>s don’t just have to pass on data; they can also represent transformations on the data.</p>
<p>One example of a transform on text would be simple upper-casing. A function to upper-case text would be <code>text =&gt; text.toUpperCase()</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Rspan&gt;&#123;<span class="hljs-keyword">this</span>.bond.map(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> t.toUpperCase())&#125;&lt;<span class="hljs-regexp">/Rspan&gt;</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-13T07:11:48.000Z">2017-07-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 492 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/13/Tutorial-Par1-of-Dapp/">Tutorial Part 1 of Dapp</a>
            
        </h1>
        <div class="content">
            <h1 id="Spawning-a-new-Dapp"><a href="#Spawning-a-new-Dapp" class="headerlink" title="Spawning a new Dapp"></a>Spawning a new Dapp</h1><p>The dapp will use modern JS technologies: NPM, Webpack2, React, Babel, ES6, JSX and oo7.</p>
<p>Clone a <code>skeleton</code> repo from parity:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="hljs-built_in">clone</span> https://github.com/paritytech/skeleton mydapp</span><br></pre></td></tr></table></figure>
<p>This will make your a new repo with everything ready.</p>
<p><code>cd</code> in to it and remove the origin repository lest it confuse Git.</p>
<p>It’s liberally licensed (Apache 2.0) so you don’t have to worry about open sourcing your own code(though obviously you’ll be enlightened and want to do that anyway.)</p>
<p>The next stage is to get all dependencies installed, NPM makes this rather easy, but the bundled script makes it even easier</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./init.sh</span><br></pre></td></tr></table></figure>
<p>This should grab and install all that is required. The next thing to do is to build the final web-ready version of the fledling dapp. We use webpack for this.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack</span><br></pre></td></tr></table></figure>
<p>You now have a basic dapp built.</p>
<h1 id="Configuring-its-look"><a href="#Configuring-its-look" class="headerlink" title="Configuring its look"></a>Configuring its look</h1><p>While your dapp may well be built, it is not yet easily discoverable. You would have to host it somewhere. This can be done traditionally with a web server but for development, we will use Parity’s in-built hosting.</p>
<p>Parity uses a special ‘manifest’ file called to figure out how to display the entry for your dapp in Parity Wallet. This file is called <code>manifest.json</code> and must be placed in the root of your dapp’s directory, in our case, thi sis our ‘build’ directory, <code>dist</code>.</p>
<p>Open an editor to edit <code>dist/manifest.json</code> you’ll see something like:</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"skeleton"</span>,</span><br><span class="line">  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Skeleton"</span>,</span><br><span class="line">  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"A skeleton dapp"</span>,</span><br><span class="line">  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.1"</span>,</span><br><span class="line">  <span class="hljs-attr">"author"</span>: <span class="hljs-string">"parity Technologies Ltd"</span>,</span><br><span class="line">  <span class="hljs-attr">"iconUrl"</span>: <span class="hljs-string">"title.png"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>The <code>id</code> is the dapp’s unique identity: change that from <code>skeleton</code> to <code>mydapp</code></p>
</li>
<li><p>The <code>name</code> is the dapp’s user-visible name: change that to <code>My Dapp</code></p>
</li>
<li><p>The <code>description</code> is a user-visible by-line describing what the dapp is good for.</p>
</li>
<li><p><code>version</code> is the dapp’s version - you can leave that at <code>0.1</code> for now.</p>
</li>
<li><p>You can change the <code>author</code> to your name.</p>
</li>
<li><p>The <code>iconUrl</code> is the path(within <code>dist</code>) to a square(best to make it 128 x 128) icon for your dapp.</p>
</li>
</ul>
<h1 id="Getting-it-visible-in-Parity"><a href="#Getting-it-visible-in-Parity" class="headerlink" title="Getting it visible in Parity"></a>Getting it visible in Parity</h1><p>To get Parity to discover your dapp, it needs to be placed into a place that Parity will see it in its local ‘dapps’ directory. We will make a symbolic linke for our dapp’s <code>dist</code> directory(containing all of the ready-built dapp) in Parity’s dapp directory.</p>
<p>Parity’s directory structure is different depending on your system.</p>
<p>For Mac, Parity’s local dapp directory sits at <code>$HOME/Library/Application Support/io.parity.ethereum/dapps</code></p>
<p>Once you have it linked, you should start(or restart, if already running) Parity and head to the Application Page of Parity Wallet. There you will see your new dapp:</p>
<p>Note: If you are not running <code>npm start</code> in parity/src/js to have a development instance your URL is likely <code>localhost:8180</code> instead of port 3000.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-13T02:07:07.000Z">2017-07-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 0 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/13/d3-scale/">D3-Scale</a>
            
        </h1>
        <div class="content">
            
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-12T07:43:59.000Z">2017-07-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 minutes read (About 1597 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/12/d3-shape/">D3-Shape</a>
            
        </h1>
        <div class="content">
            <h3 id="d3-shape"><a href="#d3-shape" class="headerlink" title="d3.shape"></a>d3.shape</h3><p>Visualization typically consist of discrete  graphical marks, such as <code>Symbols</code>, <code>arcs</code>, <code>lines</code> and <code>areas</code>. While the ractangles of a bar chart may be easy enough to generate directly using <code>SVG</code> or <code>Canvas</code>, other shapes are complex, such as roudned annular sectors and centripetal Catmull-Rom splines. This module provides a variety of shape generators for your convenience.</p>
<p>As with other aspects of D3, these shapes are driven by data: each shape generator exposes accessors that control how the input data are mapped to a visual representation.</p>
<p>You might define a line generator for a time series by <code>scaling</code> field of your data to fit the chart.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> lineGen = d3.line()</span><br><span class="line">    .x(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (d.date))</span><br><span class="line">    .y(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (d.value))</span><br></pre></td></tr></table></figure>
<p>This line generator can then be used to compute the <code>d</code> attribute of an SVG path element:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.datum(data).attr(<span class="hljs-string">'d'</span>, lineGen)</span><br></pre></td></tr></table></figure>
<p>Or you can use it to render to a Canvas 2D context:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lineGen.context(context)(data)</span><br></pre></td></tr></table></figure>
<h3 id="Installing"><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h3><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://d3js.org/d3-path.v1.min.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://d3js.org/d3-shape.v1.min.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add d3-shape</span><br></pre></td></tr></table></figure>
<h3 id="Arcs"><a href="#Arcs" class="headerlink" title="Arcs"></a>Arcs</h3><p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/pie.png" alt=""></p>
<p>The arc genrateor produces a circular or annular sector, as in a pie or donut chart. If the difference between the start and end angles(the regular span) is greater than 2 <em> Math.PI, the arc generator will produce a complete circle or annulus. If it is less than 2 </em> Math.PI, arcs may have rounded corners and angular padding.</p>
<p>Arcs are always centered at &lt;0, 0&gt;, use a transform to move the arc to a different position.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> arc = d3.arc() <span class="hljs-comment">// construct a new arc genrator with default settings.</span></span><br><span class="line"></span><br><span class="line">arc(&#123;</span><br><span class="line">  innerRadius: <span class="hljs-number">0</span>,</span><br><span class="line">  outerRadius: <span class="hljs-number">100</span>,</span><br><span class="line">  startAngle: <span class="hljs-number">0</span>,</span><br><span class="line">  endAngle: <span class="hljs-built_in">Math</span>.PI / <span class="hljs-number">2</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="hljs-comment">// or</span></span><br><span class="line"><span class="hljs-keyword">const</span> arc = d3.arc()</span><br><span class="line">    .innerRadius(<span class="hljs-number">0</span>)</span><br><span class="line">    .outerRadius(<span class="hljs-number">100</span>)</span><br><span class="line">    .startAngle(<span class="hljs-number">0</span>)</span><br><span class="line">    .endAngle(<span class="hljs-built_in">Math</span>.PI/<span class="hljs-number">2</span>)</span><br><span class="line"></span><br><span class="line">arc()</span><br></pre></td></tr></table></figure>
<p><strong>arc.centroid(arguments)</strong> computes the midpoint &lt;x, y&gt; of the center line of the arc that would be generated by the given arguments. The arguments are arbitrary. They are simple propagated to the arc generator’s accessor functions along with the <code>this</code> object.</p>
<p>To be consistent with the generated arc, the accessors must be deterministirc, i.e., return the same value given the same arguments. The midpoint is defined as (startAngle + endAngle) / 2 and (innerRadius + outerRadius) / 2</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/centroid-annular-sector.png" alt=""></p>
<p><strong>arc.cornerRadius([radius])</strong> sets the corner radius to the specified function or number and returns the arc generator.</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/rounded-annular-sector.png" alt=""></p>
<p><strong>arc.padAngle([angle])</strong> sets the pad angle to the specifid function or number and returns this arc generator. The pad angle is converted to a fixed linear distances seperateing adajacent arcs, defined as <strong>padRadius * padAngle</strong>.</p>
<p><strong>arc.context([context])</strong> sets the context and returns this arc generator. If <em>context</em> is not specified, returns the current context, which defaults to null. If the context is not null, then the generated arc is rendered to this context as a sequence of path method calls. Otherwise, a path data string representing the generated arc is returned.</p>
<h3 id="Pies"><a href="#Pies" class="headerlink" title="Pies"></a>Pies</h3><p>This pie generator does not produce a shape directly, but instead <strong>computes</strong> the necessary angles to represent a tabular dataset as a pie or donut chart. These angles can be passed to an arc generator.</p>
<p><strong>d3.pie()</strong> constructs a new pie generator with the default settings.</p>
<p><strong>pie(data[, arguments])</strong> generates a pie for the given array of data, <strong>returning an array of objects representing each datum’s arc angle</strong>. Any additional arguments are arbitrary. They are simply propagated to the pie generator’s accessor functions along with the <code>this</code> object.</p>
<p>The length of the returned array is the same as data and each element <em>i</em> in the returned array corresponds to the element <em>i</em> in the input data. Each object in the returned array has the following properties:</p>
<ul>
<li><p>data: the input datum; the corresponding element in the input data array.</p>
</li>
<li><p>value: the numeric value of the arc</p>
</li>
<li><p>index: the zero-based sorted index of arc</p>
</li>
<li><p>startAgnle: the start angle of the arc</p>
</li>
<li><p>endAngle: the end angle of the arc</p>
</li>
<li><p>padAngle: the pad angle of the arc</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> data = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">21</span>];</span><br><span class="line"><span class="hljs-keyword">var</span> arcs = d3.pie()(data);</span><br><span class="line"><span class="hljs-comment">// to</span></span><br><span class="line">[</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>:  <span class="hljs-number">1</span>, <span class="hljs-string">"value"</span>:  <span class="hljs-number">1</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">6</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">6.050474740247008</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">6.166830023713296</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>:  <span class="hljs-number">1</span>, <span class="hljs-string">"value"</span>:  <span class="hljs-number">1</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">7</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">6.166830023713296</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">6.283185307179584</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>:  <span class="hljs-number">2</span>, <span class="hljs-string">"value"</span>:  <span class="hljs-number">2</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">5.817764173314431</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">6.050474740247008</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>:  <span class="hljs-number">3</span>, <span class="hljs-string">"value"</span>:  <span class="hljs-number">3</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">5.468698322915565</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">5.817764173314431</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>:  <span class="hljs-number">5</span>, <span class="hljs-string">"value"</span>:  <span class="hljs-number">5</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">3</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">4.886921905584122</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">5.468698322915565</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>:  <span class="hljs-number">8</span>, <span class="hljs-string">"value"</span>:  <span class="hljs-number">8</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">2</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">3.956079637853813</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">4.886921905584122</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>: <span class="hljs-number">13</span>, <span class="hljs-string">"value"</span>: <span class="hljs-number">13</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">2.443460952792061</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">3.956079637853813</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-string">"data"</span>: <span class="hljs-number">21</span>, <span class="hljs-string">"value"</span>: <span class="hljs-number">21</span>, <span class="hljs-string">"index"</span>: <span class="hljs-number">0</span>, <span class="hljs-string">"startAngle"</span>: <span class="hljs-number">0.000000000000000</span>, <span class="hljs-string">"endAngle"</span>: <span class="hljs-number">2.443460952792061</span>, <span class="hljs-string">"padAngle"</span>: <span class="hljs-number">0</span>&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>The first pair of parens, <code>pie()</code> constructs a default pie generator, the second <code>pie()(data)</code> invokes this generator on the dataset, returning an array of objects.</p>
<p>Note that the returned array is in the same order as the data.</p>
<h3 id="Lines"><a href="#Lines" class="headerlink" title="Lines"></a>Lines</h3><p>The line generator produces a spline or polyline, as in a line chart. Lines also appear in many other visualization types, such as the links in hierarchical edge bundling.</p>
<p><strong>d3.line()</strong> constructs a new line generator with default settings.</p>
<p><strong>line(data)</strong> generates a line for the given array of data. Depending on this line generator’s assciated curve, the given input data may need to be sorted by x-value before being passed to the line generator. If the line generator has a context, then the line is rendered to this context as a sequence of path method calls and this function returns void.</p>
<p><strong>line.x(fn)</strong> specifies the x accessor.</p>
<p><strong>line.y(fn)</strong> specifies the y accessor.</p>
<p><strong>line.defined([defined])</strong> sets the defined accessor.</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/line-defined.png" alt=""></p>
<p><strong>line.curve([curve])</strong> sets the curve factory and returns this line genrator. If curve is not specified, returns the current curve factory, which defaults to <strong>curveLinear</strong>.</p>
<p><strong>d3.lineRadial()</strong> constructs a new radial line generator with the default settings.</p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/line-radial.png" alt=""></p>
<p>A radial line generator is equivalent to the standard cartesian line generator, except the x and y accessor are replaced with angle and readius accessors.</p>
<p>Radial lines are always positioned relative to &lt;0, 0&gt;, use a transform to change the origin.</p>
<h3 id="Areas"><a href="#Areas" class="headerlink" title="Areas"></a>Areas</h3><p>The area generator produces an area, as in an area chart. An area is defined by two bounding lines, either splines or polilines. Typically two lines share the same x-value, differing only in y-value; most commonly, y0 is defined as a constant representing zero.  The first line (the top line) is defined by x1 and y1 and is rendered first; the second line (the base line) is defined by x0 and y0 and is rendered second, with the points in reverse order.</p>
<p><strong>d3.area()</strong> constructs a new area generator with the default settings.</p>
<p><strong>area.data()</strong> generats area for the given array of data. Depending on this area generator’s associated curve.</p>
<p><strong>area.x([x])</strong> sets x0 to x and x1 to null.</p>
<p><strong>area.x0()</strong> sets the x0 accessor.</p>
<p><strong>area.defined()</strong></p>
<p><strong>d3.areaRadial()</strong></p>
<p><img src="https://raw.githubusercontent.com/d3/d3-shape/master/img/area-radial.png" alt=""></p>
<h3 id="Curves"><a href="#Curves" class="headerlink" title="Curves"></a>Curves</h3><p>Curves are typically not constructed or used directly, insread being passed to <code>line.curve</code> and <code>arec.curve</code>. For example:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> line = d3.line()</span><br><span class="line">  .x(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>&#123; <span class="hljs-keyword">return</span> x(d.date) &#125;)</span><br><span class="line">  .y(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>&#123; <span class="hljs-keyword">return</span> y(d.value) &#125;)</span><br><span class="line">  .curve(d3.curveCatmullRom.alpha(<span class="hljs-number">0.5</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li><p>d3.curveBasis(context)</p>
</li>
<li><p>d3.curveBasisClosed(context)</p>
</li>
<li><p>d3.curveBasisOpen(context)</p>
</li>
<li><p>d3.curveBundle(context)</p>
</li>
<li><p>d3.curveCardinal(context)</p>
</li>
<li><p>d3.curveCardinalClosed(context)</p>
</li>
<li><p>d3.curveLinear(context)</p>
</li>
<li><p>d3.curveStep(context)</p>
</li>
<li><p>d3.curveStepAfter(context)</p>
</li>
<li><p>d3.curveStepBefore(context)</p>
</li>
</ul>
<h3 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h3><p>The link shape generates a smooth cubic Bezier curve from a source point to a target point. The tangents of the curve at the start and end are either <code>vertical</code>, <code>horizontal</code>, or <code>radial</code>.</p>
<p><strong>d3.linkVertical()</strong>, returns a new link generator with vertical tangents.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> link = d3.linkVertical()</span><br><span class="line">    .x(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>)</span>&#123; <span class="hljs-keyword">return</span> d.x &#125;)</span><br><span class="line">    .y(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>)</span>&#123; <span class="hljs-keyword">return</span> d.y &#125;)</span><br></pre></td></tr></table></figure>
<p><strong>d3.linkHorizontal()</strong>, returns a new link generator with horizontal tangents.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> link = d3.linkHorizontal()</span><br><span class="line">    .x(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>&#123; <span class="hljs-keyword">return</span> d.y &#125;)</span><br><span class="line">    .y(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>&#123; <span class="hljs-keyword">return</span> d.x &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Stacks"><a href="#Stacks" class="headerlink" title="Stacks"></a>Stacks</h3><p>Some shape types can be stakced, placing one shape adjacent to another.</p>
<p>Stacked charts can show overall value and per-category value simultaneously.</p>
<p><strong>d3.stack()</strong>, constructs a new stack generator with the default settings.</p>
<p><strong>stack(data[, arguments])</strong>, generates a stack for the given array of data, returning an array of representing each series. Any additional arguments are arbitrary, they are simply propagated to accessors along with <code>this</code> object.</p>
<p>The series are determined by the keys accessor; each series <em>i</em> in the returned array corresponds to the <em>i</em> th key. Each series is an array o points, where each point <em>j</em> corresponds to the <em>j</em> th element in the input <em>data</em>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> data = [</span><br><span class="line">  &#123;<span class="hljs-attr">month</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2015</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>), <span class="hljs-attr">apples</span>: <span class="hljs-number">3840</span>, <span class="hljs-attr">bananas</span>: <span class="hljs-number">1920</span>, <span class="hljs-attr">cherries</span>: <span class="hljs-number">960</span>, <span class="hljs-attr">dates</span>: <span class="hljs-number">400</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-attr">month</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2015</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>), <span class="hljs-attr">apples</span>: <span class="hljs-number">1600</span>, <span class="hljs-attr">bananas</span>: <span class="hljs-number">1440</span>, <span class="hljs-attr">cherries</span>: <span class="hljs-number">960</span>, <span class="hljs-attr">dates</span>: <span class="hljs-number">400</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-attr">month</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2015</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>), <span class="hljs-attr">apples</span>:  <span class="hljs-number">640</span>, <span class="hljs-attr">bananas</span>:  <span class="hljs-number">960</span>, <span class="hljs-attr">cherries</span>: <span class="hljs-number">640</span>, <span class="hljs-attr">dates</span>: <span class="hljs-number">400</span>&#125;,</span><br><span class="line">  &#123;<span class="hljs-attr">month</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2015</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>), <span class="hljs-attr">apples</span>:  <span class="hljs-number">320</span>, <span class="hljs-attr">bananas</span>:  <span class="hljs-number">480</span>, <span class="hljs-attr">cherries</span>: <span class="hljs-number">640</span>, <span class="hljs-attr">dates</span>: <span class="hljs-number">400</span>&#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// To produce a stack of this data</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> stack = d3.stack()</span><br><span class="line">    .keys([ <span class="hljs-string">'apples'</span>, <span class="hljs-string">'bananas'</span>, <span class="hljs-string">'cherries'</span>, <span class="hljs-string">'dates'</span> ])</span><br><span class="line">    .order(d3.stackOrderNone)</span><br><span class="line">    .offset(d3.stackOffsetNone)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// returned</span></span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">  [[   <span class="hljs-number">0</span>, <span class="hljs-number">3840</span>], [   <span class="hljs-number">0</span>, <span class="hljs-number">1600</span>], [   <span class="hljs-number">0</span>,  <span class="hljs-number">640</span>], [   <span class="hljs-number">0</span>,  <span class="hljs-number">320</span>]], <span class="hljs-comment">// apples</span></span><br><span class="line">  [[<span class="hljs-number">3840</span>, <span class="hljs-number">5760</span>], [<span class="hljs-number">1600</span>, <span class="hljs-number">3040</span>], [ <span class="hljs-number">640</span>, <span class="hljs-number">1600</span>], [ <span class="hljs-number">320</span>,  <span class="hljs-number">800</span>]], <span class="hljs-comment">// bananas</span></span><br><span class="line">  [[<span class="hljs-number">5760</span>, <span class="hljs-number">6720</span>], [<span class="hljs-number">3040</span>, <span class="hljs-number">4000</span>], [<span class="hljs-number">1600</span>, <span class="hljs-number">2240</span>], [ <span class="hljs-number">800</span>, <span class="hljs-number">1440</span>]], <span class="hljs-comment">// cherries</span></span><br><span class="line">  [[<span class="hljs-number">6720</span>, <span class="hljs-number">7120</span>], [<span class="hljs-number">4000</span>, <span class="hljs-number">4400</span>], [<span class="hljs-number">2240</span>, <span class="hljs-number">2640</span>], [<span class="hljs-number">1440</span>, <span class="hljs-number">1840</span>]], <span class="hljs-comment">// dates</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><strong>stack.keys([keys])</strong>, sets the keys accessor to the specified function or array and returns this stack generator.</p>
<p><strong>stack.order([order])</strong>, sets the order accessor to the specified functino or array and returns this stack generator. If order is not specified, returns the current order accessor, which default to <code>stackOrderNone</code>, this uses the order given by the key accessor.</p>
<ul>
<li><p>d3.stackOrderAscending(series)</p>
</li>
<li><p>d3.stackOrderDescending(series)</p>
</li>
<li><p>d3.stackOrderInsideOut(series)</p>
</li>
<li><p>d3.stackOrderNone(series)</p>
</li>
<li><p>d3.stackOrderReverse(series)</p>
</li>
</ul>
<p><strong>stack.offset([offest])</strong>, sets the offset accessor to the specified function or array, and returns this stack generator. If no offset is specified, returns the current offset accessor, which default to <code>stackOffsetNone</code>, this uses a zero baseline.</p>
<ul>
<li><p>d3.stackOffsetDiverging(series, order)</p>
</li>
<li><p>d3.stackOffsetExpand(series, order)</p>
</li>
<li><p>d3.stackOffsetNone(series, order)</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-12T06:44:24.000Z">2017-07-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 107 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/12/d3-range/">d3.range</a>
            
        </h1>
        <div class="content">
            <figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.range([start, ]stop[, step])</span><br></pre></td></tr></table></figure>
<p>Returns an array containing an arithmetic progression, similar to the Python built-in range. This method is often used to iterate over a sequence of uniformly-spaced numeric values, such as the indexes of an array or the ticks of a linear scale.</p>
<p>If <em>step</em> is ommitted, it defaults to 1. If <em>start</em> ommitted, it defaults to 0. The <em>stop</em> value is exclusive; it is not included in the result.</p>
<p>The arguments are not required to be integers; however, the results are more predicable if they are.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d3.range(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>/<span class="hljs-number">49</span>) <span class="hljs-comment">// BAD, and returns 50 elements</span></span><br><span class="line">d3.range(<span class="hljs-number">49</span>).map(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (d/<span class="hljs-number">49</span>)) <span class="hljs-comment">// GOOD, and returns 49 elements</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-11T06:34:23.000Z">2017-07-11</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 853 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/11/Quick-Reference-of-D3/">Quick Reference of D3</a>
            
        </h1>
        <div class="content">
            <h1 id="Selections"><a href="#Selections" class="headerlink" title="Selections"></a>Selections</h1><h3 id="d3-select"><a href="#d3-select" class="headerlink" title="d3.select()"></a>d3.select()</h3><p>Returns a reference to the first element found.</p>
<h3 id="d3-selectAll"><a href="#d3-selectAll" class="headerlink" title="d3.selectAll()"></a>d3.selectAll()</h3><p>Returns references to all found elements</p>
<h3 id="selection-append"><a href="#selection-append" class="headerlink" title="selection.append()"></a>selection.append()</h3><p>Takes a selection, creates a new element inside of it, then returns a reference to the newly created element.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> newCirlce = svg.append(<span class="hljs-string">'circle'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="selection-remove"><a href="#selection-remove" class="headerlink" title="selection.remove()"></a>selection.remove()</h3><p>Takes a selection, removes it from the DOM, and returns a reference to the deleted selection.</p>
<h3 id="selection-text"><a href="#selection-text" class="headerlink" title="selection.text()"></a>selection.text()</h3><p>Takes a selection, sets its text content, and returns a reference to the acted-upon selection.</p>
<h3 id="selection-attr"><a href="#selection-attr" class="headerlink" title="selection.attr()"></a>selection.attr()</h3><p>Takes a selection, sets an attribute value, and returns a reference to the acted-upon selection.</p>
<h3 id="selection-style"><a href="#selection-style" class="headerlink" title="selection.style()"></a>selection.style()</h3><p>Takes a selection, sets an inline CSS style, and returns a reference to the acted-upon selection.</p>
<h3 id="selection-classed"><a href="#selection-classed" class="headerlink" title="selection.classed()"></a>selection.classed()</h3><p>Takes a selection, adds or remove a class, and returns a reference to the acted-upon selection; <code>true</code> adds the specified class, <code>false</code> removes it.</p>
<h3 id="selection-each"><a href="#selection-each" class="headerlink" title="selection.each()"></a>selection.each()</h3><p>Takes a selection, and runs an arbitrary function for each element in the selection, with the <code>this</code> context set to the element being acted upon.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="hljs-string">'circle'</span>).each(zoomAndEnhance)</span><br></pre></td></tr></table></figure>
<h1 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h1><h3 id="selection-data"><a href="#selection-data" class="headerlink" title="selection.data()"></a>selection.data()</h3><p>Takes a selection, calculates the difference between the number of elements and number of data value, and binds the array of data value to any existing elements(or not existing placeholder elements).</p>
<h3 id="selection-datum"><a href="#selection-datum" class="headerlink" title="selection.datum()"></a>selection.datum()</h3><p>Takes a selection, and binds a single data value to a single element.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="hljs-string">'path'</span>).datum(dataset).attr(<span class="hljs-string">'d'</span>, line)</span><br></pre></td></tr></table></figure>
<h3 id="selection-enter"><a href="#selection-enter" class="headerlink" title="selection.enter()"></a>selection.enter()</h3><p>Takes a selection and returns a subselection of ‘new’ placeholder elements.</p>
<h3 id="selection-merge"><a href="#selection-merge" class="headerlink" title="selection.merge()"></a>selection.merge()</h3><p>Takes a selection and merges it with another specified selection, returning a newly merged selection.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bars.enter().append(<span class="hljs-string">'rect'</span>).merge(bars) <span class="hljs-comment">// merge enter subselection with existing selection.</span></span><br></pre></td></tr></table></figure>
<h3 id="selection-exit"><a href="#selection-exit" class="headerlink" title="selection.exit()"></a>selection.exit()</h3><p>Takes a selection and returns a subselection of ‘exiting’ elements.</p>
<h3 id="selection-remove-1"><a href="#selection-remove-1" class="headerlink" title="selection.remove()"></a>selection.remove()</h3><p>Takes a selection and removes associated elements from the DOM.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bars.exit().remove()</span><br></pre></td></tr></table></figure>
<h3 id="function-d-…"><a href="#function-d-…" class="headerlink" title="function (d) { … }"></a>function (d) { … }</h3><p>Use anonymouse functions to access data values bound to element via <code>d</code>.</p>
<h3 id="function-d-i-…"><a href="#function-d-i-…" class="headerlink" title="function (d, i) { … }"></a>function (d, i) { … }</h3><p>Including <code>i</code> to get the index value of each element in the selection.</p>
<h3 id="selection-fitler"><a href="#selection-fitler" class="headerlink" title="selection.fitler()"></a>selection.fitler()</h3><p>Takes a selection and returns a new (sub)selection</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> d &gt; <span class="hljs-number">15</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .style(<span class="hljs-string">'color'</span>, <span class="hljs-string">'red'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="d3-csv"><a href="#d3-csv" class="headerlink" title="d3.csv()"></a>d3.csv()</h3><p>Loads an external CSV file, parses the contents into JSON, then hands off the results to a callback function.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d3.csv(<span class="hljs-string">'food.csv'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="d3-json"><a href="#d3-json" class="headerlink" title="d3.json()"></a>d3.json()</h3><p>Loads an external JSON file, parse the content into JSON, then hands off the results to a callback function.</p>
<h3 id="d3-request"><a href="#d3-request" class="headerlink" title="d3.request()"></a>d3.request()</h3><p>Loads an arbitrary external file, then hands off the result to a callback function.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d3.request(<span class="hljs-string">'interesting_data.txt'</span>)</span><br><span class="line">  .get(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-comment">// Do something</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Transitions"><a href="#Transitions" class="headerlink" title="Transitions"></a>Transitions</h1><h3 id="selection-transition"><a href="#selection-transition" class="headerlink" title="selection.transition()"></a>selection.transition()</h3><p>Takes a selection, and initiates a new transition, so values specified after this point will be interpolated over time(rather than set immediately).</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'cx'</span>, <span class="hljs-number">0</span>)</span><br><span class="line">  .transition()</span><br><span class="line">  .attr(<span class="hljs-string">'cx'</span>, <span class="hljs-number">100</span>)</span><br></pre></td></tr></table></figure>
<h3 id="selection-delay"><a href="#selection-delay" class="headerlink" title="selection.delay()"></a>selection.delay()</h3><p>Takes a transition, and sets the delay, in milliseconds.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'cx'</span>, <span class="hljs-number">0</span>)</span><br><span class="line">  .transition()</span><br><span class="line">  .delay(<span class="hljs-number">1000</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'cx'</span>, <span class="hljs-number">100</span>)</span><br></pre></td></tr></table></figure>
<h3 id="transition-duration"><a href="#transition-duration" class="headerlink" title="transition.duration()"></a>transition.duration()</h3><p>Takes a transition and sets the duration in milliseconds.</p>
<h3 id="transition-ease"><a href="#transition-ease" class="headerlink" title="transition.ease()"></a>transition.ease()</h3><p>Takes a transition and sets the easing to be used.</p>
<h3 id="transition-on"><a href="#transition-on" class="headerlink" title="transition.on()"></a>transition.on()</h3><p>Takes a transition, and binds a function to be executed at either the <code>start</code> or <code>end</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'cx'</span>, <span class="hljs-number">0</span>)</span><br><span class="line">  .transition()</span><br><span class="line">  .attr(<span class="hljs-string">'cx'</span>, <span class="hljs-number">100</span>)</span><br><span class="line">  .on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'All done'</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Scale"><a href="#Scale" class="headerlink" title="Scale"></a>Scale</h1><h3 id="d3-scaleLinear"><a href="#d3-scaleLinear" class="headerlink" title="d3.scaleLinear()"></a>d3.scaleLinear()</h3><p>Creates a new linear scale function.</p>
<h3 id="scaleLinear-domain"><a href="#scaleLinear-domain" class="headerlink" title="scaleLinear.domain()"></a>scaleLinear.domain()</h3><p>Sets a linear scale’s input domain.</p>
<h3 id="scaleLinear-range"><a href="#scaleLinear-range" class="headerlink" title="scaleLinear.range()"></a>scaleLinear.range()</h3><p>Sets a linear scale’s output range.</p>
<h3 id="scaleLinear-rangeRound"><a href="#scaleLinear-rangeRound" class="headerlink" title="scaleLinear.rangeRound()"></a>scaleLinear.rangeRound()</h3><p>Sets a linear scale’s output range, and have all values output by the scale rounded to the nearest whole number.</p>
<h3 id="scaleLinear-nice"><a href="#scaleLinear-nice" class="headerlink" title="scaleLinear.nice()"></a>scaleLinear.nice()</h3><p>Expands a linear sclae’s domain to the nearest round values.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xScale.nice()</span><br></pre></td></tr></table></figure>
<h3 id="scaleLinear-clamp"><a href="#scaleLinear-clamp" class="headerlink" title="scaleLinear.clamp()"></a>scaleLinear.clamp()</h3><p>Forces any values output by this scale to be constrainted (rounded to be) within the specified range.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xScale.clamp(<span class="hljs-literal">true</span>)</span><br></pre></td></tr></table></figure>
<h3 id="d3-min"><a href="#d3-min" class="headerlink" title="d3.min()"></a>d3.min()</h3><p>Returns the smallest value in an array.</p>
<h3 id="d3-max"><a href="#d3-max" class="headerlink" title="d3.max()"></a>d3.max()</h3><p>Returns the largest value in an array.</p>
<h1 id="Axes"><a href="#Axes" class="headerlink" title="Axes"></a>Axes</h1><h3 id="d3-axisTop-d3-axisRight-d3-axisBottom-d3-axisLeft"><a href="#d3-axisTop-d3-axisRight-d3-axisBottom-d3-axisLeft" class="headerlink" title="d3.axisTop, d3.axisRight, d3.axisBottom, d3.axisLeft"></a>d3.axisTop, d3.axisRight, d3.axisBottom, d3.axisLeft</h3><p>Create a new axis generator function, with specified orientation.</p>
<h3 id="axis-scale"><a href="#axis-scale" class="headerlink" title="axis.scale()"></a>axis.scale()</h3><p>Takes an axis, and specifies the scale to be used.</p>
<h3 id="axis-ticks"><a href="#axis-ticks" class="headerlink" title="axis.ticks()"></a>axis.ticks()</h3><p>Takes an axis, and specifies a target number of ticks to be used.</p>
<h3 id="axis-tickValues"><a href="#axis-tickValues" class="headerlink" title="axis.tickValues()"></a>axis.tickValues()</h3><p>Takes an axis, and specifies the values to be labeled with ticks.</p>
<h3 id="selection-call"><a href="#selection-call" class="headerlink" title="selection.call()"></a>selection.call()</h3><p>Takes a selection, and calls an arbitrary method to act upon the selection; commonly used to generate an axis.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="hljs-string">'g'</span>).call(xAxis)</span><br></pre></td></tr></table></figure>
<h1 id="Interactivity"><a href="#Interactivity" class="headerlink" title="Interactivity"></a>Interactivity</h1><h3 id="selection-on"><a href="#selection-on" class="headerlink" title="selection.on()"></a>selection.on()</h3><p>Takes a selection, and binds an event listener</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d3.select(<span class="hljs-string">'#button'</span>)</span><br><span class="line">  .on(<span class="hljs-string">'click'</span>, () =&gt; &#123; ... &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="d3-select-this"><a href="#d3-select-this" class="headerlink" title="d3.select(this)"></a>d3.select(this)</h3><p>Within an anonymous function, <code>this</code> refers to <code>the element current being acted upon</code></p>
<h1 id="Numebrs-Dates-and-Times"><a href="#Numebrs-Dates-and-Times" class="headerlink" title="Numebrs, Dates, and Times"></a>Numebrs, Dates, and Times</h1><h3 id="d3-range"><a href="#d3-range" class="headerlink" title="d3.range()"></a>d3.range()</h3><p>Generates an array of sequential numbers.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.range(<span class="hljs-number">5</span>); <span class="hljs-comment">// Returns [0, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>
<h3 id="d3-format"><a href="#d3-format" class="headerlink" title="d3.format()"></a>d3.format()</h3><p>Creates a new number formatter, for convertiing numbers to strings.</p>
<h3 id="d3-timeParse"><a href="#d3-timeParse" class="headerlink" title="d3.timeParse()"></a>d3.timeParse()</h3><p>Creates a new time parser, for converting strings to Date Object.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> parseTime = d3.timeParse(<span class="hljs-string">"%m/%d/%y"</span>)</span><br><span class="line">parseTime(<span class="hljs-string">'02/20/17'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="d3-timeFormat"><a href="#d3-timeFormat" class="headerlink" title="d3.timeFormat()"></a>d3.timeFormat()</h3><p>Creates a new time formatter, for converting Data Object to strings.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> formatTime = d3.timeFormat(<span class="hljs-string">"%b %e"</span>)</span><br><span class="line">formatTime(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-10T04:09:21.000Z">2017-07-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 338 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/10/Simple-Api-of-Mongoose/">Simple Api of Mongoose</a>
            
        </h1>
        <div class="content">
            <h3 id="Two-methods-to-connect-to-Mongo-DB"><a href="#Two-methods-to-connect-to-Mongo-DB" class="headerlink" title="Two methods to connect to Mongo DB"></a>Two methods to connect to Mongo DB</h3><ul>
<li><p><code>mongoose.connect</code></p>
</li>
<li><p><code>mongoose.createConnection</code></p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> dbURL = <span class="hljs-string">'mongodb://...'</span></span><br><span class="line"><span class="hljs-keyword">const</span> dbOptions = &#123;</span><br><span class="line">  user: <span class="hljs-string">'db_user'</span>,</span><br><span class="line">  pass: <span class="hljs-string">'db_pass'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">const</span> adminConnection = mongoose.createConnection(dbURL, dbOptions)</span><br></pre></td></tr></table></figure>
<h3 id="Close-Connection"><a href="#Close-Connection" class="headerlink" title="Close Connection"></a>Close Connection</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connection.close(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Connection cvlosed'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">adminConnection.close(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'adminConnection closed'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// auto close when process exit</span></span><br><span class="line">process..on(<span class="hljs-string">'SIGINT'</span> () =&gt; &#123;</span><br><span class="line">  mongoose.connection.close(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mongoose disconnected through app termination'</span>)</span><br><span class="line">    process.exit(<span class="hljs-number">0</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Cache-Error"><a href="#Cache-Error" class="headerlink" title="Cache Error"></a>Cache Error</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connection.on(<span class="hljs-string">'error'</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mongoose connection error: '</span> + err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="db-js"><a href="#db-js" class="headerlink" title="db.js"></a>db.js</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// /model/db.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> dbURL = <span class="hljs-string">'mongodb://...'</span></span><br><span class="line"></span><br><span class="line">mongoose.connect(dbURL)</span><br><span class="line"></span><br><span class="line">mongoose.connection.on(<span class="hljs-string">'connected'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mongoose connected to '</span> + dbURL)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">mongoose.connection.on(<span class="hljs-string">'error'</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mongoose connection error: '</span> + err)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">mongoose.connection.on(<span class="hljs-string">'disconnected'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mongoose disconnected'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">process.on(<span class="hljs-string">'SIGINT'</span>, () =&gt; &#123;</span><br><span class="line">  mongoose.connection.close(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mongoose disconnected through app termination'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// app.js</span></span><br><span class="line">db = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./model/db'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Schema-and-Model-in-Mongoose"><a href="#Schema-and-Model-in-Mongoose" class="headerlink" title="Schema and Model in Mongoose"></a>Schema and Model in Mongoose</h2><blockquote>
<p>Everything in Mongoose starts with a Schema. Each schema maps to a MongoDB collection and defines the shape of the documents within that collection.</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> Schema = mongoose.Schema</span><br><span class="line"><span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> Schema(&#123;</span><br><span class="line">  name: <span class="hljs-built_in">String</span>,</span><br><span class="line">  pass: <span class="hljs-built_in">String</span>,</span><br><span class="line">  email: <span class="hljs-built_in">String</span>,</span><br><span class="line">  createTime: <span class="hljs-built_in">String</span>,</span><br><span class="line">  lastLogin: <span class="hljs-built_in">String</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Schema to define table structure.</p>
<p>Model to manipulate collection.</p>
<p>Use model to create documents in Mongodb.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// create model</span></span><br><span class="line"><span class="hljs-keyword">const</span> User = mongoose.model(<span class="hljs-string">'User'</span>, userSchema)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// create instance, namely document</span></span><br><span class="line"><span class="hljs-keyword">const</span> newUser = <span class="hljs-keyword">new</span> User(&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// insert document to db</span></span><br><span class="line">newUser.save(<span class="hljs-function">(<span class="hljs-params">err, doc</span>) =&gt;</span> &#123;</span><br><span class="line">  err &amp;&amp; <span class="hljs-built_in">console</span>.error(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'doc is saved'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// create and insert</span></span><br><span class="line">User.create(&#123;...&#125;, (err, doc) =&gt; &#123;</span><br><span class="line">  err &amp;&amp; <span class="hljs-built_in">console</span>.error(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'doc saved'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// add staitc methods</span></span><br><span class="line">userSchema.statics.findUsersByType = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">type, cb</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.find(&#123; <span class="hljs-attr">type</span>: <span class="hljs-keyword">this</span>.type &#125;, cb)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Model.$where(argument: string | Function): <query>, creates a Query and specifies a <em>$where</em> condition</query></li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Blog.$where(<span class="hljs-string">'this.username.indexOf("val") !== -1'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, docs</span>) </span>&#123;&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>Model#increment()</li>
</ul>
<h3 id="search"><a href="#search" class="headerlink" title="search"></a>search</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.find(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'type'</span> &#125;).where(<span class="hljs-string">'age'</span>).gt(<span class="hljs-number">2</span>).limit(<span class="hljs-number">10</span>).exec()</span><br></pre></td></tr></table></figure>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User.remove(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'type'</span> &#125;, (err, res) =&gt; &#123;</span><br><span class="line">  err &amp;&amp; <span class="hljs-built_in">console</span>.error(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">User.find(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'type'</span> &#125;).update(&#123;</span><br><span class="line">  $set: &#123;</span><br><span class="line">    date: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, (err) =&gt; &#123;</span><br><span class="line">  err &amp;&amp; <span class="hljs-built_in">console</span>.error(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>More…</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-07T04:23:35.000Z">2017-07-07</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    29 minutes read (About 4375 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/07/Notes-on-Interactive-Data-Visualization-for-the-Web/">Notes on Interactive Data Visualization for the Web</a>
            
        </h1>
        <div class="content">
            <h1 id="Introducing-D3"><a href="#Introducing-D3" class="headerlink" title="Introducing D3"></a>Introducing D3</h1><p>D3 – also referred to as d3.js – is a JavaScript library for creating data visualization. But that kind of undersell it.</p>
<p>The abbreviation D3 reference the tool’s full name, <em>Data-Driven Documents</em>. The <em>data</em> is provided by you, and the <em>documents</em> are web-based documents, meaning anything that can be rendered by a web browser, such as HTML and SVG. D3 does the <em>driviing</em>, in the sense that it connects the data to the documents.</p>
<h1 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h1><p><em>Data</em> is an extemely broad term, only slightly less vague than the nearly all-encompassing <em>information</em>.</p>
<p>Boradly speaking, data is a structured information with potential for meaning.</p>
<p>In the context of programming for visualization, data is stored in a digital file, typically in either text or binary form. Of course, potentially every piece of digital ephemera may be considered <code>data</code> – not just text, but bits and bytes representing images, audio, video, database, streams, models, archives, and anything else.</p>
<p>Within the scope of D3 and browser-based visualization, however, we will limit ourselves to <em>text-based</em>. That is, anything that can be presented as numbers and strings of alpha charaters.</p>
<h2 id="Binding-Data"><a href="#Binding-Data" class="headerlink" title="Binding Data"></a>Binding Data</h2><p>We use D3’s <code>data()</code> method to bind data to DOM elements. But there are two things we need in place first, before we can bind data:</p>
<ul>
<li><p>The data</p>
</li>
<li><p>A selection of DOM elements</p>
</li>
</ul>
<p>Anytime after you call <code>data()</code>, you can craete an anonymous function accepts <code>d</code> as input.</p>
<p>The magical <code>data()</code> method ensures that <code>d</code> is set to the corresponding value in your original dataset, given the current element at hand.</p>
<h2 id="Drawing-with-Data"><a href="#Drawing-with-Data" class="headerlink" title="Drawing with Data"></a>Drawing with Data</h2><p><code>.attr</code>, <code>.classed</code>, <code>.style</code></p>
<h1 id="Scales"><a href="#Scales" class="headerlink" title="Scales"></a>Scales</h1><blockquote>
<p>Scales are functions that map from an input domain to an output domain.</p>
</blockquote>
<p>The values in any dataset are unlikely to correspond exactly to pixel measurement for use in your visuallization.  Scales provide a convenient way to map those data values to new values useful for visuallization purposes.</p>
<p>D3 scales are <em>functions</em> with parameters that you define. Once they are created, you call the <code>scale</code> function , pass it a data value and it nicely returns a scaled output value.</p>
<p>A scale is a mathematical relationship, with no direct visual output.</p>
<h2 id="Domains-and-Ranges"><a href="#Domains-and-Ranges" class="headerlink" title="Domains and Ranges"></a>Domains and Ranges</h2><p>A scale’s <em>input domain</em> is the range of possible input data values.</p>
<p>A scale’s <em>output range</em> is the range of possible output values, commonly used as display values in pixel units.</p>
<h2 id="Normalization"><a href="#Normalization" class="headerlink" title="Normalization"></a>Normalization</h2><p>Normalization is the process of mapping a numeric value to a new value between 0 and 1, based on the possible minumum and maximum values.</p>
<h2 id="Creating-a-Scale"><a href="#Creating-a-Scale" class="headerlink" title="Creating a Scale"></a>Creating a Scale</h2><p>D3’s linear scale function generator is accessed with <code>d3.scaleLiner()</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> scale = d3.scaleLinear()</span><br></pre></td></tr></table></figure>
<p>Now <code>scale</code> is a function to which you can pass input values.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scale(<span class="hljs-number">2.5</span>) <span class="hljs-comment">// return 2.5</span></span><br></pre></td></tr></table></figure>
<p>Because we haven’t set a domain and a range yet, this function will map input to output on a <code>1:1</code> scale.</p>
<p>We set the scale’s input domain to 100, 500 by passing those values to the <code>domain()</code> method as an array.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scale.domain([<span class="hljs-number">100</span>, <span class="hljs-number">500</span>])</span><br></pre></td></tr></table></figure>
<p>Set the output range in similar fashion, with <code>range()</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scale.range([<span class="hljs-number">10</span>, <span class="hljs-number">350</span>])</span><br></pre></td></tr></table></figure>
<p>These steps can be chained:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> scale = d3.scaleLinear()</span><br><span class="line">  .domain([<span class="hljs-number">100</span>, <span class="hljs-number">500</span>])</span><br><span class="line">  .range([<span class="hljs-number">10</span>, <span class="hljs-number">350</span>])</span><br></pre></td></tr></table></figure>
<p>Now it’s effective</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scale(<span class="hljs-number">100</span>) <span class="hljs-comment">// return 10</span></span><br><span class="line">scale(<span class="hljs-number">300</span>) <span class="hljs-comment">// return 180</span></span><br><span class="line">scale(<span class="hljs-number">500</span>) <span class="hljs-comment">// return 350</span></span><br></pre></td></tr></table></figure>
<h3 id="d3-max-and-d3-min"><a href="#d3-max-and-d3-min" class="headerlink" title="d3.max() and d3.min()"></a>d3.max() and d3.min()</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> dataset = [</span><br><span class="line">  [<span class="hljs-number">5</span>, <span class="hljs-number">20</span>], [<span class="hljs-number">480</span>, <span class="hljs-number">90</span>], [<span class="hljs-number">250</span>, <span class="hljs-number">50</span>], [<span class="hljs-number">100</span>, <span class="hljs-number">33</span>], [<span class="hljs-number">330</span>, <span class="hljs-number">95</span>],</span><br><span class="line">  [<span class="hljs-number">410</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">475</span>, <span class="hljs-number">44</span>], [<span class="hljs-number">25</span>, <span class="hljs-number">67</span>], [<span class="hljs-number">85</span>, <span class="hljs-number">21</span>], [<span class="hljs-number">220</span>, <span class="hljs-number">88</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">d3.max(dataset, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> d[<span class="hljs-number">0</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="hljs-comment">// this function will return the value 480</span></span><br></pre></td></tr></table></figure>
<h3 id="Setting-Up-Dynamic-Scales"><a href="#Setting-Up-Dynamic-Scales" class="headerlink" title="Setting Up Dynamic Scales"></a>Setting Up Dynamic Scales</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> xScale = d3.scaleLinear()</span><br><span class="line">  .domain([<span class="hljs-number">0</span>, d3.max(dataset, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">    retrun d[<span class="hljs-number">0</span>]</span><br><span class="line">  &#125;)])</span><br><span class="line">  .range([<span class="hljs-number">0</span>, w])</span><br></pre></td></tr></table></figure>
<p>Output range is set to 0 and w, the SVG’s width.</p>
<p>Use the scale</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.attr(<span class="hljs-string">'x'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> xScale(d[<span class="hljs-number">0</span>])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>d3.scaleLinear()</code> has several other handly methods that deserve a breif mention here:</p>
</blockquote>
<ul>
<li><p><code>nice()</code>: this tells the scale to take whatever input domain that you gave to <code>domian()</code> and expand both ends to the nearest round value.</p>
</li>
<li><p><code>rangeRound()</code>: User <code>rangeRound()</code> in place of <code>range()</code>, and all values output by the scale will be rounded to nearest whole number.</p>
</li>
<li><p><code>clamp()</code>: By default, a linear scale can return values outside of the specified range. For example, if if given a value outside of its expected input domain, a scale will return a number also outside of the output range. Calling <code>clamp(true)</code> on a scale, forces all output values to be within the specified range. This means excessive values will be rounded to the range’s low or high value.</p>
</li>
</ul>
<p>To use any of these special methods, just tack them onto the chain in which you define the original scale function.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> scale = d3.scaleLinear().domain([<span class="hljs-number">0.123</span>, <span class="hljs-number">4.67</span>]).range([<span class="hljs-number">0</span>, <span class="hljs-number">500</span>]).nice()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Other Scales</p>
</blockquote>
<ul>
<li><p><code>sclaeSqrt</code></p>
</li>
<li><p><code>scalePow</code></p>
</li>
<li><p><code>scaleLog</code></p>
</li>
<li><p><code>scaleQuantize</code></p>
</li>
<li><p><code>scaleQuantile</code></p>
</li>
<li><p><code>scaleOrdinal</code></p>
</li>
<li><p><code>scaleTime</code></p>
</li>
</ul>
<h1 id="Axes"><a href="#Axes" class="headerlink" title="Axes"></a>Axes</h1><p>D3’s axes are actually <code>function</code> whose parameters you define. Unlike scales, when an axis function is called, it doesn’t return a value, but generates the visual elements of the axis, including lines, labels, and ticks.</p>
<h2 id="Setting-Up-an-Axis"><a href="#Setting-Up-an-Axis" class="headerlink" title="Setting Up an Axis"></a>Setting Up an Axis</h2><p>There are four different axis function constructors, each one corresponding to a different orientation and placement of labels: <code>d3.axisTop</code>, <code>d3.axisBottom</code>, <code>d3.axisLeft</code>, <code>d3.axisRight</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> xAxis = d3.axisBottom()</span><br></pre></td></tr></table></figure>
<p>At a minimum, each axis also needs to be told on what <em>scale</em> to operate.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> xAxis = d3.axisBottom().scale(xScale)</span><br><span class="line"><span class="hljs-comment">// or</span></span><br><span class="line"><span class="hljs-keyword">const</span> xAxis = d3.axisBottom(xScale)</span><br></pre></td></tr></table></figure>
<p>Finally, to actually generate the axis and insert all those little lines and labels into our SVG, we must <code>call</code> teh <code>xAxis</code> function. This is similar to the scale functions, which we first configured by setting parameters, and then later <code>called</code> to put them into action.</p>
<p>Here we put this code at the end of script, so the axis is generated after the other elements in the SVG, and therefore appears ‘on top’</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="hljs-string">'g'</span>).call(xAxis)</span><br></pre></td></tr></table></figure>
<p>This is where things get a little funky. You might be wondering why this looks so different from our friendly scale functions. Here’s why: because an axis function actually draws something to the screen (by appending SVG elements to the DOM), we need to specify where in the DOM it should place new elements.</p>
<p>In the svg, we <code>append()</code> a new <code>g</code> element to the end of the SVG. In SVG land, a <code>g</code> element is a <code>group</code> element. Group elements are invisible, unlike <code>line</code>, <code>rect</code>, and <code>circle</code> and they have no visual presence themselves.</p>
<p>The <code>g</code> element can keep our code nice and be transformed.</p>
<p>So we’ve created a new <code>g</code>, and then finally, the function <code>call()</code> is called on our new <code>g</code>.</p>
<p>D3’s <code>call()</code> function takes the incoming <code>selection</code>, as received from the prior link in the chain, and hands that selection off to any <code>function</code>.</p>
<p>This this case, the selection is our new <code>g</code> group element. Although the <code>g</code> isn’t strictly necessary, we are using it because the axis function is about to generate lots of crazy lines and numbers, and it’s noce to contain all those element within a single group object.</p>
<p><code>call()</code> hands off <code>g</code> to the <code>xAxis</code> function, so our axis is genrated within <code>g</code></p>
<h3 id="Positioning-Axes"><a href="#Positioning-Axes" class="headerlink" title="Positioning Axes"></a>Positioning Axes</h3><p>By default, an axis is positioned using the range values of the specified scale. In our case, <code>xAxis</code> is referencing <code>xScale</code>, which has a range of [20, 460], because we applied 20 pixels of padding on all edge of the SVG. We can transform the axis by:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="hljs-string">'g'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'axis'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'tranform'</span>, <span class="hljs-string">'translate(0, '</span> + (h - padding) + <span class="hljs-string">')'</span>)</span><br><span class="line">  .call(xAxis)</span><br></pre></td></tr></table></figure>
<p>In the end, we would like  our <code>g</code> to look like this in the DOM:</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"axis"</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">"translate(0, 280)"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="CSS-styles-on-axis"><a href="#CSS-styles-on-axis" class="headerlink" title="CSS styles on axis"></a>CSS styles on axis</h3><p>The axes themselves are made up of <code>path</code>, <code>line</code>, <code>text</code> element, so those are the three elemnts to target in your CSS.</p>
<p>The paths and lines can be styled together, with the same rules, and text gets its own rules around for font and font size.</p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.axis</span> <span class="hljs-selector-tag">path</span>, <span class="hljs-selector-class">.axis</span> <span class="hljs-selector-tag">line</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">stroke</span>: teal;</span><br><span class="line">  <span class="hljs-attribute">shape-rendering</span>: crispEdges;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-selector-class">.axis</span> <span class="hljs-selector-tag">text</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">font-family</span>: Optima, Futura, sans-serif;</span><br><span class="line">  <span class="hljs-attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;</span><br><span class="line">  <span class="hljs-attribute">fill</span>: teal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>These CSS rules will override D3’s default styles.</p>
<p>Note that when we use CSS rules to style SVG elements, only SVG attribute names – not regular CSS properties – should be used.</p>
<h3 id="Check-for-Ticks"><a href="#Check-for-Ticks" class="headerlink" title="Check for Ticks"></a>Check for Ticks</h3><p>Some ticks spread disease, but D3’s ticks communicates information.</p>
<p>You can customize all aspects of your axes, starting with the rough number of ticks, using <code>ticks()</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> xAxis = d3.axisBottom().scale(xScale).ticks(<span class="hljs-number">6</span>) <span class="hljs-comment">// set rough # of ticks</span></span><br></pre></td></tr></table></figure>
<p>Specifying tick values manually</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> xAixs = d3.axisBottom().scale(xScale).tickValues([<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">250</span>, <span class="hljs-number">700</span>])</span><br></pre></td></tr></table></figure>
<h3 id="Formatting-Tick-labels"><a href="#Formatting-Tick-labels" class="headerlink" title="Formatting Tick labels"></a>Formatting Tick labels</h3><p>Enter <code>tickFormat()</code>, which enables you to specify how your numbers should be formatted.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> formatAsPercentage = d3.format(<span class="hljs-string">".1%"</span>)</span><br><span class="line">xAxis.tickFormat(formatAsPercentage)</span><br></pre></td></tr></table></figure>
<h1 id="Updates-Transtions-and-Motion"><a href="#Updates-Transtions-and-Motion" class="headerlink" title="Updates, Transtions, and Motion"></a>Updates, Transtions, and Motion</h1><blockquote>
<p>Transtion: .transition(), .duration()</p>
</blockquote>
<blockquote>
<p>Motion: .delay(), .ease()</p>
</blockquote>
<p>The argument could be number or function</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.transition()</span><br><span class="line">.delay(<span class="hljs-function">(<span class="hljs-params">d, i</span>) =&gt;</span> <span class="hljs-number">100</span> * i)</span><br><span class="line">.duration(<span class="hljs-number">300</span>)</span><br></pre></td></tr></table></figure>
<p>The default easing is <code>d3.easeCubicInOut</code>, which produces the gradual acceleration and deceleration.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.transition()</span><br><span class="line">.duration(<span class="hljs-number">3000</span>)</span><br><span class="line">.ease(d3.easeLinear)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>d3.easeCircleIn</p>
</li>
<li><p>d3.easeElasticOut</p>
</li>
<li><p>d3.easeBounceOut</p>
</li>
</ul>
<h3 id="on-Transition-Starts-and-Ends"><a href="#on-Transition-Starts-and-Ends" class="headerlink" title="on() Transition Starts and Ends"></a>on() Transition Starts and Ends</h3><p>There will be times when you want to make something happen at the start or end of a transition. In those time you can use <code>on()</code> to execute arbitrary code for each element in the selection.</p>
<p><code>on()</code> expects two arguments:</p>
<ul>
<li><p>Either “start” or “end”</p>
</li>
<li><p>An anonymous function, to be executed either at the start of a transition, or as soon as it has ended.</p>
</li>
</ul>
<blockquote>
<p>Notice: Only one transition can be active on any given element at any given time.</p>
</blockquote>
<h3 id="Containing-Visual-Elements-With-Clipping-Paths"><a href="#Containing-Visual-Elements-With-Clipping-Paths" class="headerlink" title="Containing Visual Elements With Clipping Paths"></a>Containing Visual Elements With Clipping Paths</h3><p>SVG has support for <em>clipping paths</em>, which you might know as <em>masks</em> in many drawing tools.</p>
<p>Much like <code>g</code>, <code>clipPath</code> has no visual presence of its own, but it contains visual elements.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;clipPath id=<span class="hljs-string">"chart-area"</span>&gt;</span><br><span class="line">  &lt;rect x=<span class="hljs-string">"30"</span> y=<span class="hljs-string">"30"</span> width=<span class="hljs-string">"410"</span> height=<span class="hljs-string">"240"</span>&gt;<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">rect</span>&gt;</span></span></span><br><span class="line">&lt;<span class="hljs-regexp">/clipPath&gt;</span></span><br></pre></td></tr></table></figure>
<p>Note that outer <code>clipPath</code> element has been given an ID of <code>chart-area</code>. We can use that ID to reference it later. Within the <code>clipPath</code> is a <code>rect</code>, which will function as the mask.</p>
<p>3 steps to using a clipping path:</p>
<ol>
<li><p>Define a <code>clipPath</code> and give it an ID</p>
</li>
<li><p>Put visual elements within the <code>clipPath</code> (usuallly just a <code>rect</code>, but this could be <code>circles</code> or any other visual elements)</p>
</li>
<li><p>Add a reference to the <code>clipPath</code> form whatever elements you wish to be masked.</p>
</li>
</ol>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="hljs-string">'clipPath'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'id'</span>, <span class="hljs-string">'chart-area'</span>) <span class="hljs-comment">// assign an id</span></span><br><span class="line">  .append(<span class="hljs-string">'rect'</span>) <span class="hljs-comment">// within the clippath, create new rect</span></span><br><span class="line">  .attr(<span class="hljs-string">'x'</span>, padding)</span><br><span class="line">  .attr(<span class="hljs-string">'y'</span>, padding)</span><br><span class="line">  .attr(<span class="hljs-string">'width'</span>, w - padding * <span class="hljs-number">2</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'height'</span>, h - padding * <span class="hljs-number">2</span>)</span><br><span class="line"></span><br><span class="line">svg.append(<span class="hljs-string">'g'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'id'</span>, <span class="hljs-string">'circles'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'clip-path'</span>, <span class="hljs-string">'url(#chart-area)'</span>)</span><br><span class="line">  .selectAll(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .data(dataset)</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'circle'</span>)</span><br></pre></td></tr></table></figure>
<h1 id="Interactivity"><a href="#Interactivity" class="headerlink" title="Interactivity"></a>Interactivity</h1><p>D3 allows you to bind event listener to more than one element at a time.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">svg.selectAll(<span class="hljs-string">'rect'</span>)</span><br><span class="line">  .data(dataset)</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'rect'</span>)</span><br><span class="line">  ....</span><br><span class="line">  .on(<span class="hljs-string">'click'</span>, (d) =&gt; &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<p>Within anonymous function , D3 automatically sets the context of <code>this</code>  so it references <code>current element upon which we are acting</code></p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-tag">svg</span> <span class="hljs-selector-tag">text</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">pointer-event</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="hljs-string">'text'</span>).style(<span class="hljs-string">'pointer-event'</span>, <span class="hljs-string">'none'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Grouping-SVG-Element"><a href="#Grouping-SVG-Element" class="headerlink" title="Grouping SVG Element"></a>Grouping SVG Element</h3><p>Note that <code>g</code> group elements do not, by themselves, trigger any mouse events. The reason for this is that <code>g</code> elements have no pixels.</p>
<p>You can still bind event listener to <code>g</code> elements, just keep in mind that the elements within that <code>g</code> will then behave as a group. If any of the enclosed elements are clicked or moused over, then the listener function will be activated.</p>
<h3 id="Tooltips"><a href="#Tooltips" class="headerlink" title="Tooltips"></a>Tooltips</h3><p>In interactive visualizations, tooltips are small overlays that present data values. In many cases, it’s not necessary to label every individual data value in the default value, but that level of detail should still be accessible to users.</p>
<h4 id="SVG-Element-Tooltips"><a href="#SVG-Element-Tooltips" class="headerlink" title="SVG Element Tooltips"></a>SVG Element Tooltips</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.on(<span class="hljs-string">'mouseover'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> xPosition = <span class="hljs-built_in">parseFloat</span>(d3.select(<span class="hljs-keyword">this</span>)).attr(<span class="hljs-string">'x'</span>) + xScale.bandWidth()</span><br><span class="line">  <span class="hljs-keyword">const</span> yPosition = <span class="hljs-built_in">parseFloat</span>(d3.select(<span class="hljs-keyword">this</span>)).attr(<span class="hljs-string">'y'</span>) + <span class="hljs-number">14</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// create the tooltip label</span></span><br><span class="line"></span><br><span class="line">svg.append(<span class="hljs-string">'text'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'id'</span>, <span class="hljs-string">'tooltip'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'x'</span>, xPosition)</span><br><span class="line">  .attr(<span class="hljs-string">'y'</span>, yPosition)</span><br><span class="line">  .attr(<span class="hljs-string">'text-anchor'</span>, <span class="hljs-string">'middle'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'font-family'</span>, <span class="hljs-string">'sans-serif'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'font-size'</span>, <span class="hljs-string">'11px'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'font-weight'</span>, <span class="hljs-string">'bold'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'fill'</span>, <span class="hljs-string">'black'</span>)</span><br><span class="line">  .text(d)</span><br><span class="line"></span><br><span class="line">.on(<span class="hljs-string">'mouseout'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  d3.select(<span class="hljs-string">'#tooltip'</span>).remove()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Using-Paths"><a href="#Using-Paths" class="headerlink" title="Using Paths"></a>Using Paths</h1><h3 id="Line-Charts"><a href="#Line-Charts" class="headerlink" title="Line Charts"></a>Line Charts</h3><h4 id="Scale-setup"><a href="#Scale-setup" class="headerlink" title="Scale setup"></a>Scale setup</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> xScale = d3.scaleTime()</span><br><span class="line">  .domain([</span><br><span class="line">    d3.min(dataset, (d) =&gt; d.date),</span><br><span class="line">    d3.max(dataset, (d) =&gt; da.date)</span><br><span class="line">  ])</span><br><span class="line">  .range([<span class="hljs-number">0</span>, w])</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> yScale = d3.scaleLinear()</span><br><span class="line">  .domain([</span><br><span class="line">    <span class="hljs-number">0</span>,</span><br><span class="line">    d3.max(dataset, (d) =&gt; d.avarage)</span><br><span class="line">  ])</span><br><span class="line">  .range([h, <span class="hljs-number">0</span>])</span><br></pre></td></tr></table></figure>
<p>Define a line generator</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> lineGen = d3.line()</span><br><span class="line">  .x(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> xScale(d.date))</span><br><span class="line">  .y(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> yScale(d.avarage))</span><br></pre></td></tr></table></figure>
<p>The x and y accessors tell the line generator how to decide <code>where</code> to place each point on the line.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> svg = d3.select(<span class="hljs-string">'body'</span>)</span><br><span class="line">  .append(<span class="hljs-string">'svg'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'width'</span>, w)</span><br><span class="line">  .attr(<span class="hljs-string">'height'</span>, h)</span><br><span class="line"></span><br><span class="line">svg.append(<span class="hljs-string">'path'</span>)</span><br><span class="line">  .datum(dataset)</span><br><span class="line">  .attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'line'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'d'</span>, lineGen)</span><br></pre></td></tr></table></figure>
<p>Instead of using <code>data()</code> to bind each value in our <code>dataset</code> array to a different element, we use <code>datum()</code>, the method for binding a <em>single</em> data value to a single element. The entire <code>dataset</code> array is bound to the new <code>path</code> we just created.</p>
<p>We set a <code>d</code> attribute, passing in our line generator function as an argument.</p>
<p>Since the data has already been bound to the <code>path</code>, the line generator simply grabs taht data. plots the pointers as we specified, and draws a line connecting them.</p>
<h3 id="Dealing-with-Missing-Data"><a href="#Dealing-with-Missing-Data" class="headerlink" title="Dealing with Missing Data"></a>Dealing with Missing Data</h3><p>Assume a -99.99 value is not a true measurement, namely one value is missed.</p>
<p><code>defined()</code> is just an configuration method, like <code>x()</code> and <code>y()</code>. If the result of its anonymous function is true, then that data value is included, or the value is excluded.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> lineGen = d3.line()</span><br><span class="line">  .defined(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (d.avarage &gt; <span class="hljs-number">0</span>))</span><br><span class="line">  .x(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> x.date)</span><br><span class="line">  .y(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> x.avatarge)</span><br></pre></td></tr></table></figure>
<h3 id="Area-Charts"><a href="#Area-Charts" class="headerlink" title="Area Charts"></a>Area Charts</h3><p>Areas are not too different from lines. If a line is a series of connected (x, y) points, then an area is just that same line, plus a second such line (usually a flat baseline), with all the space in between filled in.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> area = d3.area()</span><br><span class="line">  .defined(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (d.avarage &gt; <span class="hljs-number">0</span>))</span><br><span class="line">  .x(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (xScale(d.date)))</span><br><span class="line">  .y0(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (yScale.range()[<span class="hljs-number">0</span>]))</span><br><span class="line">  .y1(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> (yScale(d.avarge)))</span><br></pre></td></tr></table></figure>
<p><code>y0</code> represents the area’s baseline, which <code>y1</code> represents the top.</p>
<h1 id="Selections"><a href="#Selections" class="headerlink" title="Selections"></a>Selections</h1><h3 id="A-Closer-Look-at-Selections"><a href="#A-Closer-Look-at-Selections" class="headerlink" title="A Closer Look at Selections"></a>A Closer Look at Selections</h3><p><img src="https://www.safaribooksonline.com/library/view/interactive-data-visualization/9781491921296/assets/dvw2_1201.png" alt=""></p>
<p><code>d3.select(&#39;body&#39;)</code> returns a <code>Selection</code>, which consists of <code>_groups</code> and <code>_parents</code></p>
<p>So a selection contains two arrays: <code>_groups</code> and <code>_parents</code></p>
<p><code>_groups</code> contains yet another array, which itself contains a list of elements – ony one in this case, <code>body</code>.</p>
<p>Let’s expand <code>body</code> and will see a lot of properties associated with <code>body</code>.</p>
<p>Selections are just very special objects generated and interpreted by D3. You will never manipulate a selection yourself – don’t bother trying to reach int <code>_groups</code> – as that’s what all of D3’s selection methods are for.</p>
<p><code>d3.select()</code> and <code>d3.selectAll()</code> operate at the page level, which means</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> allGroups = d3.selectAll(<span class="hljs-string">'g'</span>)</span><br></pre></td></tr></table></figure>
<p>The <code>select()</code> and <code>selectAll()</code> statements create <em>new</em> selections, and hand those new selections off to the subsequent methods.</p>
<p>To minimize the confusion from old and new selections, Mike Bostock recommends using an indentation convetion of four space when the selection is unchanged, but only two when a new selection is returned.</p>
<p><code>select()</code> and <code>append()</code> are methods that return new selections, <code>attr()</code> does not, but merely relays whatever selection it just acted on.</p>
<h3 id="Storing-Selections"><a href="#Storing-Selections" class="headerlink" title="Storing Selections"></a>Storing Selections</h3><p>Selections are immutable. All selection methods that affect which elements are selected (or their order) return a new selection rather tahn modifying the current selection.</p>
<p>That is, once you make a selection, you can’t modify it. You can only make a new one, which could be a subset of the original, and overwrite it.</p>
<h3 id="Enter-Merge-and-Exit"><a href="#Enter-Merge-and-Exit" class="headerlink" title="Enter, Merge and Exit"></a>Enter, Merge and Exit</h3><h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d3.select(<span class="hljs-string">'body'</span>).selectAll(<span class="hljs-string">'p'</span>)</span><br><span class="line">  .data(dataset)</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'p'</span>)</span><br><span class="line">  .text(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (<span class="hljs-string">'I can count up to '</span> + d))</span><br><span class="line">  .filter(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> (d &gt; <span class="hljs-number">15</span>))</span><br><span class="line">  .style(<span class="hljs-string">'color'</span>, <span class="hljs-string">'red'</span>)</span><br></pre></td></tr></table></figure>
<p><code>filter()</code> takes a selection and an anonymous function. If the function return <code>true</code> for a given element, then that element is included in the new selection returned by <code>filter()</code>.</p>
<h3 id="Each"><a href="#Each" class="headerlink" title="Each"></a>Each</h3><p>The most common purpose of creating a selection is to ultimately to modify it in some way, such as by using <code>attr()</code> or <code>style()</code>. But it can be useful to define your own functions, espectially for custom calculation or modifications that will be repeated.</p>
<p>We can use <code>each()</code> to run an arbitrary function once for each element in a selection. <code>each()</code> takes whatever selection it’s given and calls the specified function once for each item in the selection.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">selection.each(<span class="hljs-function">(<span class="hljs-params">d, i</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Some serious points to note:</p>
<ul>
<li><p>Since the <code>d</code> and <code>i</code> arguments are specified in the function definition, D3 will populate them for you.</p>
</li>
<li><p>The value of <code>this</code> will also be set by D3 to reflect <code>the element upon which we&#39;re currently acting</code>, So <code>d3.select(this)</code> will create a selection with whatever that element is.</p>
</li>
<li><p>In <code>delay()</code> or any other function within (d, i) =&gt; {}, we can reference the value <code>d</code>, and <code>i</code> directly, no need to write <code>(d, i)</code></p>
</li>
</ul>
<h1 id="Layouts"><a href="#Layouts" class="headerlink" title="Layouts"></a>Layouts</h1><p>Contrary to what the name implies, D3 <em>layouts</em> do not, in fact, lay anything out for you on the screen. The layout methods have no direct <em>visual</em> output. Rather, D3 layouts take data that you provided and remap or otherwise transform it, thereby generating <em>new</em> data that is more convenient for a specific visual task.</p>
<p>The list of D3 layouts includes:</p>
<ul>
<li><p>Chord</p>
</li>
<li><p>Cluster</p>
</li>
<li><p>Force</p>
</li>
<li><p>Pack</p>
</li>
<li><p>Partition</p>
</li>
<li><p>Pie</p>
</li>
<li><p>Stack</p>
</li>
<li><p>Tree</p>
</li>
<li><p>Treemap</p>
</li>
</ul>
<h3 id="Pie-Layout"><a href="#Pie-Layout" class="headerlink" title="Pie Layout"></a>Pie Layout</h3><p><code>d3.pie()</code> might not be as delicious as it sounds, but it’s still worthy of your attention. It is typically used to create a doughnut or pie chart.</p>
<p>Start with simple dataset</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> dataset = [ <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">45</span>, <span class="hljs-number">6</span>, <span class="hljs-number">25</span> ]</span><br></pre></td></tr></table></figure>
<p>Wd define a default pie layout</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> pie = d3.pie()</span><br></pre></td></tr></table></figure>
<p>Then, all that remains is to hand off our data to the new <code>pie()</code> function, as in <code>pie(dataset)</code>.</p>
<p>The pie layout takes our simple array of numbers and generates an array of objects, one object for each value. Each of those objects now has a few new values – most important, <code>startAngle</code> and <code>endAngle</code>.</p>
<p>To actually draw the wedges, we turn to <code>d3.arc()</code>, a handy built-in function for drawing arcs as SVG <code>path</code> elements.</p>
<p>Arcs are defiend as custom functions, and they require inner and outer redius values.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> w = <span class="hljs-number">300</span></span><br><span class="line"><span class="hljs-keyword">const</span> h = <span class="hljs-number">300</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> outerRadius = w / <span class="hljs-number">2</span></span><br><span class="line"><span class="hljs-keyword">const</span> innerRadius = <span class="hljs-number">0</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> arc = d3.arc()</span><br><span class="line">  .innerRadius(innerRadius)</span><br><span class="line">  .outerRadius(outerRadius)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> svg = d3.select(<span class="hljs-string">'body'</span>)</span><br><span class="line">  .append(<span class="hljs-string">'svg'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'width'</span>, w)</span><br><span class="line">  .attr(<span class="hljs-string">'height'</span>, h)</span><br></pre></td></tr></table></figure>
<p>Then we can create new groups for each incoming wedge, binding the pie-ified data to the new elements, and translating each group into the center of the chart, so the <code>path</code>s will appear in the right place</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// set up groups</span></span><br><span class="line"><span class="hljs-keyword">const</span> arcs = svg.selectAll(<span class="hljs-string">'g.arc'</span>)</span><br><span class="line">  .data(pie(dataset))</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'g'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'arc'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'transform'</span>, <span class="hljs-string">'translate('</span> + outerRadius + <span class="hljs-string">', '</span> + outerRadius + <span class="hljs-string">')'</span>)</span><br></pre></td></tr></table></figure>
<p>Note that we’re saving a reference to each newly created <code>g</code> in a variable called <code>arcs</code></p>
<p>Finally, within each new <code>g</code>, we append a <code>path</code>. A <code>path</code>‘s path description is defined in the <code>d</code> attribute. So we call the <code>arc</code> generator, which generates the path information based on the data already bound to this group.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// draw arc paths</span></span><br><span class="line">arcs.append(<span class="hljs-string">'path'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'fill'</span>, (d, i) =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> colors(i)</span><br><span class="line">  &#125;)</span><br><span class="line">  .attr(<span class="hljs-string">'d'</span>, arc)</span><br></pre></td></tr></table></figure>
<p><code>arc</code> is our path generator function.</p>
<p>When a named function is specified as a parameter in this way, D3 automcatically passes in the datum and index values, without us having to write them out explicitly.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.attr(<span class="hljs-string">'d'</span>, arc)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// equivalent</span></span><br><span class="line"></span><br><span class="line">.attr(<span class="hljs-string">'d'</span>, (d, i) =&gt; (arc(d, i)))</span><br></pre></td></tr></table></figure>
<p>D3 has a number of handy ways to generate categorical colors</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> color = d3.scaleOrdinal(d3.schemeCategory10)</span><br></pre></td></tr></table></figure>
<p>Generate text labels for each wedge:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arcs.append(<span class="hljs-string">'text'</span>)</span><br><span class="line">  .artr(<span class="hljs-string">'transform'</span>, (d) =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">'translate('</span> + arc.centroid(d) + <span class="hljs-string">')'</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .attr(<span class="hljs-string">'text-anchor'</span>, <span class="hljs-string">'middle'</span>)</span><br><span class="line">  .text(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> &#123; <span class="hljs-keyword">return</span> d.value &#125;)</span><br></pre></td></tr></table></figure>
<p>A <em>centroid</em> is the calculated center point of any shape, whether that shape is regular(like a square) or highly irregular(like an outline of the state of Maryland).</p>
<p><code>arc.centroid()</code> is super-helpful function that calculates and returns the center point of any arc.</p>
<blockquote>
<p>Note: The pie layout automatically reordered out data values from largest to smallest.</p>
</blockquote>
<h3 id="Stack-Layout"><a href="#Stack-Layout" class="headerlink" title="Stack Layout"></a>Stack Layout</h3><p><code>d3.stack()</code> converts two-dimentional data into ‘stacked’ data.</p>
<p>It calculates a baseline value for each datum, so you can <code>stack</code> layers of data on top of one another.</p>
<p>Start with some data</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> dataset = [</span><br><span class="line">  &#123; <span class="hljs-attr">apples</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">oranges</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">grapes</span>: <span class="hljs-number">22</span> &#125;,</span><br><span class="line">true&#123; <span class="hljs-attr">apples</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">oranges</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">grapes</span>: <span class="hljs-number">28</span> &#125;,</span><br><span class="line">true&#123; <span class="hljs-attr">apples</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">oranges</span>: <span class="hljs-number">19</span>, <span class="hljs-attr">grapes</span>: <span class="hljs-number">32</span> &#125;,</span><br><span class="line">true&#123; <span class="hljs-attr">apples</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">oranges</span>: <span class="hljs-number">23</span>, <span class="hljs-attr">grapes</span>: <span class="hljs-number">35</span> &#125;,</span><br><span class="line">true&#123; <span class="hljs-attr">apples</span>: <span class="hljs-number">23</span>, <span class="hljs-attr">oranges</span>: <span class="hljs-number">17</span>, <span class="hljs-attr">grapes</span>: <span class="hljs-number">43</span> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>The <code>dataset</code> is organized by <em>column</em>. The stack layout reconfigures the data to be organized by <em>categories</em>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Set up stack method</span></span><br><span class="line"><span class="hljs-keyword">const</span> stack = d3.stack().keys([<span class="hljs-string">'apples'</span>, <span class="hljs-string">'oranges'</span>, <span class="hljs-string">'grapes'</span>])</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Data, stacked</span></span><br><span class="line"><span class="hljs-keyword">const</span> series = stack(dataset)</span><br></pre></td></tr></table></figure>
<p>Now <code>series</code> is an array with three values, each one itself an array corresponding to each categorical series: apples, oranges, and grapes(in that order because we specified as such in <code>keys()</code>)</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//'series', the array formerly known as 'dataset'</span></span><br><span class="line">[</span><br><span class="line">true[ [ <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>], [ <span class="hljs-number">0</span>,  <span class="hljs-number">4</span>], [ <span class="hljs-number">0</span>,  <span class="hljs-number">2</span>], [ <span class="hljs-number">0</span>,  <span class="hljs-number">7</span>], [ <span class="hljs-number">0</span>, <span class="hljs-number">23</span>] ],  <span class="hljs-comment">// apples</span></span><br><span class="line">true[ [ <span class="hljs-number">5</span>, <span class="hljs-number">15</span>], [ <span class="hljs-number">4</span>, <span class="hljs-number">16</span>], [ <span class="hljs-number">2</span>, <span class="hljs-number">21</span>], [ <span class="hljs-number">7</span>, <span class="hljs-number">30</span>], [<span class="hljs-number">23</span>, <span class="hljs-number">40</span>] ],  <span class="hljs-comment">// oranges</span></span><br><span class="line">true[ [<span class="hljs-number">15</span>, <span class="hljs-number">37</span>], [<span class="hljs-number">16</span>, <span class="hljs-number">44</span>], [<span class="hljs-number">21</span>, <span class="hljs-number">53</span>], [<span class="hljs-number">30</span>, <span class="hljs-number">65</span>], [<span class="hljs-number">40</span>, <span class="hljs-number">83</span>] ]   <span class="hljs-comment">// grapes</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>To stack element visually, now we can reference each data object’s baseline and top line values.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Add a group for each row of data</span></span><br><span class="line"><span class="hljs-keyword">const</span> groups = svg.selectAll(<span class="hljs-string">'g'</span>)</span><br><span class="line">  .data(series)</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'g'</span>)</span><br><span class="line">  .style(<span class="hljs-string">'fill'</span>, (di, i) =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> colors(i)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Add a rect for each data value</span></span><br><span class="line"><span class="hljs-keyword">const</span> rects = groups.selectAll(<span class="hljs-string">'rect'</span>)</span><br><span class="line">  .data(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> (d))</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'rect'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'x'</span>, (d, i) =&gt; &#123;</span><br><span class="line">    retrun xScale(i)</span><br><span class="line">  &#125;)</span><br><span class="line">  .attr(<span class="hljs-string">'y'</span>, (d) =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> ySclae(d[<span class="hljs-number">0</span>])</span><br><span class="line">  &#125;)</span><br><span class="line">  .attr(<span class="hljs-string">'height'</span>, (d) =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> yScale(d[<span class="hljs-number">1</span>]-d[<span class="hljs-number">0</span>])</span><br><span class="line">  &#125;)</span><br><span class="line">  .attr(<span class="hljs-string">'width'</span>, xScale.bandWidth())</span><br></pre></td></tr></table></figure>
<p>Within each group, we select all the <code>rect</code>s and bind a subset of the data with this line</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.data(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> (d))</span><br></pre></td></tr></table></figure>
<h4 id="A-New-Order"><a href="#A-New-Order" class="headerlink" title="A New Order"></a>A New Order</h4><p>Unless otherwise specified, series will be stacked in the order specified in <code>keys()</code>.</p>
<p>But you can use <code>order()</code> to specify an alternate sequence to be applied before all the stacked values are calculated.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> stack = d3.stack()</span><br><span class="line">  .keys([ <span class="hljs-string">'apples'</span>, <span class="hljs-string">'oranges'</span>, <span class="hljs-string">'grapes'</span> ])</span><br><span class="line">  .order(d3.stackOrderDesending)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>d3.stackOrderNone</p>
</li>
<li><p>d3.stackOrderReverse</p>
</li>
<li><p>d3.stackOrderAscending</p>
</li>
<li><p>d3.stackOrderDescending</p>
</li>
</ul>
<h3 id="Stacked-Areas"><a href="#Stacked-Areas" class="headerlink" title="Stacked Areas"></a>Stacked Areas</h3><p>This can be a valuable way to represent time series data, when a sum total is derived from several related categories.</p>
<h3 id="Force-Layout"><a href="#Force-Layout" class="headerlink" title="Force Layout"></a>Force Layout</h3><p>Force-directed layouts are so-called because they use simulations of physical <em>force</em> to arrange elements on the screen.</p>
<p>Force layouts are typically used with network data. In computer science, this kind of dataset is called a <code>graph</code>. A simple graph is a list of <code>node</code> and <code>edge</code>. The nodes are entities in the dataset, and the edges are the <code>connection</code>s between nodes. Some nodes will be connected by edges and others won’t.</p>
<p>Nodea are commonly represented as circles and edges as lines.</p>
<p>The physical metaphor here is of particles that repel each other, yet are also connected by strings.  The repelling forces push particles away from each other, preventing visual overlap, and the strings prevent them from just flying out into space, thereby keeping them on the screen where we can see them.</p>
<h4 id="Preparing-the-network-data"><a href="#Preparing-the-network-data" class="headerlink" title="Preparing the network data"></a>Preparing the network data</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> dataset = &#123;</span><br><span class="line">truenodes: [</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Adam"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Carrie"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Donovan"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Edward"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Felicity"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"George"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Hannah"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Iris"</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">"Jerry"</span> &#125;</span><br><span class="line">true],</span><br><span class="line">trueedges: [</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">1</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">2</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">3</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">4</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">5</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">5</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">5</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">4</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">8</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">9</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">7</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">8</span> &#125;,</span><br><span class="line">truetrue&#123; <span class="hljs-attr">source</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">target</span>: <span class="hljs-number">9</span> &#125;</span><br><span class="line">true]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="Defining-the-Force-Simulation"><a href="#Defining-the-Force-Simulation" class="headerlink" title="Defining the Force Simulation"></a>Defining the Force Simulation</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Initialize a simple force layout, using the nodes and edges in dataset</span></span><br><span class="line"><span class="hljs-keyword">const</span> layout = d3.forceSimulation(dataset.nodes)</span><br><span class="line">  .force(<span class="hljs-string">'charge'</span>, d3.forceManyBody())</span><br><span class="line">  .force(<span class="hljs-string">'link'</span>, d3.forceLink(dataset.edges))</span><br><span class="line">  .force(<span class="hljs-string">'center'</span>, d3.forceCenter().x(w/<span class="hljs-number">2</span>).y(h/<span class="hljs-number">2</span>))</span><br></pre></td></tr></table></figure>
<p>Call <code>d3.forceSimulation()</code> and pass in a reference to the nodes. This will generate a new simulator and automatically start running it, but without any forces applied, it won’t be very interesting.</p>
<p>To create force, call <code>force()</code> as many times as you like, each time specifying an arbitrary name for each force(in case you want to reference it later) and the name of a force function.</p>
<ul>
<li><p><code>d3.forceManyBody()</code>: Create a <em>many-body</em> force which acts on <strong>all</strong> nodes, meaning this can be used to either attract all nodes to each other or repel all nodes from each other. Try different <code>strength()</code> values, and see what happens. The default <code>strength()</code> is -30, so we will see a slight repelling force.</p>
</li>
<li><p><code>d3.forceLink()</code>: Our nodes are connected by edges, so we apply this force, specifying <code>dataset.edges</code>. Specify a target <code>distance()</code> (the default is 30 pixles), and this force will struggle agains any competing forces to achieve that distance.</p>
</li>
<li><p><code>d3.forceCenter()</code>: This force centers the entire simulation around whatever point you specify with <code>x()</code> and <code>y()</code>.</p>
</li>
</ul>
<h4 id="Creating-the-Visual-Elements"><a href="#Creating-the-Visual-Elements" class="headerlink" title="Creating the Visual Elements"></a>Creating the Visual Elements</h4><p>After defining our force simulation, we proceed to generate visual elements.</p>
<p>First we create a line for each edge:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Create edges as lines</span></span><br><span class="line"><span class="hljs-keyword">const</span> edges = svg.selectAll(<span class="hljs-string">'line'</span>)</span><br><span class="line">  .data(dataset.edges)</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'line'</span>)</span><br><span class="line">  .style(<span class="hljs-string">'stroke'</span>, <span class="hljs-string">'#ccc'</span>)</span><br><span class="line">  .style(<span class="hljs-string">'stroke-width'</span>, <span class="hljs-number">1</span>)</span><br></pre></td></tr></table></figure>
<p>Then create a circle for each node:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> nodes = svg.selectAll(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .data(dataset.nodes)</span><br><span class="line">  .enter()</span><br><span class="line">  .append(<span class="hljs-string">'circle'</span>)</span><br><span class="line">  .attr(<span class="hljs-string">'r'</span>, <span class="hljs-number">10</span>)</span><br><span class="line">  .style(<span class="hljs-string">'fill'</span>, (d, i) =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> colors(i)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<p>Add simple tooltip:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Add a simple tooltip</span></span><br><span class="line"></span><br><span class="line">nodes.append(<span class="hljs-string">'title'</span>)</span><br><span class="line">  .text(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> d.name</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Updating-Visuals-Over-Time"><a href="#Updating-Visuals-Over-Time" class="headerlink" title="Updating Visuals Over Time"></a>Updating Visuals Over Time</h4><p>D3’s force simulation ‘ticks’ forward through time, just like every other physics simulation. With each tick, the simulation adjusts the position values for each node and edge according to the rules we specified when the layout was first initialized. To see this progress visually, we need to update the associated elements – the lines and circles – on every tick.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Every time the simulation 'ticks', this will be called</span></span><br><span class="line">force.on(<span class="hljs-string">'tick'</span>, () =&gt; &#123;</span><br><span class="line">  edges.attr(<span class="hljs-string">'x1'</span>, d =&gt; (d.source.x))</span><br><span class="line">    .attr(<span class="hljs-string">'y1'</span>, d =&gt; (d.source.y))</span><br><span class="line">    .attr(<span class="hljs-string">'x2'</span>, d =&gt; (d.target.x))</span><br><span class="line">    .attr(<span class="hljs-string">'y2'</span>, d =&gt; (d.target.y))</span><br><span class="line"></span><br><span class="line">  nodes.attr(<span class="hljs-string">'cx'</span>, d =&gt; (d.x))</span><br><span class="line">    .attr(<span class="hljs-string">'cy'</span>, d =&gt; (d.y))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>This tells D3, ‘Ok, every time you tick, take the new (x, y) values for each line and circle and update them in the DOM’</p>
<p>Here the (x, y) are calculated and appeded by D3.</p>
<h4 id="Draggable-Nodes"><a href="#Draggable-Nodes" class="headerlink" title="Draggable Nodes"></a>Draggable Nodes</h4><p>Add the <code>call()</code> statement to our <code>Nodes</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.cal(d3.drag()</span><br><span class="line">  .on(<span class="hljs-string">'start'</span>, dragStarted)</span><br><span class="line">  .on(<span class="hljs-string">'drag'</span>, dragging)</span><br><span class="line">  .on(<span class="hljs-string">'end'</span>, dragEnded))</span><br></pre></td></tr></table></figure>
<p>This bit code ‘calls’ the <code>d3.drag()</code> method on each node.</p>
<p><code>d3.drag()</code>, in turn, sets event listeners for the three drag-related events, and specifies functions to trigger whenever one of those events occurs.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dragStarted</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (!d3.event.active) force.alphaTarget(<span class="hljs-number">0.3</span>).restart()</span><br><span class="line">  d.fx = d.x</span><br><span class="line">  d.fy = d.y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dragging</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">  d.fx = d3.event.x</span><br><span class="line">  d.fy = d3.event.y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dragEnded</span> (<span class="hljs-params">d</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (!d3.event.active) force.alphaTarget(<span class="hljs-number">0</span>)</span><br><span class="line">  d.fx = <span class="hljs-literal">null</span></span><br><span class="line">  d.fy = <span class="hljs-literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Geomapping"><a href="#Geomapping" class="headerlink" title="Geomapping"></a>Geomapping</h1><p>…</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-01T06:52:04.000Z">2017-07-01</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 699 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/01/Simple-usage-of-SW/">Simple Usage of SW</a>
            
        </h1>
        <div class="content">
            <h1 id="Register"><a href="#Register" class="headerlink" title="Register"></a>Register</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">navigator.serviceWorker.register(<span class="hljs-string">'your_service_worker,js'</span>, &#123; <span class="hljs-attr">scope</span>: <span class="hljs-string">'your_path_name'</span> &#125;)</span><br><span class="line">.then(<span class="hljs-function">(<span class="hljs-params">worker</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] Registration succeeded.'</span>)</span><br><span class="line">&#125;).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] Registration failed with '</span> + err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Unregister"><a href="#Unregister" class="headerlink" title="Unregister"></a>Unregister</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">navigator.serviceWorker.getRegistration(<span class="hljs-string">'your_service_worker.js'</span>, &#123; <span class="hljs-attr">scope</span>: <span class="hljs-string">'your_path_name'</span> &#125;)</span><br><span class="line">.then(<span class="hljs-function">(<span class="hljs-params">worker</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (worker &amp;&amp; worker.unregister) &#123;</span><br><span class="line">    worker.unregister()</span><br><span class="line">    .then(<span class="hljs-function">(<span class="hljs-params">isUnregistered</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (isUnregistered) &#123;</span><br><span class="line">        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] Unregister succeeded'</span>)</span><br><span class="line">      &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] Unregister failed'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] Unregister failed with '</span> + err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Worker-js"><a href="#Worker-js" class="headerlink" title="Worker.js"></a>Worker.js</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="hljs-string">'install'</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[Worker] installing'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="hljs-string">'activate'</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[Worker] ready'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="hljs-string">'fetch'</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(event.request.url)</span><br><span class="line">  <span class="hljs-keyword">return</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="LifeCycle"><a href="#LifeCycle" class="headerlink" title="LifeCycle"></a>LifeCycle</h1><p><img src="http://foio.github.io/images/sw-lifecycle.png" alt=""></p>
<h1 id="Download-and-Parse"><a href="#Download-and-Parse" class="headerlink" title="Download and Parse"></a>Download and Parse</h1><p>After registration of Service Worker, browser will download and parse the script from specified url.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/* In main.js */</span></span><br><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> <span class="hljs-keyword">in</span> navigator) &#123;</span><br><span class="line">  navigator.serviceWorker.register(<span class="hljs-string">'./sw.js'</span>)</span><br><span class="line">  .then(<span class="hljs-function">(<span class="hljs-params">worker</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Service Worker Registered'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Service Worker Failed to Register'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Installing"><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h1><p>After successfully parsed, browser will install the Service Worker. Once the Install finished, the worker will emit <code>install</code> event, and waiting for <code>activating</code>. If the install failed, Service Worker will be <code>Redundant</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/* In sw.js */</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'install'</span>, (event) =&gt; &#123;</span><br><span class="line">  event.waitUntil(</span><br><span class="line">    caches.open(currentCacheName)</span><br><span class="line">    .then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> cache.addAll(arrayOfFilesToCache)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>If there is an <code>event.waitUntil(promiseObj)</code> method in the event, the installing event will not be successful until the Promise within it is solved. If the Promise is rejected, the install event fails and the Service Worker became <strong>redundant</strong></p>
<h1 id="Installed-Waiting"><a href="#Installed-Waiting" class="headerlink" title="Installed / Waiting"></a>Installed / Waiting</h1><p>If the installation is successful, the Service Worker moves to the <strong>installed</strong>(also called <strong>waiting</strong>) state. In this state it is a valid, but not yet active, worker. It is not yet in control of the document., but rather is waiting to take control form the current worker.</p>
<h1 id="Activating"><a href="#Activating" class="headerlink" title="Activating"></a>Activating</h1><p>The <strong>activating</strong> state will be triggered for a waiting Service Worker in one of the following scenarios -</p>
<ul>
<li><p>if there is no current active worker already</p>
</li>
<li><p>if the <code>self.skipWaiting()</code> method is called in the Service Worker script</p>
</li>
<li><p>if the user has navigated away from the page, thereby releasing the previous active worker.</p>
</li>
<li><p>if a specified period of time has passed, thereby releasing the previous active worker</p>
</li>
</ul>
<p>During the activating state, the <strong>active</strong> event in the Service Worker script is carried out. In a typical activate event, we clear files from old caches.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/* In sw.js */</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'activate'</span>, (event) =&gt; &#123;</span><br><span class="line">  event.waitUntil(</span><br><span class="line">    <span class="hljs-comment">// get all the cache names</span></span><br><span class="line">    caches.keys().then(<span class="hljs-function">(<span class="hljs-params">cacheNames</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(</span><br><span class="line">        cacheNames.filter(<span class="hljs-function">(<span class="hljs-params">cacheName</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">      )</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Activate"><a href="#Activate" class="headerlink" title="Activate"></a>Activate</h1><p>If the worker is activated, it will emit <code>active</code> event, and take over all fetch from page. If active failed, the worker will be <code>Redundant</code></p>
<h1 id="Redundant"><a href="#Redundant" class="headerlink" title="Redundant"></a>Redundant</h1><p>Once a worker is redundant, it won’t have effect on page.</p>
<h1 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h1><ul>
<li><p>fetch</p>
</li>
<li><p>promise</p>
</li>
<li><p>CacheStorage: store Cache Object</p>
</li>
<li><p>Cache: store Request/Response Pair Object</p>
</li>
</ul>
<p><img src="http://foio.github.io/images/sw-cache-storage.png" alt=""></p>
<h1 id="Example-Cache-Static-Resource"><a href="#Example-Cache-Static-Resource" class="headerlink" title="Example: Cache Static Resource"></a>Example: Cache Static Resource</h1><ul>
<li><p>listen to install to cache static resource</p>
</li>
<li><p>listen to fetch to intercept request and return cached static Resource</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> CACHE_NAME = <span class="hljs-string">'my-site-cache-v1'</span></span><br><span class="line"><span class="hljs-keyword">var</span> urlsToCache = [</span><br><span class="line">  <span class="hljs-string">'/'</span>,</span><br><span class="line">  <span class="hljs-string">'/styles/main.css'</span>,</span><br><span class="line">  <span class="hljs-string">'/script/main.js'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// cache resource after installation</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'install'</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// perform install steps</span></span><br><span class="line">  event.waitUntil(</span><br><span class="line">    caches.open(CACHE_NAME)</span><br><span class="line">    .then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Opened Cache'</span>)</span><br><span class="line">      <span class="hljs-keyword">return</span> cache.addAll(urlsToCache)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// listen to fetch, use cache if cached</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'fetch'</span>, (event) =&gt; &#123;</span><br><span class="line">  event.responseWith(</span><br><span class="line">    caches.match(event.request)</span><br><span class="line">    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (response) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> response</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="hljs-keyword">return</span> fetch(event.request)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Version-Controls"><a href="#Version-Controls" class="headerlink" title="Version Controls"></a>Version Controls</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> deleteObsoleteCache = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> caches.keys().then(<span class="hljs-function">(<span class="hljs-params">keys</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">var</span> all = keys.map(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (key.indexOf(CACHE_PREFIX) !== <span class="hljs-number">-1</span> &amp;&amp; key.indexOf(CACHE_VERSION) === <span class="hljs-number">-1</span>) &#123;</span><br><span class="line">        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] Delete cache: '</span> + key)</span><br><span class="line">        <span class="hljs-keyword">return</span> caches.delete(key)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(all)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Whitelist"><a href="#Whitelist" class="headerlink" title="Whitelist"></a>Whitelist</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// resource whitelist</span></span><br><span class="line"><span class="hljs-keyword">const</span> allAssets = [</span><br><span class="line">  <span class="hljs-string">'//your.cdn.com/app.css'</span>,</span><br><span class="line">  <span class="hljs-string">'//your.cdn.com/app.js'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// match</span></span><br><span class="line"><span class="hljs-keyword">const</span> matchAssets = <span class="hljs-function">(<span class="hljs-params">requestUrl</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> urlObj = <span class="hljs-keyword">new</span> URL(requestUrl)</span><br><span class="line">  <span class="hljs-keyword">const</span> noProtocolUrl = urlObj.href.substr(urlObj.protocol.length)</span><br><span class="line">  <span class="hljs-keyword">if</span> (allAssets.includes(noProtocolUrl)) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// listen to fetch, proxy fetch matching Whitelist</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'fetch'</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> requestUrl = event.target.url</span><br><span class="line">    <span class="hljs-keyword">const</span> isGet = event.request.method === <span class="hljs-string">'GET'</span></span><br><span class="line">    <span class="hljs-keyword">const</span> assetMatches = matchAssets(requestUrl)</span><br><span class="line">    <span class="hljs-keyword">if</span> (!assetMatches || !isGet) &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">const</span> resource = cacheFirstResponse(event)</span><br><span class="line">    event.responseWith(resource)</span><br><span class="line">  &#125; cache (err) &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[SW] handle fetch event error'</span>)</span><br><span class="line">    <span class="hljs-keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-01T02:35:36.000Z">2017-07-01</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 minutes read (About 1329 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/01/Glossary-of-Terms-on-InfluxDB/">Glossary of Terms on InfluxDB</a>
            
        </h1>
        <div class="content">
            <h1 id="aggregation"><a href="#aggregation" class="headerlink" title="aggregation"></a>aggregation</h1><p>An InfluxQL function that returns an aggregated value across a set of points</p>
<h1 id="batch"><a href="#batch" class="headerlink" title="batch"></a>batch</h1><p>A collection of points in line protocol format, separated by newlines(0x0A). A batch of points may be submitted to the database using a single HTTP request to the write endpoint. This makes writes via the HTTP API much more performant by drastically reducting the HTTP overhead. InfluxData recommends batch size of 5,000-10,000 points, although different use cases may be better served by significantly smaller or larger batches.</p>
<h1 id="continuous-query-CQ"><a href="#continuous-query-CQ" class="headerlink" title="continuous query(CQ)"></a>continuous query(CQ)</h1><p>An InfluxQL query that runs automatically and periodically within a database. Continuous queries require a function in the <code>SELECT</code> clause and must include a <code>GROUP BY time()</code> clause.</p>
<h1 id="database"><a href="#database" class="headerlink" title="database"></a>database</h1><p>A logical container for users, retention policies, continuous queries, and time series data.</p>
<h1 id="duration"><a href="#duration" class="headerlink" title="duration"></a>duration</h1><p>The attribute of the retention policy that determines how long InfluxDB stores data. Data older than the duration are automatically dropped from the database.</p>
<h1 id="field"><a href="#field" class="headerlink" title="field"></a>field</h1><p>The key-value pair in InfluxDB’s data structure that records metadata and the actual data value. Fields are required in InfluxDB’s data structure and they are not indexed - queries on field values scan all points that match the specified time range and , as a result, are not performant relative to tags.</p>
<blockquote>
<p>Query tip: Compare fields to tags: tags are indexed</p>
</blockquote>
<h1 id="field-key"><a href="#field-key" class="headerlink" title="field key"></a>field key</h1><p>The key part of the key-value pair that makes up a field. Field keys are strings and they store metadata.</p>
<h1 id="field-set"><a href="#field-set" class="headerlink" title="field set"></a>field set</h1><p>The collection of field keys and field values on a point.</p>
<h1 id="field-value"><a href="#field-value" class="headerlink" title="field value"></a>field value</h1><p>The value part of the key-value pair that makes up a field. Field values are the actual data: they can be strings, floats, integers, or booleans. A field value is always associated with a timestamp.</p>
<p>Field values are not indexed - queries on field values scan all points that match the specified time range and, as a result, are not performant.</p>
<h1 id="function"><a href="#function" class="headerlink" title="function"></a>function</h1><p>InfluxQL aggregation, selectors, and transformations.</p>
<h1 id="identifier"><a href="#identifier" class="headerlink" title="identifier"></a>identifier</h1><p>Tokens that refer to continuous query names, database names, field keys, measurement names, retention policy names, subscription names, tag keys and user names.</p>
<h1 id="line-protocol"><a href="#line-protocol" class="headerlink" title="line protocol"></a>line protocol</h1><p>The text based format for writing points to InfluxDB.</p>
<h1 id="measurement"><a href="#measurement" class="headerlink" title="measurement"></a>measurement</h1><p>The part of InfluxDB’s structure that describes the data stored in the associated fields. Measurements are strings.</p>
<h1 id="metastore"><a href="#metastore" class="headerlink" title="metastore"></a>metastore</h1><p>Contains internal information about the status of the system. The metastore contains the user information, databse, retention policies, shard metadata, continuous queries, and subscriptions.</p>
<h1 id="node"><a href="#node" class="headerlink" title="node"></a>node</h1><p>An independent <code>influxd</code> process</p>
<h1 id="now"><a href="#now" class="headerlink" title="now()"></a>now()</h1><p>The local server’s nanosecond timestamp</p>
<h1 id="point"><a href="#point" class="headerlink" title="point"></a>point</h1><p>The part of InfluxDB’s data structure taht consists of a single collection of fields in a series. Each point is uniquely idenfified by its series and timestamp.</p>
<p>You cannot store more than one point with the same timestamp in the same series. Instead, when you write a new point to the same series with the same timestamp as an existing point in that series, the field set becomes the union of the old field set and the new field set, where any ties tgo to the new field set.</p>
<h1 id="query"><a href="#query" class="headerlink" title="query"></a>query</h1><p>An operation that retrieves data from InfluxDB.</p>
<h1 id="replication-factor"><a href="#replication-factor" class="headerlink" title="replication factor"></a>replication factor</h1><p>The attribute of the retention policy that determines how many copies of the data are stored <strong>in the cluster</strong>.</p>
<blockquote>
<p>Replication factors do not seve a purpose with single node instances.</p>
</blockquote>
<h1 id="retention-policy-RP"><a href="#retention-policy-RP" class="headerlink" title="retention policy (RP)"></a>retention policy (RP)</h1><p>The part of InfluxDB’s data structure that describes for how long InfluxDB keeps data(ducation), how many copies of those data are stored in the cluster(<strong>replication factor</strong>), and the time range covered by shard groups(shard group duration). RPs are unique per databse and along with the measurement and tag set define a series.</p>
<p>When you create a database, InfluxDB automatically creates a retention policy called <code>autogen</code> with an infinite duration, a replication factor set to one, and a shard group duration set to seven days.</p>
<h1 id="schema"><a href="#schema" class="headerlink" title="schema"></a>schema</h1><p>How the data are organized in InfluxDB. The fundamentals of the InfluxDB schema are database, retention policies, series, measurements, tag keys, tag values, and field keys.</p>
<h1 id="selector"><a href="#selector" class="headerlink" title="selector"></a>selector</h1><p>An InfluxQL function that returns a single point from the range of specified points.</p>
<h1 id="series"><a href="#series" class="headerlink" title="series"></a>series</h1><p>The collection of data in InfluxDB’s data structure that share a measurement, tag set and retention policy.</p>
<blockquote>
<p>The field set is not part of the series identification.</p>
</blockquote>
<h1 id="series-cardinality"><a href="#series-cardinality" class="headerlink" title="series cardinality"></a>series cardinality</h1><p>The number of unique database, measurement, and tag set combinations in an InfluxDB instance.</p>
<p>For example, assume that an InfluxDB instance has a single database and one measurement. The single measurement has two tag keys: <code>email</code> and <code>status</code>. If there are three different <code>email</code>s, and each email address is associated with two different <code>status</code>, then the series cardinality for the measurement is 6.</p>
<p>Note that, in some cases, simply performing that multiplication may overestimate series cardinality because of the presence of dependent tags.</p>
<h1 id="server"><a href="#server" class="headerlink" title="server"></a>server</h1><p>A machine virtual or physical, that is running InfluxDB. There should only be one InfluxDB process per server.</p>
<h1 id="shard"><a href="#shard" class="headerlink" title="shard"></a>shard</h1><p>A shard contains the actual encoded and compressed data, and is represented by a TSM file on disk. Every shard belongs to one and only one shard group. Multiple shards may exist in a single shard group. Each shard contains a specific set of series. All points falling on a given series in a given shard group will be stored in the same shard(TSM file) on disk.</p>
<h1 id="shard-duration"><a href="#shard-duration" class="headerlink" title="shard duration"></a>shard duration</h1><p>The shard duration determines hwo much time each shard group spans. The specific interval is determined by the <code>SHARD DURATION</code> of the retention policy.</p>
<p>For example, given a retention policy with <code>SHARD DURATION</code> set to <code>1w</code>, each shard group will span a single week and contain all points with timestamps in that week.</p>
<h1 id="shard-group"><a href="#shard-group" class="headerlink" title="shard group"></a>shard group</h1><p>Shard groups are logical container for shards. Shard groups are organized by <strong>time and retention policy</strong>. Every retention policy that contains data has at least one associated shard group. A given shard group contains all shards with data for the interval covered by the shard group. The interval spanned by each shard group is the shard duration.</p>
<h1 id="subscription"><a href="#subscription" class="headerlink" title="subscription"></a>subscription</h1><p>Subscription allows <code>Kapacitor</code> to receive data from InfluxDB in a push model rather than the pull model based on querying data. When Kapacitor is configured to work with InfluxDB, the subscription will automatically push every write for the subscribed databse form InfluxDB to Kapacitor. Subscription can use TCP or UDP for transmitting the writes.</p>
<h1 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h1><p>The key-value pair in InfluxDB’s data structure that records metadata. Tags are an optional part of InfluxDB’s data structure but they are useful for storing commonly-queried metadata; tags are indexed so queries on tags are performant</p>
<h1 id="tag-key"><a href="#tag-key" class="headerlink" title="tag key"></a>tag key</h1><p>The key part of the key-value pair that makes up a tag. Tag keys are strings and they store metadata. Tag keys are indexed so queires on tag keys are performant.</p>
<h1 id="tag-set"><a href="#tag-set" class="headerlink" title="tag set"></a>tag set</h1><p>The collection of tag keys and tag values on a point.</p>
<h1 id="tag-value"><a href="#tag-value" class="headerlink" title="tag value"></a>tag value</h1><p>The value part of the key-value pair that makes up a tag. Tag values are strings and they store metadata. Tag values are indexed so queries on tag values are performant.</p>
<h1 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp"></a>timestamp</h1><p>The date and time associated with a point. All time in influxDB is UTC.</p>
<h1 id="transformation"><a href="#transformation" class="headerlink" title="transformation"></a>transformation</h1><p>An InfluxQl function that returns a value or a set of values calculated from specified points, but does not return an aggregated value across those points.</p>
<h1 id="tsm-Time-Structured-Merge-Tree"><a href="#tsm-Time-Structured-Merge-Tree" class="headerlink" title="tsm (Time Structured Merge Tree)"></a>tsm (Time Structured Merge Tree)</h1><p>The purpose-built data storage format for InfluxDB. TSM allows for greater compaction and higher write and read throughput than exsiting B+ or LSM tree implementations.</p>
<h1 id="user"><a href="#user" class="headerlink" title="user"></a>user</h1><p>There are two kinds of users in InfluxDB:</p>
<ul>
<li><p><em>Admin users</em> have <code>READ</code> and <code>WRITE</code> access to all database and full across to administrative queries and user management commands.</p>
</li>
<li><p><em>Non-admin users</em> have <code>READ</code>, <code>WRITE</code>, or <code>ALT</code> (both <code>READ</code>, <code>WRITE</code>) access to per database.</p>
</li>
</ul>
<p>When authentication is enabled, InfluxDB only executes HTTP requests that are spent with a valid username and password.</p>
<h1 id="values-per-second"><a href="#values-per-second" class="headerlink" title="values per second"></a>values per second</h1><p>The preferred measurement of the rate at which data are persisted to InfluxDB. Write speeds are generally quoted in values per second.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-30T11:37:30.000Z">2017-06-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 906 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/30/APIs-of-InfluxDB/">APIs of InfluxDB</a>
            
        </h1>
        <div class="content">
            <p>The InfluxDB API provides a simple way interact with the database. It uses HTTP response codes, HTTP authentication, JWT Token, and basic authentication and responses are returned in JSON.</p>
<p>The following sections assume your InfluxDB instance is running on <code>localhost</code> port <code>8086</code> and HTTPS is not enabled.</p>
<h1 id="Endpoints"><a href="#Endpoints" class="headerlink" title="Endpoints"></a>Endpoints</h1><table>
<thead>
<tr>
<th style="text-align:left">Endpoint</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/ping</td>
<td style="text-align:left">use <code>/ping</code> to check the status of your InfluxDB instance and your version of InfluxDB</td>
</tr>
<tr>
<td style="text-align:left">/query</td>
<td style="text-align:left">use <code>/query</code> to query data and manage databsae, retention policies and users</td>
</tr>
<tr>
<td style="text-align:left">/write</td>
<td style="text-align:left">use <code>/write</code> to write data to a pre-exising databse</td>
</tr>
</tbody>
</table>
<h2 id="ping"><a href="#ping" class="headerlink" title="/ping"></a>/ping</h2><p>The ping endpoint accepts both <code>GET</code> and <code>POST</code> HTTP requests. Use this endpoint to check the status of your InfluxDB instance and your version of InfluxDB.</p>
<h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET http://localhost:8086/ping</span><br><span class="line"></span><br><span class="line">HEAD http://localhost:8086/ping</span><br></pre></td></tr></table></figure>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Extract the version of your InfluxDB instance in the <code>X-Influxdb-Version</code> field of the header</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ curl -sl -I localhost:8086/ping</span><br><span class="line"></span><br><span class="line">HTTP/1.1 204 No Content</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Request-Id: [...]</span><br><span class="line">X-Influxdb-Version: 1.2.x</span><br><span class="line">Date: Wed, 01 Mar 2017 00:09:51 GMT</span><br></pre></td></tr></table></figure>
<h3 id="Status-Codes-and-Responses"><a href="#Status-Codes-and-Responses" class="headerlink" title="Status Codes and Responses"></a>Status Codes and Responses</h3><p>The response body is empty</p>
<table>
<thead>
<tr>
<th style="text-align:center">HTTP Status Code</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">      204</td>
<td style="text-align:center">Success! Your InfluxDB instance is up and running</td>
</tr>
</tbody>
</table>
<h2 id="query"><a href="#query" class="headerlink" title="/query"></a>/query</h2><p>The <code>/query</code> endpoint accepts <code>GET</code> and <code>POST</code> HTTP requests. Use this endpoint to query data and manage databases, retention policies, and users.</p>
<h3 id="Definition-1"><a href="#Definition-1" class="headerlink" title="Definition"></a>Definition</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET http://localhost:8086/query</span><br><span class="line"></span><br><span class="line">POST http://localhost:8086/query</span><br></pre></td></tr></table></figure>
<h3 id="Verb-usage"><a href="#Verb-usage" class="headerlink" title="Verb usage"></a>Verb usage</h3><table>
<thead>
<tr>
<th style="text-align:center">verb</th>
<th style="text-align:center">Query Type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">GET</td>
<td style="text-align:center">use for all queries that start with <code>SETECT</code>, <code>SHOW</code></td>
</tr>
<tr>
<td style="text-align:center">POST</td>
<td style="text-align:center">use for all queries that start with <code>ALTER</code>, <code>CREATE</code>, <code>DELETE</code>, <code>DROP</code>, <code>GRANT</code>, <code>KILL</code>, <code>REVOKE</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>THe only exceptions are <code>SELECT</code> queries that include an <code>INTO</code> <strong>clause</strong>. Those <code>SELECT</code> queries require a <code>POST</code> request.</p>
</blockquote>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><h5 id="Example-1-Query-data-with-a-SELECT-statement"><a href="#Example-1-Query-data-with-a-SELECT-statement" class="headerlink" title="Example 1: Query data with a SELECT statement"></a>Example 1: Query data with a <code>SELECT</code> statement</h5><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -G <span class="hljs-string">'http://localhost:8086/query?db=mydb'</span> --data-urlencoded <span class="hljs-string">'q=SELECT * FROM "mymeas"'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="hljs-string">"results"</span>:[&#123;<span class="hljs-string">"statement_id"</span>:0,<span class="hljs-string">"series"</span>:[&#123;<span class="hljs-string">"name"</span>:<span class="hljs-string">"mymeas"</span>,<span class="hljs-string">"columns"</span>:[<span class="hljs-string">"time"</span>,<span class="hljs-string">"myfield"</span>,<span class="hljs-string">"mytag1"</span>,<span class="hljs-string">"mytag2"</span>],<span class="hljs-string">"values"</span>:[[<span class="hljs-string">"2017-03-01T00:16:18Z"</span>,33.1,null,null],[<span class="hljs-string">"2017-03-01T00:17:18Z"</span>,12.4,<span class="hljs-string">"12"</span>,<span class="hljs-string">"14"</span>]]&#125;]&#125;]&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>mymeas</code> <strong>measurement</strong> has two points. The first point has the <strong>timestamp</strong> <code>2017-03--1T00:15:18Z</code>, a <code>myfield</code> value of <code>33.1</code> and no tag values for the <code>mytag1</code> and <code>mytag2</code> tag keys.</p>
<p>The second point has the timestamp <code>2017-03--1T00:18:18Z</code>, a <code>myfield</code> value of <code>12</code>, a <code>mymeas</code> value of <code>12</code>, a <code>mytag1</code> value of <code>12</code> and a <code>mytag2</code> value of <code>14</code></p>
<p>The same query in InfluxDB’s Command Line Interface(CLI) returns the following table:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name: mymeas</span><br><span class="line">time                   myfield   mytag1   mytag2</span><br><span class="line">----                   -------   ------   ------</span><br><span class="line">2017-03--1T00:15:18Z    33.1</span><br><span class="line">2017-03--1T00:18:18Z    12        12       14</span><br></pre></td></tr></table></figure>
<h5 id="Example-2-Query-data-with-a-SELECT-statement-and-an-INTO-clause"><a href="#Example-2-Query-data-with-a-SELECT-statement-and-an-INTO-clause" class="headerlink" title="Example 2: Query data with a SELECT statement and an INTO clause"></a>Example 2: Query data with a <code>SELECT</code> statement and an <code>INTO</code> clause</h5><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="hljs-string">'http://localhost:8086/query?db=mydb'</span> --data-urlencoded <span class="hljs-string">'q=SELECT * INTO "newmeas" FROM "mymeas"'</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>SELECT</code> queries that include and <code>INTO</code> clause require a <code>POST</code> requests</p>
</blockquote>
<h5 id="Example-3-Create-a-database"><a href="#Example-3-Create-a-database" class="headerlink" title="Example 3: Create a database"></a>Example 3: Create a database</h5><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="hljs-string">'http://localhost:8086/query'</span> --data-urlencoded <span class="hljs-string">'q=CREATE DATABASE "mydb"'</span></span><br></pre></td></tr></table></figure>
<p>A successful <code>CREATE DATABASE</code> query returns no additional information.</p>
<h4 id="Query-String-Parameter"><a href="#Query-String-Parameter" class="headerlink" title="Query String Parameter"></a>Query String Parameter</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Query String Parameter         |                                            Optional/Required                                             |                                                                                Definition</span><br></pre></td></tr></table></figure>
<p>:———————————–: | :——————————————————————————————————: | :———————————————————————————————————————————————————————–: chunked=[true | &lt;number_of_points] | Optional | Returns points in streamed batches instead of in a single response. If set to <code>true</code>, InfluxDB chunks responses by series or by every 10,000 point, whichever occurs first. It set to a specific value, InfluxDB chunks responses by series or by that number of points db=</p>
&lt;database_name&gt;<br>&lt;/database_name&gt;

<p> | Required for database-dependent queries(most <code>SELECT</code> queries and <code>SHOW</code> queries require this parameter) | Sets the target database for the query epoch=[ns,u,ms,s,m,h] | Optional | Returns epoch timestamps with the specified precision. By default, InfluxDB returns timestamps in RFC3339 format with nanosecond precision. Both <code>u</code> indicate microsecond p=</p>
<password><br></password>

<p> | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the password for authentication if you’ve enabled authentication. Use with the query string parameter <code>u</code> pretty=true | Optional | Enables pretty-printed JSON output. While this is useful for debugging it is not recommended for production use as it consumes unnecessary network bandwidth u=</p>
<username><br></username>

<p> | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the username for authentication if you’ve enabled authentication. The user must have read access to the database. Use with the query string parameter <code>p</code></p>
<blockquote>
<p>In versions 1.2.0 and 1.2.1, InfluxDB automatically truncates the number of rows returned for requests without the <code>chunked</code> parameter. By default, the maximum number of rows returned is set to 10000, if a query has more than 10000 rows to return, InfluxDB includes a <code>&#39;partial&#39;: true</code> tag in the response body.</p>
</blockquote>
<blockquote>
<p>The HTTP API also supports basic authentication. Use basic authentication if you’ve enabled authentication and aren’t using the query string parameter <code>u</code> and <code>p</code>.</p>
</blockquote>
<h5 id="Example-Create-a-database-using-HTTP-authentication"><a href="#Example-Create-a-database-using-HTTP-authentication" class="headerlink" title="Example: Create a database using HTTP authentication"></a>Example: Create a database using HTTP authentication</h5><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="hljs-string">'http://localhost:8086/query?u=myusername&amp;p=mypassword'</span> --data-urlencoded <span class="hljs-string">'q=CREATE DATABASE "mydb"'</span></span><br></pre></td></tr></table></figure>
<h2 id="write"><a href="#write" class="headerlink" title="/write"></a>/write</h2><p>The <code>/write</code> endpoint accepts <code>POST</code> HTTP requests. Use this endpoint to write data to a pre-existing databse.</p>
<h3 id="Definition-2"><a href="#Definition-2" class="headerlink" title="Definition"></a>Definition</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:8086/write</span><br></pre></td></tr></table></figure>
<h3 id="Query-String-Parameter-1"><a href="#Query-String-Parameter-1" class="headerlink" title="Query String Parameter"></a>Query String Parameter</h3><pre><code>Query String Parameter                 | Optional/Required                                                                         | Description
</code></pre><p>:—————————————————: | :—————————————————————————————- | :————————————————————————————————————————————————————–<br>                  consistency=[any                    | one                                                                                       | quorum                                                                                                                                                          | all] | Optional, available with InfluxEnterprise clusters only | Sets the write consistency for the point. InfluxDB assumes that the write consistency is <code>one</code> if you do not specify <code>consistency</code><br>             db=</p>
<p><database><br></database>              | Required                                                                                  | Sets the target database for the write<br>             p=</p>
<p><password><br></password>               | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the password for authentication if you’ve enabled authentication. Use with the query string parameter <code>u</code><br>               precision=[ns,u,ms,m,h]                | Optional                                                                                  | Sets the precision for the supplied Unix time values. InfluxDB assumes that timestamps are in nanoseconds if you do not specify <code>precision</code><br>rp=</p>
<p>&lt;retention_policy_name&gt;<br>&lt;/retention_policy_name&gt; | Optional                                                                                  | Sets the target retention policy for the write. InfluxDB writes to the <code>DEFAULT</code> retention policy if you do not specify a retention policy<br>             u=</p>
<p><username><br></username>               | Optional if you haven’t enabled authentication. Required if you’ve enabled authentication | Sets the username for authentication if you’ve enabled authentication. The user must have write access to the database. Use with the query string parameter <code>p</code></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-30T09:58:54.000Z">2017-06-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 712 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/30/Writing-Data-in-InfluxDB-with-HTTP-API/">Writing Data in InfluxDB With HTTP API</a>
            
        </h1>
        <div class="content">
            <h1 id="Create-a-database-using-the-HTTP-API"><a href="#Create-a-database-using-the-HTTP-API" class="headerlink" title="Create a database using the HTTP API"></a>Create a database using the HTTP API</h1><p>To create a database send a <code>POST</code> request to the <code>/query</code> endpoint and set the URL parameter <code>q</code> to <code>CREATE DATABASE &lt;new_database_name&gt;</code>. The example below sends a request to InfluxDB running on <code>locahost</code> and create the database <code>mydb</code>.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -XPOST http://localhost:8086/query --data-urlencoded <span class="hljs-string">"q=CREATE DATABASE mydb"</span></span><br></pre></td></tr></table></figure>
<h1 id="Writing-data-using-the-HTTP-API"><a href="#Writing-data-using-the-HTTP-API" class="headerlink" title="Writing data using the HTTP API"></a>Writing data using the HTTP API</h1><p>The HTTP API is the primary means of writing data into InfluxDB, by sending <code>POST</code> requests to the <code>/write</code> endpoint. The example below writes a single point to the <code>mydb</code> database. The data consist of the <strong>measurement</strong> <code>cpu_load_short</code>. the <strong>tag keys</strong> <code>host</code> and <code>region</code> with the <strong>tag values</strong> <code>server01</code> and <code>us-west</code>, the <strong>field key</strong> <code>value</code> with a <strong>field value</strong> of <code>0.64</code> and the <strong>timestamp</strong> <code>434055562000000000</code>.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -XPOST <span class="hljs-string">'http://localhost:8086/write?db=mydb'</span> --data-binary <span class="hljs-string">'cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000'</span></span><br></pre></td></tr></table></figure>
<p>When writing points, you must specify an existing database in the <code>db</code> query parameter. Points will be written to <code>db</code>‘s default retention policy if you do not supply a retention policy via the <code>rp</code> query parameter.</p>
<p>The body of the POST - we call this the <code>Line Protocol</code> - contains the time-series data that you wish to store. They consist of a <strong>measurement</strong>, <strong>tags</strong>, <strong>fields</strong>, and a <strong>timestamp</strong>. InfluxDB requires a measurement name.</p>
<p>Strictly speaking, tags are optional but most series include tags to differentiate data sources and to make querying both easy and efficient. Both tag keys and tag values are strings.</p>
<p>Field keys are required and always strings, and <strong>by default</strong>, field values are floats. The timestamp - supplied at the end of the line in Unix time in nanoseconds since January 1, 1970 UTC - is optional. If you do not specify a timestamp InfluxDB uses the server’s local nanoseconds timestamp in Unix epoch.</p>
<p>Anything that has to do with tim ein InfluxDB is always UTC.</p>
<h2 id="Writing-multiple-points"><a href="#Writing-multiple-points" class="headerlink" title="Writing multiple points"></a>Writing multiple points</h2><p>Post multiple points to multiple series at the same time by separating each point with a new line. Batching points in this manner results in much higher performance.</p>
<p>The following example writes three points to the database <code>mydb</code>.</p>
<p>The first point belongs to the series with the measurement <code>cpu_load_short</code> and tag set <code>host-server02</code> and has the server’s local timestamp</p>
<p>The second point belongs to the series with the measurement <code>cpu_load_short</code> and tag set <code>host=server02,region=us-west</code> and has the specified timestamp <code>1422568543702900257</code>.</p>
<p>The third point has the same specified timestamp as the second point, but it is written to the series with the measruement <code>cpu_load_short</code> and tag set <code>direction=in,host=server01,region=us-west</code></p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -XPOST <span class="hljs-string">'http://localhost:8086/write?db=mydb'</span> --data-binary <span class="hljs-string">'cpu_load_short,host=server02 value=0.67 cpu_load_short,host=server02,region=us-west value=0.5 cpu_load_short,direction=in,host=server01,region=us-west value=0.2'</span></span><br></pre></td></tr></table></figure>
<h2 id="Writing-points-from-a-file"><a href="#Writing-points-from-a-file" class="headerlink" title="Writing points from a file"></a>Writing points from a file</h2><p>Write points from a <strong>file</strong> by passing <code>@filename</code> to <code>curl</code>. The data in the file should follow InfluxDB’s <strong>line protocol syntax</strong></p>
<p>Example of a properly-formatted file(<code>cpu_data.txt</code>)</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cpu_load_short,host=server02 value=0.2</span><br><span class="line">cpu_load_short,host=server02,region=us-west value=0.5</span><br><span class="line">cpu_load_short,direction=in,host=server01,region=us-west value=0.2</span><br></pre></td></tr></table></figure>
<p>Write the data in <code>cpu_data.txt</code> to the <code>mydb</code> datbase with:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -XPOST <span class="hljs-string">'http://localhost:8086/write?db=mydb'</span> --data-binary @cpu_data.txt</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note: If your data file has more than 5000 points, it may be necessary to split that file into several files in order to write your data in batches to influxDB. By default, the HTTP request times out after five seconds. InfluxDB will still attempt to write the points after that time out but there will be no confirmation that they were successfully written.</p>
</blockquote>
<h2 id="Schemaless-Design"><a href="#Schemaless-Design" class="headerlink" title="Schemaless Design"></a>Schemaless Design</h2><p>InfluxDB is a schemaless database. You can add new measurement, tags, and fields at any time. Note that if you attempt to write data with a different type than previous used(for example, writing a string to a field that previously accepted integers), InfluxDB will reject those data.</p>
<h2 id="HTTP-response-summary"><a href="#HTTP-response-summary" class="headerlink" title="HTTP response summary"></a>HTTP response summary</h2><ul>
<li><p>2xx: If you write request received <code>HTTP 204 No Content</code>, it was a success</p>
</li>
<li><p>4xx: InfluxDB could not understand the request</p>
</li>
<li><p>5xx: The system is overloaded or significantly impaired.</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-30T09:11:14.000Z">2017-06-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 208 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/30/Querying-InfluxDB-with-the-HTTP-API/">Querying InfluxDB With the HTTP API</a>
            
        </h1>
        <div class="content">
            <p>The HTTP API is the primary means for querying data in InfluxDB.</p>
<p>To perform a query send a <code>GET</code> request to the <code>/query</code> endpoint, set the URL parameter <code>db</code> as the target database, and set the URL parameter <code>q</code> as your query.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -G <span class="hljs-string">'http://localhost:8086/query?pretty=true'</span> --data-urlencode <span class="hljs-string">"db=mydb"</span> --data-urlencode <span class="hljs-string">"q=SELECT \"value\" FROM \"cpu_load_short\" WHERE \"region\"='us-west'"</span></span><br></pre></td></tr></table></figure>
<p>InfluxDB returns JSON. The results of your query appear in the <code>&#39;result&#39;</code> array. If an error occurs, InfluxDB sets an <code>&#39;error&#39;</code> key with an explanation of the error.</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"results"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="hljs-attr">"statement_id"</span>: <span class="hljs-number">0</span>,</span><br><span class="line">      <span class="hljs-attr">"series"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="hljs-attr">"name"</span>: <span class="hljs-string">"cpu_load_start"</span>,</span><br><span class="line">          <span class="hljs-attr">"columns"</span>: [</span><br><span class="line">            <span class="hljs-string">"time"</span>,</span><br><span class="line">            <span class="hljs-string">"value"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="hljs-attr">"values"</span>: [</span><br><span class="line">            [</span><br><span class="line">                <span class="hljs-string">"2015-01-29T21:55:43.702900257Z"</span>,</span><br><span class="line">                <span class="hljs-number">2</span></span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="hljs-string">"2015-01-29T21:55:43.702900257Z"</span>,</span><br><span class="line">                <span class="hljs-number">0.55</span></span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                <span class="hljs-string">"2015-06-11T20:46:02Z"</span>,</span><br><span class="line">                <span class="hljs-number">0.64</span></span><br><span class="line">            ]</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note: Appending <code>pretty=true</code> to the URL enables pretty-printed JSON output. While this is useful for debugging or when queryting directly with tools like <code>curl</code>, it is not recommended for production use as it consumes unnecessary network bandwidth.</p>
</blockquote>
<h1 id="Multiple-queries"><a href="#Multiple-queries" class="headerlink" title="Multiple queries"></a>Multiple queries</h1><p>Send multiple queries to InfluxDB in a single API call. Simply delimit each query using a semicolon</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -G <span class="hljs-string">'http://localhost:8086/query?pretty=true'</span> --data-urlencode <span class="hljs-string">"db=mydb"</span> --data-urlencode <span class="hljs-string">"q=SELECT \"value\" FROM \"cpu_load_short\" WHERE \"region\"='us-west';SELECT count(\"value\") FROM \"cpu_load_short\" WHERE \"region\"='us-west'"</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-30T08:00:10.000Z">2017-06-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 580 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/30/Simple-about-InfluxDB/">Simple About InfluxDB</a>
            
        </h1>
        <div class="content">
            <h1 id="Install-InfluxDB-on-MacOS"><a href="#Install-InfluxDB-on-MacOS" class="headerlink" title="Install InfluxDB on MacOS"></a>Install InfluxDB on MacOS</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew install influxdb</span><br></pre></td></tr></table></figure>
<p>To run influxDB at startup, run this command</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sfv /usr/<span class="hljs-built_in">local</span>/opt/influxdb/*.plist ~/Library/LaunchAgents</span><br></pre></td></tr></table></figure>
<p>Now, to start InfluxDB, run this command(Accept the request of incoming connections in the window that appears)</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">influxd -config /usr/<span class="hljs-built_in">local</span>/etc/influxdb.conf</span><br></pre></td></tr></table></figure>
<h1 id="Check-if-InfluxDB-works"><a href="#Check-if-InfluxDB-works" class="headerlink" title="Check if InfluxDB works"></a>Check if InfluxDB works</h1><p>InfluxDB exposes an API with which one can easily check its good working condition. Here’s what you will receive in return for this curl command</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -sl -I localhost:8086/ping</span><br><span class="line">HTTP/1.1 204 No Content</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Request-Id: 95b307f8-5d6b-11e7-8002-000000000000</span><br><span class="line">X-Influxdb-Version: v1.3.0</span><br><span class="line">Date: Fri, 30 Jun 2017 08:10:31 GMT</span><br></pre></td></tr></table></figure>
<h1 id="Terminology-difference-with-SQL-database"><a href="#Terminology-difference-with-SQL-database" class="headerlink" title="Terminology, difference with SQL database"></a>Terminology, difference with SQL database</h1><p>Like all non-relational database, InfluxDB for its own vocabulary your need to know before starting</p>
<ul>
<li><p><strong>Measurement</strong> is equivalent to <strong>SQL table</strong></p>
</li>
<li><p><strong>Tags</strong> is similar to a <strong>indexed column</strong> in a SQL database</p>
</li>
<li><p><strong>Fields</strong> is similar to the <strong>column not indexed</strong> in a SQL database</p>
</li>
<li><p><strong>Points</strong> is equivalent to <strong>line(row)</strong> in a SQL database</p>
</li>
</ul>
<h1 id="Database-Management-Methods"><a href="#Database-Management-Methods" class="headerlink" title="Database Management Methods"></a>Database Management Methods</h1><p>There are 6 methods to manage database</p>
<ul>
<li><p>CREATE DATABASE</p>
</li>
<li><p>DROP DATABASE</p>
</li>
<li><p>DROP SETS</p>
</li>
<li><p>DELETE</p>
</li>
<li><p>DROP MEASUREMENT</p>
</li>
<li><p>DROP SHARD</p>
</li>
</ul>
<h2 id="Create-a-Database"><a href="#Create-a-Database" class="headerlink" title="Create a Database"></a>Create a Database</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE &lt;database_name&gt; [WITH [DURATION &lt;duration&gt;] [REPLICATION &lt;n&gt;] [SHARD DURATION &lt;shard_duration&gt;] [NAME &lt;retention-policy-name&gt;]]</span><br></pre></td></tr></table></figure>
<p><strong>Basic Setting</strong></p>
<ul>
<li><p>database_name: name of the database</p>
</li>
<li><p>duration: you can set the period of data retention(conversation) but it makes more sense to implement a retention policy.</p>
</li>
</ul>
<h2 id="Delete-a-database-drop-database"><a href="#Delete-a-database-drop-database" class="headerlink" title="Delete a database (drop database)"></a>Delete a database (drop database)</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE &lt;database_name&gt;</span><br></pre></td></tr></table></figure>
<h1 id="Establish-a-retention-policy"><a href="#Establish-a-retention-policy" class="headerlink" title="Establish a retention policy"></a>Establish a retention policy</h1><p>InfluxDB incorporates a system of automatic deletion of data. It is the policy of Retention. Spent some time, data is automatically deleted from the base. This mechanism is very convenient because it for a good grasp of size of the base and we don’t have to worry about the maintenance operation. Free to each set the lifetime of any particular measure. If you want to follow the temperature of its microprocessor, one less may be sufficient, instead the retention policy must be more flexible if we want to compare the temperature in a House form one year to the other. It will also think about the system upstream, you don’t have to store a measurement of atmosphere temperature every 10 seconds! A measurement per minutes, 15 minutes, that’s enough. Instead in an industrial process, we certainly want to go for the second… or a lot less.</p>
<p>We therefore for 3 methods</p>
<ul>
<li><p>Create: to create a rule of conservation of data</p>
</li>
<li><p>Alter: to change a rule</p>
</li>
<li><p>Drop: to remove a rule</p>
</li>
</ul>
<h1 id="Create-a-retention-policy"><a href="#Create-a-retention-policy" class="headerlink" title="Create a retention policy"></a>Create a retention policy</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE RETENTION POLICY &lt;name_politic_retention&gt; ON &lt;name_database&gt; DURATION: &lt;duration&gt; REPLICATION: &lt;n&gt; [SHARD DURATION &lt;duration duration_shard&gt;] [DEFAULT]</span><br></pre></td></tr></table></figure>
<p><strong>Parameters</strong></p>
<ul>
<li><p>name_politic_retention: a short name without spaces of preference</p>
</li>
<li><p>name_database: the database on which applies the retention policy</p>
</li>
<li><p>duration: duration of data retention. It’s a literal expression which must respect the convention InfluxDB</p>
</li>
<li><p>duration_shard: the duration of storage of the data in the buffer zone</p>
</li>
<li><p>n: number of replication(required), put 1 if no cluster installed</p>
</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE RETENTION POLICY <span class="hljs-string">'one_day_only'</span> WE <span class="hljs-string">'NOAA_water_database'</span> DURATION 1 d REPLICATION 1</span><br></pre></td></tr></table></figure>
<p>This policy keeps the records during a day(one_day_only) based NOAA_water_database. The data are stored in space shard 1 day. Replication 1 indicates that a copy of each item is copied in the cluster.</p>
<h1 id="Modify-retention-policy-alter-retention-policy"><a href="#Modify-retention-policy-alter-retention-policy" class="headerlink" title="Modify retention policy(alter retention policy)"></a>Modify retention policy(alter retention policy)</h1><p>This method allows to change an existing retention policy</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER ...</span><br></pre></td></tr></table></figure>
<h1 id="Destroyed-a-retention-policy-drop-retention-policy"><a href="#Destroyed-a-retention-policy-drop-retention-policy" class="headerlink" title="Destroyed a retention policy(drop retention policy)"></a>Destroyed a retention policy(drop retention policy)</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP RETENTION ...</span><br></pre></td></tr></table></figure>
<h1 id="Discover-the-InfluxDB-Shell"><a href="#Discover-the-InfluxDB-Shell" class="headerlink" title="Discover the InfluxDB Shell"></a>Discover the InfluxDB Shell</h1><p>Now we know some methods, we will provide to run some test</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-30T02:29:34.000Z">2017-06-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 826 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/30/Usage-of-Node-Influx/">Usage of Node-Influx</a>
            
        </h1>
        <div class="content">
            <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>InfluxDB is a time series database, so it would make sense that the concept of time is moderately important when dealing with it.</p>
<p>By default, Influx will store all dates you give to it as a nanosecond precision timestamp, whereas in JavaScript, most of the time we’re dealing with millisecond precision timestamps, which we get from <code>Date.now()</code> or <code>myDate.getTime()</code>. This presents a bit of a problem for us JavaScripters, since nanosecond-precision timestamps are stored as 64-bit unsigned integers that JavaScript simply cannot represent accurately.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node-influx git:(master) node</span><br><span class="line">&gt; <span class="hljs-number">1475985480231035677</span></span><br><span class="line"><span class="hljs-number">1475985480231035600</span></span><br></pre></td></tr></table></figure>
<p>This module tries to make dates as easy as possible for you to deal with, and out of the box everything should ‘just work’.</p>
<p>There are three places that dates can get passed around:</p>
<ul>
<li><p>Dates coming rom Influx queries, like <code>select * from my_series</code></p>
</li>
<li><p>Dates being interpolated <em>into</em> Influx queries</p>
</li>
<li><p>Dates being used when writing points on the line protocol, via <code>.writePoints()</code> or <code>.writeMeasurement()</code>.</p>
</li>
</ul>
<p>To deal with this, we introduce a new type called <code>NanoDate</code>. These dates behave just like the normal <code>Date</code> type, but have two additional methods: <code>.getNanoTime()</code> and <code>.getNanoISOString()</code>. They behave just like the normal <code>.getTime()</code> and <code>getISOString</code> methods, but they both return nanosecond-precision strings instead of millisecond-precision numbers and timestamps.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">expect(myNanoDate.getTime()).to.equal(<span class="hljs-number">1475985480231</span>)</span><br><span class="line">expect(myNanoDate.getNanoTime()).to.equal(<span class="hljs-string">'1475985480231035677'</span>)</span><br><span class="line">expect(myNanoDate.toISOString()).to.equal(<span class="hljs-string">'2016-10-09T03:58:00.231Z'</span>)</span><br><span class="line">expect(myNanoDate.toNanoISOString()).to.equal(<span class="hljs-string">'2016-10-09T03:58:00.231035677Z'</span>)</span><br></pre></td></tr></table></figure>
<p>All times returned from Influx queries are parsed to INanoDates. For example you can do something like the following:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">influx.query(<span class="hljs-string">'select * from perf'</span>).then(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> &#123;</span><br><span class="line">  result.forEach(<span class="hljs-function"><span class="hljs-params">row</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Used <span class="hljs-subst">$&#123;row.cpu&#125;</span> at <span class="hljs-subst">$&#123;row.time.toNanoISOString()&#125;</span>`</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>When writing data to Influx, all write methods accept INanoDates in all situation. This means if you select data from Influx and want to update a data point, you can pass the time right back into <code>write</code> method. (Remember, points within series are unique by their time) If you have a nanosecond timestamp from some external source, you can convert it to INanoDate using <code>toNanoDate</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> &#123; toNanoDate &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'influx'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> myNanoDate = toNanoDate(<span class="hljs-string">'1475985480231035600'</span>)</span><br><span class="line">expect(myNanoDate.getTime()).to.equal(<span class="hljs-number">1475985480231</span>)</span><br><span class="line">expect(myNanoDate.getNanoTime()).to.equal(<span class="hljs-string">'1475985480231035600'</span>)</span><br><span class="line">expect(myNanoDate.toNanoISOString()).to.equal(<span class="hljs-string">'2016-10-09T03:58:00.231035600Z'</span>)</span><br></pre></td></tr></table></figure>
<p>Finally, if you want to embed a iNanoDate into an Influx query, you should use <code>toNanoString</code> to do so:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">influx.query(<span class="hljs-string">`select * from perf where time &gt; "<span class="hljs-subst">$&#123;myNanoDate.toNanoISOString()&#125;</span>"`</span>)</span><br></pre></td></tr></table></figure>
<h1 id="Browser-Setup"><a href="#Browser-Setup" class="headerlink" title="Browser Setup"></a>Browser Setup</h1><p>For Node.js, <code>influx</code> can be installed and you can use it out of the box.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add influx@next</span><br></pre></td></tr></table></figure>
<p>You can tell Webpack to use this module by adding the following section in your <code>webpack.config.js</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> http = path.resolve(__dirname, <span class="hljs-string">'node_modules/stream-http/index.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123; http, <span class="hljs-attr">https</span>: http &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><h2 id="Class-Summary"><a href="#Class-Summary" class="headerlink" title="Class Summary"></a>Class Summary</h2><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">ExponentialBackoff</td>
</tr>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">Expression:<br></td>
</tr>
</tbody>
</table>
<p>Expression is used to build filtering expression, like those used in WHERE clauses<br>public | InfluxDB:<br><br>InfluxDB is the public interface to run queries against your database<br>public | Measurement:<br><br>Measurement creates a reference to a particular measurement<br>public | Pool:<br><br>The Pool maintains a list available Influx hosts and dispatches requests to them<br>public | Raw:<br><br>You can provide Raw values to Influx methods to prevent it from escaping your provided string.<br>public | RequestError:<br><br>An RequestError is thrown when a query generates errorful results in a 300&lt;= error &lt;=500<br>public | ResultError:<br><br>An ResultError is thrown when a query generates errorful results from Influx<br>public | ServiceNotAvailableError:<br><br>An ServiceNotAvailableError is returned as an error from requests that result in a &gt;500 error code</p>
<h3 id="interface-Summary"><a href="#interface-Summary" class="headerlink" title="interface Summary"></a>interface Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">IBackoffStrategy:<br></td>
</tr>
</tbody>
</table>
<p>The IBackoffStrategy dictates behavior to use when hosts in the connection pool start failing<br>public | INanoDate:<br><br>An INanoDate is a type of Date that holds a nanosecond-precision unix timestamp<br>public | IResults:<br><br>IResults are returned from the InfluxBD#query mehtod</p>
<h3 id="Function-Summary"><a href="#Function-Summary" class="headerlink" title="Function Summary"></a>Function Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">toNanoDate(timestamp: String): NanoDate:<br></td>
</tr>
</tbody>
</table>
<p>Covers a nanoseconds unix timestamp to a INanoDate for node-influx.</p>
<h3 id="Variable-Summary"><a href="#Variable-Summary" class="headerlink" title="Variable Summary"></a>Variable Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">Precision: Object</td>
</tr>
</tbody>
</table>
<p>&lt;string, string=””&gt;:<br>Precision is a map of available influx time precision&lt;/string,&gt;<br>public | escape: Object:<br><br>tagEscaper escapes tag keys, tag values and field keys.</p>
<h3 id="Typedef-Summary"><a href="#Typedef-Summary" class="headerlink" title="Typedef Summary"></a>Typedef Summary</h3><table>
<thead>
<tr>
<th style="text-align:center">attr</th>
<th style="text-align:left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">public</td>
<td style="text-align:left">FieldType: Number:<br></td>
</tr>
</tbody>
</table>
<p>FieldType is an enumeration of influxDB field data types<br>public | IClusterConfig: Object:<br><br>A IClusterConfig can be provided into <code>new InfluxDB(config)</code> when you have a multiple influx nodes to connect to<br>public | IPingStats: Object:<br><br>IPingStats is returned from InfluxDB#ping<br>public | IPoint: Object<br><br>IPoint is passed to the client’s write methods to store a point in InfluxDB<br>public | IPoolOptions: Object<br><br>Pool options can be passed into the database to configure the behavior of the connection Pool<br>public | IQueryOptions: Object<br><br>The IQueryOptions allows you to configure how queries are run against Influx<br>public | ISchemaOptions: Object<br><br>Schema options can be passed into the <code>new InfluxDB()</code> constructor to help define the shape of your data.<br>public | ISingleHostConfig: Object<br><br>A ISingleHostConfig can be provided into <code>new InfluxDB(config)</code> when you have a single Influx address to connect to<br>public | IWriteOptions: Object<br><br>IWriteOptions configure how points are written in the database.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-30T01:09:56.000Z">2017-06-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 391 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/30/Example-of-node-influx/">Example of Node-Influx</a>
            
        </h1>
        <div class="content">
            <h1 id="Express-Response-Times-Example"><a href="#Express-Response-Times-Example" class="headerlink" title="Express Response Times Example"></a>Express Response Times Example</h1><p>In this example we’ll create a server which has an index page that prints out ‘hello world’, and a page</p>
<p><code>http://localhost:3000/times</code> which prints out the last ten response times that influxDB gave us.</p>
<p>The end result should look something like this:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">curl -s localhost:3000</span><br><span class="line">Hello world</span><br><span class="line"></span><br><span class="line">curl -s localhost:3000/<span class="hljs-built_in">times</span> | jq</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="hljs-string">"time"</span>: <span class="hljs-string">"2016-10-09T19:13:26.815Z"</span>,</span><br><span class="line">    <span class="hljs-string">"duration"</span>: 205,</span><br><span class="line">    <span class="hljs-string">"host"</span>: <span class="hljs-string">"ares.peet.io"</span>,</span><br><span class="line">    <span class="hljs-string">"path"</span>: <span class="hljs-string">"/"</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>Get started by installing and importing everything we need. This example requires Node 6.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install influx express</span><br></pre></td></tr></table></figure>
<p>Now create a new file <code>app.js</code> and start writing</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> Influx = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../../'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">'os'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> app = express()</span><br></pre></td></tr></table></figure>
<p>Create a new influx client. We tell it to use the <code>express_response_db</code> database by default, and give it some information about the schema we’re writing. It can use this to be smarter about what data formats it writes and do some basic validation for us.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> influx = <span class="hljs-keyword">new</span> Influx.InfluxBD(&#123;</span><br><span class="line">  host: <span class="hljs-string">'localhost'</span>,</span><br><span class="line">  database: <span class="hljs-string">'express_response_db'</span>,</span><br><span class="line">  schema: [</span><br><span class="line">    &#123;</span><br><span class="line">      measurement: <span class="hljs-string">'response_time'</span>,</span><br><span class="line">      fields: &#123;</span><br><span class="line">        path: Influx.FieldType.STRING,</span><br><span class="line">        duration: Influx.FieldType.INTEGER</span><br><span class="line">      &#125;,</span><br><span class="line">      tags: [</span><br><span class="line">        <span class="hljs-string">'host'</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Now we have a working influx client!</p>
<p>We’ll make sure the database exists and boot the app.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">influx.getDatabaseName()</span><br><span class="line">.then(<span class="hljs-function"><span class="hljs-params">names</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (!names.includes(<span class="hljs-string">'express_response_db'</span>)) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> influx.createDatabase(<span class="hljs-string">'express_response_db'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">  http.createServer(app).listen(<span class="hljs-number">3000</span>, () =&gt; &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Listening on port 3000'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'Error creating Influx database'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Finally we’ll define the middleware and routes we’ll use. We have a generic middleware that records the time between when requests comes in, and the time we response to them. We also have another route called <code>/times</code> which prints out the last ten timings we recorded.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> start = <span class="hljs-built_in">Date</span>.now()</span><br><span class="line">  res.on(<span class="hljs-string">'finish'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> duration = <span class="hljs-built_in">Date</span>.now() - start</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Request to <span class="hljs-subst">$&#123;req.path&#125;</span> took <span class="hljs-subst">$&#123;duration&#125;</span> ms`</span>)</span><br><span class="line">    influx.writePoints([</span><br><span class="line">      &#123;</span><br><span class="line">        measurement: <span class="hljs-string">'response_times'</span>,</span><br><span class="line">        tags: &#123; <span class="hljs-attr">host</span>: os.hostname() &#125;,</span><br><span class="line">        fields: &#123; duration, <span class="hljs-attr">path</span>: req.path &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Error saving data to InfluxDB: <span class="hljs-subst">$&#123;err.stack&#125;</span>`</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="hljs-keyword">return</span> next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> res.end(<span class="hljs-string">'Hello world'</span>), <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">500</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/times'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  influx.query(<span class="hljs-string">`</span></span><br><span class="line"><span class="hljs-string">      select * from response_times</span></span><br><span class="line"><span class="hljs-string">      where host = <span class="hljs-subst">$&#123;Influx.<span class="hljs-built_in">escape</span>.stringLit(os.hostname())&#125;</span></span></span><br><span class="line"><span class="hljs-string">      order by time desc</span></span><br><span class="line"><span class="hljs-string">      limit 10</span></span><br><span class="line"><span class="hljs-string">  `</span>).then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> &#123;</span><br><span class="line">    res.json(result)</span><br><span class="line">  &#125;).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">    res.status(<span class="hljs-number">500</span>).send(err.stack)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-29T05:50:27.000Z">2017-06-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 503 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/29/snippets-of-koa-middlewares/">Snippets of Koa Middlewares</a>
            
        </h1>
        <div class="content">
            <h1 id="koa-compress"><a href="#koa-compress" class="headerlink" title="koa-compress"></a>koa-compress</h1><p>Compress middleware for Koa</p>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> compress = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-compress'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</span><br><span class="line">app.use(compress(&#123;</span><br><span class="line">  filter: <span class="hljs-function">(<span class="hljs-params">content_type</span>) =&gt;</span> /text/i.test(content_type),</span><br><span class="line">  threshold: <span class="hljs-number">2048</span>,</span><br><span class="line">  flush: <span class="hljs-built_in">require</span>(<span class="hljs-string">'zlib'</span>).Z_SYNC_FLUSH,</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><p>The options are passed to <code>zlib</code></p>
<blockquote>
<p>filter: An optional function that checks the response content type to decide whether to compress. By default, it uses <a href="https://github.com/expressjs/compressible" target="_blank" rel="noopener">compressible</a></p>
</blockquote>
<blockquote>
<p>threshold: Minimum response size in bytes to compress. Default 1024 byte or 1kb.</p>
</blockquote>
<h3 id="koa-morgan"><a href="#koa-morgan" class="headerlink" title="koa-morgan"></a>koa-morgan</h3><p>HTTP Request logger middleware for node.js</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> morgan = <span class="hljs-built_in">require</span>(<span class="hljs-string">'morgan'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="morgan-format-options"><a href="#morgan-format-options" class="headerlink" title="morgan(format, options)"></a>morgan(format, options)</h4><p>Create a new morgan logger middleware function using the given <code>format</code> and <code>options</code>.</p>
<p>The <code>format</code> argument amay be a string of a predefined name, a string fo a format string, or a function that will produce a log entry.</p>
<p>The <code>format</code> function will be called with three arguments <code>tokens</code>, <code>req</code> and <code>res</code>, where <code>tokens</code> is object with all tokens, <code>req</code> is the HTTP request and <code>res</code> is the HTTP response. The function is expected to return a string that will be the log line, or <code>undefined</code>/<code>null</code> to skip logging.</p>
<h4 id="predefined-format-string"><a href="#predefined-format-string" class="headerlink" title="predefined format string"></a>predefined format string</h4><blockquote>
<p><code>combined</code>: Standard Apache combined log output</p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:remote-addr - :remote-user [:date[clf]] <span class="hljs-string">":method :url HTTP/:http-version"</span> :status :res[content-length] <span class="hljs-string">":referrer"</span> <span class="hljs-string">":user-agent"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>common</code>: Standard Apache common log output</p>
</blockquote>
<blockquote>
<p><code>dev</code></p>
</blockquote>
<blockquote>
<p><code>short</code></p>
</blockquote>
<blockquote>
<p><code>tiny</code></p>
</blockquote>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:method :url :status :res[content-length] - :response-time ms</span><br></pre></td></tr></table></figure>
<h4 id="write-logs-to-a-file"><a href="#write-logs-to-a-file" class="headerlink" title="write logs to a file"></a>write logs to a file</h4><p>Single file</p>
<p>Simple app that will log all request in the Apache combined format to the file <code>access.log</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> morgan = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-morgan'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> accessLogStream = fs.createWriteStream(__dirname + <span class="hljs-string">'/access.log'</span>, &#123; <span class="hljs-attr">flags</span>: <span class="hljs-string">'a'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// setup the logger</span></span><br><span class="line"></span><br><span class="line">app.use(morgan(<span class="hljs-string">'combined'</span>, &#123; <span class="hljs-attr">stream</span>: accessLogStream &#125;))</span><br><span class="line"></span><br><span class="line">app.use(<span class="hljs-function">(<span class="hljs-params">ctx</span>) =&gt;</span> &#123;</span><br><span class="line">  ctx.body = <span class="hljs-string">'hello world'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="hljs-number">3000</span>)</span><br></pre></td></tr></table></figure>
<h3 id="koa-session"><a href="#koa-session" class="headerlink" title="koa-session"></a>koa-session</h3><p>Simple session middleware for koa. Default is cookie-based session and support external store.</p>
<p><em>Require Node 7.6 or greater for asycn/await support</em></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-session'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</span><br><span class="line"></span><br><span class="line">app.keys = [<span class="hljs-string">'some secret hurr'</span>]</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> CONFIG = &#123;</span><br><span class="line">  key: <span class="hljs-string">'koa:sess'</span>, <span class="hljs-comment">// (string) cookie key, default is koa:sess</span></span><br><span class="line">  maxAge: <span class="hljs-number">86400000</span>, <span class="hljs-comment">// (number) in ms, default is 1 day,</span></span><br><span class="line">  overWrite: <span class="hljs-literal">true</span>, <span class="hljs-comment">// (boolean) can overwrite or not, default true</span></span><br><span class="line">  httpOnly: <span class="hljs-literal">true</span>, <span class="hljs-comment">// (boolean) httpOnly or not, default true</span></span><br><span class="line">  signed: <span class="hljs-literal">true</span>, <span class="hljs-comment">// (boolean) signed or not, default true</span></span><br><span class="line">  rolling: <span class="hljs-literal">false</span>, <span class="hljs-comment">// (boolean) Force a session identifier cookie to be set on every response. The expiration is reset to the original maxAge.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.use(session(CONFIG, app)) <span class="hljs-comment">// or if you prefer to default config, you can use =&gt; app.use(session(app))</span></span><br><span class="line"></span><br><span class="line">app.use(<span class="hljs-function"><span class="hljs-params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (ctx.path === <span class="hljs-string">'/favicon.ico'</span>) <span class="hljs-keyword">return</span></span><br><span class="line">  <span class="hljs-keyword">let</span> n = ctx.session.views || <span class="hljs-number">0</span></span><br><span class="line">  ctx.session.views = ++n</span><br><span class="line">  ctx.body = n + <span class="hljs-string">' views'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="hljs-number">3000</span>)</span><br><span class="line"><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'listening on port 3000'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Options-1"><a href="#Options-1" class="headerlink" title="Options"></a>Options</h4><p>The cookie name is controlled by the key option, which default to ‘koa:sess’. All other options are passed to <code>ctx.cookies.get()</code> and <code>ctx.cookies.set()</code> allowing you to control security, domain, path and signing among other setting.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-14T06:11:07.000Z">2017-06-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 910 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/14/git-merge-and-rebase/">Git Merge and Rebase</a>
            
        </h1>
        <div class="content">
            <h1 id="Conceptual-Overview"><a href="#Conceptual-Overview" class="headerlink" title="Conceptual Overview"></a>Conceptual Overview</h1><p>The first thing to understand about <code>git rebase</code> is that it solves the same problem as <code>git merge</code>. Both of these commands are designed to integrate changes from one branch into another branch – they just do it in very different ways.</p>
<p>Consider what happens when you start working on a new feature in a dedicated branch, then another team member updates the <code>master</code> branch with new commits. The results in a forked history which should be familiar to anyone who has used Git as a collaboration tool.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:01b0b04e-64f3-4659-af21-c4d86bc7cb0b/01.svg?cdnVersion=ey" alt=""></p>
<p>Now, let’s say that the new commits in <code>master</code> are relevant to the feature that you’re working on. To incorporate the new commits into your <code>feature</code> branch, you have two options: <code>mergin</code>or <code>rebasing</code>.</p>
<h1 id="The-Merge-Option"><a href="#The-Merge-Option" class="headerlink" title="The Merge Option"></a>The Merge Option</h1><p>The easiest option is to merge the <code>master</code> branch into the <code>feature</code> branch using something like the following:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git merge master</span><br></pre></td></tr></table></figure>
<p>Or you can condense this to a one-liner:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge master feature</span><br></pre></td></tr></table></figure>
<p>This creates a new <code>merge commit</code> in the <code>feature</code> branch that ties together the histories of the both branches, giving you a branch structure that looks like this:</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:e229fef6-2c2f-4a4f-b270-e1e1baa94055/02.svg?cdnVersion=ey" alt=""></p>
<p>Merging is nice because it’s a <code>non-destructive</code> operation. The existing branches are not changed in any way. This avoids all of the potential pitfalls of rebasing.</p>
<p>On the other hand, this also means that the <code>feature</code> branch will have an extraneous merge commit every time you need to incorporate upstream changes. If <code>master</code> is very active, this can pollute your <code>feature</code> branch history quite a bit. While it’s possible to migrate this issue with advanced <code>git log</code> options, it can make it hard to other developers to understand the history of the project.</p>
<h1 id="The-Rebase-Option"><a href="#The-Rebase-Option" class="headerlink" title="The Rebase Option"></a>The Rebase Option</h1><p>As an alternative to merge, you can rebase the <code>feature</code> branch onto <code>master</code> branch using the following commands:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git rebase master</span><br></pre></td></tr></table></figure>
<p>This moves the entire <code>feature</code> branch to begin on the top of the <code>master</code> branch, effectively incorporating all of the new commits in <code>master</code>. But, instead of using a merge commit, rebasing <code>re-writes</code> the project history by creating brand new commits for each commit in the original branch.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:5b153a22-38be-40d0-aec8-5f2fffc771e5/03.svg?cdnVersion=ey" alt=""></p>
<p>The major benefit of rebasing is that you get a much cleaner project history. First, it eliminates the unnecessary merge commits required by <code>git merge</code>. Second, as you can see in the above diagram, rebasing also results in a perfectly linear project history – you can follow the top of <code>feature</code> all the way to the beginning of the project without any forks. This makes it easier to navigate your project with commands like <code>git log</code>.</p>
<h1 id="Interactive-Rebasing"><a href="#Interactive-Rebasing" class="headerlink" title="Interactive Rebasing"></a>Interactive Rebasing</h1><p>Interactive rebasing gives you the opportunity to alter commits as they are moved to the new branch. This is even more powerful than an automated rebase, since it offers complete control over the branch’s commit history. Typically, this is used to clean up a messy history before merging a feature branch into <code>master</code>.</p>
<p>To begin an interactive rebasing session, pass the <code>-i</code> option to the <code>git rebase</code> command.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git rebase -i master</span><br></pre></td></tr></table></figure>
<p>This will open a text editor listing all of the commits that are about to be moved:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pick 33d5b7a Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#1</span></span><br><span class="line">pick 9480b3d Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#2</span></span><br><span class="line">pick 5c67e61 Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#3</span></span><br></pre></td></tr></table></figure>
<p>This listing defines exactly what the branch will look like after the rebase is performed. By changing the <code>pick</code> command and/or reordering the entries, you can make the branch’s history look like whatever you want.</p>
<p>For example, if the 2nd commit fixes a small problem in the 1st commit, you can condense them into a single comit with the <code>fixup</code> command:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pick 33d5b7a Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#1</span></span><br><span class="line">fixup 9480b3d Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#2</span></span><br><span class="line">pick 5c67e61 Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#3</span></span><br></pre></td></tr></table></figure>
<p>When you save and close the file, Git will perform the rebase according to your instructions, resulting in project history that looks like the following:</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:fe6942b4-7a60-4464-9181-b67e59e50788/04.svg?cdnVersion=ey" alt=""></p>
<p>Eliminating insignificant commits like this makes your feature’s history much easier to understand. <strong>This is something that <code>git merge</code> simply cannot do</strong>.</p>
<h1 id="The-Golden-Rule-of-Rebasing"><a href="#The-Golden-Rule-of-Rebasing" class="headerlink" title="The Golden Rule of Rebasing"></a>The Golden Rule of Rebasing</h1><p>The Golden Rule of <code>git rebase</code> is to never use it on <em>public</em> branches.</p>
<p>For example, think about what would happen if you rebased <code>master</code> onto your <code>feature</code> branch.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:1d22f018-b2c7-4096-9db1-c54940cf4f4e/05.svg?cdnVersion=ey" alt=""></p>
<p>The rebase moves all of the commits in <code>master</code> onto the tip of <code>feature</code>. The problem is that only happened in <em>your</em> repo. All of the other developers are still working with the origin master. Since rebasing results in brand new commits, Git will think that your <code>master</code> branch’s history has diverged from everybody else’s.</p>
<p>The only way to synchronize the two <code>master</code> branches is to merge them back together, resulting in an extra merge commit <strong>and</strong> two sets of commits that contain the same changes.</p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/5/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/7/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/5/">5</a></li>
            
            <li><a class="pagination-link is-current" href="/page/6/">6</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/7/">7</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/16/">16</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.jpg" alt="Keith Chen">
                    
                    
                    <p class="is-size-4 is-block">
                        Keith Chen
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        FE Engineer on Blockchain
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>30°17&#39;37N, 120°9&#39;41E</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        303
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        7
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        89
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/keith-CY" target="_blank">
                Follow</a>
        </div>
        
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/keith-CY" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Keith CY</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.linkedin.com/in/宇-陈-644b61ba" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Yu Chen</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.linkedin.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Soup/">
            <span class="level-start">
                <span class="level-item">Soup</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Uncategorized/">
            <span class="level-start">
                <span class="level-item">Uncategorized</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/github/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">141</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/note/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AJAX/" style="font-size: 10.91px;">AJAX</a> <a href="/tags/BOOTSTRAP/" style="font-size: 10px;">BOOTSTRAP</a> <a href="/tags/Bash/" style="font-size: 11.82px;">Bash</a> <a href="/tags/BlockChain/" style="font-size: 10px;">BlockChain</a> <a href="/tags/Blockchain/" style="font-size: 10px;">Blockchain</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/CSS/" style="font-size: 10.91px;">CSS</a> <a href="/tags/CSS3/" style="font-size: 20px;">CSS3</a> <a href="/tags/Closure/" style="font-size: 10px;">Closure</a> <a href="/tags/CommonJS/" style="font-size: 10px;">CommonJS</a> <a href="/tags/Contract-Ethereum-Web3/" style="font-size: 10px;">Contract, Ethereum, Web3</a> <a href="/tags/Contract-Solidity/" style="font-size: 10px;">Contract, Solidity</a> <a href="/tags/D3-Example/" style="font-size: 10px;">D3, Example</a> <a href="/tags/DAPP-Solidity/" style="font-size: 10px;">DAPP, Solidity</a> <a href="/tags/DApp-Solidity/" style="font-size: 10px;">DApp, Solidity</a> <a href="/tags/DOM/" style="font-size: 12.73px;">DOM</a> <a href="/tags/DevTools/" style="font-size: 10px;">DevTools</a> <a href="/tags/Drizzle-Ethereum-BlockChain/" style="font-size: 10px;">Drizzle, Ethereum, BlockChain</a> <a href="/tags/ES6/" style="font-size: 10.91px;">ES6</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/ETH-Wallet/" style="font-size: 10px;">ETH, Wallet</a> <a href="/tags/Elixir-Phoenix-SCSS/" style="font-size: 10px;">Elixir, Phoenix, SCSS</a> <a href="/tags/Erlang-Elixir-GenServer/" style="font-size: 10px;">Erlang, Elixir, GenServer</a> <a href="/tags/Ethereum/" style="font-size: 10px;">Ethereum</a> <a href="/tags/Ethereum-IPFS/" style="font-size: 10px;">Ethereum, IPFS</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Go-Http-Web/" style="font-size: 10px;">Go, Http, Web</a> <a href="/tags/GraphQL-Apollo-TypeScript/" style="font-size: 10px;">GraphQL, Apollo, TypeScript</a> <a href="/tags/Gulp/" style="font-size: 11.82px;">Gulp</a> <a href="/tags/HTML5/" style="font-size: 15.45px;">HTML5</a> <a href="/tags/HTTP2-Node/" style="font-size: 10px;">HTTP2, Node</a> <a href="/tags/Html-Picture/" style="font-size: 10px;">Html, Picture</a> <a href="/tags/Immutable/" style="font-size: 10px;">Immutable</a> <a href="/tags/Int8Array/" style="font-size: 10px;">Int8Array</a> <a href="/tags/JSON-RPC/" style="font-size: 10px;">JSON-RPC</a> <a href="/tags/Javascript/" style="font-size: 19.09px;">Javascript</a> <a href="/tags/Koa/" style="font-size: 10.91px;">Koa</a> <a href="/tags/Koa-NPM-Package/" style="font-size: 10px;">Koa, NPM, Package</a> <a href="/tags/MDL/" style="font-size: 16.36px;">MDL</a> <a href="/tags/Material-Design/" style="font-size: 17.27px;">Material Design</a> <a href="/tags/Mock-JavaScript/" style="font-size: 10px;">Mock, JavaScript</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/NODE/" style="font-size: 13.64px;">NODE</a> <a href="/tags/NPM/" style="font-size: 10.91px;">NPM</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Nock/" style="font-size: 10px;">Nock</a> <a href="/tags/Node-CLI/" style="font-size: 10.91px;">Node, CLI</a> <a href="/tags/Node-Fastify/" style="font-size: 10.91px;">Node, Fastify</a> <a href="/tags/Node-Graphql-Koa/" style="font-size: 10px;">Node, Graphql, Koa</a> <a href="/tags/Node-js/" style="font-size: 10.91px;">Node.js</a> <a href="/tags/Phoenix-Elixir-Ecto/" style="font-size: 10px;">Phoenix, Elixir, Ecto</a> <a href="/tags/Promise/" style="font-size: 11.82px;">Promise</a> <a href="/tags/Protobuf/" style="font-size: 10px;">Protobuf</a> <a href="/tags/Pug-HTML/" style="font-size: 10px;">Pug, HTML</a> <a href="/tags/React/" style="font-size: 18.18px;">React</a> <a href="/tags/React-Docker/" style="font-size: 10px;">React, Docker</a> <a href="/tags/React-Router-Code-splitting/" style="font-size: 10px;">React, Router, Code-splitting</a> <a href="/tags/React-Native/" style="font-size: 10px;">React-Native</a> <a href="/tags/React-Redux/" style="font-size: 10px;">React-Redux</a> <a href="/tags/React-Router/" style="font-size: 10.91px;">React-Router</a> <a href="/tags/Redux/" style="font-size: 14.55px;">Redux</a> <a href="/tags/RegExp/" style="font-size: 10px;">RegExp</a> <a href="/tags/Ruby-Rails/" style="font-size: 10px;">Ruby, Rails</a> <a href="/tags/Ruby-Rails-RoR-Mina/" style="font-size: 10px;">Ruby, Rails, RoR, Mina</a> <a href="/tags/Rust-Rocket/" style="font-size: 10px;">Rust, Rocket</a> <a href="/tags/RxJS/" style="font-size: 10px;">RxJS</a> <a href="/tags/Smart-Contract-Web3/" style="font-size: 10px;">Smart Contract, Web3</a> <a href="/tags/Solidity/" style="font-size: 12.73px;">Solidity</a> <a href="/tags/Solidity-Error-Handling/" style="font-size: 10px;">Solidity, Error Handling</a> <a href="/tags/Solidity-Public-External/" style="font-size: 10px;">Solidity, Public, External</a> <a href="/tags/Solidity-Smart-Contract/" style="font-size: 10px;">Solidity, Smart Contract</a> <a href="/tags/Thunk/" style="font-size: 10.91px;">Thunk</a> <a href="/tags/Trick/" style="font-size: 11.82px;">Trick</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Webpack-DLL/" style="font-size: 10px;">Webpack, DLL</a> <a href="/tags/automatic/" style="font-size: 10px;">automatic</a> <a href="/tags/babel/" style="font-size: 10px;">babel</a> <a href="/tags/babel-polyfill/" style="font-size: 10px;">babel-polyfill</a> <a href="/tags/blockchain-bitcoin-bip/" style="font-size: 10px;">blockchain, bitcoin, bip</a> <a href="/tags/commandline/" style="font-size: 10px;">commandline</a> <a href="/tags/github/" style="font-size: 10.91px;">github</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/precache/" style="font-size: 10px;">precache</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/webpack/" style="font-size: 17.27px;">webpack</a> <a href="/tags/webpack2/" style="font-size: 11.82px;">webpack2</a> <a href="/tags/测试/" style="font-size: 11.82px;">测试</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="5 Tips in CRA@2.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time></div>
                    <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="has-link-black-ter is-size-6">5 Tips in CRA@2.0</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/08/Assembly-in-Solidity/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Assembly in Solidity">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time></div>
                    <a href="/2018/11/08/Assembly-in-Solidity/" class="has-link-black-ter is-size-6">Assembly in Solidity</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/09/10/Analysis-of-Ujo/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Analysis of Ujo">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-09-10T05:26:39.000Z">2018-09-10</time></div>
                    <a href="/2018/09/10/Analysis-of-Ujo/" class="has-link-black-ter is-size-6">Analysis of Ujo</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="5 Tips in CRA@2.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time></div>
                    <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="has-link-black-ter is-size-6">5 Tips in CRA@2.0</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/08/Assembly-in-Solidity/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Assembly in Solidity">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time></div>
                    <a href="/2018/11/08/Assembly-in-Solidity/" class="has-link-black-ter is-size-6">Assembly in Solidity</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/09/10/Analysis-of-Ujo/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Analysis of Ujo">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-09-10T05:26:39.000Z">2018-09-10</time></div>
                    <a href="/2018/09/10/Analysis-of-Ujo/" class="has-link-black-ter is-size-6">Analysis of Ujo</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="EzCook" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Chen Yu&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>