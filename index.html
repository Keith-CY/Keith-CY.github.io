<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8">
<title>EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>


    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="EzCook" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-image">
        <a href="/2019/04/20/node-on-bip-173/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/segwit.png" alt="Node-on-Bip-173">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-04-20T08:36:54.000Z">2019-04-20</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 216 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/04/20/node-on-bip-173/">Node-on-Bip-173</a>
            
        </h1>
        <div class="content">
            <p><a href="https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki" target="_blank" rel="noopener">wiki</a></p>
<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>BIP 173 proposed a checksummed base32 format, <strong>Bech32</strong> and a standard for native segregated witness output addresses using it to replace BIP 142. This format is not required for using segwit, but is more efficient, flexible and nicer to use.</p>
<h1 id="Bech32"><a href="#Bech32" class="headerlink" title="Bech32"></a>Bech32</h1><p>A Bech32 string is at most <strong>90</strong> characters long and consists of:</p>
<ul>
<li><p>The <strong>human-readable part(hrp)</strong>, which is intended to convey <strong>the type of data</strong>, or anything else that is relevant to the reader.</p>
</li>
<li><p>The <strong>separator</strong> which is always <strong>“1”</strong>. In case “1” is allowed inside the hrp, the last one in the string is the separator.</p>
</li>
<li><p>The <strong>data part</strong>, which is at least <strong>6</strong> characters long and only consists of alphanumeric characters excluding “1”, “b”, “i”, “o”.</p>
</li>
</ul>
<h2 id="Checksum"><a href="#Checksum" class="headerlink" title="Checksum"></a>Checksum</h2><p>The last six characters of the data part form a chechsum and contain no information.</p>
<h2 id="Segwit-address-format"><a href="#Segwit-address-format" class="headerlink" title="Segwit address format"></a>Segwit address format</h2><p>A segwit address is a Bech32 encoding of:</p>
<ul>
<li><p>The human-readable part “bc” for mainnet and the “tb” for testnet.</p>
</li>
<li><p>The data-part values:</p>
<ul>
<li><p>1 byte: the witness version</p>
</li>
<li><p>A convention of the 2-to-40-byte witness program to base32:</p>
<ul>
<li><p>Start with the bits of the witness program, most significant bit per btye first.</p>
</li>
<li><p>Re-arrange those bits into groups of 5, and pad with zeros at the end if needed.</p>
</li>
<li><p>Translate those bits to characters.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-04-17T03:32:32.000Z">2019-04-17</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 96 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/04/17/notes-of-building-product-talking-to-users-and-growing/">[WIP]notes of Building Product, Talking to Users and Growing</a>
            
        </h1>
        <div class="content">
            <p><a href="https://genius.com/Adora-cheung-lecture-4-building-product-talking-to-users-and-growing-annotated" target="_blank" rel="noopener">original notes</a></p>
<ol>
<li><p>You need a lot of feedback. Maybe you get a lot of people to your site, but no one sticks around because you didn’t get that initial user feedback.</p>
</li>
<li><p>When you have an idea, you should really think about what the idea is really solving. Like what is the actual problem. You should describe your problem in one sentence, and then you should think.</p>
</li>
<li><p>When you have a problem and are able to state it, you should think about</p>
</li>
</ol>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/2019/03/16/keystore/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 529 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/16/keystore/">Keystore</a>
            
        </h1>
        <div class="content">
            <p><a href="https://medium.com/@julien.maffre/what-is-an-ethereum-keystore-file-86c8c5917b97" target="_blank" rel="noopener">Original</a></p>
<h1 id="What-is-a-keystore-file"><a href="#What-is-a-keystore-file" class="headerlink" title="What is a keystore file"></a>What is a keystore file</h1><p>A keystore file is en encrypted version of your unique private key that you will use to sign your transactions. If you lose this file your lose your assets.</p>
<h1 id="What-do-keystore-files-look-like"><a href="#What-do-keystore-files-look-like" class="headerlink" title="What do keystore files look like"></a>What do keystore files look like</h1><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"crypto"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"cipher"</span>: <span class="hljs-string">"aes-128-ctr"</span>,</span><br><span class="line">    <span class="hljs-attr">"cipherparams"</span>: &#123;</span><br><span class="line">      <span class="hljs-attr">"iv"</span>: <span class="hljs-string">"83dbcc02d8ccb40e466191a123791e0e"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-attr">"ciphertext"</span>: <span class="hljs-string">"d172bf743a674da9cdad04534d56926ef8358534d458fffccd4e6ad2fbde479c"</span>,</span><br><span class="line">    <span class="hljs-attr">"kdf"</span>: <span class="hljs-string">"scrypt"</span>,</span><br><span class="line">    <span class="hljs-attr">"kdfparams"</span>: &#123;</span><br><span class="line">      <span class="hljs-attr">"dklen"</span>: <span class="hljs-number">32</span>,</span><br><span class="line">      <span class="hljs-attr">"n"</span>: <span class="hljs-number">262144</span>,</span><br><span class="line">      <span class="hljs-attr">"r"</span>: <span class="hljs-number">1</span>,</span><br><span class="line">      <span class="hljs-attr">"p"</span>: <span class="hljs-number">8</span>,</span><br><span class="line">      <span class="hljs-attr">"salt"</span>: <span class="hljs-string">"ab0c7876052600dd703518d6fc3fe8984592145b591fc8fb5c6d43190334ba19"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-attr">"mac"</span>: <span class="hljs-string">"2103ac29920d71da29f15d75b4a16dbe95cfd7ff8faea1056c33131d846e3097"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"3198bc9c-6672-5ab3-d995-4942343ae5b6"</span>,</span><br><span class="line">  <span class="hljs-attr">"version"</span>: <span class="hljs-number">3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Thses fields mean:</p>
<ul>
<li><p>cipher: The name of a symmetric AES algorithm</p>
</li>
<li><p>cipherparams: The parameters required for the “cipher” algorithm above</p>
</li>
<li><p>ciphertext: The private key encrypted using the “cipher” algorithm above</p>
</li>
<li><p>kdf: A key derivation function used to let you encrypt your keystore file with a password</p>
</li>
<li><p>kdfparams: The parameters required for the “kdf” algorithm above</p>
</li>
<li><p>mac: A code used to verify your password</p>
</li>
</ul>
<h1 id="Work-flow"><a href="#Work-flow" class="headerlink" title="Work flow"></a>Work flow</h1><ol>
<li>Encrypting your private key</li>
</ol>
<p>These symmetric algorithms use a key to encrypt some data. The resulting data is encrypted and can be decrypted with the same method and the same key.</p>
<p>The relation between cipher, cipherparams, ciphertext:</p>
<ul>
<li><p>cipher is the symmetric algorithm used to encrypt the private key.</p>
</li>
<li><p>cipherparams are the parameters required for teh symmetric algorithm.</p>
</li>
<li><p>ciphertext is the encrypted input of the symmetric input.</p>
</li>
</ul>
<p>You get the decryption-key as the output of the kdf.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*nNI586I7fXesxYNls1pm2A.png" alt=""></p>
<p>By this, you need to retrieve your decryption-key(namely the key used in encryption) to decrypt your private key.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*3a9LeWT9B9CSu7a3x8GdKw.png" alt=""></p>
<ol>
<li>Protect with your passphrase</li>
</ol>
<p>To make sure unlocking your account is easy, you don’t need to remember your very long and non-user-friendly decrption-key that is used to decrypt ciphertext. Instead, the developers have opted for a passphrase-based protection.</p>
<p>The keystore use a kdf(key derivation function) that computes the decryption-key given a passphrase and a list of parameters.</p>
<ul>
<li><p>kdf is the key derivation function used to compute the decryption-key from your passphrase.</p>
</li>
<li><p>kdfparams are the parameters required for the function</p>
</li>
</ul>
<p>By the passphrase with kdfparams, the kdf returns your decrption-key.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*nNI586I7fXesxYNls1pm2A.png" alt=""></p>
<ol>
<li>Make sure your passphrase is right</li>
</ol>
<p>We need to guarantee that the passphrase typed to unlock the account is right, that it is the same one as the one entered when the keystore is generated.</p>
<p>This is where the field mac in the keystore works. Just after the kdf is executed, its result(decryption-key) and ciphertext are processed and compared to mac. If the result is the same as mac, then the passphrase was right and the decrption-key is correct.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*YaBR2RaF0-RulLc-pUmdyQ.png" alt=""></p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p><img src="https://cdn-images-1.medium.com/max/1200/1*jHfiOdfCKhyCq5V39vty-A.png" alt=""></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/2019/03/05/note-on-bip32/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 957 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/05/note-on-bip32/">Note on Bip32</a>
            
        </h1>
        <div class="content">
            <p><a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki" target="_blank" rel="noopener">wiki</a></p>
<p>The specification consists of two parts:</p>
<ol>
<li><p>a system for deriving a tree of keypairs from a single seed.</p>
</li>
<li><p>demostrate how to build a wallet structure on top of such a tree.</p>
</li>
</ol>
<h1 id="Specification-Key-derivation"><a href="#Specification-Key-derivation" class="headerlink" title="Specification: Key derivation"></a>Specification: Key derivation</h1><h2 id="Convention"><a href="#Convention" class="headerlink" title="Convention"></a>Convention</h2><p>In this text we assume the public key cryptography used in Bitcoin, namely elliptic curve cryttography using the field and curve parameters defined by secp256k1. Variables below are either:</p>
<ul>
<li><p>Integers modulo the order of the curve (referred to as n)</p>
</li>
<li><p>Coordinates of points on the curve</p>
</li>
<li><p>Byte sequences</p>
</li>
</ul>
<p>Addition (+) of two coordinate pair is defined as application of the EC group operation. Concatenation(||) is the operation of appending one byte sequence onto another.</p>
<h2 id="Extended-Keys"><a href="#Extended-Keys" class="headerlink" title="Extended Keys"></a>Extended Keys</h2><p>We are going to define a function to derive a number of child keys from a parent key. In order to prevent these from depending solely on the key itself, we extend both private key and public key first with an extra 256 bits of entropy. This extention, called the <strong>chain code</strong>, is identical for corresponding private key and public keys, and consist of 256 bits, namely 32 bytes.</p>
<p>We represent an extended private key as <code>(k, c)</code>, with <code>k</code> the normal private key and the c, the <code>chain code</code>. And extended public key is represented as <code>(K, c)</code>, with <code>K = point(k)</code> and the c the chain code.</p>
<p>Each extended key has 2^31 <strong>normal child keys</strong>, and 2^31 <strong>hardened child keys</strong>. Each of these child keys has an index. The normal child keys use indices <code>0</code> through <code>2^31 - 1</code>.</p>
<p>The hardened child keys use indices <code>2^31 - 1</code> through <code>2^32 - 1</code>.</p>
<p>To ease notation for hardened key indices, a number i_H represents i + 2 ^ 31.</p>
<h2 id="Child-key-derivation-CKB-function"><a href="#Child-key-derivation-CKB-function" class="headerlink" title="Child key derivation (CKB) function"></a>Child key derivation (CKB) function</h2><p>Given a parent extended key and an index i, it is possible to compute the corresponding child extended key. The algorithm to do so depends on whether the child is a hardened key or not.</p>
<h3 id="Private-parent-key-gt-private-child-key"><a href="#Private-parent-key-gt-private-child-key" class="headerlink" title="Private parent key =&gt; private child key"></a>Private parent key =&gt; private child key</h3><p>The function CKDpriv((k_par, c_par), i) =&gt; (k_i, c_i) computes a child extended private key from the parent extended private key.</p>
<ul>
<li>Check whether i &gt;= 2^31(whether the child is a hardened key)<ul>
<li>if so (hardened child): return failure</li>
<li>if not (normal child), let I = HMAC-SHA512(Key = c_par, Data = ser_P(K_par)||ser_32(i))</li>
</ul>
</li>
<li>Split I into two 32-byte sequences, I_L, and I_R.</li>
<li>The returned child key k_i is parse_256(I_L) + k_par(mod n)</li>
<li>The returned chain code c_i is I_R</li>
</ul>
<h3 id="Private-parent-key-gt-public-child-key"><a href="#Private-parent-key-gt-public-child-key" class="headerlink" title="Private parent key =&gt; public child key"></a>Private parent key =&gt; public child key</h3><h3 id="Public-parent-key-gt-private-child-key"><a href="#Public-parent-key-gt-private-child-key" class="headerlink" title="Public parent key =&gt; private child key"></a>Public parent key =&gt; private child key</h3><p>This is not possible.</p>
<h2 id="The-key-tree"><a href="#The-key-tree" class="headerlink" title="The key tree"></a>The key tree</h2><p>The next step is cascading serveral CKD construction to build a tree. We start with one root, the master extended key m. By evaluating CKBpriv(m, i) for several values of i, we get a number of level-1 derived nodes. As each of these is again an extended key, CKDpriv can be applied to those as well.</p>
<p>To shorten notation, we will write <code>CKDpriv(CKDpriv(CKDpriv(m, 3_H), 2), 5)</code> as <code>m/3_H/2/5</code>. Equivalently for public keys, we write <code>CKDpub(CKDpub(CKDpub(M, 3), 2), 5)</code> as <code>M/3/2/5</code>. This results in the following identities:</p>
<ul>
<li>N(m/a/b/c) = N(m/a/b)/c = N(m/a)/b/b = N(m)/a/b/c = M/a/b/c</li>
<li>N(m/a_H/b/c) = N(m/a_H/b)/c = N(m/a_H)/b/c</li>
</ul>
<p>However, N(m/a_H) cannot be rewritten as N(m)/a_H, as the latter is not possible.</p>
<h2 id="Key-identifiers"><a href="#Key-identifiers" class="headerlink" title="Key identifiers"></a>Key identifiers</h2><p>Extended keys can be identified by the Hash160(RIPED160 after SHA256) of the serialized ECDSA public key K, ignoring the chain code. This corresponds exactly to the data used in traditional Bitcoin addresses. It is not advised to represent this data in base58 format though, as it may be interpreted as an address that way.</p>
<p>The first 32 bits of the identifier are called <code>key finterprint</code>.</p>
<h2 id="Serialization-format"><a href="#Serialization-format" class="headerlink" title="Serialization format"></a>Serialization format</h2><p>Extended public and private keys are serialized as follows:</p>
<ul>
<li>4 bytes: version bytes (mainnet: 0x0488B21E public, 0x0488ADE4 private; testnet: 0x043587CF public, 0x04358394 private)</li>
<li>1 byte: depth: 0x00 for master nodes, 0x01 for level-1 derived keys.</li>
<li>4 bytes: the fingerprint of the parent’s key (0x00000000 if master key)</li>
<li>4 bytes: child number, 0x00000000 if master key</li>
<li>32 bytes: the chain code</li>
<li>33 bytes: the public key or private key data</li>
</ul>
<p>The 78 bytes structure can be encoded like other Bitcoin data in Base58, by first adding 32 checksum bits(derived from the double SHA256 checksum), and then conventing to the Base58 representation.</p>
<h1 id="Master-key-generation"><a href="#Master-key-generation" class="headerlink" title="Master key generation"></a>Master key generation</h1><p>The total number of possible extended keypairs is almost 2^512, but the produced keys are only 256 bits long, and offer about half of that in terms of security. Therefore the master keys are not generated directly, but instead from a potentially short seed value.</p>
<ul>
<li>Generate a seed byte sequence S of a chosen length(between 128 and 512 bits, 256 bits is advised) from a (P)RNG.</li>
<li>Calculate I = HMAC-SHA512(Key = “Bitcoin seed”, Data = S)</li>
<li>Split I into two 32-byte sequence, I_L and I_R</li>
<li>Use parse_256(I_L) as master secret key and I_R as master chain code.</li>
</ul>
<p>In case I_L is 0 or &gt;= n, the master key is invalid.</p>
<p><img src="https://github.com/bitcoin/bips/raw/master/bip-0032/derivation.png" alt=""></p>
<h1 id="Specification-Wallet-Structure"><a href="#Specification-Wallet-Structure" class="headerlink" title="Specification: Wallet Structure"></a>Specification: Wallet Structure</h1><h2 id="The-default-wallet-layout"><a href="#The-default-wallet-layout" class="headerlink" title="The default wallet layout"></a>The default wallet layout</h2><p>An HD Wallet is organized as several ‘accounts’. Accounts are numbered, the default account (“”) being numbered 0. Clients are not required to support more than one account, if not, they only use the default account.</p>
<p>Each account is composed of two keypair chains: an internal and an external one. The external keychain is used to generate new public addresses, while the internal one is used for all other operations(change addresses, generate addresses, anything that doesn’t need to be communicated).</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 909 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/11/20/React-Hooks/">React Hooks</a>
            
        </h1>
        <div class="content">
            <h1 id="Basic-Hooks"><a href="#Basic-Hooks" class="headerlink" title="Basic Hooks"></a>Basic Hooks</h1><h2 id="useState"><a href="#useState" class="headerlink" title="useState"></a><code>useState</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> [state, setState] = useState(initialState)</span><br></pre></td></tr></table></figure>
<p>Returns a stateful value and a function to update it.</p>
<p>During subsequent re-renders, the first value returned by <code>useState</code> will always be the most recent state after applying updates.</p>
<h3 id="Functional-updates"><a href="#Functional-updates" class="headerlink" title="Functional updates"></a>Functional updates</h3><p>If the new state is computed using the previous state, you can pass a function to <code>setState</code>. The function will receive the previous value and return an updated value.</p>
<blockquote>
<p>Note: Unlike the <code>setState</code> method found in class component, <code>useState</code> does not automatically merge upate objects.</p>
</blockquote>
<blockquote>
<p><code>useReducer</code> is more suited for managing state objects that contains multiple sub-values.</p>
</blockquote>
<h3 id="Lazy-initialization"><a href="#Lazy-initialization" class="headerlink" title="Lazy initialization"></a>Lazy initialization</h3><p>The <code>initialState</code> argument is the state used during the initial render. <strong>In subsequent renders, it is disregarded. If the initial state is the result of an expensive computation, you may provide a function instead, which will be executed only on the initial render.</strong></p>
<h2 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a><code>useEffect</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useEffect(didUpdate)</span><br></pre></td></tr></table></figure>
<p>Accept a function that contains imperative, possibly effectful code.</p>
<p>Mutations, subscriptions, timers, logging and other side effects are not allowed inside the main body of a function component. Instead, use <code>useEffect</code>. The functino passed to <code>useEffect</code> will run after the render is committed to the screen.</p>
<p>By default, effects run after every completed render, but you can choose to fire it only when certain values have changed.</p>
<h3 id="Cleaning-up-an-effect"><a href="#Cleaning-up-an-effect" class="headerlink" title="Cleaning up an effect"></a>Cleaning up an effect</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> subscription = props.source.subscribe()</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-comment">// Clean up the subscription</span></span><br><span class="line">    subscription.unsubscribe()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Timing-of-effects"><a href="#Timing-of-effects" class="headerlink" title="Timing of effects"></a>Timing of effects</h3><p>Unlike <code>componentDidMount</code> and <code>componentDidUpdate</code>, the function passed to <code>useEffect</code> fires after layout and paint, during a deferred event. This makes it suitable for the many common side effects, like setting up subscriptions and event handlers, because most types fo work shouldn’t block the browser from updating the screen.</p>
<p><code>useMutationEffect</code> and <code>useLayoutEffect</code> have the same signature as <code>useEffect</code> and only differ in when they are fired.</p>
<p>Although <code>useEffect</code> is deferred until after the browser has painted, it’s guaranteed to fire before any new renders.</p>
<h3 id="Conditionally-firing-an-effect"><a href="#Conditionally-firing-an-effect" class="headerlink" title="Conditionally firing an effect"></a>Conditionally firing an effect</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">useEffect(</span><br><span class="line">  () =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> subscription = props.source.subscribe()</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> subscription.unsubscribe()</span><br><span class="line">  &#125;,</span><br><span class="line">  [props.source],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a><code>useContext</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> context = useContext(Context)</span><br></pre></td></tr></table></figure>
<p>Accepts a context object(the value returned from <code>React.createContext</code>) and returns the current context value, as given by the nearest context provider for the given context.</p>
<p>When the provider updates, this hook will trigger a rerender with the latest context value.</p>
<h1 id="Additional-Hooks"><a href="#Additional-Hooks" class="headerlink" title="Additional Hooks"></a>Additional Hooks</h1><h2 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a><code>useReducer</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState)</span><br></pre></td></tr></table></figure>
<p>An alternative to <code>useState</code>. Accepts a reducer of type <code>(state, action) =&gt; newState</code>, and returns the current state paired with a <code>dispatch</code> method.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> initialState = &#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">state, action</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-string">'reset'</span>: &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> initialState</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-string">'increment'</span>: &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">count</span>: state.count + <span class="hljs-number">1</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-string">'decrement'</span>: &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">count</span>: state.count - <span class="hljs-number">1</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">default</span>:</span><br><span class="line">      <span class="hljs-keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params">&#123; initialCount &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, &#123; <span class="hljs-attr">count</span>: initialCount &#125;)</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      Count: &#123;state.count&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">'reset'</span> &#125;)&#125;&gt;Reset&lt;<span class="hljs-regexp">/button&gt;</span></span><br><span class="line"><span class="hljs-regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Lazy-initialization-1"><a href="#Lazy-initialization-1" class="headerlink" title="Lazy initialization"></a>Lazy initialization</h3><p><code>useReducer</code> accepts an optional third argument, <code>initialAction</code>. If provided, the initial action is applied during the initial render. This is useful for computing an initial state that includes values passed via props.</p>
<h2 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a><code>useCallback</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> memoizedCallback = useCallback(</span><br><span class="line">  () =&gt; &#123;</span><br><span class="line">    doSomething(a, b)</span><br><span class="line">  &#125;,</span><br><span class="line">  [a, b],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>Returns <code>memoized</code> callback.</p>
<p>Pass an inline callback and an array of inputs, <code>useCallback</code> will return a memoized version of the callback that only changes if one of the inputs has changed. This is useful when passing callbacks to optimized child components that rely on reference equality to prevent unnecessary render.</p>
<blockquote>
<p>Note: The array of inputs is not passed as arguments to the callback. Conceptually, though, that’s what represent: every value referenced inside the callback should also appear in the inputs array.</p>
</blockquote>
<h2 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a><code>useMemo</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> memoizedValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> computeExpensiveValue(a, b), [a, b])</span><br></pre></td></tr></table></figure>
<p>Returns a <code>memoized</code> value.</p>
<p>Pass a “create” function and an array of inputs, <code>useMemo</code> will only recompute the memoized value when one of the inputs has changed. This optimization helps to avoid expensive calculations on every render.</p>
<p>If no array is provided, a new value will be computed whenever a new function instance is passed as the first argument.(With an inline function, on every render)</p>
<h2 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a><code>useRef</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> refContainer = useRef(initialValue)</span><br></pre></td></tr></table></figure>
<p><code>useRef</code> returns a mutable ref object whose <code>.current</code> property is initialized to the passed argument(<code>initialValue</code>). The returned object will persist for the full lifetime of the component.</p>
<p>A common use case is to access a child imperatively:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TextInputFocusButton</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> inputEl = useRef(<span class="hljs-literal">null</span>)</span><br><span class="line">  <span class="hljs-keyword">const</span> onButtonClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">    inputEl.current.focus()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;input ref=&#123;inputEl&#125; type=<span class="hljs-string">"text"</span> /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onButtonClick&#125;&gt;Focus the input&lt;<span class="hljs-regexp">/button&gt;</span></span><br><span class="line"><span class="hljs-regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="useImperativeMethods"><a href="#useImperativeMethods" class="headerlink" title="useImperativeMethods"></a><code>useImperativeMethods</code></h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useImperativeMethods(ref, createInstance, [inputs])</span><br></pre></td></tr></table></figure>
<p><code>useImperativeMethods</code> customizes the instance value that is exposed to parent component when use <code>ref</code>. As always, imperative code using refs should be avoided in most cases. <code>useImperativeMethods</code> should be used with <code>forwardRef</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FancyInput</span>(<span class="hljs-params">props, ref</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> inputRef = useRef()</span><br><span class="line">  useImperativeMethods(ref, () =&gt; (&#123;</span><br><span class="line">    focus: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      inputRef.current.focus()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;))</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="hljs-xml">&#125;</span></span><br><span class="line"><span class="hljs-xml">FancyInput = forwardRef(FancyInput)</span></span><br></pre></td></tr></table></figure>
<p>In this example, a parent component that renders <code>&lt;FancyInput ref={fancyInputRef} /&gt;</code> would be able to call <code>fancyInputRef.current.focus()</code>.</p>
<h2 id="useMutationEffect"><a href="#useMutationEffect" class="headerlink" title="useMutationEffect"></a><code>useMutationEffect</code></h2><p>The signature is identical to <code>useEffect</code>, but it fires synchronously during the same phase that React performs its DOM mutations, before sibling components has been updated.</p>
<p>Prefer the standard <code>useEffect</code> when possible to avoid blocking visual updates.</p>
<blockquote>
<p>Note: Avoid reading from the DOM in <code>useMutationEffect</code>. If you do, you can cause performance problems by introducing <code>layout trash</code>.</p>
</blockquote>
<h2 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a><code>useLayoutEffect</code></h2><p>The signature is identical to <code>useEffect</code> but it fires synchronously <strong>after</strong> all DOM mutations.</p>
<p>Use this to read layout from the DOM and synchronously re-render. Updates scheduled inside <code>useLayoutEffect</code> will be flushed synchronously, before the browser has a chance to paint.</p>
<blockquote>
<p>Fires in the same phase as <code>componentDidMount</code> and <code>componentDidUpdate</code></p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 212 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/11/11/5-tips-in-CRA-2-0/">5 Tips in CRA@2.0</a>
            
        </h1>
        <div class="content">
            <p><a href="https://www.telerik.com/blogs/5-things-i-didnt-know-about-create-react-app" target="_blank" rel="noopener">Original</a></p>
<p>It’s fucking long time not learning React.</p>
<p>Five Tips</p>
<ol>
<li>Displaying Lint Error in the Editor</li>
</ol>
<p>Create <code>.eslintrc</code> with content of</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "extends: "react-app"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>Formatting Code Automatically</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev prettier husky lint-staged</span><br></pre></td></tr></table></figure>
<p>And add scripts in <code>package.json</code></p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"husky"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"hooks"</span>: &#123;</span><br><span class="line">      <span class="hljs-attr">"pre-commit"</span>: <span class="hljs-string">"lint-staged"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-attr">"lint-staged"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"src/**/*.&#123;js,jsx,json,css&#125;"</span>: [<span class="hljs-string">"prettier --write"</span>, <span class="hljs-string">"git add"</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>I prefer to use <code>prettier</code> with <code>eslint</code></p>
<ol>
<li>Developing Components in Isolation</li>
</ol>
<p>…</p>
<p>I use <code>bit</code></p>
<ol>
<li>Making a Progressive Web App</li>
</ol>
<p>In <code>src/index.js</code>, change <code>serviceWorker.unregister()</code> to <code>serviceWorker.register()</code></p>
<ol>
<li>Code Splitting</li>
</ol>
<p>Create React App v2 supports code splitting via dynamic <code>import()</code> statements. That is, if it encouters a call to <code>import(&#39;./someModule&#39;)</code> when building your app, it will create a new chunk for someModule and all its dependencies, totally seperate from your entry bundle.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React, &#123; Component &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"><span class="hljs-keyword">import</span> &#123; Formik &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'formik'</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Yup <span class="hljs-keyword">from</span> <span class="hljs-string">'yup'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> formValidator = Yup.object().shape(<span class="hljs-comment">/* ... */</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Form</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> &lt;Formik validationSchema=&#123;formValidator&#125;&gt;&#123;/* ... */&#125;&lt;/Formik&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React, &#123; Component &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    Form: <span class="hljs-literal">undefined</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  showForm = <span class="hljs-keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">default</span>: Form &#125; = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./Form'</span>)</span><br><span class="line">    <span class="hljs-keyword">this</span>.setState(&#123; Form &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> &#123; Form &#125; = <span class="hljs-keyword">this</span>.state</span><br><span class="line">    <span class="hljs-keyword">return</span> &lt;div className="app"&gt;&#123;Form ? &lt;Form /&gt; : &lt;button onClick=&#123;this.showForm&#125;&gt;Show Form&lt;/button&gt;&#125;&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 2 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/11/08/Assembly-in-Solidity/">Assembly in Solidity</a>
            
        </h1>
        <div class="content">
            <h1 id="Inline-Assembly"><a href="#Inline-Assembly" class="headerlink" title="Inline Assembly"></a>Inline Assembly</h1><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-09-10T05:26:39.000Z">2018-09-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 154 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/09/10/Analysis-of-Ujo/">Analysis of Ujo</a>
            
        </h1>
        <div class="content">
            <h1 id="What-is-Ujo"><a href="#What-is-Ujo" class="headerlink" title="What is Ujo"></a>What is Ujo</h1><p>The Ujo platform uses blockchain technology to create a transparent and decentralized database of rights and rights owners, automating royalty payments using smart contracts and cryptocurrency.</p>
<p>Ujo Music is a ConsenSys spoke, with a vision for a music industry that allows creators to grow and thrive independently. It is a platform that uses the ethereum blockchain as the substrate for innovation by empowering artists, digitizing their music rights and metadata, sharing this information in an open environment, thus enabling new applications, products and services to license their catelogs and pay artists directly with minimal friction.</p>
<h1 id="History"><a href="#History" class="headerlink" title="History"></a>History</h1><p>2015.10, <strong>IMOGEN HEAP</strong>: In 2015 Imogen Heap collaborated with Ujo to demonstrate how Ethereum could usher in a modern music supply chain built on a backbone of prompt and transparent payments</p>
<h1 id="Why-use-Ujo"><a href="#Why-use-Ujo" class="headerlink" title="Why use Ujo"></a>Why use Ujo</h1><h1 id="How-does-Ujo-work"><a href="#How-does-Ujo-work" class="headerlink" title="How does Ujo work"></a>How does Ujo work</h1><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li>[1] (Ujo FAQ)[<a href="https://ujomusic.com/faq]" target="_blank" rel="noopener">https://ujomusic.com/faq]</a></li>
<li>[2] (Imogen Heap)[<a href="https://imogen2.surge.sh/#/imogen_heap/tiny_human/tiny_human]" target="_blank" rel="noopener">https://imogen2.surge.sh/#/imogen_heap/tiny_human/tiny_human]</a></li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-08-27T06:38:32.000Z">2018-08-27</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 75 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/08/27/development-of-neuron-web-extension/">Development of Neuron Web Extension</a>
            
        </h1>
        <div class="content">
            <h1 id="Create-Project"><a href="#Create-Project" class="headerlink" title="Create Project"></a>Create Project</h1><figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create-react-app neuron-web scripts-version=react-scripts-ts</span><br></pre></td></tr></table></figure>
<h1 id="Add-Manifest"><a href="#Add-Manifest" class="headerlink" title="Add Manifest"></a>Add Manifest</h1><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// ./public/manifest.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;short_name&quot;: &quot;NeuronWeb&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;Neuron Web&quot;,</span><br><span class="line">  &quot;start_url&quot;: &quot;./index.html&quot;,</span><br><span class="line">  &quot;display&quot;: &quot;standalone&quot;,</span><br><span class="line">  &quot;theme_color&quot;: &quot;#000&quot;,</span><br><span class="line">  &quot;background_color&quot;: &quot;#fff&quot;,</span><br><span class="line">  &quot;browser_action&quot;: &#123;</span><br><span class="line">    &quot;default_popup&quot;: &quot;./index.html&quot;,</span><br><span class="line">    &quot;default_title&quot;: &quot;NervosWeb&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;manifest_version&quot;: 2,</span><br><span class="line">  &quot;version&quot;: &quot;1.0&quot;,</span><br><span class="line">  &quot;permissions&quot;: [</span><br><span class="line">    &quot;tabs&quot;,</span><br><span class="line">    &quot;activeTab&quot;,</span><br><span class="line">    &quot;clipboardWrite&quot;,</span><br><span class="line">    &quot;http://**/*&quot;,</span><br><span class="line">    &quot;https://**/*&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;content_security_policy&quot;: &quot;script-src &apos;self&apos; &apos;unsafe-eval&apos;; object-src &apos;self&apos;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Add-Style-Dependencies"><a href="#Add-Style-Dependencies" class="headerlink" title="Add Style Dependencies"></a>Add Style Dependencies</h1><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Roboto:300,400,500"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @mateiral-ui/&#123;core,icons&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-07-21T12:54:58.000Z">2018-07-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 minutes read (About 1475 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/07/21/Details-in-Web3-Contract/">Details in Web3 -- Contract</a>
            
        </h1>
        <div class="content">
            <h1 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// To initialize a contract</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> Contract = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-eth-contract'</span>)</span><br><span class="line">Contract.setProvider(<span class="hljs-string">'ws://localhost:8546'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> contract = <span class="hljs-keyword">new</span> Contract(abi, address, options)</span><br></pre></td></tr></table></figure>
<h1 id="Import"><a href="#Import" class="headerlink" title="Import"></a>Import</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> core = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-core'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> Method = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-core-method'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-utils'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> Subscription = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-core-subscription'</span>).subscription</span><br><span class="line"><span class="hljs-keyword">var</span> formatters = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-core-helpers'</span>).formatters</span><br><span class="line"><span class="hljs-keyword">var</span> errors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-core-helpers'</span>).errors</span><br><span class="line"><span class="hljs-keyword">var</span> promiEvent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-core-promievent'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> abi = <span class="hljs-built_in">require</span>(<span class="hljs-string">'web3-eth-abi'</span>)</span><br></pre></td></tr></table></figure>
<h1 id="Contract-Constructor"><a href="#Contract-Constructor" class="headerlink" title="Contract Constructor"></a>Contract Constructor</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment"> * Should be called to create new contract instance</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * @method Contract</span></span><br><span class="line"><span class="hljs-comment"> * @constructor</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Array&#125; jsonInterface</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;String&#125; address</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Object&#125; options</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> Contract = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Contract</span>(<span class="hljs-params">jsonInterface, address, options</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">var</span> _this = <span class="hljs-keyword">this</span></span><br><span class="line">  <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// check if the instance is initialized correctly</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Contract)) &#123;</span><br><span class="line">    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(</span><br><span class="line">      <span class="hljs-string">'Please use the "new" keyword to instantiate a web3.eth.contract() object!'</span>,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// sets _requestManager</span></span><br><span class="line">  core.packageInit(<span class="hljs-keyword">this</span>, [<span class="hljs-keyword">this</span>.constructor.currentProvider])</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// set clearSubscriptions</span></span><br><span class="line">  <span class="hljs-keyword">this</span>.clearSubscriptions = <span class="hljs-keyword">this</span>._requestManager.clearSubscriptions</span><br><span class="line">  <span class="hljs-comment">// check params jsonInterface</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (!jsonInterface || !<span class="hljs-built_in">Array</span>.isArray(jsonInterface)) &#123;</span><br><span class="line">    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(</span><br><span class="line">      <span class="hljs-string">'You must provide the json interface of the contract when instantiating a contract object'</span>,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// clear the options object</span></span><br><span class="line">  <span class="hljs-keyword">this</span>.options = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">var</span> lastArg = args[args.length - <span class="hljs-number">1</span>]</span><br><span class="line">  <span class="hljs-comment">// set options</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (_.isObject(lastArg) &amp;&amp; !_.isArray(lastArray)) &#123;</span><br><span class="line">    options = lastArgs</span><br><span class="line">    <span class="hljs-keyword">this</span>.options = _.extend(<span class="hljs-keyword">this</span>.options, <span class="hljs-keyword">this</span>._getOrSetDefaultOptions(options))</span><br><span class="line">    <span class="hljs-comment">// clear address if the fact is options, in this case the address is not passed in.</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (_.isObject(address)) &#123;</span><br><span class="line">      address = <span class="hljs-literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// set address</span></span><br><span class="line">  <span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-keyword">this</span>.options, <span class="hljs-string">'address'</span>, &#123;</span><br><span class="line">    set: <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (value) &#123;</span><br><span class="line">        _this._address = utils.toChecksumAddress(</span><br><span class="line">          formatters.inputAddressFormatter(<span class="hljs-string">'value'</span>),</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    get: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> _this._address</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: <span class="hljs-literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// add method and event signature when the jsonInterface gets set</span></span><br><span class="line">  <span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-keyword">this</span>.options, <span class="hljs-string">'jsonInterface'</span>, &#123;</span><br><span class="line">    set: <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;</span><br><span class="line">      _this.methods = &#123;&#125;</span><br><span class="line">      _this.events = &#123;&#125;</span><br><span class="line"></span><br><span class="line">      _this._jsonInterface = value.map(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">var</span> func, funcName</span><br><span class="line">        <span class="hljs-keyword">if</span> (method.name) &#123;</span><br><span class="line">          funcName = utils._jsonInterfaceMethodToString(method)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (method.type === <span class="hljs-string">'function'</span>) &#123;</span><br><span class="line">          method.signature = abi.encodeFunctionSignature(funcName)</span><br><span class="line">          func = _this._createTxObject.bind(&#123;</span><br><span class="line">            method: method,</span><br><span class="line">            parent: _this,</span><br><span class="line">          &#125;)</span><br><span class="line"></span><br><span class="line">          <span class="hljs-comment">// add method only if not one already exists</span></span><br><span class="line">          <span class="hljs-keyword">if</span> (!_this.methods[method.name]) &#123;</span><br><span class="line">            _this.methods[method.name] = func</span><br><span class="line">          &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">var</span> cascadeFunc = _this._createTxObject.bind(&#123;</span><br><span class="line">              method: method,</span><br><span class="line">              parent: _this,</span><br><span class="line">              nextMethod: _this.methods[method.name],</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="hljs-keyword">this</span>.methods[method.name] = cascadeFunc</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="hljs-comment">// definitely add the method based on its signature</span></span><br><span class="line">          _this.methods[method.signature] = func</span><br><span class="line">          <span class="hljs-comment">//add method by name</span></span><br><span class="line">          _this.methods[method.name] = func</span><br><span class="line">          <span class="hljs-comment">// event</span></span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.type === <span class="hljs-string">'event'</span>) &#123;</span><br><span class="line">          method.signature = abi.encodeEventSignature(funcName)</span><br><span class="line">          <span class="hljs-keyword">var</span> event = _this._on.bind(_this, method.signature)</span><br><span class="line"></span><br><span class="line">          <span class="hljs-comment">// add method only if not already exists</span></span><br><span class="line">          <span class="hljs-keyword">if</span> (</span><br><span class="line">            !_this.events[method.name] ||</span><br><span class="line">            _this.events[method.name].name === <span class="hljs-string">'bound'</span></span><br><span class="line">          ) &#123;</span><br><span class="line">            _this.events[method.name] = event</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="hljs-comment">// definitely add the method based on its signature</span></span><br><span class="line">          _this.events[method.signature] = event</span><br><span class="line"></span><br><span class="line">          <span class="hljs-comment">// add event by name</span></span><br><span class="line">          _this.events[funcName] = event</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> method</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="hljs-comment">// add allEvents</span></span><br><span class="line">      _this.events.allEvents = _this._on.bind(_this, <span class="hljs-string">'allevents'</span>)</span><br><span class="line"></span><br><span class="line">      <span class="hljs-keyword">return</span> _this._jsonInterface</span><br><span class="line">    &#125;,</span><br><span class="line">    get: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> _this._jsonInterface</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: <span class="hljs-literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// get default account from the Class</span></span><br><span class="line">  <span class="hljs-keyword">var</span> defaultAccount = <span class="hljs-keyword">this</span>.constructor.defaultAccount</span><br><span class="line">  <span class="hljs-keyword">var</span> defaultBlock = <span class="hljs-keyword">this</span>.constructor.defaultBlock || <span class="hljs-string">'latest'</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-keyword">this</span>, <span class="hljs-string">'defaultAccount'</span>, &#123;</span><br><span class="line">    get: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> defaultAddress</span><br><span class="line">    &#125;,</span><br><span class="line">    set: <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (value) &#123;</span><br><span class="line">        defaultAccount = utils.toChecksumAddress(</span><br><span class="line">          formatters.inputAddressFormatter(value),</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="hljs-keyword">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: <span class="hljs-literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-keyword">this</span>, <span class="hljs-string">'defaultBlock'</span>, &#123;</span><br><span class="line">    get: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> defaultBlock</span><br><span class="line">    &#125;,</span><br><span class="line">    set: <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;</span><br><span class="line">      defaultBlock = value</span><br><span class="line">      <span class="hljs-keyword">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: <span class="hljs-literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// properties</span></span><br><span class="line">  <span class="hljs-keyword">this</span>.methods = &#123;&#125;</span><br><span class="line">  <span class="hljs-keyword">this</span>.events = &#123;&#125;</span><br><span class="line">  <span class="hljs-keyword">this</span>._address = <span class="hljs-literal">null</span></span><br><span class="line">  <span class="hljs-keyword">this</span>._jsonInterface = []</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// set getter/setter properties</span></span><br><span class="line">  <span class="hljs-keyword">this</span>.options.address = address</span><br><span class="line">  <span class="hljs-keyword">this</span>.options.jsonInterface = jsonInterface</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Contract.setProvider = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">provider, accounts</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// Contract.currentProvider = provider</span></span><br><span class="line">  core.packageInit(<span class="hljs-keyword">this</span>, [provider])</span><br><span class="line">  <span class="hljs-keyword">this</span>._ethAccounts = accounts</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Get the callback and modify the array if necessary</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * @method _getCallback</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Array&#125; args</span></span><br><span class="line"><span class="hljs-comment"> * @return &#123;Function&#125; the callback</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">Contract.prototype._getCallback = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCallback</span>(<span class="hljs-params">args</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (args &amp;&amp; _.isFunction(args[args.length - <span class="hljs-number">1</span>])) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> args.pop() <span class="hljs-comment">// modify the args array!</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Checks that no listener with name 'newListener' or 'removeListener' is added</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * @method _checkLister</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;String&#125; type</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;String&#125; event</span></span><br><span class="line"><span class="hljs-comment"> * @return &#123;Object&#125; the contract instance</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">Contract.prototype._checkListerner = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, event</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (event === type) &#123;</span><br><span class="line">    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(</span><br><span class="line">      <span class="hljs-string">`The event <span class="hljs-subst">$&#123;type&#125;</span> is a reserved event name, you can't use it`</span>,</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Use default values, if options are not avaible</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * @method _getOrSetDefaultOptions</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Object&#125; options the options given by the user</span></span><br><span class="line"><span class="hljs-comment"> * @return &#123;Object&#125; the options with gaps filled by defaults</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">Contract.prototype._getOrSetDefaultOptions = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getOrSetDefaultOptions</span>(<span class="hljs-params"></span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">  options,</span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">var</span> gasPrice = options.gasPrice ? <span class="hljs-built_in">String</span>(options.gasPrice)&#125; : <span class="hljs-literal">null</span></span><br><span class="line">  <span class="hljs-keyword">var</span> <span class="hljs-keyword">from</span> = options.from ? utils.toChecksumAddress(formatters.inputAddressFormatter(options.from)): <span class="hljs-literal">null</span></span><br><span class="line"></span><br><span class="line">  options.data = option.data || <span class="hljs-keyword">this</span>.options.data</span><br><span class="line"></span><br><span class="line">  option.from = <span class="hljs-keyword">from</span> || <span class="hljs-keyword">this</span>.options.from</span><br><span class="line">  option.gasPrice = gasPrice || <span class="hljs-keyword">this</span>.options.gasPrice</span><br><span class="line">  options.gas = options.gas || options.gasLimit || <span class="hljs-keyword">this</span>.options.gas</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">delete</span> options.gasLimit</span><br><span class="line">  <span class="hljs-keyword">return</span> options</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span></span></span><br><span class="line"><span class="hljs-comment">// _encodeEventABI</span></span><br><span class="line"><span class="hljs-comment">// _decodeEventABI</span></span><br><span class="line"><span class="hljs-comment">// _encodeMethodABI</span></span><br><span class="line"><span class="hljs-comment">// _decodeMethodABI</span></span><br><span class="line"><span class="hljs-comment">// _decodeMethodReturn</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Deploys a contract and fire events based on its state: transactionHash, receipt</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * All event listeners will be removed, once the last possible event is fired ('error' or 'receipt')</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * @method deploy</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Object&#125; options</span></span><br><span class="line"><span class="hljs-comment"> * @param &#123;Function&#125; callback</span></span><br><span class="line"><span class="hljs-comment"> * @return &#123;Object&#125; EventEmitter possible are "error", "transactionHash", and "receipt"</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">Contract.prototype.deploy = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options, callback</span>) </span>&#123;</span><br><span class="line">  options = options || &#123;&#125;</span><br><span class="line">  options.arguments = options.arguments || []</span><br><span class="line">  options = <span class="hljs-keyword">this</span>._getOrSetDefaultOptions(options)</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// return error if no 'data' is specified</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (!options.data) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> utils._fireError(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'No "data" specifed in neither the given options, nor the default options'</span>), <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, callback)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">var</span> <span class="hljs-keyword">constructor</span> = _.find(this.options.jsonInterface, function(method) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> (method.type === <span class="hljs-string">'contructor'</span>)</span><br><span class="line">  &#125;) || &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">constructor</span>.signature = '<span class="hljs-keyword">constructor</span>'</span><br><span class="line"></span><br><span class="line">  return this._createTxObject.apply(&#123;</span><br><span class="line">    method: <span class="hljs-keyword">constructor</span>,</span><br><span class="line">    parent: this,</span><br><span class="line">    deployData: options.data,</span><br><span class="line">    _ethAccounts: this.<span class="hljs-keyword">constructor</span>._ethAccounts</span><br><span class="line">  &#125;, options.arguments)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// TODO:</span><br><span class="line">// _generateEventOptions</span><br><span class="line">// clone</span><br><span class="line">// once</span><br><span class="line">// _on</span><br><span class="line">// getPastEvents</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * returns the an object with call, send, estimate functions</span><br><span class="line"> *</span><br><span class="line"> * @method _createTxObject</span><br><span class="line"> * @return &#123;<span class="hljs-built_in">Object</span>&#125; an object <span class="hljs-keyword">with</span> functions to call the method</span><br><span class="line"> *<span class="hljs-regexp">/</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">Contract.prototype._createTxObject = function _createTxObject()&#123;</span></span><br><span class="line"><span class="hljs-regexp">  var args = Array.prototype.slice.call(arguments)</span></span><br><span class="line"><span class="hljs-regexp">  var txObject = &#123;&#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  if (this.method.type === 'function') &#123;</span></span><br><span class="line"><span class="hljs-regexp">    txObject.call = this.parent._executeMethod.bind(txObject, 'call')</span></span><br><span class="line"><span class="hljs-regexp">    txObject.call.request = this.parent._executeMethod.bind(txObject, 'call', true) /</span><span class="hljs-regexp">/ to make batch request</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  txObject.send = this.parent._executeMethod.bind(txObject, 'send')</span></span><br><span class="line"><span class="hljs-regexp">  txObject.send.request = this.parent._executeMethod.bind(txObject)</span></span><br><span class="line"><span class="hljs-regexp">  txObject.encodeABI = this.parent._encodeMethodABI.bind(txObject)</span></span><br><span class="line"><span class="hljs-regexp">  txObject.estimateGas = this.parent._executeMethod.bind(txObject, 'estimate')</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  /</span><span class="hljs-regexp">/ check arguments length</span></span><br><span class="line"><span class="hljs-regexp">  if (args &amp;&amp; this.method.inputs &amp;&amp; args.length !== this.method.inputs.length) &#123;</span></span><br><span class="line"><span class="hljs-regexp">    if (this.nextMethod) &#123;</span></span><br><span class="line"><span class="hljs-regexp">      return this.nextMethod.apply(null, args)</span></span><br><span class="line"><span class="hljs-regexp">    &#125;</span></span><br><span class="line"><span class="hljs-regexp">    throw errors.InvalidNumberOfParams(args.length, this.method.inputs.length, this.method.name)</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  txObject.arguments = args || []</span></span><br><span class="line"><span class="hljs-regexp">  txObject._method = this.method</span></span><br><span class="line"><span class="hljs-regexp">  txObject._parent = this.parent</span></span><br><span class="line"><span class="hljs-regexp">  txObject._ethAccounts = this.parent.constructor._ethAccounts || this._ethAccounts</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  if(this.deployData) &#123;</span></span><br><span class="line"><span class="hljs-regexp">    txObject._deployData = this.deployData</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  return txObject</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">/</span><span class="hljs-regexp">/ _processExecuteArguments</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">/</span>**</span><br><span class="line"> * Execute a call, transact or estimateGas on a contract <span class="hljs-function"><span class="hljs-keyword">function</span></span></span><br><span class="line"><span class="hljs-function"> *</span></span><br><span class="line"><span class="hljs-function"> * @<span class="hljs-title">method</span> <span class="hljs-title">_executeMethod</span></span></span><br><span class="line"><span class="hljs-function"> * @<span class="hljs-title">param</span> </span>&#123;<span class="hljs-built_in">String</span>&#125; type the type <span class="hljs-keyword">this</span> execute <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">should</span> <span class="hljs-title">execute</span></span></span><br><span class="line"><span class="hljs-function"> * @<span class="hljs-title">param</span> </span>&#123;<span class="hljs-built_in">Boolean</span>&#125; makeRequest <span class="hljs-keyword">if</span> <span class="hljs-literal">true</span>, it simply returns the request parameters, rather than execute it.</span><br><span class="line"> *<span class="hljs-regexp">/</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">Contract.prototype._executeMethod = function _executeMethod () &#123;</span></span><br><span class="line"><span class="hljs-regexp">  var _this = this</span></span><br><span class="line"><span class="hljs-regexp">  var args = this._parent._processExecuteArguments.call(this, Array.prototype.slice.call(arguments))</span></span><br><span class="line"><span class="hljs-regexp">  var defer = promiEvent((args.type !== 'send))</span></span><br><span class="line"><span class="hljs-regexp">  var ethAccounts = _this.constructor._ethAccounts || _this._ethAccounts</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  /</span><span class="hljs-regexp">/ simply return request for batch requests</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">  if (args.generateRequest) &#123;</span></span><br><span class="line"><span class="hljs-regexp">    /</span><span class="hljs-regexp">/ handle batch request</span></span><br><span class="line"><span class="hljs-regexp">    var payload = &#123;</span></span><br><span class="line"><span class="hljs-regexp">      params: [formatters.inputCallFormatter.call(this._parent, args.options)],</span></span><br><span class="line"><span class="hljs-regexp">      callback: args.callback,</span></span><br><span class="line"><span class="hljs-regexp">    &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">    if (args.type === 'call') &#123;</span></span><br><span class="line"><span class="hljs-regexp">      payload.params.push(formatters.inputDefaultBlockNumber.call(this._parent, args.defaultBlockNumber))</span></span><br><span class="line"><span class="hljs-regexp">      payload.method = 'eth_call'</span></span><br><span class="line"><span class="hljs-regexp">      payload.format = this._parent.decodeMethodReturn.bind(null, this._method.outputs)</span></span><br><span class="line"><span class="hljs-regexp">    &#125; else &#123;</span></span><br><span class="line"><span class="hljs-regexp">      payload.method = 'eth_sendTransaction'</span></span><br><span class="line"><span class="hljs-regexp">    &#125;</span></span><br><span class="line"><span class="hljs-regexp">    return payload</span></span><br><span class="line"><span class="hljs-regexp">  &#125; else &#123;</span></span><br><span class="line"><span class="hljs-regexp">    /</span><span class="hljs-regexp">/ handle call or send</span></span><br><span class="line"><span class="hljs-regexp">    switch (args.type) &#123;</span></span><br><span class="line"><span class="hljs-regexp">      case 'estimate': &#123;</span></span><br><span class="line"><span class="hljs-regexp">        var estimateGas = (new Method(&#123;</span></span><br><span class="line"><span class="hljs-regexp">          name: 'estimateGas',</span></span><br><span class="line"><span class="hljs-regexp">          call: 'eth_estimateGas',</span></span><br><span class="line"><span class="hljs-regexp">          params: 1,</span></span><br><span class="line"><span class="hljs-regexp">          inputFormatter: [formatter.inputCallFormatter],</span></span><br><span class="line"><span class="hljs-regexp">          outputFormatter: utils.hexToNumber,</span></span><br><span class="line"><span class="hljs-regexp">          requestManager: _this._parent._requestManager,</span></span><br><span class="line"><span class="hljs-regexp">          accounts: ethAccounts, /</span><span class="hljs-regexp">/ specify accounts</span></span><br><span class="line"><span class="hljs-regexp">          defaultAccount: _this._parent.defaultAccount,</span></span><br><span class="line"><span class="hljs-regexp">          defaultBlock: _this._parent.defaultBlock,</span></span><br><span class="line"><span class="hljs-regexp">        &#125;)).createFunction();</span></span><br><span class="line"><span class="hljs-regexp">        return estimateGas(args.options, args.callback)</span></span><br><span class="line"><span class="hljs-regexp">      &#125;</span></span><br><span class="line"><span class="hljs-regexp">      case 'call': &#123;</span></span><br><span class="line"><span class="hljs-regexp">        var call = (new Method(&#123;</span></span><br><span class="line"><span class="hljs-regexp">           name: 'call',</span></span><br><span class="line"><span class="hljs-regexp">           call: 'eth_call',</span></span><br><span class="line"><span class="hljs-regexp">           params: 2,</span></span><br><span class="line"><span class="hljs-regexp">           inputFormatter: [formatters.inputCallFormatter, formatters.inputDefaultBlockNumberFormatter],</span></span><br><span class="line"><span class="hljs-regexp">           outputFormatter: result =&gt; &#123;</span></span><br><span class="line"><span class="hljs-regexp">             return _this._parent.decodeMethodReturn(_this._method.outputs, result)</span></span><br><span class="line"><span class="hljs-regexp">           &#125;,</span></span><br><span class="line"><span class="hljs-regexp">           requestManager: _this._parent._requestManager,</span></span><br><span class="line"><span class="hljs-regexp">           accounts: ethAccounts, /</span><span class="hljs-regexp">/ is eth.accounts (necessary for wallet signing)</span></span><br><span class="line"><span class="hljs-regexp">           defaultAccount: _this._parent.defaultAccount,</span></span><br><span class="line"><span class="hljs-regexp">           defaultBlock: _this._parent.defaultBlock,</span></span><br><span class="line"><span class="hljs-regexp">        &#125;)).createFunction()</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">        return call(args.options, args.defaultBlock, args.callback)</span></span><br><span class="line"><span class="hljs-regexp">      &#125;</span></span><br><span class="line"><span class="hljs-regexp">      case 'send': &#123;</span></span><br><span class="line"><span class="hljs-regexp">        if(!utils.isAddress(args.options.from)) &#123;</span></span><br><span class="line"><span class="hljs-regexp">            return utils._fireError(new Error('No "from" address specified in neither the given options, nor the default options.'), defer.eventEmitter, defer.reject, args.callback);</span></span><br><span class="line"><span class="hljs-regexp">        &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">        if (_.isBoolean(this._method.payable) &amp;&amp; !this._method.payable &amp;&amp; args.options.value &amp;&amp; args.options.value &gt; 0) &#123;</span></span><br><span class="line"><span class="hljs-regexp">            return utils._fireError(new Error('Can not send value to non-payable contract method or constructor'), defer.eventEmitter, defer.reject, args.callback);</span></span><br><span class="line"><span class="hljs-regexp">        &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">        /</span><span class="hljs-regexp">/ make sure receipt logs are decoded</span></span><br><span class="line"><span class="hljs-regexp">        var extraFormatters = &#123;</span></span><br><span class="line"><span class="hljs-regexp">          receiptFormatter: receipt =&gt; &#123;</span></span><br><span class="line"><span class="hljs-regexp">            if (_.isArray(receipt.logs)) &#123;</span></span><br><span class="line"><span class="hljs-regexp">              /</span><span class="hljs-regexp">/ decode logs</span></span><br><span class="line"><span class="hljs-regexp">              var events = _.map(receipt.logs, log =&gt; &#123;</span></span><br><span class="line"><span class="hljs-regexp">                return _this._parent._decodeEventABI.call(&#123;</span></span><br><span class="line"><span class="hljs-regexp">                  name: 'ALLEVENT',</span></span><br><span class="line"><span class="hljs-regexp">                  jsonInterface: _this._parent.options.jsonInterface,</span></span><br><span class="line"><span class="hljs-regexp">                &#125;, log)</span></span><br><span class="line"><span class="hljs-regexp">              &#125;)</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">              /</span><span class="hljs-regexp">/ make sure log names keys</span></span><br><span class="line"><span class="hljs-regexp">              receipt.events = &#123;&#125;</span></span><br><span class="line"><span class="hljs-regexp">              var count = 0</span></span><br><span class="line"><span class="hljs-regexp">              events.forEach(ev =&gt; &#123;</span></span><br><span class="line"><span class="hljs-regexp">                if (ev.event) &#123;</span></span><br><span class="line"><span class="hljs-regexp">                  /</span><span class="hljs-regexp">/ if &gt; 1 of the same event, don't overwrite any existing events</span></span><br><span class="line"><span class="hljs-regexp">                  if (receipt.events[ev.event]) &#123;</span></span><br><span class="line"><span class="hljs-regexp">                    if (Array.isArray(receipt.events[ev.event])) &#123;</span></span><br><span class="line"><span class="hljs-regexp">                      receipt.events[ev.event].push(ev)</span></span><br><span class="line"><span class="hljs-regexp">                    &#125; else &#123;</span></span><br><span class="line"><span class="hljs-regexp">                      receipt.events[ev.event] = [receipt.events[ev.event], ev]</span></span><br><span class="line"><span class="hljs-regexp">                    &#125;</span></span><br><span class="line"><span class="hljs-regexp">                  &#125; else &#123;</span></span><br><span class="line"><span class="hljs-regexp">                    receipt.event[ev.event] = ev</span></span><br><span class="line"><span class="hljs-regexp">                  &#125;</span></span><br><span class="line"><span class="hljs-regexp">                &#125; else &#123;</span></span><br><span class="line"><span class="hljs-regexp">                  receipt.events[count] = ev</span></span><br><span class="line"><span class="hljs-regexp">                  count++</span></span><br><span class="line"><span class="hljs-regexp">                &#125;</span></span><br><span class="line"><span class="hljs-regexp">              &#125;)</span></span><br><span class="line"><span class="hljs-regexp">              delete receipt.logs</span></span><br><span class="line"><span class="hljs-regexp">            &#125;</span></span><br><span class="line"><span class="hljs-regexp">            return receipt</span></span><br><span class="line"><span class="hljs-regexp">          &#125;,</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">          contractDeployFormatter: receipt =&gt; &#123;</span></span><br><span class="line"><span class="hljs-regexp">            var newContract = _this._parent.clone()</span></span><br><span class="line"><span class="hljs-regexp">            newContract.options.address = receipt.contractAddress</span></span><br><span class="line"><span class="hljs-regexp">            return newContract</span></span><br><span class="line"><span class="hljs-regexp">          &#125;</span></span><br><span class="line"><span class="hljs-regexp">        &#125;</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">        var sendTransaction = (new Method(&#123;</span></span><br><span class="line"><span class="hljs-regexp">          name: 'sendTransaction',</span></span><br><span class="line"><span class="hljs-regexp">          call: 'eth_sendTransaction',</span></span><br><span class="line"><span class="hljs-regexp">          params: 1,</span></span><br><span class="line"><span class="hljs-regexp">          inputFormatter: [formatters.inputTransactionFormatter],</span></span><br><span class="line"><span class="hljs-regexp">          requestManager: _this._parent.requestManager,</span></span><br><span class="line"><span class="hljs-regexp">          accounts: _this.constructor._ethAccount || _this._ethAccounts, /</span><span class="hljs-regexp">/ is eth.accounts,</span></span><br><span class="line"><span class="hljs-regexp">          defaultAccount: _this._parent.defaultAccount,</span></span><br><span class="line"><span class="hljs-regexp">          defaultBlock: _this._parent.defaultBlock,</span></span><br><span class="line"><span class="hljs-regexp">          extraFormatter: extraFormatters,</span></span><br><span class="line"><span class="hljs-regexp">        &#125;)).createFunction()</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">        return sendTransaction(args.options, args.callback)</span></span><br><span class="line"><span class="hljs-regexp">      &#125;</span></span><br><span class="line"><span class="hljs-regexp">    &#125;</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-07-11T06:02:47.000Z">2018-07-11</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 0 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/07/11/Declaration-in-TypeScript/">Declaration in TypeScript</a>
            
        </h1>
        <div class="content">
            
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-07-10T03:53:59.000Z">2018-07-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 60 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/07/10/RxjsV6/">RxjsV6</a>
            
        </h1>
        <div class="content">
            <h3 id="animationFrame-scheduler"><a href="#animationFrame-scheduler" class="headerlink" title="animationFrame - scheduler"></a>animationFrame - scheduler</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> animationFrame: any;</span><br></pre></td></tr></table></figure>
<p>Perform task when <code>window.requestAnimationFrame</code> would fire.</p>
<p>When <code>animationFrame</code> scheduler is used with delay, it will fall back to <code>async</code> scheduler behaviour.</p>
<p>Without delay, <code>animationFrame</code> scheduler can be used to create smooth browser animations. It makes sure scheduled task will happen just before next browser content repaint, thus performing animations as efficiently as possible.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-05-17T12:37:13.000Z">2018-05-17</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 216 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/17/content-parser-in-cita/">Content Parser in CITA</a>
            
        </h1>
        <div class="content">
            <p>The parse now we used is</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> parser = <span class="hljs-function">(<span class="hljs-params">content: string</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> bytes = hexToBytes(content)</span><br><span class="line">  <span class="hljs-keyword">const</span> decoded = pb.UnverifiedTransaction.deserializeBinary(bytes)</span><br><span class="line">  <span class="hljs-keyword">const</span> tx = decoded.getTransaction()</span><br><span class="line">  <span class="hljs-keyword">return</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">from</span>: tx.getFrom ? tx.getFrom() : <span class="hljs-string">''</span>,</span><br><span class="line">    to: tx.getTo ? tx.getTo() : <span class="hljs-string">''</span>,</span><br><span class="line">    data: tx.getData ? tx.getData() : <span class="hljs-string">''</span>,</span><br><span class="line">    value: tx.getValue ? tx.getValue().toString() : <span class="hljs-string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here we use these methods:</p>
<ul>
<li><p>hexToBytes(content) =&gt; bytes</p>
</li>
<li><p>pb.UnverifiesTransaction.deserializeBinary(bytes) =&gt; decoded</p>
</li>
<li><p>decoded.getTransaction() =&gt; transaction</p>
</li>
<li><p>transaction.{getFrom, getTo, getValue, getData}</p>
</li>
</ul>
<h5 id="hexToBytes"><a href="#hexToBytes" class="headerlink" title="hexToBytes"></a>hexToBytes</h5><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> hexToBytes = <span class="hljs-function">(<span class="hljs-params">hex: string</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> _hex = hex.startsWith(<span class="hljs-string">'0x'</span>) ? hex.slice(<span class="hljs-number">2</span>) : hex <span class="hljs-comment">// remove 0x prefix</span></span><br><span class="line">  <span class="hljs-keyword">let</span> result = []</span><br><span class="line">  <span class="hljs-keyword">while</span> (_hex.length &gt;= <span class="hljs-number">2</span>) &#123;</span><br><span class="line">    result.push(<span class="hljs-built_in">parseInt</span>(_hex.substring(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>)) <span class="hljs-comment">// parse hex to bytes(int8 array)</span></span><br><span class="line">    _hex = _hex.substring(<span class="hljs-number">2</span>, _hex.length)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="pb-UnverifiedTransaction-deserializeBinary"><a href="#pb-UnverifiedTransaction-deserializeBinary" class="headerlink" title="pb.UnverifiedTransaction.deserializeBinary"></a>pb.UnverifiedTransaction.deserializeBinary</h5><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> jspb = <span class="hljs-built_in">require</span>(<span class="hljs-string">'google-protobuf'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> goog = jspb</span><br><span class="line"></span><br><span class="line">proto.UnverifiedTransaction = <span class="hljs-function"><span class="hljs-params">opt_data</span> =&gt;</span> &#123;</span><br><span class="line">  jspb.Message.initialize(<span class="hljs-keyword">this</span>, opt_data, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proto.UnverifiedTransaction.deserializeBinaryFromReader = <span class="hljs-function">(<span class="hljs-params">msg, reader</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">while</span> (reader.nextField()) &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (reader.isEndGroup()) &#123;</span><br><span class="line">      <span class="hljs-keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">let</span> field = reader.getFieldNumber()</span><br><span class="line">    <span class="hljs-keyword">switch</span> (field) &#123;</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: &#123;</span><br><span class="line">        <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">new</span> proto.Transaction()</span><br><span class="line">        reader.readMessage(value.proto.Transaction.deserializeBinaryFromReader)</span><br><span class="line">        msg.setTransaction(value)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: &#123;</span><br><span class="line">        <span class="hljs-keyword">let</span> value = <span class="hljs-comment">/** @type &#123;!Uint8Array&#125; */</span> (reader.readBytes())</span><br><span class="line">        msg.setSignature(value)</span><br><span class="line">        <span class="hljs-keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: &#123;</span><br><span class="line">        <span class="hljs-keyword">let</span> value = <span class="hljs-comment">/** @type &#123;!proto.Crypto&#125; */</span> (reader.readEnum())</span><br><span class="line">        msg.setCrypto(value)</span><br><span class="line">        <span class="hljs-keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="hljs-keyword">default</span>: &#123;</span><br><span class="line">        reader.skipField()</span><br><span class="line">        <span class="hljs-keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> msg</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proto.UnverifiedTransaction.deserializeBinary = <span class="hljs-function"><span class="hljs-params">bytes</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> jspb.BinaryReader(bytes)</span><br><span class="line">  <span class="hljs-keyword">const</span> msg = <span class="hljs-keyword">new</span> proto.UnverifiedTransaction()</span><br><span class="line">  <span class="hljs-keyword">return</span> proto.UnverifiedTransaction.deserializeBinaryFromReader(msg, reader)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-05-16T01:43:19.000Z">2018-05-16</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 787 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/16/GenServer-in-Erlang/">GenServer in Erlang</a>
            
        </h1>
        <div class="content">
            <p><a href="https://medium.com/learn-elixir/genserver-explained-in-5-minutes-ae5823af4d44" target="_blank" rel="noopener">Original</a></p>
<p><code>GenServer</code> is essential part of OTP, which simplifies repeating tasks, letting programmer concentrate on logic of the application, and not on handling edge cases and repeated error handling.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*TpSDUSS0z3lgrUg1uEOUZg.gif" alt="Every Time When GenServer callback is called"></p>
<p>The idea behind <code>GenServer</code> is simple - you start separate process, that holds some state, then on each incoming message(be that <code>call</code> or <code>cast</code>) it may change it internal state and also generate some response(in case of <code>call</code>)</p>
<p>In this manual <code>calling process</code> is named <code>Alice</code> and newly process is <code>Bob</code>.</p>
<h5 id="Programming-without-GenServer-as-you-would-done-it-manually"><a href="#Programming-without-GenServer-as-you-would-done-it-manually" class="headerlink" title="Programming without GenServer, as you would done it manually"></a>Programming without GenServer, as you would done it manually</h5><figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">SimpleGenServerMock</span></span> <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_link</span></span>() <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *caller* context `Alice`</span></span><br><span class="line">    spawn_link(__MODULE_<span class="hljs-number">_</span>, <span class="hljs-symbol">:init</span>, [])</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span></span>(pid, arguments) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *caller* context `Alice`</span></span><br><span class="line">    send pid, &#123;<span class="hljs-symbol">:call</span>, <span class="hljs-keyword">self</span>(), arguments&#125;</span><br><span class="line">    receive</span><br><span class="line">      &#123;<span class="hljs-symbol">:response</span>, data&#125; -&gt; data</span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cast</span></span>(pid, arguments) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in `caller` context `Alice`</span></span><br><span class="line">    send pid, &#123;<span class="hljs-symbol">:cast</span>, arguments&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span></span>() <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *server* context `Bob`</span></span><br><span class="line">    initial_state = <span class="hljs-number">1</span></span><br><span class="line">    loop(initial_state)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">loop</span></span>(state) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *server* context `Bob`</span></span><br><span class="line"></span><br><span class="line">    receive command <span class="hljs-keyword">do</span></span><br><span class="line">      &#123;<span class="hljs-symbol">:call</span>, pid, <span class="hljs-symbol">:get_data</span>&#125; -&gt;</span><br><span class="line">        <span class="hljs-comment"># do some work on data here and update state</span></span><br><span class="line">        &#123;new_state, data&#125; = &#123;state, state&#125;</span><br><span class="line">        send pid, &#123;<span class="hljs-symbol">:response</span>, data&#125;</span><br><span class="line">        loop(new_state)</span><br><span class="line">      &#123;<span class="hljs-symbol">:cast</span>, <span class="hljs-symbol">:increment</span>&#125; -&gt;</span><br><span class="line">        <span class="hljs-comment"># do some work on data here and update state</span></span><br><span class="line">        new_state = state + <span class="hljs-number">1</span></span><br><span class="line">        loop(new_state)</span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Code <code>initial_state = 1</code> is exactly same code we write in <code>init</code> callback. Internal state of the server is simply an integer. Usually it is a map, tuple or list with settings and state.</p>
<p><code>{state, state}</code> means that we do not want to update the state and want to return state as result. This is the code which goes in <code>handle_call</code> callback in <code>Bob</code>.</p>
<p>And code <code>new_state = state + 1</code> is the code which goes into <code>handle_cast</code> callback, because we do not need to respond with result, we just change server <code>Bob</code> internal state.</p>
<p>Working with module will look like:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pid = SimpleGenServerMock.start_link()</span><br><span class="line">counter = SimpleGenServerMock.call(pid, :get_data)</span><br><span class="line">IO.puts <span class="hljs-string">"Counter: #&#123;counter&#125;"</span></span><br><span class="line">SimpleGenServerMock.cast(pid, :increment)</span><br><span class="line">counter = SimpleGenServerMock.call(pid, :get_data)</span><br><span class="line">IO.puts <span class="hljs-string">"Counter: #&#123;counter&#125;"</span></span><br></pre></td></tr></table></figure>
<h5 id="Same-Server-With-GenServer-Behaviour"><a href="#Same-Server-With-GenServer-Behaviour" class="headerlink" title="Same Server With GenServer Behaviour"></a>Same Server With GenServer Behaviour</h5><p>Now if we want to re-write same code using <code>GenServer</code> it will look like this:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">SimpleGenServerBehaviour</span></span> <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">use</span> GenServer</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_link</span></span>() <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *caller* context `Alice`</span></span><br><span class="line">    GenServer.start_link(__MODULE_<span class="hljs-number">_</span>, [])</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span></span>(<span class="hljs-number">_</span>) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *server* context `Bob`</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:ok</span>, <span class="hljs-number">1</span>&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_call</span></span>(<span class="hljs-symbol">:get_data</span>, _from, state) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *server* context `Bob`</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:reply</span>, state, state&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_cast</span></span>(<span class="hljs-symbol">:increment</span>, state) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># runs in the *server* context `Bob`</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:noreply</span>, state + <span class="hljs-number">1</span>&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>While in this example it did not saved a lot of lines for more complicated code having <code>GenServer</code> deal with all complexity saves a lot of tying. Also you got timeout, named processes and stable, production proven error hanlding for free.</p>
<p>Using GenServer behaviour is very similar to code we wrote before:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;:ok, pid&#125; = GenServer.start_link(SimpleGenServerBehaviour, [])</span><br><span class="line">counter = GenServer.call(SimpleGenServerBehaviour, :get_data)</span><br><span class="line">GenServer.cast(SimpleGenServerBehaviour, :increment)</span><br></pre></td></tr></table></figure>
<p>Better to implement start in the module</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">Stack</span></span> <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">use</span> GenServer</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_link</span></span>(defaut) <span class="hljs-keyword">do</span></span><br><span class="line">    GenServer.start_link(default)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span></span>(pid, item) <span class="hljs-keyword">do</span></span><br><span class="line">    GenServer.cast(pid, &#123;<span class="hljs-symbol">:push</span>, item&#125;)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pop</span></span>(pid) <span class="hljs-keyword">do</span></span><br><span class="line">    GenServer.call(pid, <span class="hljs-symbol">:pop</span>)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment"># Server callbacks</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-variable">@impl</span> ture</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_call</span></span>(<span class="hljs-symbol">:pop</span>, _from, [h | t]) <span class="hljs-keyword">do</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:reply</span>, h, t&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-variable">@impl</span> <span class="hljs-keyword">true</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_cast</span></span>(&#123;<span class="hljs-symbol">:push</span>, item&#125;, state) <span class="hljs-keyword">do</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:noreply</span>, [item | state]&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<h5 id="Receiving-Regular-Messages"><a href="#Receiving-Regular-Messages" class="headerlink" title="Receiving Regular Messages"></a>Receiving Regular Messages</h5><p>The goal of <code>GenServer</code> is to abstract the “receive” loop for developers, automatically handling system messages, support code changes, synchronous calls and more. Therefore, you should never call your own “recieve” inside the GenServer callbacks as doing will cause the GenServer misbehave.</p>
<p>Besides the synchronous and asynchronous communication provided by <code>call/3</code> and <code>cast/2</code>, regular messages sent by functions such as <code>Kernal/send2</code>, <code>Process.send_after/4</code> and similar, can be handled inside the <code>handle_info/2</code> callback.</p>
<p><code>handle_info/2</code> can be used in many sinutations, such as handling monitor DOWN messages sent by <code>Process.monitor/1</code>. Another use case for <code>handle_info/2</code> is to perform periodic work, with the help of <code>Process.send_after/4</code>:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">MyApp</span></span>.Periodically <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">use</span> GenServer</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_link</span></span> <span class="hljs-keyword">do</span></span><br><span class="line">    GenServer.start_link(__MODULE_<span class="hljs-number">_</span>, %&#123;&#125;)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-variable">@impl</span> <span class="hljs-keyword">true</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span></span>(state) <span class="hljs-keyword">do</span></span><br><span class="line">    schedule_work() <span class="hljs-comment"># Schedule work to be performed on start</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:ok</span>, state&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-variable">@impl</span> <span class="hljs-keyword">true</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_info</span></span>(<span class="hljs-symbol">:work</span>, state) <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-comment"># Do the desired work here</span></span><br><span class="line">    schedule_work() <span class="hljs-comment"># Reschedule once more</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:noreply</span>, state&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">defp</span> <span class="hljs-title">schedule_work</span></span>() <span class="hljs-keyword">do</span></span><br><span class="line">    Process.send_after(<span class="hljs-keyword">self</span>(), <span class="hljs-symbol">:work</span>, <span class="hljs-number">1000</span>)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-05-15T07:06:06.000Z">2018-05-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 527 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/15/Association-in-Phoenix/">Association in Phoenix</a>
            
        </h1>
        <div class="content">
            <p><a href="http://blog.plataformatec.com.br/2015/08/working-with-ecto-associations-and-embeds/" target="_blank" rel="noopener">Original</a></p>
<h3 id="Associations"><a href="#Associations" class="headerlink" title="Associations"></a>Associations</h3><p>Associations in Ecto are used when two difference sources(tables) are linked via foreign keys.</p>
<p>A classic example of this setup is “Post has many comments”. First create the two tables in migrations</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">create table(<span class="hljs-symbol">:posts</span>) <span class="hljs-keyword">do</span></span><br><span class="line">  add <span class="hljs-symbol">:title</span>, <span class="hljs-symbol">:string</span></span><br><span class="line">  add <span class="hljs-symbol">:body</span>, <span class="hljs-symbol">:text</span></span><br><span class="line"></span><br><span class="line">  timestamps()</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">create table(<span class="hljs-symbol">:comments</span>) <span class="hljs-keyword">do</span></span><br><span class="line">  add <span class="hljs-symbol">:post_id</span>, references(<span class="hljs-symbol">:posts</span>)</span><br><span class="line">  add <span class="hljs-symbol">:body</span>, <span class="hljs-symbol">:text</span></span><br><span class="line"></span><br><span class="line">  timestamps()</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Each comment contains a <code>post_id</code> column that by default points to a post <code>id</code></p>
<p>And now defined the schemas</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">MyApp</span></span>.Post <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">use</span> Ecto.Schema</span><br><span class="line"></span><br><span class="line">  schema <span class="hljs-string">"posts"</span> <span class="hljs-keyword">do</span></span><br><span class="line">    field <span class="hljs-symbol">:title</span></span><br><span class="line">    field <span class="hljs-symbol">:body</span></span><br><span class="line">    has_many <span class="hljs-symbol">:comments</span>, MyApp.Comment</span><br><span class="line">    timestamps</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">MyApp</span></span>.Comment <span class="hljs-keyword">do</span></span><br><span class="line">  <span class="hljs-keyword">use</span> Ecto.Schema</span><br><span class="line"></span><br><span class="line">  schema <span class="hljs-string">"comments"</span> <span class="hljs-keyword">do</span></span><br><span class="line">    field <span class="hljs-symbol">:body</span></span><br><span class="line">    belongs_to <span class="hljs-symbol">:post</span>, MyApp.Post</span><br><span class="line">    timestamps</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="Querying-associations"><a href="#Querying-associations" class="headerlink" title="Querying associations"></a>Querying associations</h3><p>One of the benefits of defining associations is taht they can be used in queries. For example:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Repo.all from p <span class="hljs-keyword">in</span> Post, <span class="hljs-symbol">preload:</span> [<span class="hljs-symbol">:comments</span>]</span><br></pre></td></tr></table></figure>
<p>Now all posts will be fetched from the database with their associated comments. The example above will perform two queries: one for loading all posts and another for loading all comments. This is often the most efficient way of loading associations from the database(even if two queries are performed) because we need to receive and parse only POSTS + COMMENTS results.</p>
<p>It is also possible to preload associations using joins while performing more complex queries. For example, imagine both posts and comments have votes and you want only comments with more votes than the post itself:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Repo.all from p <span class="hljs-keyword">in</span> Post,</span><br><span class="line">      <span class="hljs-symbol">join:</span> c <span class="hljs-keyword">in</span> assoc(p, <span class="hljs-symbol">:comments</span>),</span><br><span class="line">      <span class="hljs-symbol">where:</span> c.votes &gt; p.votes</span><br><span class="line">      <span class="hljs-symbol">preload:</span> [<span class="hljs-symbol">comments:</span> c]</span><br></pre></td></tr></table></figure>
<h3 id="Manipulating-associations"><a href="#Manipulating-associations" class="headerlink" title="Manipulating associations"></a>Manipulating associations</h3><p>While Ecto 2.0 allows you insert a post with multiple comments in one operation:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Repo.insert!(%Post&#123;</span><br><span class="line">  <span class="hljs-symbol">title:</span> <span class="hljs-string">"Hello"</span>,</span><br><span class="line">  <span class="hljs-symbol">body:</span> <span class="hljs-string">"world"</span>,</span><br><span class="line">  <span class="hljs-symbol">comments:</span> [</span><br><span class="line">    %Comment&#123;<span class="hljs-symbol">body:</span> <span class="hljs-string">"Excellent"</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Many times you may want to break it into distinct steps so you have more flexibility in managing those entries. For example, you could use changesets to build your posts and comments along the way</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">post = Ecto.Changeset.change(%Post&#123;&#125;, <span class="hljs-symbol">title:</span> <span class="hljs-string">"Hello"</span>, <span class="hljs-symbol">body:</span> <span class="hljs-string">"World"</span>)</span><br><span class="line">comment = Ecto.Changeset.change(%Comment&#123;&#125;, <span class="hljs-symbol">body:</span> <span class="hljs-string">"Excellent"</span>)</span><br><span class="line">post_with_comments = Ecto.Changeset.put_assoc(post, <span class="hljs-symbol">:comments</span>, [comment]) <span class="hljs-comment"># Main Step</span></span><br><span class="line">Repo.insert!(post_with_comments)</span><br></pre></td></tr></table></figure>
<p>Or by handling each entry individually inside a transation:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Repo.transaction <span class="hljs-keyword">fn</span> -&gt;</span><br><span class="line">  post = Repo.insert!(%Post&#123;<span class="hljs-symbol">title:</span> <span class="hljs-string">"Hello"</span>, <span class="hljs-symbol">body:</span> <span class="hljs-string">"World"</span>&#125;)</span><br><span class="line">  <span class="hljs-comment"># Build a comment from the post struct</span></span><br><span class="line">  comment = Ecto.build_assoc(post, <span class="hljs-symbol">:comments</span>, <span class="hljs-symbol">body:</span> <span class="hljs-string">"Execellent"</span>)</span><br><span class="line">  Repo.insert!(comment)</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p><code>Ecto.build_assoc/3</code> builds the comment using the id currently set in the post struct. It is equivalnet to:</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%Comment&#123;post_id: post.id, body: &quot;Execellent&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>The Ecto.build_assoc/3 function is specially useful in Phoenix controllers. For example when creating the post, one would do:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ecto.build_assoc(current_user, <span class="hljs-symbol">:post</span>)</span><br></pre></td></tr></table></figure>
<p>As we likely want to associate the post to the user currently signed in the application. In another controller, we could build a comment for an existing post with:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ecto.build_assoc(post, <span class="hljs-symbol">:comments</span>)</span><br></pre></td></tr></table></figure>
<p>Ecto does not provide functions like <code>post.comments &lt;&lt; comment</code> that allows mixing persisted data with non-persisted data. The only macha</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-05-15T03:20:43.000Z">2018-05-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 minutes read (About 1026 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/15/cast-assoc/">Difference Bwtween Build_assoc, Put_assoc, and Cast_assoc</a>
            
        </h1>
        <div class="content">
            <h3 id="Cast-Assoc-code"><a href="#Cast-Assoc-code" class="headerlink" title="Cast Assoc code"></a>Cast Assoc <a href="https://github.com/elixir-ecto/ecto/blob/v2.2.10/lib/ecto/changeset.ex#L659" target="_blank" rel="noopener">code</a></h3><blockquote>
<p>cast_assoc(changeset, name, opts \ [])</p>
</blockquote>
<p>Casts the given association with the <code>changeset params</code></p>
<p>This function should be used when working withe the entire association at once(and not a single element of a many-style association) and using data external to the application.</p>
<p>When updating the data, this function requires the association to have been preloaded in the changeset struct. Missing data will invoke the <code>:on_replace</code> behaviour defined on the association. Preloading is not necessary for newly built structs.</p>
<p>The parameters for the given association will be retrieved from <code>changeset.params</code>. Those parameters are expected to be a map with attributes, similar to the ones passed to <code>cast/4</code>. Once parameter are retrieved, <code>cast_assoc/3</code> will match those parameters with the associations already in the changeset record</p>
<p>For example, imagine a user has many addresses relationship where post data is sent as follow</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%&#123;<span class="hljs-string">"name"</span> =&gt; <span class="hljs-string">"John Doe"</span>, <span class="hljs-string">"addresses"</span> =&gt; [</span><br><span class="line">  %&#123;<span class="hljs-string">"street"</span> =&gt; <span class="hljs-string">"Some where"</span>, <span class="hljs-string">"country"</span> =&gt; <span class="hljs-string">"Brzil"</span>, <span class="hljs-string">"id"</span> =&gt; 1&#125;,</span><br><span class="line">  %&#123;<span class="hljs-string">"street"</span> =&gt; <span class="hljs-string">"Else where"</span>, <span class="hljs-string">"country"</span> =&gt; <span class="hljs-string">"Poland"</span>&#125;,</span><br><span class="line">]&#125;</span><br></pre></td></tr></table></figure>
<p>and then</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user</span><br><span class="line">|&gt; Repo.preload(<span class="hljs-symbol">:addresses</span>)</span><br><span class="line">|&gt; Ecto.Changeset.cast(params, [])</span><br><span class="line">|&gt; Ecto.Changeset.cast_assoc(<span class="hljs-symbol">:addresses</span>)</span><br></pre></td></tr></table></figure>
<p>Once <code>cast_assoc/3</code> is called, Ecto will compare those params with the addresses already associated with the user and acts as follows:</p>
<ul>
<li><p>If the parameter does not contain an ID, the parameter data will be passed to <code>changeset/2</code> with a new struct and become an insert operation</p>
</li>
<li><p>If the parameter contains an ID and there is no associated child with such ID, the parameter data will be passed to <code>changeset/2</code> with a new struct and become an insert operation</p>
</li>
<li><p>If the parameter contains an ID and there is an associated children with such ID, the parameter data will be passed to <code>changeset/2</code> with the existing struct and become an update operation.</p>
</li>
<li><p>If there is an associated child with an ID and its ID is not given as parameter, the <code>:on_replace</code> callback for that association will be invoked</p>
</li>
</ul>
<h5 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h5><figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">`cast_assoc/<span class="hljs-number">3</span>` is useful <span class="hljs-keyword">when</span> the associated data is managed alongside the parent struct, all at once.</span><br><span class="line"></span><br><span class="line">To work with a single element of an association, other functions are more appropriate. For example to insert a single associated struct <span class="hljs-keyword">for</span> a `has_many` association it<span class="hljs-string">'s much easier to construct the associated struct with `Ecto.build_assoc/3` and persist it directly with `Ecto.Repo.insert/2`</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">Furthurmore, if each side of the association is managed seperately, it is prefereable to use `put_assoc/3` and directly instruct Ecto how the association should look like.</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">For example, imagine you are receiving a set of tags you want to associate to an user. Those tags are meant to **exist upfront**. Using `cast_assoc/3` won'</span>t work as desired because the tags are <span class="hljs-keyword">not</span> managed alongside the user. In such cases, `put_assoc/<span class="hljs-number">3</span>` will work as desired. With the given <span class="hljs-symbol">parameters:</span></span><br><span class="line"></span><br><span class="line">  %&#123;<span class="hljs-string">"name"</span> =&gt; <span class="hljs-string">"John Doe"</span>, <span class="hljs-string">"tags"</span> =&gt; [<span class="hljs-string">"linear"</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">and</span> <span class="hljs-keyword">then</span></span><br><span class="line"></span><br><span class="line">  tags = Repo.all(from t <span class="hljs-keyword">in</span> Tag, <span class="hljs-symbol">where:</span> t.name <span class="hljs-keyword">in</span> ^params[<span class="hljs-string">"tags"</span>])</span><br><span class="line"></span><br><span class="line">  user</span><br><span class="line">  |&gt; Repo.preload(<span class="hljs-symbol">:tags</span>)</span><br><span class="line">  |&gt; Ecto.Changeset.cast(params) <span class="hljs-comment"># no need to allow :tags as we put them directly</span></span><br><span class="line">  |&gt; Ecto.Changeset.put_assoc(<span class="hljs-symbol">:tags</span>, tags) <span class="hljs-comment"># explicitly set the tags</span></span><br><span class="line"></span><br><span class="line">note the changeset must have been previously `cast` using `cast/<span class="hljs-number">4</span>` before this function is called.</span><br></pre></td></tr></table></figure>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cast_assoc</span></span>(changeset, name, opts \\ []) <span class="hljs-keyword">when</span> is_atom(name) <span class="hljs-keyword">do</span></span><br><span class="line">  cast_relation(<span class="hljs-symbol">:assoc</span>, changeset, name, opts)</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">defp</span> <span class="hljs-title">cast_relation</span></span>(type, %Changeset&#123;&#125; = changeset, key, opts) <span class="hljs-keyword">do</span></span><br><span class="line">  &#123; key, param_key &#125; = cast_key(key)</span><br><span class="line">  %&#123;<span class="hljs-symbol">data:</span> data, <span class="hljs-symbol">types:</span> types, <span class="hljs-symbol">params:</span> params, changes, changes &#125; = changeset</span><br><span class="line">  %&#123;<span class="hljs-symbol">related:</span> related&#125; = relation = relation!(<span class="hljs-symbol">:cast</span>, type, key, Map.get(types, key))</span><br><span class="line">  params = params || %&#123;&#125;</span><br><span class="line"></span><br><span class="line">  &#123;changeset, required?&#125; = if opts[<span class="hljs-symbol">:required</span>] <span class="hljs-keyword">do</span></span><br><span class="line">    &#123;update_in(changeset.required, &amp;[key|&amp;<span class="hljs-number">1</span>]), <span class="hljs-keyword">true</span>&#125;</span><br><span class="line">  else</span><br><span class="line">    &#123;changeset, <span class="hljs-keyword">false</span>&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  on_cast = Keyword.get_lazy(opts, <span class="hljs-symbol">:with</span>, <span class="hljs-keyword">fn</span> -&gt; on_cast_default(type, related) <span class="hljs-keyword">end</span>)</span><br><span class="line">  original = Map.get(data, key)</span><br><span class="line"></span><br><span class="line">  changeset = <span class="hljs-keyword">case</span> Map.fetch(params, params_key) <span class="hljs-keyword">do</span></span><br><span class="line">    &#123;<span class="hljs-symbol">:ok</span>, value&#125; -&gt;</span><br><span class="line">      current = Relation.load!(data, original)</span><br><span class="line">      <span class="hljs-keyword">case</span> Relation.cast(relation, value, current, on_cast) <span class="hljs-keyword">do</span></span><br><span class="line">        &#123;<span class="hljs-symbol">:ok</span>, change, relation_valid?&#125; <span class="hljs-keyword">when</span> change != original -&gt;</span><br><span class="line">          missing_relation(%&#123;changeset |  <span class="hljs-symbol">change:</span> Map.put(changes, key, changes), <span class="hljs-symbol">valid?:</span> changeset.valid? <span class="hljs-keyword">and</span> relation_valid?&#125;, key, current, required?, relation, opts)</span><br><span class="line">        <span class="hljs-symbol">:error</span> -&gt;</span><br><span class="line">          %&#123;changeset | <span class="hljs-symbol">errors:</span> [&#123;key, &#123;message(opts, <span class="hljs-symbol">:invalid_message</span>, <span class="hljs-string">"is invalid"</span>), [<span class="hljs-symbol">type:</span> expected_relation_type(relation)]&#125;&#125; | changeset.errors], valid? <span class="hljs-keyword">false</span>&#125;</span><br><span class="line">        <span class="hljs-number">_</span> -&gt; missing_relation(changeset, key, current, required?, relation, opts)</span><br><span class="line">      <span class="hljs-keyword">end</span></span><br><span class="line">    <span class="hljs-symbol">:error</span> -&gt; missing_relation(changeset, key, current, required?, relation, opts)</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">  update_in changeset.types[key], <span class="hljs-keyword">fn</span> &#123;type, relation&#125; -&gt;</span><br><span class="line">    &#123;type, %&#123;relation | <span class="hljs-symbol">on_cast:</span> on_cast&#125;&#125;</span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="Put-Assoc"><a href="#Put-Assoc" class="headerlink" title="Put Assoc"></a>Put Assoc</h3><p>As alternative to <code>cast_assoc/3</code></p>
<p><code>cast_assoc/3</code> is useful when the associated data is managed alongside the parent struct, all at once.</p>
<p>If each side of the association is managed seperately, it is preferable to use <code>put_assoc/3</code> and directly instruct Ecto how the association should look like.</p>
<p>For example, imagine you are receiving a set of tags you want to associate to an user. Those tags are meant to exist upfront. Using <code>cast_assoc/3</code> won’t work as desired because the tags are not managed alongside the user. In such cases, <code>put_assoc/3</code> will work as desired.</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;<span class="hljs-string">"name"</span> =&gt; <span class="hljs-string">"John Doe"</span>, <span class="hljs-string">"tags"</span> =&gt; [<span class="hljs-string">"lieanr"</span>]&#125;</span><br></pre></td></tr></table></figure>
<p>and then:</p>
<figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tags = Repo.all(from t <span class="hljs-keyword">in</span> Tag, <span class="hljs-symbol">where:</span> t.name <span class="hljs-keyword">in</span> ^params[<span class="hljs-string">"tags"</span>])</span><br><span class="line"></span><br><span class="line">user</span><br><span class="line">|&gt; Repo.preload(<span class="hljs-symbol">:tags</span>)</span><br><span class="line">|&gt; Ecto.Changeset.cast(params)</span><br><span class="line">|&gt;  Ecto.Changeset.put_assoc(<span class="hljs-symbol">:tags</span>, tags)</span><br></pre></td></tr></table></figure>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><h5 id="Build-Assoc"><a href="#Build-Assoc" class="headerlink" title="Build_Assoc"></a>Build_Assoc</h5><p>Gen an instance with foreign key</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">iex&gt; post = Ecto.build_assoc(user, :posts, %&#123;header: <span class="hljs-string">"Clickbait header"</span>, body: <span class="hljs-string">"No real contet"</span>&#125;)</span><br><span class="line">%EctoAssoc.Post&#123;__meta__: <span class="hljs-comment">#Ecto.Schema.Metadata&lt;:built, "posts"&gt;,</span></span><br><span class="line">  body: <span class="hljs-string">"No real content"</span>, header: <span class="hljs-string">"Clickbait header"</span>, id: nil,</span><br><span class="line">  user: <span class="hljs-comment">#Ecto.Association.NotLoaded&lt;association :user is not loaded&gt;, user_id: 1&#125;</span></span><br><span class="line"></span><br><span class="line">iex&gt; Repo.insert!(post)</span><br></pre></td></tr></table></figure>
<h5 id="Put-Assoc-1"><a href="#Put-Assoc-1" class="headerlink" title="Put_Assoc"></a>Put_Assoc</h5><p>Add association to changeset which is not persisted</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iex&gt; post_changeset = Ecto.Changeset.change(post)</span><br><span class="line">iex&gt; post_with_tags = Ecto.Changeset.put_assoc(post_changeset, :tags, [misc_tag])</span><br><span class="line">iex&gt; Repo.insert!(post_with_tags)</span><br></pre></td></tr></table></figure>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p><code>cast_assoc</code> when you want to cast external parameters, like the ones from a form, into an association.</p>
<p><code>put_assoc</code> when you already have an <strong>association struct</strong></p>
<p><code>build_assoc</code> receive an existing struct(for example <code>user</code>), that was persisted to the database, and builds a struct(for example <code>post</code>, based on its association(for example <code>:posts</code>), with the foreign key field(for example <code>user_id</code>).</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-04-14T12:13:53.000Z">2018-04-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 78 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/04/14/Introduction-to-Object-getOwnPropertyDescriptors/">Introduction to Object.getOwnPropertyDescriptors</a>
            
        </h1>
        <div class="content">
            <h3 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors"></a>Object.getOwnPropertyDescriptors</h3><p>This method returns all properties including <code>getter</code> and <code>setter</code>.</p>
<p><code>Object.assign</code> shallow copies all the properties excluding <code>getter</code> and <code>setter</code> of the original source object.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> car = &#123;</span><br><span class="line">  name: <span class="hljs-string">'BMW'</span>,</span><br><span class="line">  price: <span class="hljs-number">100000</span>,</span><br><span class="line">  get discount () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.d</span><br><span class="line">  &#125;</span><br><span class="line">  set discount (x) &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.d = x</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(car, <span class="hljs-string">'discount'</span>) <span class="hljs-comment">// &#123;get, set, enumerable, configurable&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> assignedCar = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, car)</span><br><span class="line"><span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(assignedCar, <span class="hljs-string">'discount'</span>) <span class="hljs-comment">// &#123;value: undefined&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> definedCar = <span class="hljs-built_in">Object</span>.defineProperties(&#123;&#125;, <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptors(car))</span><br><span class="line"><span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(definedCar, <span class="hljs-string">'discount'</span>) <span class="hljs-comment">// &#123;get, set, enumerable, configurable&#125;</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-04-06T12:26:36.000Z">2018-04-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 77 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/04/06/enable-sass-scss-in-phoenix/">Enable Sass/scss in Phoenix</a>
            
        </h1>
        <div class="content">
            <h1 id="Step-1-Add-brunch"><a href="#Step-1-Add-brunch" class="headerlink" title="Step 1: Add brunch"></a>Step 1: Add brunch</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">cd</span> assets &amp;&amp; yarn add sass-brunch</span><br></pre></td></tr></table></figure>
<h1 id="Step-2-Add-plugin-in-brunch-config-js"><a href="#Step-2-Add-plugin-in-brunch-config-js" class="headerlink" title="Step 2: Add plugin in brunch-config.js"></a>Step 2: Add plugin in brunch-config.js</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// brunch-config.js</span></span><br><span class="line">plugins: &#123;</span><br><span class="line">  sass: &#123;</span><br><span class="line">    mode: <span class="hljs-string">'native'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Step3-Enable-hot-reload"><a href="#Step3-Enable-hot-reload" class="headerlink" title="Step3: Enable hot-reload"></a>Step3: Enable hot-reload</h1><figure class="highlight elixir hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/<span class="hljs-regexp">/ dev.exs</span></span><br><span class="line"><span class="hljs-regexp">/</span><span class="hljs-regexp">/ add sass and scss to the pattern</span></span><br><span class="line"><span class="hljs-regexp">config :citaDappStore, CitaDappStoreWeb.Endpoint,</span></span><br><span class="line"><span class="hljs-regexp">  live_reload: [</span></span><br><span class="line"><span class="hljs-regexp">    patterns: [</span></span><br><span class="line"><span class="hljs-regexp">      ~r&#123;priv/static</span><span class="hljs-regexp">/.*(js|css|png|jpeg|jpg|gif|svg|sass|scss)$&#125;,</span></span><br><span class="line"><span class="hljs-regexp">      ~r&#123;priv/gettext</span><span class="hljs-regexp">/.*(po)$&#125;,</span></span><br><span class="line"><span class="hljs-regexp">      ~r&#123;lib/cita</span>DappStore_web/views/.*(ex)<span class="hljs-variable">$&#125;</span>,</span><br><span class="line">      ~r&#123;lib/citaDappStore_web/templates/.*(eex)<span class="hljs-variable">$&#125;</span></span><br><span class="line">    ]</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure>
<p>That’s all.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-03-14T05:42:39.000Z">2018-03-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 337 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/03/14/Model-Generator-of-Rails/">Model Generator of Rails</a>
            
        </h1>
        <div class="content">
            <p><a href="https://railsguides.net/advanced-rails-model-generators/" target="_blank" rel="noopener">Original</a></p>
<h3 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model User email</span><br></pre></td></tr></table></figure>
<p>This command will generate user model with email field type of string, migration which creates user table, test for model and factory.</p>
<p>If you want to have model with different type of string pass type after field name following by <code>:</code>.</p>
<p>The whole list of available types:</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">integer</span><br><span class="line">primary_key</span><br><span class="line">decimal</span><br><span class="line">float</span><br><span class="line">boolean</span><br><span class="line">binary</span><br><span class="line">string</span><br><span class="line">text</span><br><span class="line">date</span><br><span class="line">time</span><br><span class="line">datetime</span><br><span class="line">timestamp</span><br></pre></td></tr></table></figure>
<p>You are able to pass -option parameter to generator. It will inherit generating class from passed name to achieve STI(Single Table Inheritance):</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model admin --parent user</span><br></pre></td></tr></table></figure>
<p>This example generates model:</p>
<figure class="highlight ruby hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Admin</span> &lt; User</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Interesting fact that if you generate model in some scope passing model like <em>admin/user</em> of <em>Admin::User</em>:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model admin/user</span><br></pre></td></tr></table></figure>
<p>you will get generated model in scope <code>app/models/admin/user.rb</code>, defined scope <code>app/models/admin.rb</code> which is required to define module.</p>
<figure class="highlight ruby hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Admin</span></span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">self</span>.<span class="hljs-title">table_name_prefix</span></span></span><br><span class="line">   <span class="hljs-string">'admin_'</span></span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>It means that generated table name for <em>Admin::User</em> starts with prefix _admin_user_. This feature allows to have seperated namespaced models as in rails code as in db schema.</p>
<h3 id="Advantage-useage"><a href="#Advantage-useage" class="headerlink" title="Advantage useage"></a>Advantage useage</h3><p>Sometimes you have to automatically add index for columns in your migration. It’s not a problem.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model user email:index location_id:<span class="hljs-built_in">integer</span>:index</span><br></pre></td></tr></table></figure>
<p>Or uniq index</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model user pseudo:string:uniq</span><br></pre></td></tr></table></figure>
<p>Set limit for field of integer, string, text and binary fields</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model product <span class="hljs-string">'price:decimal&#123;10,2&#125;'</span></span><br></pre></td></tr></table></figure>
<p>The last useful feature of generators - it’s options to generate reference columns (fields which are used in rails as foreign_key)</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g model photo album:references</span><br></pre></td></tr></table></figure>
<p>This command will generate photos table with integer field _album_id_ and also it will add index for this field automatically.</p>
<figure class="highlight ruby hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreatePhotos</span> &lt; ActiveRecord::Migration</span></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change</span></span></span><br><span class="line">    create_table <span class="hljs-symbol">:photos</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|t|</span></span><br><span class="line">      t.references <span class="hljs-symbol">:album</span></span><br><span class="line"></span><br><span class="line">      t.timestamps</span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">    add_index <span class="hljs-symbol">:photos</span>, <span class="hljs-symbol">:album_id</span></span><br><span class="line">  <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-03-13T09:40:04.000Z">2018-03-13</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 262 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/03/13/Error-Handling-in-Solidity/">Error Handling in Solidity</a>
            
        </h1>
        <div class="content">
            <p>Solidity uses state-reverting exceptions to handle errors. Such an exception will undo all changes made to the state in the current call(and all its sub-calls) and also flag an error to the caller. The convenience function <code>assert</code> and <code>require</code> can be used to check for conditions and throw an exception if the condition is not met.</p>
<p>The <code>assert</code> function should only be used to test for internal errors, and to check invariants.</p>
<p>The <code>require</code> function should be used to ensure valid conditions, such as inputs, or contract state variables are met, or to validate return values from calls to external contracts.</p>
<p>If used properly, analysis tools can evaluate your contract to identify the conditions and function calls which will reach a failing <code>assert</code>. Properly functioning code should never reach a failing assert statement. If this happens there is a bug in your contract which you should fix.</p>
<p>There are two ways to trigger exceptions:</p>
<ul>
<li><p>The <code>revert</code> function can be used to flag an error and revert the current call. In the future, it might be possible to also include details about error in a call to <code>revert</code>.</p>
</li>
<li><p>The <code>throw</code> keyword can also be used as an alternative to <code>revert()</code></p>
</li>
</ul>
<blockquote>
<p>From 0.4.13, the <code>throw</code> is deprecated.</p>
</blockquote>
<p>When exceptions happen in a sub-call, they ‘bubble up’ automatically. Exceptions to this rule are <code>send</code> and the low-level functions <code>call</code>, <code>delegatecall</code> and <code>callcode</code> – those return <code>false</code> in case of an exception instead of ‘bubble up’.</p>
<blockquote>
<p>low-level function <code>call</code>, <code>delegatecall</code>, <code>callcode</code> return false when exceptions occur.</p>
</blockquote>
<p>Catch exceptions is not yet possible.</p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/16/">16</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.jpg" alt="Keith Chen">
                    
                    
                    <p class="is-size-4 is-block">
                        Keith Chen
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        FE Engineer on Blockchain
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>30°17&#39;37N, 120°9&#39;41E</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        306
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        7
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        90
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/keith-CY" target="_blank">
                Follow</a>
        </div>
        
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/keith-CY" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Keith CY</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.linkedin.com/in/宇-陈-644b61ba" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Yu Chen</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.linkedin.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Soup/">
            <span class="level-start">
                <span class="level-item">Soup</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Uncategorized/">
            <span class="level-start">
                <span class="level-item">Uncategorized</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/github/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">141</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/note/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AJAX/" style="font-size: 10.91px;">AJAX</a> <a href="/tags/BOOTSTRAP/" style="font-size: 10px;">BOOTSTRAP</a> <a href="/tags/Bash/" style="font-size: 11.82px;">Bash</a> <a href="/tags/BlockChain/" style="font-size: 10px;">BlockChain</a> <a href="/tags/Blockchain/" style="font-size: 10px;">Blockchain</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/CSS/" style="font-size: 10.91px;">CSS</a> <a href="/tags/CSS3/" style="font-size: 20px;">CSS3</a> <a href="/tags/Closure/" style="font-size: 10px;">Closure</a> <a href="/tags/CommonJS/" style="font-size: 10px;">CommonJS</a> <a href="/tags/Contract-Ethereum-Web3/" style="font-size: 10px;">Contract, Ethereum, Web3</a> <a href="/tags/Contract-Solidity/" style="font-size: 10px;">Contract, Solidity</a> <a href="/tags/D3-Example/" style="font-size: 10px;">D3, Example</a> <a href="/tags/DAPP-Solidity/" style="font-size: 10px;">DAPP, Solidity</a> <a href="/tags/DApp-Solidity/" style="font-size: 10px;">DApp, Solidity</a> <a href="/tags/DOM/" style="font-size: 12.73px;">DOM</a> <a href="/tags/DevTools/" style="font-size: 10px;">DevTools</a> <a href="/tags/Drizzle-Ethereum-BlockChain/" style="font-size: 10px;">Drizzle, Ethereum, BlockChain</a> <a href="/tags/ES6/" style="font-size: 10.91px;">ES6</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/ETH-Wallet/" style="font-size: 10px;">ETH, Wallet</a> <a href="/tags/Elixir-Phoenix-SCSS/" style="font-size: 10px;">Elixir, Phoenix, SCSS</a> <a href="/tags/Erlang-Elixir-GenServer/" style="font-size: 10px;">Erlang, Elixir, GenServer</a> <a href="/tags/Ethereum/" style="font-size: 10px;">Ethereum</a> <a href="/tags/Ethereum-IPFS/" style="font-size: 10px;">Ethereum, IPFS</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Go-Http-Web/" style="font-size: 10px;">Go, Http, Web</a> <a href="/tags/GraphQL-Apollo-TypeScript/" style="font-size: 10px;">GraphQL, Apollo, TypeScript</a> <a href="/tags/Gulp/" style="font-size: 11.82px;">Gulp</a> <a href="/tags/HTML5/" style="font-size: 15.45px;">HTML5</a> <a href="/tags/HTTP2-Node/" style="font-size: 10px;">HTTP2, Node</a> <a href="/tags/Html-Picture/" style="font-size: 10px;">Html, Picture</a> <a href="/tags/Immutable/" style="font-size: 10px;">Immutable</a> <a href="/tags/Int8Array/" style="font-size: 10px;">Int8Array</a> <a href="/tags/JSON-RPC/" style="font-size: 10px;">JSON-RPC</a> <a href="/tags/Javascript/" style="font-size: 19.09px;">Javascript</a> <a href="/tags/Koa/" style="font-size: 10.91px;">Koa</a> <a href="/tags/Koa-NPM-Package/" style="font-size: 10px;">Koa, NPM, Package</a> <a href="/tags/MDL/" style="font-size: 16.36px;">MDL</a> <a href="/tags/Material-Design/" style="font-size: 17.27px;">Material Design</a> <a href="/tags/Mock-JavaScript/" style="font-size: 10px;">Mock, JavaScript</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/NODE/" style="font-size: 13.64px;">NODE</a> <a href="/tags/NPM/" style="font-size: 10.91px;">NPM</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Nock/" style="font-size: 10px;">Nock</a> <a href="/tags/Node-CLI/" style="font-size: 10.91px;">Node, CLI</a> <a href="/tags/Node-Fastify/" style="font-size: 10.91px;">Node, Fastify</a> <a href="/tags/Node-Graphql-Koa/" style="font-size: 10px;">Node, Graphql, Koa</a> <a href="/tags/Node-js/" style="font-size: 10.91px;">Node.js</a> <a href="/tags/Phoenix-Elixir-Ecto/" style="font-size: 10px;">Phoenix, Elixir, Ecto</a> <a href="/tags/Promise/" style="font-size: 11.82px;">Promise</a> <a href="/tags/Protobuf/" style="font-size: 10px;">Protobuf</a> <a href="/tags/Pug-HTML/" style="font-size: 10px;">Pug, HTML</a> <a href="/tags/React/" style="font-size: 18.18px;">React</a> <a href="/tags/React-Docker/" style="font-size: 10px;">React, Docker</a> <a href="/tags/React-Router-Code-splitting/" style="font-size: 10px;">React, Router, Code-splitting</a> <a href="/tags/React-Native/" style="font-size: 10px;">React-Native</a> <a href="/tags/React-Redux/" style="font-size: 10px;">React-Redux</a> <a href="/tags/React-Router/" style="font-size: 10.91px;">React-Router</a> <a href="/tags/Redux/" style="font-size: 14.55px;">Redux</a> <a href="/tags/RegExp/" style="font-size: 10px;">RegExp</a> <a href="/tags/Ruby-Rails/" style="font-size: 10px;">Ruby, Rails</a> <a href="/tags/Ruby-Rails-RoR-Mina/" style="font-size: 10px;">Ruby, Rails, RoR, Mina</a> <a href="/tags/Rust-Rocket/" style="font-size: 10px;">Rust, Rocket</a> <a href="/tags/RxJS/" style="font-size: 10px;">RxJS</a> <a href="/tags/Smart-Contract-Web3/" style="font-size: 10px;">Smart Contract, Web3</a> <a href="/tags/Solidity/" style="font-size: 12.73px;">Solidity</a> <a href="/tags/Solidity-Error-Handling/" style="font-size: 10px;">Solidity, Error Handling</a> <a href="/tags/Solidity-Public-External/" style="font-size: 10px;">Solidity, Public, External</a> <a href="/tags/Solidity-Smart-Contract/" style="font-size: 10px;">Solidity, Smart Contract</a> <a href="/tags/Thunk/" style="font-size: 10.91px;">Thunk</a> <a href="/tags/Trick/" style="font-size: 11.82px;">Trick</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Webpack-DLL/" style="font-size: 10px;">Webpack, DLL</a> <a href="/tags/automatic/" style="font-size: 10px;">automatic</a> <a href="/tags/babel/" style="font-size: 10px;">babel</a> <a href="/tags/babel-polyfill/" style="font-size: 10px;">babel-polyfill</a> <a href="/tags/blockchain-bitcoin-bip/" style="font-size: 10.91px;">blockchain, bitcoin, bip</a> <a href="/tags/commandline/" style="font-size: 10px;">commandline</a> <a href="/tags/github/" style="font-size: 10.91px;">github</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/lecture-yc/" style="font-size: 10px;">lecture, yc</a> <a href="/tags/precache/" style="font-size: 10px;">precache</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/webpack/" style="font-size: 17.27px;">webpack</a> <a href="/tags/webpack2/" style="font-size: 11.82px;">webpack2</a> <a href="/tags/测试/" style="font-size: 11.82px;">测试</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/04/20/node-on-bip-173/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/segwit.png" alt="Node-on-Bip-173">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-04-20T08:36:54.000Z">2019-04-20</time></div>
                    <a href="/2019/04/20/node-on-bip-173/" class="has-link-black-ter is-size-6">Node-on-Bip-173</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/04/17/notes-of-building-product-talking-to-users-and-growing/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="[WIP]notes of Building Product, Talking to Users and Growing">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-04-17T03:32:32.000Z">2019-04-17</time></div>
                    <a href="/2019/04/17/notes-of-building-product-talking-to-users-and-growing/" class="has-link-black-ter is-size-6">[WIP]notes of Building Product, Talking to Users and Growing</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/16/keystore/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time></div>
                    <a href="/2019/03/16/keystore/" class="has-link-black-ter is-size-6">Keystore</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">April 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/04/20/node-on-bip-173/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/segwit.png" alt="Node-on-Bip-173">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-04-20T08:36:54.000Z">2019-04-20</time></div>
                    <a href="/2019/04/20/node-on-bip-173/" class="has-link-black-ter is-size-6">Node-on-Bip-173</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/04/17/notes-of-building-product-talking-to-users-and-growing/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="[WIP]notes of Building Product, Talking to Users and Growing">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-04-17T03:32:32.000Z">2019-04-17</time></div>
                    <a href="/2019/04/17/notes-of-building-product-talking-to-users-and-growing/" class="has-link-black-ter is-size-6">[WIP]notes of Building Product, Talking to Users and Growing</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/16/keystore/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time></div>
                    <a href="/2019/03/16/keystore/" class="has-link-black-ter is-size-6">Keystore</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">April 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="EzCook" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Chen Yu&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>