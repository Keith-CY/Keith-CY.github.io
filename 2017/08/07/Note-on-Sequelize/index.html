<!DOCTYPE html>
<html lang="en">
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.4 -->

    <!-- Title -->
    
    <title>
        
            Note on Sequelize | 
        
        EzCook
    </title>

    <!-- Meta & Info -->
    <meta charset="utf-8">

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    

    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Chen Yu">
    <meta name="description" content="null">
    <meta name="keywords" content="EzCook, JavaScript, React, RxJS, Redux">

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="EzCook">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Note on Sequelize | EzCook">
    <meta property="og:description" content="null">
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS & jQuery -->
    
        <link rel="stylesheet" href="/css/material.min.css">
        <link rel="stylesheet" href="/css/style.min.css">
        <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00BCD4;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #00BCD4 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #00BCD4 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #00BCD4 !important;
  }

  .toTop {
    background: #000BCD4 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #000BCD4;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #000BCD4;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #000BCD4;
  }

  .post-toc a:hover {
    color: #00BCD4;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


        <script src="/js/jquery.min.js"></script>
        <script src="/js/queue.js"></script>
    

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    


    <!-- Bing Background -->
    
        <script type="text/javascript">
            queue.offer(function(){
                $('body').attr('data-original', 'https://api.i-meto.com/bing?null');
            });
        </script>
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Example"><span class="post-toc-number">1.</span> <span class="post-toc-text">Example</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Start"><span class="post-toc-number">2.</span> <span class="post-toc-text">Start</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Installation"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">Installation</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Setup-a-connection"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Setup a connection</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Test-the-connection"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">Test the connection</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Model"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">Model</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Query"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">Query</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Application-wide-model-options"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">Application wide model options</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Promises"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">Promises</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Model-Definition"><span class="post-toc-number">3.</span> <span class="post-toc-text">Model Definition</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Configuration"><span class="post-toc-number">4.</span> <span class="post-toc-text">Configuration</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Import"><span class="post-toc-number">5.</span> <span class="post-toc-text">Import</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Database-Synchronization"><span class="post-toc-number">6.</span> <span class="post-toc-text">Database Synchronization</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Expansion-of-models"><span class="post-toc-number">7.</span> <span class="post-toc-text">Expansion of models</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Indexes"><span class="post-toc-number">8.</span> <span class="post-toc-text">Indexes</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Model-Usage"><span class="post-toc-number">9.</span> <span class="post-toc-text">Model Usage</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Data-Retrieval-Finders"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">Data Retrieval / Finders</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#find-search-for-one-specific-element-in-the-database"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">find - search for one specific element in the database</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#findOrCreate-Search-for-a-specific-element-or-create-it-if-not-available"><span class="post-toc-number">9.3.</span> <span class="post-toc-text">findOrCreate - Search for a specific element or create it if not available</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#fineAndCountAll-Search-for-multiple-elements-in-the-database-returns-both-data-and-total-count"><span class="post-toc-number">9.4.</span> <span class="post-toc-text">fineAndCountAll - Search for multiple elements in the database, returns both data and total count</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#findAll-Search-for-multiple-elements-in-the-database"><span class="post-toc-number">9.5.</span> <span class="post-toc-text">findAll - Search for multiple elements in the database</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Complex-filtering-OR-NOT-queries"><span class="post-toc-number">9.6.</span> <span class="post-toc-text">Complex filtering /OR/NOT queries</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Manipulating-the-database-with-limit-offset-order-and-group"><span class="post-toc-number">9.7.</span> <span class="post-toc-text">Manipulating the database with limit, offset, order and group</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Raw-queries"><span class="post-toc-number">9.8.</span> <span class="post-toc-text">Raw queries</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Queries"><span class="post-toc-number">10.</span> <span class="post-toc-text">Queries</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Attributes"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">Attributes</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Where"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">Where</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Basics"><span class="post-toc-number">10.3.</span> <span class="post-toc-text">Basics</span></a></li></ol></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                Note on Sequelize
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="images/avatar.gif" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Chen Yu</strong>
        <span>Aug 07, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Note on Sequelize&url=http://yoursite.com//2017/08/07/Note-on-Sequelize/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Note on Sequelize&url=http://yoursite.com//2017/08/07/Note-on-Sequelize/index.html&via=Chen Yu" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com//2017/08/07/Note-on-Sequelize/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://yoursite.com//2017/08/07/Note-on-Sequelize/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>Sequelize is a promise-based ORM for Node.</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Sequelize = <span class="built_in">require</span>(<span class="string">'sequelize'</span>)</div><div class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> Sequeslize(<span class="string">'database'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>)</div><div class="line"></div><div class="line"><span class="keyword">const</span> User = sequelize.define(<span class="string">'user'</span>, &#123;</div><div class="line">  <span class="attr">username</span>: Sequelize.STRING,</div><div class="line">  <span class="attr">birthday</span>: Sequelize.DATE,</div><div class="line">&#125;)</div><div class="line"></div><div class="line">sequelize.sync().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  User.create(&#123;</div><div class="line">    <span class="attr">username</span>: <span class="string">'Jane'</span>,</div><div class="line">    <span class="attr">birthday</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1980</span>, <span class="number">5</span>, <span class="number">2</span>),</div><div class="line">  &#125;)</div><div class="line">&#125;).then(<span class="function"><span class="params">jane</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'create successfully'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Start"><a href="#Start" class="headerlink" title="Start"></a>Start</h3><h4 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">yarn add sequelize</div><div class="line"><span class="comment"># add one of the following:</span></div><div class="line">yarn add pg pg-hstore</div><div class="line">yarn add mysql2</div><div class="line">yarn add sqlite3</div><div class="line">yarn add tedious // MSSQL</div></pre></td></tr></table></figure>
<h4 id="Setup-a-connection"><a href="#Setup-a-connection" class="headerlink" title="Setup a connection"></a>Setup a connection</h4><p>Sequelize will setup a connection pool on initialization so you should ideally only ever create one instance per database if you’re connecting to the DB from a single process. If you’re connecting to the DB from multiple processes, you’ll have to create one instance per process, but each instance should have a maximum connection pool size of “max connection pool size divided by number of instances”. So, if you wanted a max connection pool size of 90 and you have 3 worker process, each process’s instance should have a max connection pool size of 30.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Conn = <span class="keyword">new</span> Sequelize(<span class="string">'database'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>, &#123;</div><div class="line">  <span class="attr">host</span>: <span class="string">'localhost'</span>,</div><div class="line">  <span class="attr">dialect</span>: <span class="string">'mysql'</span>|<span class="string">'sqlite'</span>|<span class="string">'postgres'</span>|<span class="string">'mssql'</span>,</div><div class="line">  <span class="attr">pool</span>: &#123;</div><div class="line">    <span class="attr">max</span>: <span class="number">5</span>,</div><div class="line">    <span class="attr">min</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">idle</span>: <span class="number">10000</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">storage</span>: <span class="string">'path/to/database.sqlite'</span>,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// or you can simply use a connection uri</span></div><div class="line"><span class="keyword">const</span> Conn = <span class="keyword">new</span> Sequelize(<span class="string">'postgres://user:pass@example.com:5432/dbname'</span>)</div></pre></td></tr></table></figure>
<h4 id="Test-the-connection"><a href="#Test-the-connection" class="headerlink" title="Test the connection"></a>Test the connection</h4><p>You can use the <code>.authenticate()</code> function like this to test the connection.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Conn.authenticate().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Connection has been established successfully'</span>)</div><div class="line">&#125;).catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.error(<span class="string">'Unable to connect to the database: '</span>, e)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h4><p>Models are defined with <code>Conn.define(&#39;name&#39;, {attributes}, {options})</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> User = Conn.define(<span class="string">'user'</span>, &#123;</div><div class="line">  <span class="attr">firstName</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.STRING,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">lastName</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.STRING,</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// force: true will drop the table if it already exists</span></div><div class="line">User.sync(&#123; <span class="attr">force</span>: <span class="literal">true</span> &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// Table created</span></div><div class="line">  <span class="keyword">return</span> User.create(&#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'John'</span>,</div><div class="line">    <span class="attr">lastName</span>: <span class="string">'Hank'</span>,</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">User.findAll().then(<span class="function"><span class="params">users</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(users)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Application-wide-model-options"><a href="#Application-wide-model-options" class="headerlink" title="Application wide model options"></a>Application wide model options</h4><p>The Sequelize constructor takes a <code>define</code> option which will be used as the default options for all defined models.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Conn = <span class="keyword">new</span> Sequelize(<span class="string">'connectionUri'</span>, &#123;</div><div class="line">  <span class="attr">define</span>: &#123;</div><div class="line">    <span class="attr">timestamps</span>: <span class="literal">false</span>, <span class="comment">// true by default</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> User = Conn.define(<span class="string">'user'</span>, &#123;&#125;) <span class="comment">// timestamps is false by default</span></div><div class="line"><span class="keyword">const</span> Post = Conn.define(<span class="string">'post'</span>, &#123;&#125;, &#123;</div><div class="line">  <span class="attr">timestamps</span>: <span class="literal">true</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h4><p>Sequelize uses promises to control async control-flow.</p>
<p>Basically, a promise represents a value which will be present at some point.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">user = <span class="keyword">await</span> User.fineOne()</div><div class="line"><span class="built_in">console</span>.log(user)</div></pre></td></tr></table></figure>
<h3 id="Model-Definition"><a href="#Model-Definition" class="headerlink" title="Model Definition"></a>Model Definition</h3><p>To define mapping between a model and a table, use the <code>define</code> method. Sequelize will then automatically add the attributes <code>createdAt</code> and <code>updatedAt</code> to it. So you will be able to know when the database entry went into the db and when it was updated the last time.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Project = Conn.define(<span class="string">'project'</span>, &#123;</div><div class="line">  <span class="attr">title</span>: Sequelize.STRING,</div><div class="line">  <span class="attr">description</span>: Sequelize.TEXT,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">const</span> Task = Conn.define(<span class="string">'tastk'</span>, &#123;</div><div class="line">  <span class="attr">title</span>: Sequelize.STRING,</div><div class="line">  <span class="attr">description</span>: Sequelize.TEXT,</div><div class="line">  <span class="attr">deadline</span>: Sequelize.DATE,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>You can also set some options on each column:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Foo = Conn.define(<span class="string">'foo'</span>, &#123;</div><div class="line">  <span class="comment">// instantiating will automatically set the flat to true if not set</span></div><div class="line">  flag: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.BOOLEAN,</div><div class="line">    <span class="attr">allowNull</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">defaultValue</span>: <span class="literal">true</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">myDate</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.DATE,</div><div class="line">    <span class="attr">defaultValue</span>: Sequelize.NOW,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">title</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.STRING,</div><div class="line">    <span class="attr">allowNull</span>: <span class="literal">false</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">uniqueOne</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.STRING,</div><div class="line">    <span class="attr">unique</span>: <span class="string">'compositeIndex'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">uniqueTwo</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.INTEGER,</div><div class="line">    <span class="attr">unique</span>: <span class="string">'compositeIndex'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">foo</span>: &#123;</div><div class="line">    <span class="attr">type</span>: Sequelize.STRING,</div><div class="line">    <span class="attr">validate</span>: &#123;</div><div class="line">      <span class="attr">isEmail</span>: <span class="literal">true</span>,</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p>You can also influence the way Sequelize hadnles your column names:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Bar = Conn.define(<span class="string">'bar'</span>, &#123;</div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">&#125;, &#123;</div><div class="line">  <span class="comment">// don't add the timestamp attributes(updatedAt, createdAt)</span></div><div class="line">  timestamps: <span class="literal">false</span>,</div><div class="line">  <span class="comment">// don't delete database entries but set the newly added attribute deletedAt to the current data(when deletion was done)</span></div><div class="line">  paranoid: <span class="literal">true</span>,</div><div class="line">  <span class="comment">// don't use camelcase for automatically added attributes but underscore style so updatedAt will be udpated_at</span></div><div class="line">  underscore: <span class="literal">true</span>,</div><div class="line">  <span class="comment">// disable the modification of table names; by default, sequelize will automatically transform all passes model names(first parameter of define) into plural. If you don't want that, set the following</span></div><div class="line">  freezeTableName: <span class="literal">true</span>,</div><div class="line">  <span class="comment">// define the table's name</span></div><div class="line">  tableName: <span class="string">'my_very_custom_table_name'</span>,</div><div class="line">  <span class="comment">// Enable optimistic locking. When enabled, sequelize will add a version count attribute to the model and throw an OptimisticLockingError error when stale instances are saved.</span></div><div class="line">  version: <span class="literal">true</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Import"><a href="#Import" class="headerlink" title="Import"></a>Import</h3><p>You can also store your model definitions in a single file using the <code>import</code> method. The returned object is exactly the same as defined in the imported file’s function.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// in your server file</span></div><div class="line"><span class="keyword">const</span> Project = Conn.import(__dirname, <span class="string">"/path/to/models/project"</span>)</div><div class="line"></div><div class="line"><span class="comment">// The model definition file</span></div><div class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">Conn, DataType</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> Conn.define(<span class="string">'project'</span>, &#123;</div><div class="line">    <span class="attr">name</span>: DataTypes.STRING,</div><div class="line">    <span class="attr">description</span>: DataTypes.TEXT,</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The <code>import</code> method can also accept a callback as an argument</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Conn.import(<span class="string">'project'</span>, (Conn, DataTypes) =&gt; &#123;</div><div class="line">  <span class="keyword">return</span> Conn.define(<span class="string">'project'</span>, &#123;</div><div class="line">    <span class="attr">name</span>: DataTypes.STRING,</div><div class="line">    <span class="attr">description</span>: DataTypes.TEXT,</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Database-Synchronization"><a href="#Database-Synchronization" class="headerlink" title="Database Synchronization"></a>Database Synchronization</h3><p>When starting a new project you won’t have a database structure and using sequelize you won’t need to. Just specify your model structures and let the library do the rest. Currently supported is the creation and deletion of tables.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Create the Tables</span></div><div class="line">Project.sync()</div><div class="line">Task.sync()</div><div class="line"></div><div class="line"><span class="comment">// Force the Creation</span></div><div class="line">Project.sync(&#123; <span class="attr">force</span>: <span class="literal">true</span> &#125;) <span class="comment">// this will drop the table first and re-create it afterwards</span></div><div class="line"></div><div class="line"><span class="comment">// Drop the Tables</span></div><div class="line">Project.drop()</div><div class="line">Task.drop()</div><div class="line"></div><div class="line"><span class="comment">// Event Handling</span></div><div class="line">Project.[sync|drop]().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ok ... everything is nice</span></div><div class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ooh, did you enter wrong database credentials</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Because synchronizing and dropping all of your tables might be a lot of lines to write, you can also let Sequelize do the work for you:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sync all models that aren't already in the database</span></div><div class="line">Conn.sync()</div><div class="line"></div><div class="line"><span class="comment">// Force sync all models</span></div><div class="line">Conn.sync(&#123; <span class="attr">force</span>: <span class="literal">true</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// Drop all Tables</span></div><div class="line">Conn.drop()</div><div class="line"></div><div class="line"><span class="comment">// Emit Handling</span></div><div class="line">Conn.[sync|drop]().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Expansion-of-models"><a href="#Expansion-of-models" class="headerlink" title="Expansion of models"></a>Expansion of models</h3><p>Sequelize Models are ES6 classes, you can very easily add custom instance or class level methods.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> User = Conn.define(<span class="string">'user'</span>, &#123;</div><div class="line">  <span class="attr">firstName</span>: Sequelize.STRING,</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// add a class level method</span></div><div class="line">User.classLevelMethod = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  retunr <span class="string">'foo'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// add an instance level method</span></div><div class="line">User.prototype.instanceLevelMethod = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  retunr <span class="string">'bar'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Indexes"><a href="#Indexes" class="headerlink" title="Indexes"></a>Indexes</h3><p>Sequelize supports adding indexes to the model definition which will be created during <code>Model.sync()</code> or <code>Conn.sync()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">Conn.define(<span class="string">'user'</span>, &#123;&#125;, &#123;</div><div class="line">  <span class="attr">indexes</span>: [</div><div class="line">    <span class="comment">// Create a unique index on poem</span></div><div class="line">    &#123;</div><div class="line">      <span class="attr">unique</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">fields</span>: [<span class="string">'poen'</span>]</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// create a gin index on data with the jsonb_path_ops operator</span></div><div class="line">    &#123;</div><div class="line">      <span class="attr">fields</span>: [<span class="string">'data'</span>],</div><div class="line">      <span class="attr">using</span>: <span class="string">'gin'</span>,</div><div class="line">      <span class="attr">operator</span>: <span class="string">'jsonb_path_ops'</span>,</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// by default index name will be [table]_[fields]</span></div><div class="line">    <span class="comment">// create a multi column partial index</span></div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'public_by_author'</span>,</div><div class="line">      <span class="attr">fields</span>: [<span class="string">'author'</span>, <span class="string">'status'</span>],</div><div class="line">      <span class="attr">where</span>: &#123;</div><div class="line">        <span class="attr">status</span>: <span class="string">'public'</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Model-Usage"><a href="#Model-Usage" class="headerlink" title="Model Usage"></a>Model Usage</h3><h4 id="Data-Retrieval-Finders"><a href="#Data-Retrieval-Finders" class="headerlink" title="Data Retrieval / Finders"></a>Data Retrieval / Finders</h4><p>Finder methods are intended to query data from the database. They do not return plain objects but instead return <em>model instances</em>. Because finder methods return model instances you can call any model instance member.</p>
<h4 id="find-search-for-one-specific-element-in-the-database"><a href="#find-search-for-one-specific-element-in-the-database" class="headerlink" title="find - search for one specific element in the database"></a>find - search for one specific element in the database</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// search for known id</span></div><div class="line">Project.findById(<span class="number">123</span>).then(<span class="function"><span class="params">project</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// project will be an instance of Project and store the content of the table entry with id 123. If such an entry is not defined you will get null</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// search for attributes</span></div><div class="line">Project.findOne(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">title</span>: <span class="string">'aProject'</span></div><div class="line">  &#125;</div><div class="line">&#125;).then(<span class="function"><span class="params">project</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// project will be the first entry of the Projects table with the title 'aProject' || null</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">Project.findONe(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">title</span>: <span class="string">'aProject'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">attributes</span>: [<span class="string">'id'</span>, [<span class="string">'name'</span>, <span class="string">'title'</span>]]</div><div class="line">&#125;).then(<span class="function"><span class="params">project</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// project will be the first entry of the Projects table with the title 'aProject' || null</span></div><div class="line">  <span class="comment">// project.title will contain the name of the project</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="findOrCreate-Search-for-a-specific-element-or-create-it-if-not-available"><a href="#findOrCreate-Search-for-a-specific-element-or-create-it-if-not-available" class="headerlink" title="findOrCreate - Search for a specific element or create it if not available"></a>findOrCreate - Search for a specific element or create it if not available</h4><p>The method <code>findOrCreate</code> can be used to check if a certain element already exists in the database. If that is the case the method will result in a respective instance, if the element does not yet exists, it will be created.</p>
<p>Let’s assume we have an empty database with a <code>User</code> model which has a <code>username</code> and a <code>job</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">User.findOrCreate(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">username</span>: <span class="string">'sdepold'</span>,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">defaults</span>: &#123;</div><div class="line">    <span class="attr">job</span>: <span class="string">"Technical Lead JS"</span>,</div><div class="line">  &#125;</div><div class="line">&#125;).spread(<span class="function">(<span class="params">user, created</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(user.get(&#123;</div><div class="line">    <span class="attr">plain</span>: <span class="literal">true</span>,</div><div class="line">  &#125;))</div><div class="line">  <span class="comment">/**</span></div><div class="line">   * findOrCreate returns an array containing the object that was found or created and a boolean will be true if a new object was created, and false if not</div><div class="line">    [ &#123;</div><div class="line">      username: 'sdepold',</div><div class="line">      job: 'Technical Lead JavaScript',</div><div class="line">      id: 1,</div><div class="line">      createdAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET),</div><div class="line">      updatedAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET)</div><div class="line">    &#125;,</div><div class="line">    true ]</div><div class="line">   */</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>The code created a new instance.</p>
<h4 id="fineAndCountAll-Search-for-multiple-elements-in-the-database-returns-both-data-and-total-count"><a href="#fineAndCountAll-Search-for-multiple-elements-in-the-database-returns-both-data-and-total-count" class="headerlink" title="fineAndCountAll - Search for multiple elements in the database, returns both data and total count"></a>fineAndCountAll - Search for multiple elements in the database, returns both data and total count</h4><h4 id="findAll-Search-for-multiple-elements-in-the-database"><a href="#findAll-Search-for-multiple-elements-in-the-database" class="headerlink" title="findAll - Search for multiple elements in the database"></a>findAll - Search for multiple elements in the database</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// find multiple entries</span></div><div class="line">Project.findAll().then(<span class="function"><span class="params">projects</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// projects will be an array of all Project instances</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// also possible</span></div><div class="line">Project.all().then(<span class="function"><span class="params">projects</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// projects will be an array of all Project instances</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// search for specific attribute - hash usage</span></div><div class="line">Project.findAll(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'A Project'</span>,</div><div class="line">  &#125;</div><div class="line">&#125;).then(<span class="function"><span class="params">projects</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// search within a specific range</span></div><div class="line">Project.findAll(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">id</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">  &#125;</div><div class="line">&#125;).then(<span class="function"><span class="params">projects</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// return instances with id 1, 2, 3</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Complex-filtering-OR-NOT-queries"><a href="#Complex-filtering-OR-NOT-queries" class="headerlink" title="Complex filtering /OR/NOT queries"></a>Complex filtering /OR/NOT queries</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Project.findAll(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'a project'</span>,</div><div class="line">    <span class="attr">$or</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: &#123; <span class="attr">$gt</span>: <span class="number">10</span> &#125;&#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">Project.findAll(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'a project'</span>,</div><div class="line">    <span class="attr">id</span>: &#123;</div><div class="line">      <span class="attr">$or</span>: [</div><div class="line">        [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">        &#123; <span class="attr">$gt</span>: <span class="number">10</span> &#125;,</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Both pieces of code will generate the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SELECT * FROM `Projects` WHERE (</div><div class="line">  `Projects`.`name`=`a project`</div><div class="line">  AND (`Projects`.`id` IN (1,2,3) OR `Projects`.`id`&gt;10)</div><div class="line">  )</div></pre></td></tr></table></figure>
<h4 id="Manipulating-the-database-with-limit-offset-order-and-group"><a href="#Manipulating-the-database-with-limit-offset-order-and-group" class="headerlink" title="Manipulating the database with limit, offset, order and group"></a>Manipulating the database with limit, offset, order and group</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// limit the results of the query</span></div><div class="line">Project.findAll(&#123; <span class="attr">limit</span>: <span class="number">10</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// step over the first 10 elements</span></div><div class="line">Project.findAll(&#123; <span class="attr">offset</span>: <span class="number">10</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// step over the first 10 element and take 2</span></div><div class="line">Project.findAll(&#123; <span class="attr">offset</span>: <span class="number">10</span>, <span class="attr">limit</span>: <span class="number">2</span> &#125;)</div></pre></td></tr></table></figure>
<p>The syntax for grouping and ordering are equal, so below it is only explained with a single example for group, and the rest for order.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// yields ORDER BY title DESC</span></div><div class="line">Project.findAll(&#123; <span class="attr">order</span>: <span class="string">'title DESC'</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// yields GROUP BY name</span></div><div class="line">Project.findAll(&#123; <span class="attr">group</span>: <span class="string">'name'</span> &#125;)</div></pre></td></tr></table></figure>
<h4 id="Raw-queries"><a href="#Raw-queries" class="headerlink" title="Raw queries"></a>Raw queries</h4><p>Sometimes you might be expecting a massive dataset that you just want to display without manipulation. For each row you select, Sequelize creates an instance with functions for update, delete, get association etc. If you have thousands of rows, this might take some time. If you only need the raw data and don’t want to update anything, you can do like this to get the raw data.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Are you expecting a massive dataset from the DB, and don't want to spend the time building DAOs for each entry? You can pass an extra query option to get the raw data insetead:</span></div><div class="line">Project.findAll(&#123;</div><div class="line">  <span class="attr">where</span>: &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">raw</span>: <span class="literal">true</span>,</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Queries"><a href="#Queries" class="headerlink" title="Queries"></a>Queries</h3><h4 id="Attributes"><a href="#Attributes" class="headerlink" title="Attributes"></a>Attributes</h4><p>To select only some attributes, you can use the <code>attributes</code> option. Most often, you pass an array:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Model.findAll(&#123;</div><div class="line">  <span class="attr">attributes</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>]</div><div class="line">&#125;)</div><div class="line"><span class="comment">// Equal to</span></div><div class="line">SELECT foo, bar ...</div></pre></td></tr></table></figure>
<h4 id="Where"><a href="#Where" class="headerlink" title="Where"></a>Where</h4><p>Whether you are querying with <code>findAll</code>/<code>find</code> or doing bulk <code>updates</code>/<code>destroy</code> you can pass a <code>where</code> object to filte the query.</p>
<p><code>where</code> generally takes an object from attribute:value pairs, where value can be primitive for equality matches or keyed objects for other operators.</p>
<p>It’s also possible to generate complex <code>AND</code>/<code>OR</code> conditions by nesting of <code>$or</code> and <code>$and</code></p>
<h4 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h4>
    

    
</div>


                

                <!-- Post Comments -->
                
                    







                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/08/09/History-API/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/08/07/Build-GraphQL-Server-with-Express/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="images/avatar.gif" alt="Chen Yu's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        keithwhisper@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/08/">August 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">July 2017<span class="sidebar_archives-count">19</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">June 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">May 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">April 2017<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">March 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">January 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">December 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">November 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">October 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">September 2016<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">August 2016<span class="sidebar_archives-count">30</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">July 2016<span class="sidebar_archives-count">43</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">June 2016<span class="sidebar_archives-count">25</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">May 2016<span class="sidebar_archives-count">24</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                Categories
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Soup/">Soup<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Uncategorized/">Uncategorized<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/github/">github<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/github/note/">note<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/note/">note<span class="sidebar_archives-count">141</span></a></li><li><a class="sidebar_archives-link" href="/categories/note/workNote/">workNote<span class="sidebar_archives-count">19</span></a></li><li><a class="sidebar_archives-link" href="/categories/workNote/">workNote<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                Number of articles
                <span class="sidebar-badge">225</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Theme - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/keithwhisper" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.svg);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/Keith-CY" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.svg);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    
        <a href="https://www.linkedin.com/in/%E5%AE%87-%E9%99%88-644b61ba/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-linkedin.svg);">
                <span class="visuallyhidden">LinkedIn</span>
            </button><!--
     --></a>
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;EzCook
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->

    <script src="/js/lazyload.min.js"></script>
    <script src="/js/js.min.js"></script>



    <script src="/js/nprogress.js"></script>


<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script src="/js/smoothscroll.js"></script>
    














<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script>
    <!-- Offer LazyLoad -->
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    <!-- Start Queue -->
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

                </main>
            </div>
        </body>
    
</html>
