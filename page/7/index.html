<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8">
<title>EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>


    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="EzCook" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-14T06:11:07.000Z">2017-06-14</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 910 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/14/git-merge-and-rebase/">Git Merge and Rebase</a>
            
        </h1>
        <div class="content">
            <h1 id="Conceptual-Overview"><a href="#Conceptual-Overview" class="headerlink" title="Conceptual Overview"></a>Conceptual Overview</h1><p>The first thing to understand about <code>git rebase</code> is that it solves the same problem as <code>git merge</code>. Both of these commands are designed to integrate changes from one branch into another branch – they just do it in very different ways.</p>
<p>Consider what happens when you start working on a new feature in a dedicated branch, then another team member updates the <code>master</code> branch with new commits. The results in a forked history which should be familiar to anyone who has used Git as a collaboration tool.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:01b0b04e-64f3-4659-af21-c4d86bc7cb0b/01.svg?cdnVersion=ey" alt=""></p>
<p>Now, let’s say that the new commits in <code>master</code> are relevant to the feature that you’re working on. To incorporate the new commits into your <code>feature</code> branch, you have two options: <code>mergin</code>or <code>rebasing</code>.</p>
<h1 id="The-Merge-Option"><a href="#The-Merge-Option" class="headerlink" title="The Merge Option"></a>The Merge Option</h1><p>The easiest option is to merge the <code>master</code> branch into the <code>feature</code> branch using something like the following:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git merge master</span><br></pre></td></tr></table></figure>
<p>Or you can condense this to a one-liner:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge master feature</span><br></pre></td></tr></table></figure>
<p>This creates a new <code>merge commit</code> in the <code>feature</code> branch that ties together the histories of the both branches, giving you a branch structure that looks like this:</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:e229fef6-2c2f-4a4f-b270-e1e1baa94055/02.svg?cdnVersion=ey" alt=""></p>
<p>Merging is nice because it’s a <code>non-destructive</code> operation. The existing branches are not changed in any way. This avoids all of the potential pitfalls of rebasing.</p>
<p>On the other hand, this also means that the <code>feature</code> branch will have an extraneous merge commit every time you need to incorporate upstream changes. If <code>master</code> is very active, this can pollute your <code>feature</code> branch history quite a bit. While it’s possible to migrate this issue with advanced <code>git log</code> options, it can make it hard to other developers to understand the history of the project.</p>
<h1 id="The-Rebase-Option"><a href="#The-Rebase-Option" class="headerlink" title="The Rebase Option"></a>The Rebase Option</h1><p>As an alternative to merge, you can rebase the <code>feature</code> branch onto <code>master</code> branch using the following commands:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git rebase master</span><br></pre></td></tr></table></figure>
<p>This moves the entire <code>feature</code> branch to begin on the top of the <code>master</code> branch, effectively incorporating all of the new commits in <code>master</code>. But, instead of using a merge commit, rebasing <code>re-writes</code> the project history by creating brand new commits for each commit in the original branch.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:5b153a22-38be-40d0-aec8-5f2fffc771e5/03.svg?cdnVersion=ey" alt=""></p>
<p>The major benefit of rebasing is that you get a much cleaner project history. First, it eliminates the unnecessary merge commits required by <code>git merge</code>. Second, as you can see in the above diagram, rebasing also results in a perfectly linear project history – you can follow the top of <code>feature</code> all the way to the beginning of the project without any forks. This makes it easier to navigate your project with commands like <code>git log</code>.</p>
<h1 id="Interactive-Rebasing"><a href="#Interactive-Rebasing" class="headerlink" title="Interactive Rebasing"></a>Interactive Rebasing</h1><p>Interactive rebasing gives you the opportunity to alter commits as they are moved to the new branch. This is even more powerful than an automated rebase, since it offers complete control over the branch’s commit history. Typically, this is used to clean up a messy history before merging a feature branch into <code>master</code>.</p>
<p>To begin an interactive rebasing session, pass the <code>-i</code> option to the <code>git rebase</code> command.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git rebase -i master</span><br></pre></td></tr></table></figure>
<p>This will open a text editor listing all of the commits that are about to be moved:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pick 33d5b7a Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#1</span></span><br><span class="line">pick 9480b3d Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#2</span></span><br><span class="line">pick 5c67e61 Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#3</span></span><br></pre></td></tr></table></figure>
<p>This listing defines exactly what the branch will look like after the rebase is performed. By changing the <code>pick</code> command and/or reordering the entries, you can make the branch’s history look like whatever you want.</p>
<p>For example, if the 2nd commit fixes a small problem in the 1st commit, you can condense them into a single comit with the <code>fixup</code> command:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pick 33d5b7a Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#1</span></span><br><span class="line">fixup 9480b3d Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#2</span></span><br><span class="line">pick 5c67e61 Message <span class="hljs-keyword">for</span> commit <span class="hljs-comment">#3</span></span><br></pre></td></tr></table></figure>
<p>When you save and close the file, Git will perform the rebase according to your instructions, resulting in project history that looks like the following:</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:fe6942b4-7a60-4464-9181-b67e59e50788/04.svg?cdnVersion=ey" alt=""></p>
<p>Eliminating insignificant commits like this makes your feature’s history much easier to understand. <strong>This is something that <code>git merge</code> simply cannot do</strong>.</p>
<h1 id="The-Golden-Rule-of-Rebasing"><a href="#The-Golden-Rule-of-Rebasing" class="headerlink" title="The Golden Rule of Rebasing"></a>The Golden Rule of Rebasing</h1><p>The Golden Rule of <code>git rebase</code> is to never use it on <em>public</em> branches.</p>
<p>For example, think about what would happen if you rebased <code>master</code> onto your <code>feature</code> branch.</p>
<p><img src="https://wac-cdn-a.atlassian.com/dam/jcr:1d22f018-b2c7-4096-9db1-c54940cf4f4e/05.svg?cdnVersion=ey" alt=""></p>
<p>The rebase moves all of the commits in <code>master</code> onto the tip of <code>feature</code>. The problem is that only happened in <em>your</em> repo. All of the other developers are still working with the origin master. Since rebasing results in brand new commits, Git will think that your <code>master</code> branch’s history has diverged from everybody else’s.</p>
<p>The only way to synchronize the two <code>master</code> branches is to merge them back together, resulting in an extra merge commit <strong>and</strong> two sets of commits that contain the same changes.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-12T08:52:22.000Z">2017-06-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 372 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/12/Type-Compatibility-in-TypeScript/">Type Compatibility in TypeScript</a>
            
        </h1>
        <div class="content">
            <p>Type Compaibility in TypeScript is based on <strong>Structural Subtyping</strong>. Structural Typing is a way of relating types based solely on their members. This is in contrast with nominal typing. Consider the following code:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface Named &#123;</span><br><span class="line">  name: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;</span><br><span class="line">  name: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">let</span> p: Named</span><br><span class="line"><span class="hljs-comment">// OK, because of structural typing</span></span><br><span class="line">p = <span class="hljs-keyword">new</span> Person()</span><br></pre></td></tr></table></figure>
<p>In nominally-typed language like C# or Java, the equivalnet code would be error because the <code>Person</code> class does not explicitly describe itself as being an implementor of the <code>Named</code> interface.</p>
<p>TypeScript’s structural type system was designed based on how JavaScript code is typically written. Because JavaScript widely uses anonymous objects like function expressions and object literals, it’s much more natural to represent the kinds of relationship found in JavaScript libraries with a structural type system instead of a nominal one.</p>
<p>The basic rule for TypeScript’s structural type system is the <code>x</code> is compatible with <code>y</code> if <code>y</code> has at least the same members as <code>x</code>.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface Named &#123;</span><br><span class="line">  name: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">let</span> x: Named;</span><br><span class="line"><span class="hljs-comment">// y's inferred type is &#123; name: string, location: string &#125;</span></span><br><span class="line"><span class="hljs-keyword">let</span> y = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">location</span>: <span class="hljs-string">'Seattle'</span> &#125;</span><br><span class="line">x = y</span><br></pre></td></tr></table></figure>
<p>To check whether <code>y</code> can be assigned to <code>x</code>, the compiler checks each property of <code>x</code> to find a corresponding compatible property in <code>y</code>. In this case, <code>y</code> must have a member called <code>name</code> that is a string, so the assignment is allowed.</p>
<p>The same rule for assignment is used when checking function call arguments</p>
<blockquote>
<p>The Type Compatibility in Variable Assignment and Function Arguments.</p>
</blockquote>
<h1 id="Comparing-Two-Functions"><a href="#Comparing-Two-Functions" class="headerlink" title="Comparing Two Functions"></a>Comparing Two Functions</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> x = <span class="hljs-function">(<span class="hljs-params">a: number</span>) =&gt;</span> <span class="hljs-number">0</span></span><br><span class="line"><span class="hljs-keyword">let</span> y = <span class="hljs-function">(<span class="hljs-params">b: number, s: string</span>) =&gt;</span> <span class="hljs-number">0</span></span><br><span class="line"></span><br><span class="line">y = x <span class="hljs-comment">// OK</span></span><br><span class="line">x = y <span class="hljs-comment">// Error</span></span><br></pre></td></tr></table></figure>
<p>The check if <code>x</code> is assignable to <code>y</code>, we first look at the parameter list. Each parameter in <code>x</code> must have a corresponding parameter in <code>y</code> with a compabile type.</p>
<p>So <code>x</code> is assignable to <code>y</code>, but <code>y</code> is not assignable to <code>x</code></p>
<p>Now let’s look at how return types are treated, using two functions that differs only by their return type:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> x = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> &#125;)</span><br><span class="line"><span class="hljs-keyword">let</span> y = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">location</span>: <span class="hljs-string">'Seattle'</span> &#125;)</span><br><span class="line"></span><br><span class="line">x = y <span class="hljs-comment">// OK</span></span><br><span class="line">y = x <span class="hljs-comment">// Error</span></span><br></pre></td></tr></table></figure>
<p>The type system enforces that the source function’s return type be a subtype of the target type’s return type.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-09T03:09:21.000Z">2017-06-09</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    24 minutes read (About 3629 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/09/mannual-of-ownership-in-rust/">Mannual of Ownership in Rust </a>
            
        </h1>
        <div class="content">
            <p>Ownership is Rust’s most unique feature, and it enables Rust to make memory safety guarantees without needing a garbage collector. Therefore, it’s important to understand how ownership works in Rust. In this chapter we’ll talk about ownership as well as several related features: borrowing, slices, and how Rust lays data out in memory.</p>
<h1 id="What-is-Ownership"><a href="#What-is-Ownership" class="headerlink" title="What is Ownership"></a>What is Ownership</h1><p>Rust’s central feature is <em>ownership</em>, although the feature is staightforward to explain, it has deep implications of the rest of the language.</p>
<p>All programs have to manage the way they use a computer’s memory while running. Some languages ahve garbage collecion that constantly looks for no longer used memory as the program runs. In other languages, the programmer must explicitly allocate and free the memory. Rust uses a third approach: <strong>memory is managed through a system of ownership with a set of rules that the compiler checks at compile time.</strong> No run-time costs are iccured for any of the ownership features.</p>
<p>Because ownership is a new concept for many programmers, it does take some time to get used to. The good news is that the more experienced you become with Rust and the rules of the ownership system, the more you’ll be able to naturally develop code that is safe and efficient.</p>
<h1 id="Ownership-Rules"><a href="#Ownership-Rules" class="headerlink" title="Ownership Rules"></a>Ownership Rules</h1><p>First, let’s take a look at the ownership rules.</p>
<blockquote>
<ol>
<li>Each Value in Rust has a variable that’s called its <em>owner</em>.</li>
</ol>
</blockquote>
<blockquote>
<ol>
<li>There can only be one owner at a time.</li>
</ol>
</blockquote>
<blockquote>
<ol>
<li>When the owner goes out of scope, the value will be dropped.</li>
</ol>
</blockquote>
<h1 id="Variable-Scope"><a href="#Variable-Scope" class="headerlink" title="Variable Scope"></a>Variable Scope</h1><p>A scope is the range within a program for which an item is valid.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> s = <span class="hljs-string">"hello"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The variable <code>s</code> refers to a string literal, where the value of the string is hardcoded into the text of our program. The variable is valid from the point at which it’s declared until the end of the current <em>scope</em>.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;                       <span class="hljs-comment">// s is not valid here</span></span><br><span class="line">  <span class="hljs-keyword">let</span> s = <span class="hljs-string">"hello"</span>;      <span class="hljs-comment">// s is valid here</span></span><br><span class="line">&#125;                       <span class="hljs-comment">// the scope is over, and s is no longer valid.</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>When <code>s</code> comes <em>into scope</em> it is valid</p>
</li>
<li><p>It remains so until it goes <em>out of scope</em></p>
</li>
</ul>
<p>At this point, the relationship between scopes and the valid variables are valid is similar to other programming languages. Now we’ll build on top of this understanding by introducing the <code>String</code> type.</p>
<h1 id="The-String-Type"><a href="#The-String-Type" class="headerlink" title="The String Type"></a>The String Type</h1><p>To illustrate the rules of ownership, we need a data type that is complex.</p>
<p>We’ll use <code>String</code> as the example here and concentrate on the parts of <code>String</code> that relate to ownership. These aspects also apply to other complex data types provided by the standard library and that you create.</p>
<p>We’ve already seen string literals, where a string value is hardcoded into our program. String literals are conveient, but they aren’t always suitable for every situation in which you want to use text. One reason is that they’re immutable. Another is that not every string value can be known when we write our code. For these situations, Rust has a second string type, <code>String</code>. This type is allocated on the heap and as such is able to store an amount of text that is unknown to us at compile time. You can create a <code>String</code> from a string literal using the <code>from</code> function, like so:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"hello"</span>)</span><br></pre></td></tr></table></figure>
<p>The double colon(<code>::</code>) is an operator that allows us to namespace this particular <code>from</code> function under the <code>String</code> type rather than using some sort of name like <code>string_from</code>.</p>
<p>This kind of string <em>can</em> be mutated:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-symbol">'Hello</span>')</span><br><span class="line">s.push_str(<span class="hljs-string">", world!"</span>)</span><br><span class="line"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"&#123;&#125;"</span>, s);</span><br></pre></td></tr></table></figure>
<p>So why can <code>String</code> be mutated but literals cannot.</p>
<h1 id="Memory-and-Allocation"><a href="#Memory-and-Allocation" class="headerlink" title="Memory and Allocation"></a>Memory and Allocation</h1><p>In the case of a string literal, <em>we know the contents at compile</em> so the text is hardcoded directly in to the final executable, making string literals fast and efficient. But these properties only come from its immutability. Unfortunately, <em>we can’t put a blob of memory into the binary for each piece of text whose size is unknown at compile time</em> and whose size might change while running the program.</p>
<p>With the <code>String</code> type, in order to support a mutable, growable piece of text, we need to allocate an amount of memory on the heap, unknown at compile time, to hold the contents. This means:</p>
<ul>
<li><p>The memory must be requested from the operating system at runtime.</p>
</li>
<li><p>We need a way of returning this memory to the operating system when we’re done with our <code>String</code></p>
</li>
</ul>
<p>That first part is done by us: when we call <code>String::from</code>, its implementation requests the memory if needs. This is pretty much universal in programming languages.</p>
<p>However, the second part is different. In languages with a <code>garbage collector(GC)</code>, the GC keeps track and cleans up memory that isn’t being used anymore, and we, as the programmer, don’t need to think about it. Without a GC, it’s the programmer’s responsibility to identify when memory is no longer being used and call code to explicitly return it, just as we did to request it. Doing this correctly has historically been a difficult programming problem. If we forget, we’ll waste memory. If we do it too early, we’ll have an invalid vairable. If we do it twice, that’s a bug too. We need to pair exactly one <code>allocate</code> with exact one <code>free</code></p>
<p>Rust takes a different path: the memory is automatically returned once the variable that owns it goes out of scope.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Helloe"</span>); <span class="hljs-comment">// s is valid from this point</span></span><br><span class="line"></span><br><span class="line">&#125;  <span class="hljs-comment">// the scope is over</span></span><br></pre></td></tr></table></figure>
<p>These is a natural point at which we can return the memory our <code>String</code> needs to operating system: when <code>s</code> goes out of scope. When a variables goes out of scope, Rust calls a special function for us. This function is called <code>drop</code>, and it’s where the author of <code>String</code> can put the code to return the memory. Rust calls <code>drop</code> automatically at the closing <code>}</code>.</p>
<blockquote>
<p>Note: In C++, this pattern of deallocating resources at the end of an item’s lifetime is sometimes called <em>Resource Acquisition Is Initialization(RAII)</em>. The <code>drop</code> function in Rust will be familiar to you if you’ve used RAII patterns.</p>
</blockquote>
<p>This patterns has profound impact on the way Rust code is written. It may seem simple right now, but the behavior of code can be unexpected in more complicated situations when we want to have multiple variables use the data we’ve allocated ont the heap.</p>
<h1 id="Ways-Variables-and-Data-Interact-Move"><a href="#Ways-Variables-and-Data-Interact-Move" class="headerlink" title="Ways Variables and Data Interact: Move"></a>Ways Variables and Data Interact: Move</h1><p>Multiple variables can interact with the same data in different ways in Rust. Let’s look at an example using an integer.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;</span><br><span class="line"><span class="hljs-keyword">let</span> y = x;</span><br></pre></td></tr></table></figure>
<p>Here we got two independent variables <code>x</code> and <code>y</code>, this is because integers are simple values with a known, fixed size, and two <code>5</code> are pushed onto the stack.</p>
<p>Now let’s look at the <code>String</code> version.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s1 = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>);</span><br><span class="line"><span class="hljs-keyword">let</span> s2 = s1;</span><br></pre></td></tr></table></figure>
<p>This looks very similar to the previous code, so we might assume that the way it works would be the same: that is, the second line would make a copy of the value in <code>s1</code> and bind it to <code>s2</code>. But this isn’t quite what happens.</p>
<p>To explain this more thoroughly, let’s look at what <code>String</code> looks like under the covers in the Figure.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-01.svg" alt=""></p>
<p>A <code>String</code> is made up of three parts, shown on the left: a pointer to the memory that holds the contents of the string, a length, and a capacity. This group of data is stored on the stack. On the right is the memory on the heap that holds the contents.</p>
<p>The length is how much memory, in bytes, the contents of the <code>String</code> is currently using. The capacity is the total amount of memory, in bytes, that the <code>String</code> has received from the operating system. The difference between length and capacity matters, but not in this context, so far now, it’s fine to ignore the capacity.</p>
<p>When we assign <code>s1</code> to <code>s2</code>, the <code>String</code> data is copied, meaning we copy the pointer, the length and the capacity that are on the stack. We do not copy the data on the heap that the pointer refers to. In other words, the data representation in memory looks like the figure following.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-02.svg" alt=""></p>
<p>Eariler, we said that when a variable goes out of scope, Rust automatically calls the <code>drop</code> function and cleans up the heap memory for the variable. But the fact is that both data pointers pointing to the same location. This is a problem: when <code>s2</code> and <code>s1</code> go out of scope, they will both try to free the same memory. This is known as a <em>double free</em> error. Freeing memory twice can lead to memory corruption, which can potentially lead to security vulnerabilities.</p>
<p>To ensure memory safety, there’s one more detail to what happens in this situation in Rust. Instead of trying to copy the allocated memory, Rust considers <code>s1</code> to no longer be valid and therefore, Rust doesn’t need to free anything when <code>s1</code> goes out of scope. Check out what happens when you try to use <code>s1</code> after <code>s2</code> is created.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s1 = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"hello"</span>);</span><br><span class="line"><span class="hljs-keyword">let</span> s2 = s1;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"&#123;&#125;"</span>, s1);</span><br></pre></td></tr></table></figure>
<p>You’ll get an error like this because Rust prevents you from using the invalidated reference:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error[E0382]: use of moved value: `s1`</span><br><span class="line"> --&gt; src/main.rs:4:27</span><br><span class="line">  |</span><br><span class="line">3 |  <span class="hljs-built_in">let</span> s2 = s1;</span><br><span class="line">  |     -- value moved here</span><br><span class="line">4 |  println!(<span class="hljs-string">"&#123;&#125;"</span>, s1);</span><br><span class="line">  |                 ^^ value used here after move</span><br><span class="line">  |</span><br><span class="line">  = note: move occurs because `s1` has <span class="hljs-built_in">type</span> `std::string::String`,</span><br><span class="line"><span class="hljs-built_in">which</span> does not implement the `Copy` trait</span><br></pre></td></tr></table></figure>
<p>This action in Rust, similar to <code>shallow copy</code>, it copy pointer, length and capacity in stack, but Rust also invalidates the first variable.</p>
<p>We call it <code>move</code>.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-04.svg" alt=""></p>
<p><code>s1</code> has been invalidated.</p>
<p>That solves our problem, with only <code>s2</code> valid, when it goes out of scope, it alone will freee the memory, and we’re done.</p>
<p>In addition, there’s a design choice that’s implied by this: Rust will never automatically create ‘deep’ copies of your data. Therefore, any <em>automatic</em> copying can be assumed to be inexpensive in terms of runtime performance.</p>
<h1 id="Ways-Variables-and-Data-Interact-Clone"><a href="#Ways-Variables-and-Data-Interact-Clone" class="headerlink" title="Ways Variables and Data Interact: Clone"></a>Ways Variables and Data Interact: Clone</h1><p>If we do want to deeply copy the heap data of the <code>String</code>, not just the stack data, we can use a common method called <code>clone</code>.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s1 = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>);</span><br><span class="line"><span class="hljs-keyword">let</span> s2 = s1.clone();</span><br><span class="line"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"s1 = &#123;&#125;, s2 = &#123;&#125;"</span>, s1, s2);</span><br></pre></td></tr></table></figure>
<p>This works just fine, the heap data does get copied.</p>
<p>When you see a call to <code>clone</code>, you know that some arbitrary code is being executed and that code may be expensive. It’s a visual indicator that something different is going on.</p>
<h1 id="Stack-Only-Data-Copy"><a href="#Stack-Only-Data-Copy" class="headerlink" title="Stack-Only Data: Copy"></a>Stack-Only Data: Copy</h1><p>There’s another wrinkle we haven’t talked about yet. This code using integers.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;</span><br><span class="line"><span class="hljs-keyword">let</span> y = x;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">println!</span>(<span class="hljs-string">"x = &#123;&#125;, y = &#123;&#125;"</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>This code runs correctly because those types like integers that have a <strong>known size</strong> at compile time are stored entirely on the stack, so copied of the actual values are quick to make. That means there’s no reason we would want to prevent <code>x</code> from being valid after we created the variable <code>y</code>. In other words, there’s no difference between deep and shallow copying here, so calling <code>clone</code> wouldn’t do anything differently from the usual shallow copying and we can leave it out.</p>
<p>Rust has a special annotation called the <code>Copy</code> trait that we can place on types like integers that are stored on stack.</p>
<p>If a type has the <code>Copy</code> trait, an older variable is still usable after the assignment. Rust won’t let us annotate a type with the <code>Copy</code> trait if the type, or any of its parts, has implemented the <code>Drop</code> trait. If the type needs something special to happen when the value goes out of scope and we add the <code>Copy</code> annotation to that type, we’ll get a compile time error.</p>
<p>As a general rule, any group of simple scalar values can be <code>Copy</code>, and nothing that requires allocation or is some form of resource is <code>Copy</code>. Here are some of the types that are <code>Copy</code>:</p>
<ul>
<li><p>All the integer types</p>
</li>
<li><p>The boolean type</p>
</li>
<li><p>All the floating point types</p>
</li>
<li><p>Tuples, but only if they contain types a also <code>Copy</code>.</p>
</li>
</ul>
<h1 id="Ownership-and-Functions"><a href="#Ownership-and-Functions" class="headerlink" title="Ownership and Functions"></a>Ownership and Functions</h1><p><strong>The semantics for passing a value to a function are similar to assigning a value to a variable.</strong> Passing a variable to a function <strong>will move or copy</strong>, just like assignment.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>); <span class="hljs-comment">// s comes into scope</span></span><br><span class="line"></span><br><span class="line">  take_ownership(s); <span class="hljs-comment">// s's value moves into the function</span></span><br><span class="line">                     <span class="hljs-comment">// s is no longer valid here</span></span><br><span class="line">  <span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;         <span class="hljs-comment">// x comes into scope</span></span><br><span class="line"></span><br><span class="line">  make_copy(x);      <span class="hljs-comment">// x would move into the function, but i32 is Copy, so it's okay to still use x afterward.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">take_ownership</span> </span>(some_string: <span class="hljs-built_in">String</span>) &#123; <span class="hljs-comment">// some_string comes into scope</span></span><br><span class="line">  <span class="hljs-built_in">println!</span>(<span class="hljs-string">"&#123;&#125;"</span>, some_string);</span><br><span class="line">&#125; <span class="hljs-comment">// here, some_string goes out of scope and `drop` is called. The backing memory is freed.</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">make_copy</span> </span>(some_integer: <span class="hljs-built_in">i32</span>) &#123; <span class="hljs-comment">//  some_integer comes into scope</span></span><br><span class="line">  <span class="hljs-built_in">println!</span>(<span class="hljs-string">"&#123;&#125;"</span>, some_integer);</span><br><span class="line">&#125; <span class="hljs-comment">// Here some_integer goes out of scope.</span></span><br></pre></td></tr></table></figure>
<p>If we tried to use <code>s</code> after the call to <code>take_ownership</code>, Rust would throw a compile time error. These static checks protect us from mistakes.</p>
<h1 id="Return-Values-and-Scope"><a href="#Return-Values-and-Scope" class="headerlink" title="Return Values and Scope"></a>Return Values and Scope</h1><p>Returning values can also transfer ownership.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> s1 = give_ownership(); <span class="hljs-comment">// give_ownership moves its return value into s1</span></span><br><span class="line">  <span class="hljs-keyword">let</span> s2 = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>); <span class="hljs-comment">// s2 comes into scope</span></span><br><span class="line">  <span class="hljs-keyword">let</span> s2 = take_and_give_back(s2); <span class="hljs-comment">// s2 is moved into take_and_give_back, which aslo move its returned value into s2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">give_ownership</span> </span>() -&gt; <span class="hljs-built_in">String</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> some_string = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>); <span class="hljs-comment">// some_string comes into scope</span></span><br><span class="line">  some_string      <span class="hljs-comment">// some_string is returned and moves out to the calling function</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">take_and_give_back</span></span>(a_string: <span class="hljs-built_in">String</span>) -&gt; &#123; <span class="hljs-comment">// a_string comes into scope</span></span><br><span class="line">  a_string <span class="hljs-comment">// a_string is returned and moves out to the calling function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It’s possible to return mutiple values using a tuple.</p>
<h2 id="Reference-and-Borrowing"><a href="#Reference-and-Borrowing" class="headerlink" title="Reference and Borrowing"></a>Reference and Borrowing</h2><p>Here is how you would define and use a <code>calculate_length</code> function that has a <em>reference</em> to an object as a parameter instead of taking ownership of the value.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> s1 = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">let</span> len = calculate_length(&amp;s1);</span><br><span class="line"></span><br><span class="line">  <span class="hljs-built_in">println!</span>(<span class="hljs-string">"The length of '&#123;&#125;' is &#123;&#125;."</span>, s1, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">calculate_length</span></span>(s: &amp;<span class="hljs-built_in">String</span>) - <span class="hljs-built_in">usize</span> &#123;</span><br><span class="line">  s.len()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>First notice that all the tuple code in the variable declaration and the function return value is gone. Second, note that we pass <code>&amp;s1</code> into <code>calculate_length</code>, and in its definition, we take <code>&amp;String</code> rather than <code>String</code>.</p>
<p>These ampersands(&amp;) are <em>reference</em>, and they allow you to refer to some value without taking ownership of it.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-05.svg" alt=""></p>
<p>In this figure, <code>&amp;String s</code> pointing to <code>String s1</code></p>
<p>Let’s take a closer look at the function call here:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s1 = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>)</span><br><span class="line"><span class="hljs-keyword">let</span> len = calculate_length(&amp;s1)</span><br></pre></td></tr></table></figure>
<p>The <code>&amp;s1</code> syntax lets us create a reference that <em>refer</em> to the value of <code>s1</code>, but does not own it.</p>
<p><strong>Because it does not own it, the value it points to will not be dropped when the reference goes out of scope.</strong></p>
<p>Likewise, the signature of the function uses <code>&amp;</code> to indicate that the type of the paramter <code>s</code> is a reference.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">calculate_length</span></span>(s: &amp;<span class="hljs-built_in">String</span>) -&gt; <span class="hljs-built_in">usize</span> &#123; <span class="hljs-comment">// s is a reference to a String</span></span><br><span class="line">  s.len()</span><br><span class="line">&#125; <span class="hljs-comment">// Here, s goes out of the scope. But because it does not have ownership of what it refers to, no drop happens.</span></span><br></pre></td></tr></table></figure>
<p>The scope in which the variable <code>s</code> is valid is the same as any function parameter’s scope, but we don’t drop what the reference points to when it goes out of scope because we don’t have ownership.</p>
<p>Functions that have references as parameters instead of the actual values mean we won’t need to return the values in order to give back ownership, since we never had ownership.</p>
<p>We call having references as function paramters <code>borrowing</code>. As in real life, if a person owns something, you can borrow it from them, When you’re done, you have to give it back.</p>
<p>If we try to modify something we’re borrowing, it won’t work.</p>
<h2 id="Mutable-References"><a href="#Mutable-References" class="headerlink" title="Mutable References"></a>Mutable References</h2><figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span> </span>() &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>);</span><br><span class="line">  change(&amp;<span class="hljs-keyword">mut</span> s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">change</span></span>(some_string: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-built_in">String</span>) &#123;</span><br><span class="line">  some_string.push_str(', world')</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>First, we had to change <code>s</code> to be <code>mut</code>. Then we had to create mutable reference with <code>&amp;mut s</code> and accept a mutable reference with <code>some_string: &amp;mut String</code>.</p>
<p>But mutable references have one big restriction: you can only mutable reference to a particular piece of data in a particular scope.</p>
<p>This restriction allows for mutation but in a very controlled fashion. It’s something that new Rustaceans struggle with, because most languages let you mutate whenever you’d like. The benefit of having this restriction is that <em>Rust can prevent data races at compile time</em>.</p>
<p>A <code>data race</code> is a particular type of race condition in which these three behaviors occur:</p>
<ul>
<li><p>Two or more pointers access the same data at the same time.</p>
</li>
<li><p>At least one of the pointers is being used to write to the data.</p>
</li>
<li><p>There’s no mechanism being used to synchrnize access to the data.</p>
</li>
</ul>
<p>Data races cause undefined behavior and can be difficult to diagnose and fix when you’re trying to track them down at runtime. Rust prevents this problem from happening because it won’t even compile code with data race.</p>
<p>As always, we can use curly brackets to create a new scope, allowing for multiple mutable references, just not <em>simultaneous</em> ones:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>);</span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> r1 = &amp;<span class="hljs-keyword">mut</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">let</span> r2 = &amp;<span class="hljs-keyword">mut</span> s;</span><br></pre></td></tr></table></figure>
<p>A similar rule exists for combining mutable and immutable references. This code results in an error:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello"</span>);</span><br><span class="line"><span class="hljs-keyword">let</span> r1 = &amp;s; <span class="hljs-comment">// no problem</span></span><br><span class="line"><span class="hljs-keyword">let</span> r2 = &amp;s; <span class="hljs-comment">// no problem</span></span><br><span class="line"><span class="hljs-keyword">let</span> r3 = &amp;<span class="hljs-keyword">mut</span> s; <span class="hljs-comment">//BIG PROBLEM, mutable borrow occurs</span></span><br></pre></td></tr></table></figure>
<p>We also cannot have mutable reference while we have an immutable one.</p>
<p>Users of an immutable reference don’t expect the values to suddently change out from under them.</p>
<h2 id="Dangling-References"><a href="#Dangling-References" class="headerlink" title="Dangling References"></a>Dangling References</h2><p>In languages with pointers, it’s easy to erroneously to create a <em>dangling pointer</em>, a pointer that references a location in memory that may have been given to someone else, by freeing some memory while preserving a pointer to that memory. In Rust, by contrast, the compiler guarantees the references will never be dangling references: if we have a reference to some data, the compiler will ensure that the data will not go out of scope before reference to the data does.</p>
<h2 id="The-Rules-of-References"><a href="#The-Rules-of-References" class="headerlink" title="The Rules of References"></a>The Rules of References</h2><ul>
<li><p>At any given time, you can have <code>either</code> but not both of</p>
<ul>
<li><p>One mutable reference</p>
</li>
<li><p>Any number of immutable references</p>
</li>
</ul>
</li>
<li><p>Referecences must always be valid.</p>
</li>
</ul>
<h2 id="Slices"><a href="#Slices" class="headerlink" title="Slices"></a>Slices</h2><p>Another data type that doesn’t have ownership is the <code>slice</code>. Slices let you reference a configuous sequence of elements in a collection rather tahn the whole collection.</p>
<h2 id="String-Slice"><a href="#String-Slice" class="headerlink" title="String Slice"></a>String Slice</h2><p>A <em>string slice</em> is a reference to part of a <code>String</code>, and looks like this:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s = <span class="hljs-built_in">String</span>::from(<span class="hljs-string">"Hello world"</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">let</span> hello = &amp;s[<span class="hljs-number">0</span>..<span class="hljs-number">5</span>];</span><br><span class="line"><span class="hljs-keyword">let</span> world = &amp;s[<span class="hljs-number">6</span>..<span class="hljs-number">11</span>];</span><br></pre></td></tr></table></figure>
<p>This is similar to taking a reference to the whole <code>String</code>, but with the extra <code>[0..5]</code> but. Rather than a reference to the entire <code>String</code>, it’s a reference to an internal position in the <code>String</code> and the number of elements that it refers to.</p>
<p>We create slices with a range of <code>[start_index..end_index]</code>, but the slice data structure acutally <strong>stores the starting position and the length of the slice</strong>.</p>
<p>So in the case of <code>let world = &amp;s[6..11];</code>, <code>world</code> would be a slice that contains a pointer to the 6th byte of <code>s</code> and a length of value of 5.</p>
<p><img src="https://doc.rust-lang.org/book/second-edition/img/trpl04-06.svg" alt=""></p>
<p>With Rust’s <code>..</code> range syntax, if you want to start at the first index(0), you can drop the value before the two periods. In other words</p>
<p>By the same token, if your slice includes the last byte of the <code>String</code>, you can drop the trailing number.</p>
<p>You can also drop both values to take a slice of the entire string.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">first_word</span> </span>(s: &amp;<span class="hljs-built_in">String</span>) -&gt; &amp;<span class="hljs-built_in">str</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> bytes = s.as_bytes();</span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">for</span> (i, &amp;item) <span class="hljs-keyword">in</span> bytes.iter().enumerate() &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> item == <span class="hljs-string">b' '</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> &amp;s[<span class="hljs-number">0</span>..i]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;s[..]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="String-Literals-Are-Slices"><a href="#String-Literals-Are-Slices" class="headerlink" title="String Literals Are Slices"></a>String Literals Are Slices</h2><figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> s = <span class="hljs-string">"Hello, World"</span>;</span><br></pre></td></tr></table></figure>
<p>The type of <code>s</code> here is <code>&amp;str</code>: it’s a slice pointing to the specific point of the binary. This is also why string literals are immutable; <code>&amp;str</code> is an immutable reference.</p>
<h2 id="String-Slices-as-Parameters"><a href="#String-Slices-as-Parameters" class="headerlink" title="String Slices as Parameters"></a>String Slices as Parameters</h2><p>Knowing that you can take slices of literals and <code>String</code>s leads us to one more improvement on <code>first_word</code>, and that’s its signature:</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">first_word</span></span>(s: &amp;<span class="hljs-built_in">String</span>) -&gt; &amp;<span class="hljs-built_in">str</span> &#123;</span><br></pre></td></tr></table></figure>
<p>If we have a string slice, we can pass that directly. If we have a <code>String</code>, we can pass a slice of the entire <code>String</code>. Defining a function to take a string slcie instead of a reference to a String makes our API more general and useful without losing any functionality.</p>
<h2 id="Other-Slices"><a href="#Other-Slices" class="headerlink" title="Other Slices"></a>Other Slices</h2><p>String slices, as you might imagine, are specific to strings. But there’s a more general slice type, too.</p>
<figure class="highlight rust hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];</span><br><span class="line"><span class="hljs-keyword">let</span> slice = &amp;a[<span class="hljs-number">1</span>..<span class="hljs-number">3</span>];</span><br></pre></td></tr></table></figure>
<p>This slice has the type <code>&amp;[i32]</code>. It works the same way as string slices do, by storing a reference to the first element and the length.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-06T09:47:19.000Z">2017-06-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 452 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/06/Basic-Info-of-Web-Worker/">Basic Info of Web Worker</a>
            
        </h1>
        <div class="content">
            <figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// index.js</span></span><br><span class="line"><span class="hljs-keyword">var</span> worker = <span class="hljs-keyword">new</span> Worker (<span class="hljs-string">'worker.js'</span>)</span><br><span class="line">worker.postMessage() <span class="hljs-comment">// start the worker</span></span><br></pre></td></tr></table></figure>
<p>postMessage 方法可以接受字符串或 JSON 对象</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// index.js</span></span><br><span class="line">worker.addEventListener(<span class="hljs-string">'message'</span>, (e) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'worker said: '</span>, e.data)</span><br><span class="line">&#125;, <span class="hljs-literal">false</span>)</span><br><span class="line"></span><br><span class="line">worker.postMessage(<span class="hljs-string">'hello world'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// worker.js</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'message'</span>, (e) =&gt; &#123;</span><br><span class="line">  self.postMessage(e.data)</span><br><span class="line">&#125;, <span class="hljs-literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>index.js 中调用 postMessage() 时, worker.js 通过 message 时间处理消息, index.js 的有效信息在 e.data 上.</p>
<p>index.js 和 worker.js 传递的消息是幅值而不是共享(序列化+反序列化)</p>
<p>Example</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"sayHi()"</span>&gt;</span>SayHi<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"unknownCmd()"</span>&gt;</span>unknownCmd<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"stop()"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"result"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// index.js</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sayHi</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  worker.postMessage(&#123;</span><br><span class="line">    cmd: <span class="hljs-string">'start'</span>,</span><br><span class="line">    msg: <span class="hljs-string">'Hi'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stop</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  worker.postMessage(&#123;</span><br><span class="line">    cmd: <span class="hljs-string">'stop'</span>,</span><br><span class="line">    msg: <span class="hljs-string">'Bye'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unknownCmd</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  worker.postMessage(&#123;</span><br><span class="line">    cmd: <span class="hljs-string">'foobar'</span>,</span><br><span class="line">    msg: <span class="hljs-string">'???'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-string">'worker.js'</span>)</span><br><span class="line"></span><br><span class="line">worker.addEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'result'</span>).textContent = e.data</span><br><span class="line">&#125;, <span class="hljs-literal">false</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// worker.js</span></span><br><span class="line">self.addEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">var</span> data = e.data</span><br><span class="line">  <span class="hljs-keyword">switch</span> (data.cmd) &#123;</span><br><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-string">'start'</span>: &#123;</span><br><span class="line">      self.postMessage(<span class="hljs-string">'WORKER STARTED: '</span> + data.msg)</span><br><span class="line">      <span class="hljs-keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-string">'stop'</span>: &#123;</span><br><span class="line">      self.postMessage(<span class="hljs-string">'WORKER STOPPED: '</span> + data.msg + <span class="hljs-string">'. (buttons will no longer work)'</span>)</span><br><span class="line">      self.close()</span><br><span class="line">      <span class="hljs-keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">default</span>: &#123;</span><br><span class="line">      self.postMessage(<span class="hljs-string">'Unknown command: '</span> + data.msg)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="hljs-literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>停止 worker 的方法两种</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// index.js</span></span><br><span class="line">worker.terminate()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// worker.js</span></span><br><span class="line">self.close()</span><br></pre></td></tr></table></figure>
<h1 id="Worker-环境"><a href="#Worker-环境" class="headerlink" title="Worker 环境"></a>Worker 环境</h1><h2 id="Worker-作用域"><a href="#Worker-作用域" class="headerlink" title="Worker 作用域"></a>Worker 作用域</h2><p>在 worker.js 中, self 和 this 都是指 worker 的全局作用域</p>
<h1 id="适用于-worker-的功能"><a href="#适用于-worker-的功能" class="headerlink" title="适用于 worker 的功能"></a>适用于 worker 的功能</h1><p>由于web worker 的多线程行为, 所以他们只能使用 js 功能的子集</p>
<ul>
<li><p>navigator 对象</p>
</li>
<li><p>location 对象</p>
</li>
<li><p>XMLHttpResponse</p>
</li>
<li><p>setTimeout() / clearTimeout() / setInterval() / clearInterval()</p>
</li>
<li><p>应用缓存</p>
</li>
<li><p>使用 importScripts() 方法导入外部脚本</p>
</li>
<li><p>生成其他 worker</p>
</li>
</ul>
<p>worker 无法使用:</p>
<ul>
<li><p>DOM</p>
</li>
<li><p>window 对象</p>
</li>
<li><p>document 对象</p>
</li>
<li><p>parent 对象</p>
</li>
</ul>
<h1 id="加载外部脚本"><a href="#加载外部脚本" class="headerlink" title="加载外部脚本"></a>加载外部脚本</h1><p>worker 可以通过 importScripts() 函数将外部脚本文件或库加载到 worker 中, 该方法采用零个或多个字符串表示要导入的资源名.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// worker.js</span></span><br><span class="line">importScripts(<span class="hljs-string">'script1.js'</span>)</span><br><span class="line">importScripts(<span class="hljs-string">'script2.js'</span>)</span><br><span class="line"></span><br><span class="line">importScripts(<span class="hljs-string">'script3.js'</span>, <span class="hljs-string">'script4.js'</span>)</span><br></pre></td></tr></table></figure>
<h1 id="添加子-worker"><a href="#添加子-worker" class="headerlink" title="添加子 worker"></a>添加子 worker</h1><ul>
<li><p>subWorker 必须托管在与福网页相同的来源中</p>
</li>
<li><p>subWorker 中的 URI 应相对于 worker 的位置来解析</p>
</li>
</ul>
<h1 id="处理错误"><a href="#处理错误" class="headerlink" title="处理错误"></a>处理错误</h1><p>执行的 worker 发生错误时, 会触发 ErrorEvent, 包含三个属性: filename, lineno, message</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-05T10:28:20.000Z">2017-06-05</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 minutes read (About 2009 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/05/Deep-in-Viewport/">Deep in Viewport</a>
            
        </h1>
        <div class="content">
            <p><code>vw</code>(viewport width) and <code>vh</code>(viewport height) are legnth units that represent exactly 1% of the size of any given viewport, regardless of its measurements. <code>rem</code>(short for root em) is also similar in its functionality, although it deals specifically with font sizes, and derives its name from the value fo the font size of the root element – which should default to 16 pixels on most browsers.</p>
<p>There are also a few more viewport units available for use, such as <code>vmin</code> and <code>vmax</code> which refer respectively to 1% of the viewport’s smaller dimension, and 1% of its larger dimension.</p>
<p>Interestingly enough, browsers actually calculate the entire browser window when it comes to width, meaning they factor the scrollbar into this dimension. Should you attempt to set the width of an element to a value of 100vw, it would force a horizontal bar to appear, since you’d be lightly stretching your viewport.</p>
<h1 id="Device-Pixels-and-CSS-Pixels"><a href="#Device-Pixels-and-CSS-Pixels" class="headerlink" title="Device Pixels and CSS Pixels"></a>Device Pixels and CSS Pixels</h1><p>Device Pixels are the kind of pixels we intuitively assume to be ‘right’. These pixels give the formal resolution of whichever device you’re working on, and can be read out from <code>screen.width/height</code>.</p>
<p>If you give a certain element a <code>width: 128px</code>, and your monitor is 1024px wide, and you maximize your browser screen, the element would fit out on your monitor eight times.</p>
<p>If the user zooms, however, this calculation is going to change. If the user zooms to 200%, your element with <code>width: 128px</code> will fit only four times on this 1024px wide monitor.</p>
<p>Zooming as implemented in modern browsers consists of nothing more than ‘stretching up’ pixels. That is, the width of the elemtn is not changed from 128 to 256px, instead <em>the actual pixels</em> are doubled in size. Formally, the element still has width of 128 CSS pixels, even though it happens to take the space of 256px.</p>
<p>In other words, zooming to 200% makes one css pixels grow to four times the size of one device pixels(two times the width, two times the height)</p>
<p>A few images will clarify the concept. Here are four pixels on 100% zoom level. Here CSS px fully overlap with device px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/csspixels_100.gif" alt=""></p>
<p>Let’s zoom out. The CSS pixels start to shrink, meaning that one device px now overlaps several CSS px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/csspixels_out.gif" alt=""></p>
<p>If you zoom in, the opposite happens. The CSS px start to grow, and now one CSS px overlap several device px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/csspixels_in.gif" alt=""></p>
<p>The point is that you are only interested in CSS px. It’s those px that dictate how your style sheet is rendered.</p>
<p>Device px are almost entirely useless to you.</p>
<blockquote>
<p>At zoom level 100% one CSS px is exactly equal to Device px.</p>
</blockquote>
<h1 id="Screen-Size"><a href="#Screen-Size" class="headerlink" title="Screen Size"></a>Screen Size</h1><p><code>screen.width</code> and <code>screen.height</code> means the total width width and height of the user’s screen. <strong>These dimensions are measured in device px because they never change: they’re feature of the monitor and not of the browser.</strong></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_screen.jpg" alt=""></p>
<h1 id="Window-Size"><a href="#Window-Size" class="headerlink" title="Window Size"></a>Window Size</h1><p><code>window.innerWidth</code> and <code>window.innerHeight</code></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_inner.jpg" alt=""></p>
<p>Window Size is measured in CSS px.</p>
<h1 id="Scrolling-Offset"><a href="#Scrolling-Offset" class="headerlink" title="Scrolling Offset"></a>Scrolling Offset</h1><p><code>window.pageXOffset</code> and <code>window.pageYOffset</code> contains the horizontal and vertical scrolling offsets of the document. Thus you can find out how much the user has scrolled.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_page.jpg" alt=""></p>
<p>These properties measured in CSS px.</p>
<h1 id="Viewport"><a href="#Viewport" class="headerlink" title="Viewport"></a>Viewport</h1><p>The function of the viewport is to constrain the element, which is the uppermost containing block of your site.</p>
<p>Suppose you have a liquid layout and one of your sidebar has <code>width: 10%</code>. Now the sidebar neatly grows and shrinks as your resize the browser window. How does it work.</p>
<p>Technically, what happens is that the sidebar gets 10% of the width of its parent. Let’s say the . Normally all block-level element take 100% of the width of their parent ().</p>
<p>So your sidebar get width of 10% of browser.</p>
<p>In theory, the width of the element is restricted by the width of the viewport. The element takes 100% of the width of that viewport.</p>
<p>The viewport, in turn, is exactly equal to the browser window: it’s been defined as such. The viewport is not an HTML construct, so you cannot influence it by CSS. It just has the width and height of the browser window – on desktop. On mobile it’s quite a bit more complicated.</p>
<p>White <code>width: 100%</code> works fine at 100% zoom, if we zoomed in the viewport has become smaller than the total width of the site, the content will spills out of the element, but that element has <code>overflow: visible</code>, which means that the spilled-out content will be show in any case.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_100percent.jpg" alt=""></p>
<h1 id="Measuring-the-viewport"><a href="#Measuring-the-viewport" class="headerlink" title="Measuring the viewport"></a>Measuring the viewport</h1><p>The Viewport size can be found in <code>document.documentElement.clientHeight</code> and <code>document.documentElement.clientWidth</code></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_client.jpg" alt=""></p>
<p>If you know your DOM, you know that <code>document.documentElement</code> is in fact the <code>&lt;html&gt;</code> element: the root element of any HTML document. However, the viewport is one level higher, so to speak, it’s the element that contains the <code>&lt;html&gt;</code> element. That matters if you give the <code>&lt;html&gt;</code> element a <code>width</code>.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_client_smallpage.jpg" alt=""></p>
<p>So <code>document.documentElement.clientWidth</code> and <code>document.documentElement.clientHeight</code> always give the viewport dimensions, regardless of the dimensions of the <code>&lt;html&gt;</code> element.</p>
<h1 id="Measuring-the-element"><a href="#Measuring-the-element" class="headerlink" title="Measuring the element"></a>Measuring the element</h1><p><code>document.documentElement.offsetWidth</code> and <code>document.documentElement.offsetHeight</code> will give size.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_offset.jpg" alt=""></p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_offset_smallpage.jpg" alt=""></p>
<h2 id="Event-coordinates"><a href="#Event-coordinates" class="headerlink" title="Event coordinates"></a>Event coordinates</h2><p>There are the event coordinates. When a mouse event occurs, no less than five property pairs are exposed to give you information abou the exact place of the event. For our discussion three of them are important:</p>
<ul>
<li><p><code>pageX/pageY</code> gives the coordinates relative to the <code>&lt;html&gt;</code> element in CSS px.</p>
</li>
<li><p><code>clientX/Y</code> gives the coordinates relative to the viewport in CSS px.</p>
</li>
<li><p><code>screenX/Y</code> gives the coordinate relative to the screen in DEVICE px.</p>
</li>
</ul>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_pageXY.jpg" alt=""></p>
<p>You’ll use <code>pageX/Y</code> 90% of the time. Usually you want to know the event position relative to the document.</p>
<p>The other 10% of the time you’ll use <code>clientX/Y</code></p>
<p>You never ever need to know the event coordiantes relative to the screen.</p>
<h3 id="Media-queries"><a href="#Media-queries" class="headerlink" title="Media queries"></a>Media queries</h3><p>There are two relavant media queries: <code>width/height</code> and <code>device-width/device-height</code></p>
<ul>
<li><p><code>width/height</code> uses the same values as <code>document.Element.clientWidth/clientHeight</code>, namely the viewport, it works with CSS px.</p>
</li>
<li><p><code>device-width/device-height</code> uses the same values as <code>screen.width/height</code> with device px.</p>
</li>
</ul>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/desktop_mediaqueries.jpg" alt=""></p>
<h1 id="The-problem-of-mobile-browser"><a href="#The-problem-of-mobile-browser" class="headerlink" title="The problem of mobile browser"></a>The problem of mobile browser</h1><p>Let’s go back to our sidebar with <code>width:10%</code>, if mobile browsers would do exactly the same as desktop browser, they’d make the element about 40px (if the device-width is 400px). and that’s too narrow. Your liquid layout would look horribly squashed.</p>
<h1 id="Two-viewports"><a href="#Two-viewports" class="headerlink" title="Two viewports"></a>Two viewports</h1><p>The viewport is too narrow to serve as a basis for your CSS layout. The obvious solution is to make the viewport wider. That however requires it to be split into two: the visual viewport and the layout viewport.</p>
<p>A simple explanation at StackOverFlow:</p>
<blockquote>
<p>Imagine the layout viewport as being a large image which does not change size or shape. Now image you have a smaller frame through which you look at the large image. The small frame is surrounded by opaque material which obscures your view of all but a portion of the large image. The portion of the large image that you can see through the frame is the visual port. You can back away from the large image while holding your frame(zoom out) to see the entire image at once, or you can move closer(zoom in) to see only a portion. You can also change the orientation of the frame, but the size and shape of the large image (layout viewport) never changes.</p>
</blockquote>
<p>The visual viewport is the part of the page that’s currently shown on-screen.</p>
<p>The user may scroll to change the part of the page he sees, or zoom to change the size of the visual viewport.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_visualviewport.jpg" alt=""></p>
<p>However, the CSS layout, especially percentual widths, are calculated relative to the <strong>layout viewport</strong>, which is considerably wider than the visual viewport.</p>
<p>Thus the <code>&lt;html&gt;</code> element tabkes the width of the layout viewport initially, and your CSS is interpreted as if the screen were significantly wider than the phone screen. This makes sure that your site’s layout behaves as it does on a desktop browser.</p>
<p>How wide is the layout viewport? That differs per browser.</p>
<ul>
<li><p>Safari uses 980px</p>
</li>
<li><p>Opera uses 850px</p>
</li>
<li><p>Android 800px</p>
</li>
<li><p>IE 974px</p>
</li>
</ul>
<h1 id="Understanding-the-layout-viewport"><a href="#Understanding-the-layout-viewport" class="headerlink" title="Understanding the layout viewport"></a>Understanding the layout viewport</h1><p>In order to understand the size of the layout viewport we have to take a look at what happens when the page if fully zoomed out. Many mobile browsers initially show any page in fully zoomed-out mode.</p>
<p>The point is: browser have chosen their dimensions of the layout viewport such that it completely covers the screen if fully zoomed-out mode(equal to the visual viewport)</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_viewportzoomedout.jpg" alt=""></p>
<p>Thus the width and the height of the layout viewport are equal to whatever can be shown on the screen in the maximally zoomed-out mode. When the user zooms in these dimensions stay the same.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_layoutviewport.jpg" alt=""></p>
<p>The layout viewport width is always the same, if you rotate your phone, the visual viewport changes, but the browser adapts to this new orientation by zooming in slightly so that the layout viewport is again as wide as the visual viewport.</p>
<p>This has consequences for the layout viewport’s height, which is now substantially less than in portrait mode. But web developers don’t care about the height, only about the width.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_layoutviewport_la.jpg" alt=""></p>
<h1 id="Measuring-the-layout-viewport"><a href="#Measuring-the-layout-viewport" class="headerlink" title="Measuring the layout viewport"></a>Measuring the layout viewport</h1><p><code>document.documentElement.clientWidth</code> and <code>document.documentElement.clientHeight</code> contain the layout viewport’s dimensions.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_client.jpg" alt=""></p>
<p>The orientation matters for the height, but not for the width.</p>
<h1 id="Measuring-the-visual-viewport"><a href="#Measuring-the-visual-viewport" class="headerlink" title="Measuring the visual viewport"></a>Measuring the visual viewport</h1><p>As to the visual viewport, it is measured by <code>window.innerWidth/innerHeight</code>. Obviously the measurements change when the user zooms out or in, since more or fewer CSS px fit into the screen.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_inner.jpg" alt=""></p>
<h1 id="The-Screen"><a href="#The-Screen" class="headerlink" title="The Screen"></a>The Screen</h1><p>As on desktop, <code>screen.width/height</code> gives the screen size, in device pixels. As on the desktop, you never need this information as a web developer.</p>
<h1 id="Visual-viewport-position-relative-to-Layout-viewport"><a href="#Visual-viewport-position-relative-to-Layout-viewport" class="headerlink" title="Visual viewport position relative to Layout viewport"></a>Visual viewport position relative to Layout viewport</h1><p><img src="https://www.quirksmode.org/mobile/pix/viewport/mobile_page.jpg" alt=""></p>
<h1 id="html-element"><a href="#html-element" class="headerlink" title="html element"></a>html element</h1><p>Just as on desktop, <code>document.documentElemetn.offsetWidth/offsetHeight</code> gives the total size of the <code>&lt;html&gt;</code> element in CSS px.</p>
<h1 id="Meta-Viewport"><a href="#Meta-Viewport" class="headerlink" title="Meta Viewport"></a>Meta Viewport</h1><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=320"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>It is meant to resize the layout viewport.</p>
<p>Suppose you build a simple page and give your elemnet no <code>width</code>. Now they stretch up to take 100% of the width of the layout viewport. Most browsers zoom out to show the entire layout viewport on the screen, giving an effect like this</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_none.jpg" alt=""></p>
<p>All user will immediately zoom in, which works, but most browsers keep the width of the elements intact, whcih makes the text hard to read.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_none_zoomed.jpg" alt=""></p>
<p>Now what you can try is setting <code>html {width: 320px}</code> then</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_html300.jpg" alt=""></p>
<p>When you set</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=320"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>You set the width of the layout viewport to 320px.</p>
<p><img src="https://www.quirksmode.org/mobile/pix/viewport/mq_yes.jpg" alt=""></p>
<p>Of course now we use</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>to adapt to various browsers.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-05T03:56:47.000Z">2017-06-05</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 234 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/05/utils-in-axios/">Utils in Axios</a>
            
        </h1>
        <div class="content">
            <figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// global toString</span></span><br><span class="line"><span class="hljs-keyword">var</span> toString = <span class="hljs-built_in">Object</span>.prototype.toString</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isArray</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isArray</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> toString.call(val) === <span class="hljs-string">'[object Array]'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isArrayBuffer</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isArrayBuffer</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> toString.call(val) === <span class="hljs-string">'[object arrayBuffer]'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isFormData</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFormData</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> FormData !== <span class="hljs-string">'undefined'</span> &amp;&amp; (val <span class="hljs-keyword">instanceof</span> FormData))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isString</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isString</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'string'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isNumber</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isNumber</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'number'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isUndefinded</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isUndefined</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'undefined'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isObject</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isObject</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> val !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'object'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isDate</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDate</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> toString.call(val) === <span class="hljs-string">'[object Date]'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isFile</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFile</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> toString.call(val) === <span class="hljs-string">'[object File]'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isBlob</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBlob</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> toString.call(val) === <span class="hljs-string">'[object Blob]'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isFunction</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFunction</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> toString.call(val) === <span class="hljs-string">'[object Function]'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isStream</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isStream</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> isObject(val) &amp;&amp; isFunction(val.pipe)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isURLSearchParams</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isURLSearchParams</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> URLSearchParams !== <span class="hljs-string">'undefined'</span> &amp;&amp; val <span class="hljs-keyword">instanceof</span> URLSearchParams</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// trim</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trim</span> (<span class="hljs-params">val</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/^\s*/</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/\s*$/</span>, <span class="hljs-string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// isStandardBrowserEnv</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isStandardBrowserEnv</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> navigator !== <span class="hljs-string">'undefined'</span> &amp;&amp; navigator.product === <span class="hljs-string">'ReactNative'</span>) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">'undefined'</span></span><br><span class="line">    &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span> !== <span class="hljs-string">'undefined'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Iterate over an Array or an Object invoking a function for each item</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forEach</span> (<span class="hljs-params">obj, fn</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'undefined'</span>) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span> &amp;&amp; !isArray(obj)) &#123;</span><br><span class="line">    obj = [obj]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">if</span> (isArray(obj)) &#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = obj.length; i &lt; l; i++) &#123;</span><br><span class="line">      fn.call(<span class="hljs-literal">null</span>, obj[i], i, obj)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj) &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(obj, key)) &#123;</span><br><span class="line">        fn.call(<span class="hljs-literal">null</span>, obj[key], key, obj)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-06-01T08:23:14.000Z">2017-06-01</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 minutes read (About 1611 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/06/01/concept-of-PWA/">Concept of PWA</a>
            
        </h1>
        <div class="content">
            <h1 id="Advantages-of-Progressive-Web-Apps"><a href="#Advantages-of-Progressive-Web-Apps" class="headerlink" title="Advantages of Progressive Web Apps:"></a>Advantages of Progressive Web Apps:</h1><ul>
<li><p>Reliable - Load instantly and never show the dinasaur.</p>
</li>
<li><p>Fast - Respond quickly to user interactions with silky smooth animations.</p>
</li>
<li><p>Enaging - Feel like a natural app on the device, with immersive user experience.</p>
</li>
</ul>
<h1 id="What-is-a-Progressive-Web-App"><a href="#What-is-a-Progressive-Web-App" class="headerlink" title="What is a Progressive Web App"></a>What is a Progressive Web App</h1><ul>
<li><p>Progressive - Works for every user, regardless of browser choice because it’s built with progressive enhancement as a core tenet.</p>
</li>
<li><p>Responsive - Fits any form factor: desktop, mobile, tablet, or whatever is next.</p>
</li>
<li><p>Connectively independent - Enhanced with service workers to work offline or on low-quality networks.</p>
</li>
<li><p>App-like - Feels like an app, because the app shell model seperates the application <em>functionality</em> from application <em>content</em>.</p>
</li>
<li><p>Fresh - Always up-to-date thanks to the service worker update process.</p>
</li>
<li><p>Safe - Served via HTTPS to prevent snooping and to ensure content hasn’t been tampered with.</p>
</li>
<li><p>Discoverable - Is identifiable as an ‘application’ thanks to <em>W3C manifest</em> and <em>service worker registration</em> scope, allowing search engines to find it.</p>
</li>
<li><p>Re-engagable - Makes Re-engagement easy through features like push notification.</p>
</li>
<li><p>Installable - Allows users to add apps they find most useful to their home screen without the hassle of an app store.</p>
</li>
<li><p>Linkable - Easily share the application via URL, doesn’t require complex installation.</p>
</li>
</ul>
<h2 id="What-is-App-Shell"><a href="#What-is-App-Shell" class="headerlink" title="What is App Shell"></a>What is App Shell</h2><p>The app’s shell is the minimal HTML, CSS, JavaScript that is required to power the user interface of a progressive web app and is one of the components that ensures reliably good performance. Its first load should be extremely quick and immediately cached.</p>
<p>‘Chched’ means that the shell files are loaded once over the network and then saved to the local device. Every subsequent time that the user opens the app, the shell files are loaded from the local device’s cache, which results in blazing-fast startup times.</p>
<p>App shell architecture seperates the core application infrastructure and UI from the data. All of the UI and infrastructure is cached locally using a <em>service worker</em> so that on subsequent loads, the PWA only needs to retrieve the necessary data, instead of having to load everything.</p>
<p>A service worker is a script that your browser runs in the background, seperate from a web page, opening the door to features that don’t need a web page or user interaction.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/156b5e3cc8373d55.png" alt=""></p>
<p>The app shell is similar to the bundle of code that you’d publish to an app store when building a native app. It is the core components necessary to get your app off the ground, but likely doesn’t contain the data.</p>
<p>Using the app shell architecture allows you to focus on speed, giving the PWA similar properties to native apps:</p>
<ul>
<li><p>instant loading</p>
</li>
<li><p>regular updates</p>
</li>
</ul>
<h2 id="Implement-App-Shell"><a href="#Implement-App-Shell" class="headerlink" title="Implement App Shell"></a>Implement App Shell</h2><h3 id="Create-the-HTML-for-the-App-Shell"><a href="#Create-the-HTML-for-the-App-Shell" class="headerlink" title="Create the HTML for the App Shell"></a>Create the HTML for the App Shell</h3><p>The Components consist of:</p>
<ul>
<li><p>Header with a title, and app/refresh button</p>
</li>
<li><p>Container for forecast cards</p>
</li>
<li><p>A forecast card template</p>
</li>
<li><p>A dialog for adding new cities</p>
</li>
<li><p>A loading indicator</p>
</li>
</ul>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Weather PWA<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"styles/inline.css"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"header"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"header__title"</span>&gt;</span>Weather PWA<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"butRefresh"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"headerButton"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"butAdd"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"headerButton"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card cardTemplate weather-forecase"</span> <span class="hljs-attr">hidden</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-container"</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"loader"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 32 32"</span> <span class="hljs-attr">with</span>=<span class="hljs-string">"32"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"32"</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"spinner"</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"16"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"16"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"14"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">circle</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">&lt;!-- insert link to app.js here --&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Notice the loader is visible by default. This ensures that the user sees the loader immediately as the page loads, giving them a clear indication that the content is loading.</p>
<h3 id="Start-with-a-fast-load"><a href="#Start-with-a-fast-load" class="headerlink" title="Start with a fast load"></a>Start with a fast load</h3><h4 id="Differentiating-the-first-run"><a href="#Differentiating-the-first-run" class="headerlink" title="Differentiating the first run"></a>Differentiating the first run</h4><p>User preferences, like the list of cities a user has subscribed to, should be stored locally using IndexedBD or another fast storage mechanism. To simplify this code, here we use localStorage, which is not ideal for production apps because it is a blocking, synchronous storage mechanism that is potentially very slow on some device.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Save list of cities to lcoalStorage</span></span><br><span class="line">app.saveSelectedCities = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">var</span> selectedCities = <span class="hljs-built_in">JSON</span>.stringify(app.selectedCities)</span><br><span class="line">  localStorage.selectedCities = selectedCities</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Next, let’s add the startup code to check if the user has any saved cities and render those</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.selectedCities = lcoalStorage.selectedCities</span><br><span class="line"><span class="hljs-keyword">if</span> (app.selectedCities) &#123;</span><br><span class="line">  app.selectedCities = <span class="hljs-built_in">JSON</span>.parse(app.selectedCities)</span><br><span class="line">  app.selectedCities.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">city</span>) </span>&#123;</span><br><span class="line">    app.getForecast(city.key, city.label)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">  app.updateForecastCard(initialWeatherForecast)</span><br><span class="line">  app.selectedCities = [</span><br><span class="line">    &#123;</span><br><span class="line">      key: initialWeatherForecast.key,</span><br><span class="line">      label: initialWeatherForecast.label,</span><br><span class="line">    &#125;,</span><br><span class="line">    app.saveSelectedCities()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Use-service-workers-to-pre-cache-the-App-Shell"><a href="#Use-service-workers-to-pre-cache-the-App-Shell" class="headerlink" title="Use service workers to pre-cache the App Shell"></a>Use service workers to pre-cache the App Shell</h3><p>PWA has to be fast, and installable, which means that they work online, offline, and on intermittent, slow connections.</p>
<p>To achieve this, we need to cache our app shell using service worker, so that it’s always available quickly and reliably.</p>
<p>Features provided via service workers should be considered a progressive enhancement, and added only if supported by the browser.</p>
<h4 id="Register-the-service-worker-if-it’s-available"><a href="#Register-the-service-worker-if-it’s-available" class="headerlink" title="Register the service worker if it’s available"></a>Register the service worker if it’s available</h4><p>The first step to making the app work offline is to register a service worker, a script that allows background functionality without the need of an open web page or user interaction.</p>
<p>This takes two simple steps:</p>
<ul>
<li><p>Tell the browser to register the JavaScript file as the service worker</p>
</li>
<li><p>Create a JavaScript file containing the service worker</p>
</li>
</ul>
<p>First, we need to check if the browser supports service worker, and if it does, register the service worker. Add the following code to <code>app.js</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> <span class="hljs-keyword">in</span> navigator) &#123;</span><br><span class="line">  navigator.serviceWorker</span><br><span class="line">  .register(<span class="hljs-string">'./service-worker.js'</span>)</span><br><span class="line">  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Service Worker Registered'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Cache-the-site-assets"><a href="#Cache-the-site-assets" class="headerlink" title="Cache the site assets"></a>Cache the site assets</h4><p>When the service worker is registered, an install event is triggered the first time the user visits the page.</p>
<p>In this event handler, we will cache all the assets that are needed for the application.</p>
<p>When the service worker is fired, it should open the <code>caches</code> object and populate it with the assets necessary to load the App Shell. Create a file called <code>service-worker.js</code> in your application root folder. This file must live in the application root because the scope for service worker is defined by the directory in which the file resides. Add this code to your new <code>service-worker.js</code> file.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> cacheName = <span class="hljs-string">'weatherPWA'</span></span><br><span class="line"><span class="hljs-keyword">var</span> filesToCache = []</span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="hljs-string">'install'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Install'</span>)</span><br><span class="line">  e.waitUntil(</span><br><span class="line">    caches.open(cacheName).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cache</span>) </span>&#123;</span><br><span class="line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Caching app shell'</span>)</span><br><span class="line">      <span class="hljs-keyword">return</span> cache.addAll(filesToCache)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>First, we need to open the cache with <code>caches.open()</code> and provide a cache name. Providing a cache name allows us to version files, or separate data from the app shell so that we can easily update one but not affect other.</p>
<p>Once the cache is open, we can then call <code>cache.addAll()</code>, which takes a list of URLs, then fetches them from the server and adds the response to the cache. Unfortunately, <code>cache.addAll()</code> is atomic, if any of the files fail, the entire cache step fails.</p>
<p>DevTools can debug service workers. Before reloading your page, open up DevTools, go the <code>Service Worker</code> pane on the <code>Application</code> panel.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/ed4633f91ec1389f.png" alt=""></p>
<p>When you see a blank page like this, it means that the currently open page doesn’t have any registered service workers.</p>
<p>Now reload your page. The Service Worker pane should look like this.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/bf15c2f18d7f945c.png" alt=""></p>
<p>When you see information like this, it means the page has a service worker running.</p>
<p>Let’s add some logic on the <code>activate</code> event listener to update the cache.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="hljs-string">'activate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Activate'</span>)</span><br><span class="line">  e.waitUntil(</span><br><span class="line">    caches.keys().then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">keyList</span>) </span>&#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(keyList.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (key !== cacheName) &#123;</span><br><span class="line">          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Removing old cache'</span>, key)</span><br><span class="line">          <span class="hljs-keyword">return</span> caches.delete(key)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;))</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">  <span class="hljs-keyword">return</span> self.clients.claim()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>This code ensures that your service worker updates its cache whenever any of the app shell files change. In order for this to work, you’d need to increment the <code>cacheName</code> variable at the top of your service worker file.</p>
<p>When the app is complete, <code>self.clients.claim()</code> fixes a corner case in which the app wasn’t returning the latest data. You can reproduce the corner case by commenting out the line below and then doing the following steps:</p>
<ul>
<li><p>load app for first time so that the initial City data is shown</p>
</li>
<li><p>press the refresh button on the app</p>
</li>
<li><p>go offline</p>
</li>
<li><p>reload the app</p>
</li>
</ul>
<p>You expect to see the newer data, but you actually see the initial data. This happens because the service worker is not yet activated. <code>self.clients.claim()</code> essentially lets you activate the service worker faster.</p>
<p>Finally, let’s update the list of files required for the app shell. In the array, we need to include all of the files our app needs, including images, js, css, etc.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> filesToCache = [</span><br><span class="line">  <span class="hljs-string">'/'</span>,</span><br><span class="line">  <span class="hljs-string">'/index.html'</span>,</span><br><span class="line">  <span class="hljs-string">'/scripts/app.js'</span>,</span><br><span class="line">  <span class="hljs-string">'/styles/inline.css'</span>,</span><br><span class="line">  <span class="hljs-string">'/images/clear.png'</span>,</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="Serve-the-app-shell-from-the-cache"><a href="#Serve-the-app-shell-from-the-cache" class="headerlink" title="Serve the app shell from the cache"></a>Serve the app shell from the cache</h4><p>Service workers provide the ability to intercept requests made from our PWA and handle them within the service worker. That means we can determine how we want to handle the request and potentially serve our own cached response.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="hljs-string">'fetch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'[ServiceWorker] Fetch'</span>, e.request.url)</span><br><span class="line">  e.responseWith(</span><br><span class="line">    caches.match(e.request).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>&#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> response || fetch(e.request)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Stepping from inside, out, <code>caches.match()</code> evaluates the web request that triggered the <code>fetch</code> event, and checks to see if it’s available in the cache. It then either responds with the cached version, or uses <code>fetch</code> to get a copy from the network. The <code>response</code> is passed back to the web page with <code>e.responseWith()</code></p>
<h3 id="Beware-of-the-edge-cases"><a href="#Beware-of-the-edge-cases" class="headerlink" title="Beware of the edge cases"></a>Beware of the edge cases</h3><p>This code must not be used in production because of the many unhandled edge cases</p>
<ul>
<li><p>Cache depends on updating the cache key for every change</p>
</li>
<li><p>Requires everything to be redownloaded for every change</p>
</li>
<li><p>Browser cache may prevent the service worker cache from updating</p>
</li>
<li><p>Beware of cache-first strategies in production</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-31T05:53:13.000Z">2017-05-31</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 638 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/31/Simple-Guide-of-Jest/">Simple Guide of Jest</a>
            
        </h1>
        <div class="content">
            <h1 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev jest</span><br></pre></td></tr></table></figure>
<h1 id="Simple-Case"><a href="#Simple-Case" class="headerlink" title="Simple Case"></a>Simple Case</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// sum.js</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span> (<span class="hljs-params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = sum</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// sum.test.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> test = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jest'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> expect = <span class="hljs-built_in">require</span>(<span class="hljs-string">'expect'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> sum = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./sum'</span>)</span><br><span class="line">test(<span class="hljs-string">'adds 1 + 2 to equals 3'</span>, () =&gt; &#123;</span><br><span class="line">  expect(sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>).toBe(<span class="hljs-number">3</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="With-Babel"><a href="#With-Babel" class="headerlink" title="With Babel"></a>With Babel</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev babel-jest</span><br></pre></td></tr></table></figure>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// .babelrc</span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"presets"</span>: [</span><br><span class="line">    [ <span class="hljs-string">"env"</span>, &#123;</span><br><span class="line">      <span class="hljs-attr">"targets"</span>: &#123;</span><br><span class="line">        <span class="hljs-attr">"node"</span>: <span class="hljs-string">"current"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Jest will automatically define <code>NODE_ENV</code> as <code>test</code>. It will not use <code>development</code> section like Babel does by default when no <code>NODE_ENV</code> is set.</p>
</blockquote>
<blockquote>
<p><code>babel-jest</code> is automatically installed when installing Jest and will automatically transform files if a babel configuration exists in your project. To avoid this, you can explicitly reset the <code>transform</code> configuration option:</p>
</blockquote>
<p>In <code>package.json</code></p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"jest"</span>: &#123;</span><br><span class="line">    <span class="hljs-attr">"transform"</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Globals"><a href="#Globals" class="headerlink" title="Globals"></a>Globals</h2><p>In your test files, Jest puts each of its methods and objects into the global environment. You don’t need to require or import anything to use them.</p>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><ul>
<li>afterAll(fn): Runs a function after all the tests in this file have completed. If the function returns a promise, Jest waits for that promise to resolve before continuing. This is often useful if you want to clean up some global setup state that is shared across tests.</li>
</ul>
<p>If <code>afterAll</code> is inside a <code>describe</code> block, it runs at the end of the describe block.</p>
<ul>
<li>afterEach(fn): Runs a function after each test in this file. If the function returns a promise, Jest waits for the promise to resolve before continuing. This is often useful if you want to clean up some temprary state that is created by each test.</li>
</ul>
<p>If <code>afterEach</code> is inside a <code>describe</code> block, it only runs after the tests that are inside this describe block.</p>
<ul>
<li><p>beforeAll(fn): similar to <code>afterAll()</code></p>
</li>
<li><p>beforeEach(fn): similar to <code>afterEach()</code></p>
</li>
<li><p>describe(name, fn): create a block that groups together several related tests in one ‘test suite’. For example, if you have a <code>myBeverage</code> object that is supposed to be delicious but not sour, you could test it with:</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> myBeverage = &#123;</span><br><span class="line">  delicious: <span class="hljs-literal">true</span>,</span><br><span class="line">  sour: <span class="hljs-literal">false</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">describe(<span class="hljs-string">'my beverage'</span>, () =&gt; &#123;</span><br><span class="line">  test(<span class="hljs-string">'is delicious'</span>, () =&gt; &#123;</span><br><span class="line">    expect(myBeverage.delicious).toBeTruthy()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  test(<span class="hljs-string">'is not sour'</span>, () =&gt; &#123;</span><br><span class="line">    expect(myBeverage.sour).toBeFalsy()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>This isn’t required - you can just write the <code>test</code> block directly at the top level.</p>
<ul>
<li>describe.only(name, fn): You can use <code>describe.only</code> if you want to run only one describe block</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">describe.only(<span class="hljs-string">'my beverage'</span>, () =&gt; &#123;</span><br><span class="line">  test(<span class="hljs-string">'is delicious'</span>, () =&gt; &#123;</span><br><span class="line">    expect(myBeverage.delicious).toBeTruthy()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="hljs-string">'my other beverage'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...will be skipped</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>describe.skip(name, fn): you can use <code>describe.skip</code> if you do not want to run a particular describe block:</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="hljs-string">'my beverage'</span>, () =&gt; &#123;</span><br><span class="line">  test(<span class="hljs-string">'is delicious'</span>, () =&gt; &#123;</span><br><span class="line">    expect(myBeverage.delicious).toBeTruthy()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe.skip(<span class="hljs-string">'my other beverage'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ... will be skipped</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>require.requireActual(moduleName): returns the actual module instead of a mock, bypassing all checks on whether the module should receive a mock implementation or not.</p>
</li>
<li><p>require.requireMock(moduleName): returns a mock module instead of the actual module, bypassing all checks on whether the module should be required normally or not.</p>
</li>
<li><p>test(name, fn): Also under the alias <code>it(name, fn)</code>, all you need in a test file is that the <code>test</code> method which runs a test. For example, let’s say there’s a function <code>inchesOfRain()</code> that should be zero. Your whole test could be:</p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="hljs-string">'did not rain'</span>, () =&gt; &#123;</span><br><span class="line">  expect(inchesOfRain()).toBe(<span class="hljs-number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>The first argument is the test name; the second argument is a function that contains the expectations to test</p>
<p>If a promise is returned from <code>test</code>, Jest will wait for the promise to resolve before letting the test complete.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="hljs-string">'has lemon in it'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> fetchBeverageList().then(<span class="hljs-function"><span class="hljs-params">list</span> =&gt;</span> &#123;</span><br><span class="line">    expect(list).toContain(<span class="hljs-string">'lemon'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Even though the call to <code>test</code> will return right away, the test doesn’t complete until the promise resolves as well.</p>
<ul>
<li><p>test.only(name, fn): similar to <code>describe.only()</code></p>
</li>
<li><p>test.skip(name, fn): similar to <code>describe.skip()</code></p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-30T14:21:07.000Z">2017-05-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 654 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/30/webpack-code-splitting-async/">Webpack Code Splitting - Async</a>
            
        </h1>
        <div class="content">
            <p>Currently a ‘function-like’ <code>import()</code> module loading syntax proposal is on the way into ECMAScript.</p>
<p>The ES6 Defines <code>import()</code> as method to load ES6 modules dynamically onruntime.</p>
<p>Webpack treats <code>import()</code> as a split-point and puts the requested module in a seperate chunk. <code>import()</code> takes the module name as argument and returns a <code>Promise</code>: <code>import(name) =&gt; Promise</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">determineDate</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">import</span>(<span class="hljs-string">'moment'</span>).then(<span class="hljs-function">(<span class="hljs-params">moment</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(moment().format())</span><br><span class="line">  &#125;).catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'failed'</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">determineDate()</span><br></pre></td></tr></table></figure>
<p>Note that the fully dynamic statement, such as <code>import(foo)</code> will fail because webpack requries at least some file location information. This is because <code>foo</code> could potentially be any path to any file in your system or project. The <code>import()</code> must contain at least some information about where the module is located. so bundling can be limited to a specific directory or set of files.</p>
<h1 id="Chunk-Name"><a href="#Chunk-Name" class="headerlink" title="Chunk Name"></a>Chunk Name</h1><p>Since webpack 2.4.0, chunk names for dynamic imports can be specified using a “magic comment”</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: 'my-chunk-name' */</span> <span class="hljs-string">'module'</span>)</span><br></pre></td></tr></table></figure>
<p>Since webpack 2.6.0, the placeholder <code>[request]</code>, <code>[index]</code> are supported:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// will generate files like `i18n/namespace-i18n-bundle-en.json`</span></span><br><span class="line"><span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: 'i18n/[request]' */</span> <span class="hljs-string">`i18n/<span class="hljs-subst">$&#123;namespace&#125;</span>-i18n-bundle-<span class="hljs-subst">$&#123;language&#125;</span>.json`</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// will generate files `i18n-0`, `i18n-1`</span></span><br><span class="line"><span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: 'i18n-[index]' */</span> <span class="hljs-string">'`i18n/$&#123;namespace&#125;-i18n-bundle-$&#123;language&#125;.json`'</span>)</span><br></pre></td></tr></table></figure>
<h1 id="import-mode"><a href="#import-mode" class="headerlink" title="import mode"></a>import mode</h1><p>Since webpack 2.6.0, different modes for resolving dynamic imports can be specified:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackMode: lazy */</span> <span class="hljs-string">`i18n/<span class="hljs-subst">$&#123;namespace&#125;</span>-i18n-<span class="hljs-subst">$&#123;language&#125;</span>.json`</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>lazy: The default behavior. Lazy generates a chunk per request. So everything is lazy loaded.</p>
</li>
<li><p>lazy-once: Only available for imports with expression. Generate a single chunk for all possible requests. So the first request causes a network request for all modules, all following requests are already fulfilled.</p>
</li>
<li><p>eager: Eager generates no chunk. All files are included in the current chunk. No network request is required to load the files. It still returns a Promise, but it’s already resolved.</p>
</li>
</ul>
<p>You can combine both options ( webpackChunkName and webpackMode ), it’s parsed a JSON5 object without curly brackets:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackMode: 'lazy-once', webpackChunkName: 'all-i18n-data' */</span> <span class="hljs-string">`i18n/<span class="hljs-subst">$&#123;namespace&#125;</span>-i18n-<span class="hljs-subst">$&#123;lanaguage&#125;</span>.json`</span>)</span><br></pre></td></tr></table></figure>
<h1 id="Usage-with-Babel"><a href="#Usage-with-Babel" class="headerlink" title="Usage with Babel"></a>Usage with Babel</h1><p>If you want to use <code>import</code> with Babel, you’ll need to install the <code>syntax-dynamic-import</code> plugin while it’s still Stage 3 to get around the parser error.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev babel-core babel-loader babel-plugin-syntax-dynamic-import babel-preset-es2015</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">determineDate</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">import</span>(<span class="hljs-string">'moment'</span>).then(<span class="hljs-function"><span class="hljs-params">moment</span> =&gt;</span> moment().format()).then(<span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(str)).catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(e))</span><br><span class="line">&#125;</span><br><span class="line">determineDate()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="hljs-string">'./index'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="hljs-string">'app.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="hljs-regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="hljs-regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="hljs-string">'babel-loader'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"presets"</span>: [[<span class="hljs-string">"es2015"</span>, &#123; <span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span> &#125;]],</span><br><span class="line">  <span class="hljs-attr">"plugins"</span>: [<span class="hljs-string">"syntax-dynamic-import"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Diabled default import in es6.</p>
</blockquote>
<p>Not using the <code>syntax-dynamic-import</code> plugin will fail the build with</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Module build failed: SyntaxError: <span class="hljs-string">'import'</span> and <span class="hljs-string">'export'</span> may only appear at the top level</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Module build failed: SyntaxError: Unexpected token, expected \&#123;</span><br></pre></td></tr></table></figure>
<h1 id="Usage-with-Babel-and-async-await"><a href="#Usage-with-Babel-and-async-await" class="headerlink" title="Usage with Babel and async / await"></a>Usage with Babel and <code>async / await</code></h1><p>To use es7 <code>async</code>/<code>await</code> with <code>import()</code></p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev babel-plugin-transform-async-to-generator babel-plugin-trasnform-regenerator babel-plugin-transform-runtime babel-plugin-syntax-async-functions</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">determineDate</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> moment = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'moment'</span>)</span><br><span class="line">  <span class="hljs-keyword">return</span> moment().format()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">determineDate().then(<span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(str))</span><br></pre></td></tr></table></figure>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"presets"</span>: [[<span class="hljs-string">"es2015"</span>, &#123; <span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span> &#125;]],</span><br><span class="line">  <span class="hljs-attr">"plugins"</span>: [</span><br><span class="line">    <span class="hljs-string">"syntax-async-functions"</span>,</span><br><span class="line">    <span class="hljs-string">"syntax-dynamic-import"</span>,</span><br><span class="line">    <span class="hljs-string">"transform-async-to-generator"</span>,</span><br><span class="line">    <span class="hljs-string">"trasnform-regenerator"</span>,</span><br><span class="line">    <span class="hljs-string">"transform-runtime"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="import-imports-the-entire-module-namespace"><a href="#import-imports-the-entire-module-namespace" class="headerlink" title="import() imports the entire module namespace"></a><code>import()</code> imports the entire module namespace</h1><p>Note that the promise is resolved with the module namespace. Consider the following two examples:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Example 1: top-level import</span></span><br><span class="line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Component <span class="hljs-keyword">from</span> <span class="hljs-string">'./component'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Example 2: Code Splitting With Import()</span></span><br><span class="line"><span class="hljs-keyword">import</span>(<span class="hljs-string">'./component'</span>).then(<span class="hljs-function"><span class="hljs-params">Component</span> =&gt;</span> <span class="hljs-comment">/* ... */</span>)</span><br></pre></td></tr></table></figure>
<p><code>Component</code> in both of the cases resolves to the same thing, meaning in the case of using <code>import()</code> with ES2015 moduels you have to explicitly access default and named exports:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// Destructing Example</span></span><br><span class="line">  <span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">default</span>: Component &#125; = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span> (<span class="hljs-string">'./component'</span>)</span><br><span class="line">  <span class="hljs-comment">// Inline example</span></span><br><span class="line">  render((<span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./component'</span>)).default)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-30T10:12:40.000Z">2017-05-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 714 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/30/mongodb-simple-guide/">Mongodb Simple Guide</a>
            
        </h1>
        <div class="content">
            <ul>
<li><p><code>yarn add mongoose</code></p>
</li>
<li><p><code>import mongoose from &#39;mongoose&#39;</code></p>
</li>
<li><p><code>const db = mongoose.conenct(MONGODB_URI)</code></p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">'mongoose'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> db = mongoose.connect(MONGODB_URI)</span><br><span class="line"></span><br><span class="line">db.connection.on(<span class="hljs-string">'open'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'connected'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">db.connection.on(<span class="hljs-string">'error'</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`db error: <span class="hljs-subst">$&#123;err&#125;</span>`</span>)</span><br><span class="line">  process.exit</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h1><p>Schema defines the skeleton of minimal unit</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">'mongoose'</span></span><br><span class="line"><span class="hljs-keyword">const</span> TestSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span> &#125;,</span><br><span class="line">  age: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0</span> &#125;,</span><br><span class="line">  time: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>, <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now() &#125;,</span><br><span class="line">  email: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">''</span> &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Primitive Types: String, Number, Boolean, null, Array, Document, Date</p>
</blockquote>
<h1 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h1><p>Instance of Schema, it has ability to operate db</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> db = mongoose.connect(MONGODB.URI)</span><br><span class="line"><span class="hljs-keyword">const</span> testModal = db.model(<span class="hljs-string">'test1'</span>, TestSchema)</span><br></pre></td></tr></table></figure>
<ul>
<li>test1: Name of Collection in the DB</li>
</ul>
<h1 id="Entity"><a href="#Entity" class="headerlink" title="Entity"></a>Entity</h1><p>Instance of Model, it has ability to operate db</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> TestEntity = <span class="hljs-keyword">new</span> TestModel(&#123;</span><br><span class="line">  name: <span class="hljs-string">'Lenka'</span>,</span><br><span class="line">  age: <span class="hljs-number">35</span>,</span><br><span class="line">  email: <span class="hljs-string">'lenka@gmail.com'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">console</span>.log(TestEntity.name) <span class="hljs-comment">// Lenka</span></span><br><span class="line"><span class="hljs-built_in">console</span>.log(TestEntity.age) <span class="hljs-comment">// 35</span></span><br></pre></td></tr></table></figure>
<h1 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">'mongoose'</span></span><br><span class="line"><span class="hljs-keyword">const</span> db = mongoose.connect(MONGODB.URI)</span><br><span class="line"><span class="hljs-keyword">const</span> TestSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span> &#125;,</span><br><span class="line">  age: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0</span> &#125;,</span><br><span class="line">  email: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span> &#125;,</span><br><span class="line">  time: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>, <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now() &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> TestModel = db.model(<span class="hljs-string">'test1'</span>, TestSchema)</span><br><span class="line"><span class="hljs-keyword">const</span> TestEntity = <span class="hljs-keyword">new</span> TestModel(&#123;</span><br><span class="line">  name: <span class="hljs-string">'hello world'</span>,</span><br><span class="line">  age: <span class="hljs-number">12</span>,</span><br><span class="line">  email: <span class="hljs-string">'helloworld@gmail.com'</span>,</span><br><span class="line">&#125;)</span><br><span class="line">TestEntity.save(<span class="hljs-function">(<span class="hljs-params">err, doc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) =&gt; &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'error: '</span> + err)</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(doc)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Find"><a href="#Find" class="headerlink" title="Find"></a>Find</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.find(condition, field, callback)</span><br></pre></td></tr></table></figure>
<p>if <code>fields</code> is omited, or <code>null</code>, the docs will return all attributes</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Model.find(&#123; <span class="hljs-string">'age'</span>: <span class="hljs-number">25</span> &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(docs)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Model.find(&#123;&#125;, &#123; <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">_id</span>: <span class="hljs-number">0</span> &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// the specific attributes will be returned if corresponding fields are set to positive(here they are name and age), and _id is default to be displayed, if you want to omit it, you should set it to be 0.</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="findOne"><a href="#findOne" class="headerlink" title="findOne"></a>findOne</h1><p>Same as <code>find</code>, except it will return only one matched</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TestModel.findOne(condition, fields, (err, doc) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="findById"><a href="#findById" class="headerlink" title="findById"></a>findById</h1><p>Same as <code>findOne</code>, but it only find by <code>_id</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TestModel.findById(<span class="hljs-string">'obj._id'</span>, (err, doc) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Model.create(&#123;&#125;, callback)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Model.create(&#123;</span><br><span class="line">  name: <span class="hljs-string">'test'</span>,</span><br><span class="line">  age: <span class="hljs-number">12</span>,</span><br><span class="line">&#125;, (err, doc) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(doc)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">TestModel.create([</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test1'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test2'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test3'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test4'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test5'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test6'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test7'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test8'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test9'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h1 id="Save"><a href="#Save" class="headerlink" title="Save"></a>Save</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Entity.save(&#123;&#125;, callback)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> Entity = <span class="hljs-keyword">new</span> Model(&#123;</span><br><span class="line">  name: <span class="hljs-string">'entity_save'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Entity.save(<span class="hljs-function">(<span class="hljs-params">err, doc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(doc)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Model.create</p>
</blockquote>
<blockquote>
<p>Entity.save</p>
</blockquote>
<h1 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.update(&#123;&#125;, callback)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> conditions = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'test_upate'</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> update = &#123; <span class="hljs-attr">$set</span>: &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">16</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line">TestModel.update(conditions, update, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'success'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Remove"><a href="#Remove" class="headerlink" title="Remove"></a>Remove</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.remove(&#123;&#125;, callback)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> conditions = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'tim'</span> &#125;</span><br><span class="line"></span><br><span class="line">TestModel.remove(conditions, (err) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'success'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Advanced-Search"><a href="#Advanced-Search" class="headerlink" title="Advanced Search"></a>Advanced Search</h1><ul>
<li><p><code>$lt</code>: less than</p>
</li>
<li><p><code>$lte</code>: less than or equal to</p>
</li>
<li><p><code>$gt</code>: greater than</p>
</li>
<li><p><code>$gte</code>: greater than or equal to</p>
</li>
<li><p><code>$ne</code>: not equal to</p>
</li>
<li><p><code>$in</code>: belong to</p>
</li>
<li><p><code>$or</code>: or</p>
</li>
<li><p><code>$exists</code>: exist</p>
</li>
<li><p><code>$all</code></p>
</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Model.find(&#123; <span class="hljs-string">"age"</span>: &#123; <span class="hljs-string">"$gt"</span>: <span class="hljs-number">18</span>, <span class="hljs-string">"$lt"</span>: <span class="hljs-number">50</span> &#125; &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Model.find(&#123; <span class="hljs-string">"age"</span>: &#123; <span class="hljs-string">"$in"</span>: [<span class="hljs-number">20</span>, <span class="hljs-number">30</span>] &#125; &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Model.find(&#123;</span><br><span class="line">  <span class="hljs-string">"$or"</span>: [</span><br><span class="line">    &#123; <span class="hljs-string">"name"</span>: <span class="hljs-string">"yaya"</span> &#125;,</span><br><span class="line">    &#123; <span class="hljs-string">"age"</span>: <span class="hljs-number">28</span> &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Model.find(&#123;</span><br><span class="line">  name: <span class="hljs-string">"$exists"</span></span><br><span class="line">&#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Limit"><a href="#Limit" class="headerlink" title="Limit"></a>Limit</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find(condition, &#123; <span class="hljs-attr">limit</span>: <span class="hljs-number">20</span> &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, docs</span>) =&gt; </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Model.find(&#123;&#125;, <span class="hljs-literal">null</span>, &#123; <span class="hljs-attr">limit</span>: <span class="hljs-number">20</span> &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Skip"><a href="#Skip" class="headerlink" title="Skip"></a>Skip</h1><p>Skim first n docs</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find(&#123;&#125;, <span class="hljs-literal">null</span>, &#123; <span class="hljs-attr">skip</span>: <span class="hljs-number">4</span> &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>if total docs less than 4, it will output nothing</p>
<h1 id="Sort"><a href="#Sort" class="headerlink" title="Sort"></a>Sort</h1><p><code>-1</code>: descending, <code>1</code>: ascending</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Model.find(&#123;&#125;, <span class="hljs-literal">null</span>, &#123; <span class="hljs-attr">sort</span>: &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">-1</span> &#125; &#125;, (err, docs) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="ObjectId"><a href="#ObjectId" class="headerlink" title="ObjectId"></a>ObjectId</h1><p>The default id <code>_id</code> could be any types in mongodb, and default to be <code>ObjectId</code></p>
<p>ObjectId, is a 12-types BSON String.</p>
<ul>
<li><p>4 byte: UNIX TimeStamp</p>
</li>
<li><p>3 byte: Represents the OS where mongodb running on</p>
</li>
<li><p>2 byte: Represents the process where this <code>_id</code> in on</p>
</li>
<li><p>3 byte: Rnadom Number</p>
</li>
</ul>
<h1 id="Schema-add-Attribute"><a href="#Schema-add-Attribute" class="headerlink" title="Schema add Attribute"></a>Schema add Attribute</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">'mongoose'</span></span><br><span class="line"><span class="hljs-keyword">const</span> TestSchema = <span class="hljs-keyword">new</span> mongoose.Schema</span><br><span class="line">TestSchema.add(&#123;</span><br><span class="line">  name: <span class="hljs-string">'String'</span>,</span><br><span class="line">  email: <span class="hljs-string">'String'</span>,</span><br><span class="line">  age: <span class="hljs-string">'Number'</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="Schema-add-instance-method"><a href="#Schema-add-instance-method" class="headerlink" title="Schema add instance method"></a>Schema add instance method</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">'mongoose'</span></span><br><span class="line"><span class="hljs-keyword">const</span> TextSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="hljs-string">'String'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">TestSchema.method(<span class="hljs-string">'test'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'hah'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="hljs-keyword">const</span> say = mongoose.model(<span class="hljs-string">'say'</span>, TestSchema)</span><br><span class="line"><span class="hljs-keyword">var</span> lenka = say()</span><br><span class="line">lenka.say() <span class="hljs-comment">// 'hah'</span></span><br></pre></td></tr></table></figure>
<h1 id="Schema-add-static-method"><a href="#Schema-add-static-method" class="headerlink" title="Schema add static method"></a>Schema add static method</h1><p><code>`</code>javascript import mongoose from ‘mongoose’ const db = mongoose.connect(MONGODB.URI) const TestSchema = new mongoose.Schema({ name: { type: String }, age: { type: Number }, })</p>
<p>TestSchema.static(‘findByName’, (name, cb) =&gt; { return this.find({name: name}, cb) })</p>
<p>const TestModel = db.model(‘test’, TestSchema) TestModel.findByName(‘tim’, (err, docs) =&gt; { // … })</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-29T17:50:22.000Z">2017-05-30</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 792 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/30/start-in-typescript/">TypeScript With Node</a>
            
        </h1>
        <div class="content">
            <h1 id="Configuring-TypeScript-Compilation"><a href="#Configuring-TypeScript-Compilation" class="headerlink" title="Configuring TypeScript Compilation"></a>Configuring TypeScript Compilation</h1><p>TypeScript uses the file <code>tsconfig.json</code> to adjust project compile options</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">"compilerOptions": &#123;</span><br><span class="line">  "module": "commonjs",</span><br><span class="line">  "target": "es6",</span><br><span class="line">  "noImplicityAny": true,</span><br><span class="line">  "moduleResolution": "node",</span><br><span class="line">  "sourceMap": true,</span><br><span class="line">  "outDir": "dist",</span><br><span class="line">  "baseUrl": ".",</span><br><span class="line">  "paths": &#123;</span><br><span class="line">    "*": [</span><br><span class="line">      "node_modules/*",</span><br><span class="line">      <span class="hljs-string">"src/types/*"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th><code>compilerOptions</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>“module”: “commonjs”</td>
<td>The <strong>output</strong> module type (in your <code>.js</code> files). Node uses commonjs</td>
</tr>
<tr>
<td>“target”: “es6”</td>
<td>The output language level. Node supports ES6</td>
</tr>
<tr>
<td>“noImplicityAny”: true</td>
<td>Enables a stricter setting which throws errors when something has a default <code>any</code> value</td>
</tr>
<tr>
<td>“moduleResolution”: “node”</td>
<td>TypeScript attempts to mimic Node’s module resolution strategy</td>
</tr>
<tr>
<td>“sourceMap”: true</td>
<td></td>
</tr>
<tr>
<td>“ourDir”: “dist”</td>
<td>Location to output <code>.js</code> files after compilation</td>
</tr>
<tr>
<td>“baseUrl”: “.”</td>
<td>Part of configuring module resolution</td>
</tr>
<tr>
<td>“paths”: {…}</td>
<td>Part of configuring module resolution</td>
</tr>
</tbody>
</table>
<p>The rest of the file define the TypeScript project context. The project context is basically a set of options that determine which files are compiled when the compiler is invoked with a specific <code>tsconfig.json</code>.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"include": [</span><br><span class="line">  <span class="hljs-string">"src/**/*"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><code>include</code> takes an array of glob pattern of files to include in the compilation.</p>
<h1 id="Type-Definition-d-ts-Files"><a href="#Type-Definition-d-ts-Files" class="headerlink" title="Type Definition (.d.ts) Files"></a>Type Definition (<code>.d.ts</code>) Files</h1><p>TypeScript uses <code>.d.ts</code> files to provide types for JavaScript libraries that were not written in TypeScript. This is great because once you have a <code>.d.ts</code> file, TypeScript can type check that library and provide you better help in your editor. The TypeScript community actively shares all the most up-to-date <code>.d.ts</code> files for popular libraries on a Github repository called <strong>DefinitelyTyped</strong>.</p>
<p>Because the <code>&quot;noImplicityAny&quot;: true</code>, we are required to have a <code>.d.ts</code> file for every library used. You could set <code>noImplicityAny</code> to <code>false</code> to silence errors about missing <code>.d.ts</code> files. It’s a best practice to have a <code>.d.ts</code> file for every library(Even the <code>.d.ts</code> file is basically empty)</p>
<h1 id="Installing-d-ts-files-from-DefinitelyTyped"><a href="#Installing-d-ts-files-from-DefinitelyTyped" class="headerlink" title="Installing .d.ts files from DefinitelyTyped"></a>Installing <code>.d.ts</code> files from DefinitelyTyped</h1><p>For the most part, you’ll find <code>d.ts</code> files for the libraries you are using on DefinitelyTyped. These <code>.d.ts</code> files can be easily installed into your project by using npm scope <code>@types</code>. For example, if we want the <code>.d.ts</code> file for jQuery, we can do so with <code>npm install --save-dev @types/jquery</code>.</p>
<p>Once <code>.d.ts</code> files have been installed using npm, you should see them in your <code>node_modules/@types</code> folder. The compiler will always look in this folder for <code>.d.ts</code> files when resolving JavaScript libraries.</p>
<h1 id="What-if-a-library-isn’t-on-DefinitelyTyped"><a href="#What-if-a-library-isn’t-on-DefinitelyTyped" class="headerlink" title="What if a library isn’t on DefinitelyTyped?"></a>What if a library isn’t on DefinitelyTyped?</h1><p>Setting up TypeScript to look for <code>.d.ts</code> files in another folder</p>
<p>The Compiler knows to look in <code>node_modules/@types</code> by default, but to help the compiler find our own <code>.d.ts</code> files we have to configure path mapping in our <code>tsconfig.json</code>. Path mapping can get pretty confusing, but the basic idea is that the TypeScript compiler will look in specific places, in a specific order when resolving modules, and we have the ability to tell the compiler exactly how to do it. In the <code>tsconfig.json</code> for this project you’ll see the following:</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"baseUrl": ".",</span><br><span class="line">"paths": &#123;</span><br><span class="line">  "*": [</span><br><span class="line">    <span class="hljs-string">"src/types/*"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This tells the TypeScript compiler that in addition to looking in <code>node_module/@types</code> for every import (<code>*</code>) also look in our own <code>.d.ts</code> file location <code>&lt;baseUrl&gt; + src/types/*</code></p>
<p>First the compiler will look for a <code>.d.ts</code> file in <code>node_modules/@types</code> and then <code>src/types</code></p>
<h1 id="Summary-of-d-ts-management"><a href="#Summary-of-d-ts-management" class="headerlink" title="Summary of .d.ts management"></a>Summary of <code>.d.ts</code> management</h1><p>In general if you stick to the following steps you should have minimal <code>.d.ts</code> issues:</p>
<ul>
<li><p>After installing any npm package as a dependency or dev dependency, immediately try to install the <code>.d.ts</code> file via <code>@types</code></p>
</li>
<li><p>If the library has a <code>.d.ts</code> file on DefinitelyTyped, the install wil succeed and you are done, if the install fails because the package doesn’t exist, generate <code>.d.ts</code> by yourself</p>
</li>
</ul>
<h1 id="Source-Map"><a href="#Source-Map" class="headerlink" title="Source Map"></a>Source Map</h1><p>In the <code>tsconfig.json</code></p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"compilerOptiosn": &#123;</span><br><span class="line">  "sourceMaps": true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>With this option enabled, next to every <code>.js</code> file that the TypeScript compiler outputs there will be a <code>.map.js</code> file as well. This <code>.map.js</code> file provides the information necessary to map back to the source <code>.ts</code> file while debugging.</p>
<h1 id="Using-Debugger-in-VS-Code"><a href="#Using-Debugger-in-VS-Code" class="headerlink" title="Using Debugger in VS Code"></a>Using Debugger in VS Code</h1><p>When debugging in VS Code, it looks for a top level <code>.vscode</code> folder with a <code>launch.json</code> file. In this file, you can tell VS Code exactly what you want to do:</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,</span><br><span class="line">  <span class="hljs-attr">"request"</span>: <span class="hljs-string">"launch"</span>,</span><br><span class="line">  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Debug"</span>,</span><br><span class="line">  <span class="hljs-attr">"program"</span>: <span class="hljs-string">"$&#123;workspaceRoot&#125;/dist/server.js"</span>,</span><br><span class="line">  <span class="hljs-attr">"smartStep"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">  <span class="hljs-attr">"outFiles"</span>: [</span><br><span class="line">    <span class="hljs-string">"../dist/**/*.js"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="hljs-attr">"protocal"</span>: <span class="hljs-string">"inspector"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This is mostly identical to the “Node.js: Launch Program” template with a couple minor changes:</p>
<table>
<thead>
<tr>
<th><code>launch.json</code> Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>“program”: “${workspaceRoot}/dist/server.js”</td>
<td>Modified to point to our entry point in <code>dist</code></td>
</tr>
<tr>
<td>“smartStep”: true</td>
<td>Won’t step into code that doesn’t have a source map</td>
</tr>
<tr>
<td>“outFiles”: […]</td>
<td>Specify where output files a dropped. Use with source map</td>
</tr>
<tr>
<td>“protocal”: “inspector”</td>
<td>Use the new Node Debug Protocal because we’re on the latest node</td>
</tr>
</tbody>
</table>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-29T14:16:16.000Z">2017-05-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 210 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/29/drag-upload-and-progress/">Drag, Upload and Progress</a>
            
        </h1>
        <div class="content">
            <p>Dragging and dropping files from your desktop to a browser is one of the ultimate goals for web application integration, which consists of:</p>
<ul>
<li><p>enable file dragging and dropping onto a web page element</p>
</li>
<li><p>analyze dropped files in JavaScript</p>
</li>
<li><p>load and parse files on the client</p>
</li>
<li><p>asynchronously upload files to the server using XMLHttpRequest2</p>
</li>
<li><p>show a graphical progress bar while the upload occurs</p>
</li>
<li><p>use progressive enhancement to ensure your file upload from works in any browser</p>
</li>
</ul>
<h1 id="The-File-API"><a href="#The-File-API" class="headerlink" title="The File API"></a>The File API</h1><ul>
<li><p>FileList: represents an array of selected files</p>
</li>
<li><p>File: represents an individual file</p>
</li>
<li><p>FileReader: an interface which allows us to read file data on the client and use it within JavaScript</p>
</li>
</ul>
<h1 id="JavaScript-Events"><a href="#JavaScript-Events" class="headerlink" title="JavaScript Events"></a>JavaScript Events</h1><h2 id="Dragged-Object"><a href="#Dragged-Object" class="headerlink" title="Dragged Object"></a>Dragged Object</h2><ul>
<li><p>dragstart</p>
</li>
<li><p>drag</p>
</li>
<li><p>dragend</p>
</li>
</ul>
<h2 id="Target-Object"><a href="#Target-Object" class="headerlink" title="Target Object"></a>Target Object</h2><ul>
<li><p>dragenter</p>
</li>
<li><p>dragover</p>
</li>
<li><p>dragleave</p>
</li>
<li><p>drop</p>
</li>
</ul>
<h2 id="dataTransfer"><a href="#dataTransfer" class="headerlink" title="dataTransfer"></a>dataTransfer</h2><ul>
<li><p>dropEffect: copy | move | link | none</p>
</li>
<li><p>effectAllowed: copy | move | link | copyLink | copyMove | linkMove | none | all (default)</p>
</li>
<li><p>files</p>
</li>
<li><p>types</p>
</li>
<li><p>setDragImage(imgElement, x, y): set custom icon along dragging</p>
</li>
<li><p>setData(format, data)</p>
</li>
<li><p>getData(format)</p>
</li>
<li><p>clearData()</p>
</li>
</ul>
<h1 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h1><p>By default, brower will refuse all drag actions(and file will be opened in browser if files from desktop dragged into the browser), so <code>e.preventDefault()</code> should be added in <code>dropover</code> and <code>drop</code> event</p>
<p>Dragging Text will automatically set <code>e.dataTransfer.setData(&#39;text/plain&#39;, node.innerText)</code></p>
<p>Dragging File will add files to <code>e.dataTransfer.files</code></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-25T16:11:01.000Z">2017-05-26</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 439 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/26/simple-usage-of-flatMap/">Simple Usage of flatMap</a>
            
        </h1>
        <div class="content">
            <p><a href="http://2ality.com/2017/04/flatmap.html" target="_blank" rel="noopener">origin</a></p>
<p>Both <code>map()</code> and <code>flatMap()</code> take a function <code>f</code> as a parameter that controls how an input Array is translated to an output Array:</p>
<ul>
<li><p>With <code>map()</code>, each input Array element is translated to exactly one output element, aka, <code>f</code> returns a single value</p>
</li>
<li><p>With <code>flatMap()</code>, each input Array element is translated to zero or more output elements, aka, <code>f</code> returns an Array of values.</p>
</li>
</ul>
<p>An smiple implementation of <code>flatMap</code>:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flatMap</span> (<span class="hljs-params">arr, mapFunc</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">const</span> result = []</span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [index, value] <span class="hljs-keyword">of</span> arr.entries()) &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> x = mapFunc(value, index, arr)</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(x)) &#123;</span><br><span class="line">      result.push(...x)</span><br><span class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">      result.push(x)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>flatMap</code> is simpler if <code>mapFunc</code> is only allowed to return Arrays, but we don’t impose this restriction here, because non-Array values are occasionally useful.</p>
<h1 id="Filtering-and-mapping-at-the-same-time"><a href="#Filtering-and-mapping-at-the-same-time" class="headerlink" title="Filtering and mapping at the same time"></a>Filtering and mapping at the same time</h1><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processArray</span> (<span class="hljs-params">arr, processFunc</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> arr.map(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">value</span>: processFunc(x) &#125;</span><br><span class="line">    &#125; <span class="hljs-keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">error</span>: e &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> results = processArray(myArray, myFunc)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> values = flatMap(results, result =&gt; result.value ? [result.value] : []) <span class="hljs-comment">// here we use [result.value] to avoid destructing value if it is an array.</span></span><br><span class="line"><span class="hljs-keyword">const</span> errors = flapMap(results, result =&gt; result.error ? result.error : [])</span><br></pre></td></tr></table></figure>
<h1 id="Mapping-to-multiple-values"><a href="#Mapping-to-multiple-values" class="headerlink" title="Mapping to multiple values"></a>Mapping to multiple values</h1><p>The Array method <code>map()</code> maps each input Array element to one output. But if we want to map it to multiple output elements?</p>
<p>That becomes necessary in the following example: The React component <code>TagList</code> is invoked with two attributes</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;TagList tags=&#123;[<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-string">'baz'</span>]&#125; handleClick=&#123;x =&gt; <span class="hljs-built_in">console</span>.log(x)&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>The attributes are:</p>
<ul>
<li><p>An Array of tags, each tag being a string</p>
</li>
<li><p>A callback for handling clicks on tags</p>
</li>
</ul>
<p><code>TagList</code> is rendered as a series of links seperated by commas:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagList</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> &#123; tags, handleClick &#125; = <span class="hljs-keyword">this</span>.props</span><br><span class="line">    <span class="hljs-keyword">return</span> flatMap(tags, (tag, index) =&gt; [</span><br><span class="line">      ...(index &gt; <span class="hljs-number">0</span> ? [<span class="hljs-string">', '</span>] : []),</span><br><span class="line">      &lt;a key=&#123;index&#125; href=<span class="hljs-string">""</span> onClick=&#123;e =&gt; handleClick(tag, e)&#125;&gt;</span><br><span class="line">        &#123;tag&#125;</span><br><span class="line">      &lt;<span class="hljs-regexp">/a&gt;</span></span><br><span class="line"><span class="hljs-regexp">    ])</span></span><br><span class="line"><span class="hljs-regexp">  &#125;</span></span><br><span class="line"><span class="hljs-regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>Here each tag (except the first) provide two elements in the rendered Array</p>
<h1 id="Arbitrary-Iterables"><a href="#Arbitrary-Iterables" class="headerlink" title="Arbitrary Iterables"></a>Arbitrary Iterables</h1><p><code>flatMap</code> can be generalized to work with arbitrary iterables</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">flatMapIter</span>(<span class="hljs-params">iterable, mapFunc</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span></span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> x <span class="hljs-keyword">of</span> iterable) &#123;</span><br><span class="line">    <span class="hljs-keyword">yield</span>* mapFunc(x, index)</span><br><span class="line">    index++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>flatMapIter</code> function works with Arrays:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fillArray</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(x).fill(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-built_in">console</span>.log([...flatMapIter([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], fillArray)])</span><br></pre></td></tr></table></figure>
<h1 id="Implementing-flatMap-via-reduce"><a href="#Implementing-flatMap-via-reduce" class="headerlink" title="Implementing flatMap via reduce"></a>Implementing <code>flatMap</code> via <code>reduce</code></h1><p>You can use the Array method <code>reduce</code> to implement a simple version of <code>flatMap</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flatMap</span> (<span class="hljs-params">arr, mapFunc</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> arr.reduce(</span><br><span class="line">    (prev, x) =&gt; prev.concat(mapFunc(x)),</span><br><span class="line">    [],</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Related-to-flatMap-flatten"><a href="#Related-to-flatMap-flatten" class="headerlink" title="Related to flatMap: flatten"></a>Related to <code>flatMap</code>: <code>flatten</code></h1><p><code>flatten</code> is an operation that concatenates all the elements of an Array</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; flatten([<span class="hljs-string">'a'</span>, [<span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>], [<span class="hljs-string">'d'</span>]])</span><br><span class="line">[<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>]</span><br></pre></td></tr></table></figure>
<p>It can be implemented as follows:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> flatten = <span class="hljs-function">(<span class="hljs-params">arr</span>) =&gt;</span> [].concat(...arr)</span><br></pre></td></tr></table></figure>
<p>So the following expressions are equivalent</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flatten(arr.map(func))</span><br><span class="line">flatMap(arr, x =&gt; x)</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-21T14:49:52.000Z">2017-05-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 502 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/21/new-babel-preset-env/">New Babel Preset - Env</a>
            
        </h1>
        <div class="content">
            <p><code>babel-preset-env</code> is a new preset which let you specify an environment and automatically enables the necessary plugins.</p>
<p>At the moment, several presets let you determine what features Babel should support:</p>
<ul>
<li><p><code>babel-preset-es2015</code>, <code>babel-preset-es2016</code>, etc: incrementally support various versions of ECMAScript. <code>babel-preset-es2015</code> transpiles what’s new in ES6 to ES5, <code>babel-preset-es2016</code> transpiles what’s new in ES7 to ES6.</p>
</li>
<li><p><code>babel-preset-latest</code>: supports all features that are either part of an ECMAScript version or at stage 4.</p>
</li>
</ul>
<p>The problem with these presets is that they often do too much. For example, most modern browsers support ES6 generator. Yet if you use <code>babel-preset-es2015</code>, generator functions will always be transpiled to complex ES5 code.</p>
<p><code>babel-preset-env</code> works like <code>babel-preset-latest</code>, but it lets you specify an environment and only transpiles features that are missing in that environment.</p>
<p>Note that you need to install and enable plugins and/or presets for experimental features(that are not part of <code>babel-preset-latest</code>)</p>
<p>On the plus side, you don’t need <code>es2015</code> presets anymore.</p>
<h1 id="Browsers"><a href="#Browsers" class="headerlink" title="Browsers"></a>Browsers</h1><p>For browsers you have the option to specify either:</p>
<ul>
<li><p>Browsers via <code>browserslist</code> query syntax</p>
<ul>
<li><p>Support the last two versions of browsers and IE 7+</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"babel"</span>: &#123;</span><br><span class="line">  <span class="hljs-string">"presets"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="hljs-string">"env"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="hljs-string">"targets"</span>: &#123;</span><br><span class="line">          <span class="hljs-string">"browsers"</span>: [<span class="hljs-string">"last 2 versions"</span>, <span class="hljs-string">"ie &gt;= 7"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Support browsers that have more than 5% market share</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"targets"</span>: &#123;</span><br><span class="line">  <span class="hljs-string">"browsers"</span>: <span class="hljs-string">"&gt; 5%"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Fixed versions of browsers:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"targets"</span>: &#123;</span><br><span class="line">  <span class="hljs-string">"chrome"</span>: <span class="hljs-number">56</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h1><p>If you compile your code for Node.js on the fly via Babel, <code>babel-preset-env</code> is especially useful, because it react to the currently running version of Node.js if you set the target <code>node</code> to <code>current</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"babel"</span>: &#123;</span><br><span class="line">  <span class="hljs-string">"presets"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="hljs-string">"env"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="hljs-string">"target"</span>: &#123;</span><br><span class="line">          <span class="hljs-string">"targets"</span>: &#123;</span><br><span class="line">            <span class="hljs-string">"node"</span>: <span class="hljs-string">"current"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Additional-Options-for-babel-preset-env"><a href="#Additional-Options-for-babel-preset-env" class="headerlink" title="Additional Options for babel-preset-env"></a>Additional Options for <code>babel-preset-env</code></h1><h2 id="modules-string-default-‘commonjs’"><a href="#modules-string-default-‘commonjs’" class="headerlink" title="modules(string, default: ‘commonjs’)"></a>modules(string, default: ‘commonjs’)</h2><p>This options lets you configure to which module format ES6 modules are transpiled:</p>
<ul>
<li><p>Transpile to popular module formats: ‘amd’, ‘commonjs’, ‘systemjs’, ‘umd’</p>
</li>
<li><p>Don’t transpile: false</p>
</li>
</ul>
<h2 id="include-exclude-Array-of-strings-default"><a href="#include-exclude-Array-of-strings-default" class="headerlink" title="include, exclude (Array of strings, default [])"></a>include, exclude (Array of strings, default [])</h2><ul>
<li><p>include: always enables certain plugins</p>
</li>
<li><p>exclude: prevents certain plugins from being enabled</p>
</li>
</ul>
<h2 id="useBuiltIns-boolean-default-false"><a href="#useBuiltIns-boolean-default-false" class="headerlink" title="useBuiltIns (boolean, default: false)"></a>useBuiltIns (boolean, default: false)</h2><p>Babel comes with a polyfill for new functionality in standard library. <code>babel-preset-env</code> can optionally import only those parts of the polyfill that are needed on the specified platforms:</p>
<p>There are two ways of using the polyfill:</p>
<ul>
<li><p><code>core-js</code> polyfills ES5, ES6+ as needed</p>
<ul>
<li><p>install polyfill: <code>yarn add core-js</code></p>
</li>
<li><p>activate polyfill: <code>import &#39;core-js&#39;</code></p>
</li>
</ul>
</li>
<li><p><code>babel-polyfill</code>: polyfills <code>core-js</code> and regenerator runtime(to emulate generators on ES5)</p>
<ul>
<li><p>install polyfill: <code>yarn add babel-polyfill</code></p>
</li>
<li><p>activate polyfill: <code>import &#39;babel-polyfill&#39;</code></p>
</li>
</ul>
</li>
</ul>
<p>Either of the two import statements is transpiled to an environment-specific sequence of more fine-grained imports:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/modules/es7.string.pad-start"</span>;</span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/modules/es7.string.pad-end"</span>;</span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/modules/web.timers"</span>;</span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/modules/web.immediate"</span>;</span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/modules/web.dom.iterable"</span>;</span><br></pre></td></tr></table></figure>
<h2 id="debug-boolean-default-false"><a href="#debug-boolean-default-false" class="headerlink" title="debug (boolean, default: false)"></a>debug (boolean, default: false)</h2><p>Logs the following information via <code>console.log()</code></p>
<ul>
<li><p>Targeted environments</p>
</li>
<li><p>Enabled transformers</p>
</li>
<li><p>Enabled plugins</p>
</li>
<li><p>Enabled polyfills</p>
</li>
</ul>
<h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"presets"</span>: [</span><br><span class="line">    [<span class="hljs-string">"env"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="hljs-attr">"targets"</span>: &#123;</span><br><span class="line">          <span class="hljs-attr">"safari"</span>: <span class="hljs-number">10</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">        <span class="hljs-attr">"useBuiltIns"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">        <span class="hljs-attr">"debug"</span>: <span class="hljs-literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-21T13:38:07.000Z">2017-05-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 492 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/21/babel-polyfill-or-babel-runtime/">Babel-Polyfill or Babel-Runtime</a>
            
        </h1>
        <div class="content">
            <p>The <code>babel-polyfill</code> and <code>babel-runtime</code> modules are sued to serve the same function in two different ways. Both modules ultimately serve to emulate an ES6 environment.</p>
<p>Both <code>babel-polyfill</code> and <code>babel-runtime</code> emulate an ES6 environment with two things:</p>
<ul>
<li><p>a slew of polyfills as provided by <code>core-js</code></p>
</li>
<li><p>complete generator runtime</p>
</li>
</ul>
<p><code>babel-polyfill</code> accomplishes this task by assigning methods on the global or on native type prototypes which means that once required, as far as the javascript runtime you’re using is concerned, ES6 methods and object simply exist. If you were to require <code>babel-polyfill</code> in a script run under <strong>node v0.1.0</strong> – a runtime which does not natively support the <code>Promise</code> API – your script would then have access to the <code>Promise</code> object. As far as you are concerned, you’re suddenly using an environment that support the <code>Promise</code> object.</p>
<p><code>babel-runtime</code> does something very similar, but in a way that does not pollute native object prototypes or the global namespace. Instead, <code>babel-runtime</code> is a module that you can list as a dependency of your application like any other module, which polyfills ES6 methods. In other words and continuing the example from above, while you may not have the <code>Promise</code> object available to you, you now have the same functionality available to you from <code>require(&#39;babel-runtime/core-js/promise&#39;)</code>. By itself, this is useful but inconvenient. Fortunately, <code>babel-runtime</code> is not intended to be used by itself. Rather, <code>babel-runtime</code> is intended to be paired with the transform – <code>babel-plugin-transform-runtime</code> – which will automatically rewrite your code such that you can write your code using the <code>Promise</code> API and it will be transformed to use the Promise-like object exported by <code>babel-runtime</code></p>
<p><code>babel-polyfill</code> offers you the conveniences of gloablly defined objects without having to transform your code further. However, as with anything that mutates a global, this can introduce collision between versions, etc.</p>
<p><code>babel-runtime</code>, on the other hand, will not suffer from collision as everything is name-spcaed. Since the module will be defined in your package.json, it can be versioned like everything else. The tradeoff, however, is that a transform can only do so much. The runtime remaps methods according to a definitions map. Anecdotally, this has covered each of my use-cases but there may be an obscure method or two which is not remapped. There are also certain cases where your intent is ambiguous. In such cases, the transform won’t know exactly what to do.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>To summarize, with the general case for Babel 6, there are two main steps you’ll need to perform:</p>
<ul>
<li>Provide your code with an emulated ES6 environment by either requiring <code>babel-polyfill</code> or requiring the <code>babel-runtime</code> module plus the <code>babel-plugin-transform-runtime</code> transform:</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// for babel-polyfill, either add:</span></span><br><span class="line"><span class="hljs-built_in">require</span>(<span class="hljs-string">'babel-polyfill'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// for babel-runtime, install the module, then use the babel-plugin-transform-runtime transform by including it in your .babelrc file.</span></span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-21T12:10:56.000Z">2017-05-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 584 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/21/Deep-in-Runtime-Transform/">Deep in Runtime-Transform</a>
            
        </h1>
        <div class="content">
            <p>This plugin is recommended in a <strong>library/tool</strong></p>
<blockquote>
<p>Note: Instance methods such as <code>&#39;foobar&#39;.includes(&#39;foo&#39;)</code> will not work since that would require modification of existing built-ins(Use <code>babel-polyfill</code> for that)</p>
</blockquote>
<p>Babel uses very small helpers for common functions such as <code>_extend</code>. By default this will be added to every file that requires it. This duplication is sometimes unnecessary, especially when your application is spread out over multiple files.</p>
<p>This is where the <code>transform-runtime</code> plugin comes in: all of the helpers will reference the module <code>babel-runtime</code> to avoid duplication across your compiled output. The runtime will be compiled into your build.</p>
<p>Another purpose of this transformer is to create a sandboxed environment for your code. If you use <code>babel-polyfill</code> and the built-ins it provides such as <code>Promise</code>, <code>Set</code> and <code>Map</code>, those will pollute the global scope. While this might be ok for an app or a command line tool, it becomes a problem if your code is a library which you intend to publish for other to use or if you can’t exactly control the environment in which your code will run.</p>
<p>The transformer will alias these built-ins to <code>core-js</code> so you can use them seamlessly without having to require the polyfill.</p>
<h1 id="Prod-and-Dev"><a href="#Prod-and-Dev" class="headerlink" title="Prod and Dev"></a>Prod and Dev</h1><p>In most cases, you should install <code>babel-plugin-transform-runtime</code> as a development dependency, and <code>babel-runtime</code> as a production dependency.</p>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>I prefer to use <code>.babelrc</code></p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    [&quot;transform-runtime&quot;, &#123;</span><br><span class="line">      &quot;helpers&quot;: false,</span><br><span class="line">      &quot;polyfill&quot;: false,</span><br><span class="line">      &quot;regenerator&quot;: true,</span><br><span class="line">      &quot;moduleName&quot;: &quot;babel-runtime&quot;</span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>There the options are referred.</p>
<ul>
<li>helpers: boolean, default to <code>true</code></li>
</ul>
<p>Toggles whether or not inlined babel helpers (<code>classCallCheck</code>, <code>extends</code>, etc) are replaced with calls to <code>moduleName</code>.</p>
<ul>
<li>polyfill: boolean, default to be <code>true</code></li>
</ul>
<p>Toggles whether or not new built-ins(<code>Promise</code>, <code>Set</code>, <code>Map</code>, etc) are transformed to use a non-global polluting polyfill.</p>
<ul>
<li>renegerator: boolean, default to <code>true</code></li>
</ul>
<p>Toggles whether or not generator functions are transforms to use a regenerator runtime that does not pollute the global scope.</p>
<ul>
<li>moduleName: string, default to <code>babel-runtime</code></li>
</ul>
<p>Set the name/path of the module used when importing helpers.</p>
<p>Example:</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"moduleName"</span>: <span class="hljs-string">"flavortown/runtime"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> extends <span class="hljs-keyword">from</span> <span class="hljs-string">'flavortown/runtime/helpers/extend'</span></span><br></pre></td></tr></table></figure>
<h1 id="Technical-Details"><a href="#Technical-Details" class="headerlink" title="Technical Details"></a>Technical Details</h1><p>The <code>runtime</code> transformer plugin does three things:</p>
<ul>
<li><p>Automatically requires <code>babel-runtime/renegerator</code> when you use generator/async functions;</p>
</li>
<li><p>Automatically requires <code>babel-runtime/core-js</code> and maps ES6 static methods and built-ins;</p>
</li>
<li><p>Removes the inline Babel helpers and uses the module <code>babel-runtime/helpers</code> instead.</p>
</li>
</ul>
<p>You can use built-ins such as <code>Promise</code>, <code>Set</code>, <code>Symbol</code>, etc., as well as use all the Babel features taht require a polyfill seamlessly, without global pollution, making it extremely suitable for libraries.</p>
<h2 id="Regenerator-aliasing"><a href="#Regenerator-aliasing" class="headerlink" title="Regenerator aliasing"></a>Regenerator aliasing</h2><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> * <span class="hljs-title">foo</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>the following is generated</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> _marked = [foo].map(regeneratorRuntime.mark)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> regeneratorRuntime.wrap(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo$</span>(<span class="hljs-params">_context</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) <span class="hljs-keyword">switch</span> (_context_prev = _context.next) &#123;</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-string">'end'</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> _context.stop()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, _marked[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This isn’t ideal as then you have to include the regenerator runtime which pollutes the global scope.</p>
<p>Instead what the <code>runtime</code> transformer does it compile that to:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> _regenerator = <span class="hljs-built_in">require</span>(<span class="hljs-string">'babel-runtime/regenerator'</span>)</span><br><span class="line"><span class="hljs-keyword">var</span> _regenerator2 = _interopRequireDefault(_regenerator)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_interopRequireDefault</span> (<span class="hljs-params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : &#123; <span class="hljs-attr">default</span>: obj &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> _marked = [foo].map(_regenerator2.default.mark)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> regeneratorRuntime.wrap(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo$</span>(<span class="hljs-params">_context</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) <span class="hljs-keyword">switch</span> (_context_prev = _context.next) &#123;</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-string">'0'</span>:</span><br><span class="line">      <span class="hljs-keyword">case</span> <span class="hljs-string">'end'</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> _context.stop()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, _marked[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This means that you can use the regenerator runtime without polluting your current environment.</p>
<p>The same actions with Core-js Aliasing and Helper Aliasing.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-21T11:34:29.000Z">2017-05-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 165 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/21/More-Faster-React-Functional-Component/">More Faster React Functional Component</a>
            
        </h1>
        <div class="content">
            <p><a href="https://medium.com/missive-app/45-faster-react-functional-components-now-3509a668e69f" target="_blank" rel="noopener">origin</a></p>
<p>An basic <code>Avatar</code> Component:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Avatar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#123;this.props.url&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="hljs-xml">  &#125;</span></span><br><span class="line"><span class="hljs-xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p>And its functional component style is:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> Avatar = <span class="hljs-function">(<span class="hljs-params">&#123; url &#125;</span>) =&gt;</span> &lt;img src=&#123;url&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>As you can see, it’s just a simple js function returning an element.</p>
<p>React still does a lot of stuff on functional components that, by nature, will never be used.</p>
<p>But we can skip React internals for these functional component.</p>
<p>They are just plain JavaScritp functions, which means we can call it in the render function.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;Avatar(&#123; <span class="hljs-attr">url</span>: avatarUrl &#125;)&#125;</span><br><span class="line">    &lt;div&gt;&#123;commentBody&#125;&lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">  &lt;/</span>div&gt;,</span><br><span class="line">  mountNode,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>As we know, the traditional usage:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Avatar url=&#123;avatarUrl&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>will be compiled into</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">React.createElement(Avatar, &#123; <span class="hljs-attr">url</span>: avatarUrl &#125;)</span><br></pre></td></tr></table></figure>
<p>It will cost a lifecycle of a React Component.</p>
<p>But with direct calling of plain JavaScritp Function, all these consumption can be eliminated.</p>
<p>By the way, <code>transform-react-inline-elements</code> does the same as a bebel transform, so there’s no need to change the source code.</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-19T07:25:34.000Z">2017-05-19</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 24 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/19/css-shorthand-collection/">Css Shorthand Collection</a>
            
        </h1>
        <div class="content">
            <figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-tag">body</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">background</span>:</span><br><span class="line">    <span class="hljs-built_in">url</span>(...) <span class="hljs-comment">/* image */</span></span><br><span class="line">    top center / <span class="hljs-number">200px</span> <span class="hljs-number">200px</span> <span class="hljs-comment">/* position / size */</span></span><br><span class="line">    no-repeat <span class="hljs-comment">/* repeat */</span></span><br><span class="line">    fixed <span class="hljs-comment">/* attachment */</span></span><br><span class="line">    padding-box <span class="hljs-comment">/* origin */</span></span><br><span class="line">    content-box <span class="hljs-comment">/* clip */</span></span><br><span class="line">    red; <span class="hljs-comment">/* color */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-18T07:14:56.000Z">2017-05-18</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 minutes read (About 1492 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/18/usage-of-grid-in-css/">Usage of Grid in Css</a>
            
        </h1>
        <div class="content">
            <p><a href="https://css-tricks.com/snippets/css/complete-guide-grid/" target="_blank" rel="noopener">origin</a></p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>CSS Grid Layout (aka ‘Grid’), is a two-dimensional grid-based layout system that aims to do nothing less than completely change the way we design grid-based user interfaces.</p>
<h1 id="Terminology"><a href="#Terminology" class="headerlink" title="Terminology"></a>Terminology</h1><h2 id="Grid-Container"><a href="#Grid-Container" class="headerlink" title="Grid Container"></a>Grid Container</h2><p>The element on which <code>display: grid</code> is applied. It’s the direct parent of all the grid items. In this example <code>container</code> is the grid container.</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item item-1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item item-2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item item-3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Grid-Item"><a href="#Grid-Item" class="headerlink" title="Grid Item"></a>Grid Item</h2><p>The children (e.g. <strong>direct</strong> descendants) of the grid container. Here the <code>item</code> elements are grid items, but <code>sub-item</code> isn’t.</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sub-item"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Grid-Line"><a href="#Grid-Line" class="headerlink" title="Grid Line"></a>Grid Line</h2><p>The dividing lines that make up the structure of the grid. They can be either vertical(<code>column grid line</code>) or horizontal(<code>row grid line</code>) and reside on either side of a row or column. Here the yellow line is an example of a column grid line.</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-line.png" alt=""></p>
<h2 id="Grid-Track"><a href="#Grid-Track" class="headerlink" title="Grid Track"></a>Grid Track</h2><p>The space between two adjacent grid lines. You can think of them like the columns or rows of the grid. Here’s the grid track between second and third row grid lines.</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-track.png" alt=""></p>
<h2 id="Grid-Cell"><a href="#Grid-Cell" class="headerlink" title="Grid Cell"></a>Grid Cell</h2><p>The space between two adjacent row and two adjacent column lines. It’s a single ‘unit’ of the grid. Here’s the grid cell between row grid lines 1 and line2, and column grid lines 2 and 3.</p>
<h2 id="Grid-Area"><a href="#Grid-Area" class="headerlink" title="Grid Area"></a>Grid Area</h2><p>The total space surrounded by four grid lines. A grid area may be comprised of any number of grid cells. Here’s the grid area between row and grid lines 1 and 3, and column grid lines 1 and 3.</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-area.png" alt=""></p>
<h1 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h1><h2 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h2><ul>
<li><p>display</p>
<ul>
<li><p>grid: generates a <strong>block-level</strong> grid</p>
</li>
<li><p>inline-grid: generates an inline level grid</p>
</li>
<li><p>subgrid: if your grid container is itself a grid item(i.e. nested grids), you can use this property to indicate that you want the sizes of its rows/columns to be taken from its parent rather than specifying its own.</p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line"> <span class="hljs-attribute">display</span>: grid | inline-grid | subgrid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>column</code>, <code>float</code>, <code>clear</code> and <code>vertical-align</code> have no effect on a grid container</p>
</blockquote>
</li>
</ul>
</li>
<li><p>grid-template-rows &amp; grid-template-columns</p>
<ul>
<li><p><track-size>: can be a length, a percentage, or a function of the free space in the grid(using the <code>fr</code> unit)</track-size></p>
</li>
<li><p><line-name>: an arbitrary name of your choosing</line-name></p>
</li>
</ul>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-template-columns</span>: &lt;track-size&gt; | [&lt;line-name&gt;] &lt;track-size&gt;;</span><br><span class="line">  <span class="hljs-attribute">grid-template-rows</span>: &lt;track-size&gt; | &lt;line-name&gt; &lt;track-size&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>A line can have more than one name, seperated by spcae.</p>
</blockquote>
<p>You can use <code>repeat()</code> notation to streamline things:</p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(3, 20px [col-start]) <span class="hljs-number">5%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>fr</code> unit allows you to set the size of a track as a fraction of the free space of the grid container.</p>
<p>The free space is calculated <strong>after</strong> any non-flexible items.</p>
</li>
<li><p>grid-template-areas:</p>
<ul>
<li><p><grid-area-name>: the name of a grid area specified with <code>grid-area</code></grid-area-name></p>
</li>
<li><p><code>.</code>: a period signifies an empty grid cell.</p>
</li>
<li><p>none: no grid areas are defined.</p>
</li>
</ul>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-template-areas</span>: &lt;grid-area-name&gt; | . | none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.item-a</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-area</span>: header;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-selector-class">.item-b</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-area</span>: main;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-selector-class">.item-c</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-area</span>: sidebar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-selector-class">.item-d</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-area</span>: footer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(4, 50px);</span><br><span class="line">  <span class="hljs-attribute">grid-template-rows</span>: auto;</span><br><span class="line">  <span class="hljs-attribute">grid-template-areas</span>:</span><br><span class="line">    <span class="hljs-string">'header header header header'</span></span><br><span class="line">    <span class="hljs-string">'main main . sidebar'</span></span><br><span class="line">    <span class="hljs-string">'footer footer footer footer'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-template-areas.png" alt=""></p>
</li>
<li><p>grid-template: a shorthand for setting <code>grid-template-rows</code>, <code>grid-template-columns</code> and <code>grid-template-areas</code> in a single decalration.</p>
<ul>
<li><p>none: sets all three properties to their initial values</p>
</li>
<li><p>subgrid: sets <code>grid-template-rows</code>, <code>grid-template-columns</code> to <code>subgrid</code>, and <code>grid-template-areas</code> to its initial value.</p>
</li>
<li><p><grid-template-rows>/<grid-template-columns>: sets <code>grid-template-rows</code> and <code>grid-template-columns</code> to the specified values, respectively, and sets <code>grid-template-areas</code> to <code>none</code></grid-template-columns></grid-template-rows></p>
</li>
</ul>
</li>
<li><p>grid-column-gap &amp; grid-column-gap: Specifies the size of the grid lines. You can think of it like setting the width of the gutters between the columns/rows.</p>
<ul>
<li><line-size>: a length value</line-size></li>
</ul>
</li>
<li><p>grid-gap: a shorthand for <code>grid-row-gap</code> and <code>grid-column-gap</code></p>
</li>
<li><p>justify-items: Aligns the content inside a grid item along with the <em>row</em> axis</p>
<ul>
<li><p>start: aligns the content to the left end of the grid area</p>
</li>
<li><p>end: aligns the content to the right end of the grid area</p>
</li>
<li><p>center: aligns the content in the center of the grid area</p>
</li>
<li><p>stretch: fills the whole width of the grid area(this is the default)</p>
</li>
</ul>
<blockquote>
<p>This behavior can also be set on individual grid items via the <code>justify-self</code> property</p>
</blockquote>
</li>
<li><p>align-items: aligns the content inside a grid item along the <em>column</em> axis. This value applies to all grid items inside the container.</p>
<ul>
<li><p>start: aligns the content to the top of the grid area</p>
</li>
<li><p>end: aligns the content to the bottom of the grid area</p>
</li>
<li><p>center: aligns the content in the center of the grid area</p>
</li>
<li><p>stretch: fills the whole height of the grid area(this is the default)</p>
</li>
</ul>
<blockquote>
<p>This behavior can also be set on individual grid items via the <code>align-self</code> properties.</p>
</blockquote>
</li>
<li><p>justify-content: Sometimes the total size of your grid might be less than the size of its grid container. This could happen if all of your grid items are sized with non-flexible units like <code>px</code>. In this case you can set the alignment of the grid within the grid container. This property aligns the grid along the <em>row</em> axis.</p>
<ul>
<li><p>start: aligns the grid to the left end of the grid container</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch: <strong>resize</strong> the grid items to allow the grid to fill the full width of the grid container.</p>
</li>
<li><p>space-around: places an even amount of space between each grid item, with half-sized spaces on the far ends.</p>
</li>
<li><p>space-between: places an event amount of space between each grid item, with no space at the far ends.</p>
</li>
<li><p>space-evenly: places an even amount of space between each grid item, including the far ends</p>
</li>
</ul>
</li>
<li><p>align-content:</p>
<ul>
<li><p>start</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch</p>
</li>
<li><p>space-around</p>
</li>
<li><p>space-between</p>
</li>
<li><p>space-evenly</p>
</li>
</ul>
</li>
<li><p>grid-auto-columns &amp; grid-auto-rows:</p>
<ul>
<li><track-size>: can be a length, a percentage, or a fraction of the free space in the grid(using the <code>fr</code> unit)</track-size></li>
</ul>
<p>To illustrate how implicit grid tracks get created, think about this:</p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">60px</span> <span class="hljs-number">60px</span>;</span><br><span class="line">  <span class="hljs-attribute">grid-template-rows</span>: <span class="hljs-number">90px</span> <span class="hljs-number">90px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This creates a 2 x 2 grid</p>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/grid-auto.png" alt=""></p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.item-a</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-row</span>: <span class="hljs-number">2</span>/<span class="hljs-number">3</span>;</span><br><span class="line">  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span>/<span class="hljs-number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-selector-class">.item-b</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-row</span>: <span class="hljs-number">2</span>/<span class="hljs-number">3</span>;</span><br><span class="line">  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">5</span>/<span class="hljs-number">6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/implicit-tracks.png" alt=""></p>
<p>We told <code>.item-b</code> to start on column line 5 and end at column line 6, <em>but we never defined a column 5 or 6</em>.</p>
<p>Because we referenced lines that don’t exist, implicit track with widths of 0 are created to fill in the gap.</p>
<p>We can use <code>grid-auto-column</code> and <code>grid-auto-row</code> to specify the widths of these implicit tracks:</p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-selector-class">.container</span> &#123;</span><br><span class="line">  <span class="hljs-attribute">grid-auto-columns</span>: <span class="hljs-number">60px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.css-tricks.com/wp-content/uploads/2016/03/implicit-tracks-with-widths.png" alt=""></p>
</li>
<li><p>grid-auto-flow: If you have grid items that you don’t explicitly place on the grid, the <em>auto-placement algorithm</em> kicks in to automatically place the items. This properties controls how the auto-placement algorithm works.</p>
<ul>
<li><p>row: tells the auto-placement algorithm to fill in each row in turn. adding new rows as necessary.</p>
</li>
<li><p>column: tells the auto-placement algorithm to fill in each column in turn, adding new columns as necessary.</p>
</li>
<li><p>dense: tells the auto-placement algorithm to attempt to fill in holes earlier in the grid if smaller items come up later.</p>
</li>
</ul>
<blockquote>
<p><code>dense</code> might cause your items to appear out of order</p>
</blockquote>
</li>
<li><p>grid: a shorthand for setting all of the following properties in a single declaration:</p>
<ul>
<li><code>grid-template-rows</code>, <code>grid-template-columns</code>, <code>grid-template-areas</code>, <code>grid-auto-rows</code>, <code>grid-auto-columns</code>, <code>grid-auto-flow</code></li>
</ul>
</li>
</ul>
<h2 id="Items"><a href="#Items" class="headerlink" title="Items"></a>Items</h2><ul>
<li><p>grid-column-start &amp; grid-column-end &amp; grid-row-start &amp; grid-row-end</p>
<ul>
<li><p>determines a grid item’s location within the grid by referring to specific grid line.</p>
</li>
<li><line></line>: can be number to refer to a numbered grid line, or a name to refer to a named grid line
</li>
<li><p>span</p>
<number>: the item will span across the provided number of grid tracks</number>
</li>
<li><p>span</p>
<name>: the item will span across until it hits the next line with the provided name</name>
</li>
<li><p>auto</p>
</li>
</ul>
</li>
<li><p>grid-column &amp; grid-row: shorthand for <code>grid-column-start</code> + <code>grid-column-end</code> and <code>grid-row-start</code> + <code>grid-row-end</code>, respectively.</p>
<ul>
<li><start-value> / <end-value><br></end-value></start-value></li>
</ul>
</li>
<li><p>grid-area: gives an item a name so that it can be referenced by a template created with the <code>grid-template-areas</code> property. Alternatively, this property can be used as an even shorter shorthand for <code>grid-row-start</code> + <code>grid-column-start</code> + <code>grid-row-end</code> + <code>grid-column-end</code>.</p>
<ul>
<li><name>: a name of your choosing</name>
</li>
<li><p><row-start> / <column-start> / <row-end> / <column-end><br></column-end></row-end></column-start></row-start></p>
</li>
</ul>
</li>
<li><p>justify-self: aligns the content inside a grid item along the row axis. This value applies to the content inside a single item.</p>
<ul>
<li><p>start</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch</p>
</li>
</ul>
</li>
<li><p>align-self: aligns the content inside a grid item along the column axis. This value applies to the content inside a single grid item.</p>
<ul>
<li><p>start</p>
</li>
<li><p>end</p>
</li>
<li><p>center</p>
</li>
<li><p>stretch</p>
</li>
</ul>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-05-17T11:51:26.000Z">2017-05-17</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 242 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/05/17/simple-usage-of-scp/">Simple Usage of Scp</a>
            
        </h1>
        <div class="content">
            <p><a href="https://www.tecmint.com/scp-commands-examples/" target="_blank" rel="noopener">origin</a></p>
<h1 id="Basic-Syntax-of-SCP"><a href="#Basic-Syntax-of-SCP" class="headerlink" title="Basic Syntax of SCP"></a>Basic Syntax of SCP</h1><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp source_file_name username@destination_host:destination_folder</span><br></pre></td></tr></table></figure>
<h1 id="Provider-the-detail-information-of-SCP-process-using-v-parameter"><a href="#Provider-the-detail-information-of-SCP-process-using-v-parameter" class="headerlink" title="Provider the detail information of SCP process using -v parameter"></a>Provider the detail information of SCP process using <code>-v</code> parameter</h1><p>Baisc SCP command without parameter will copy the files in background. User will see nothing unless the process is done or something error appears.</p>
<p>You can use <code>-v</code> parameter to print debug information into screen.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># verbose</span></span><br><span class="line">scp -v source_file_name username@destination_host:destination_folder</span><br></pre></td></tr></table></figure>
<h1 id="Provider-modification-times-access-times-and-modes-from-original-files"><a href="#Provider-modification-times-access-times-and-modes-from-original-files" class="headerlink" title="Provider modification times, access times, and modes from original files"></a>Provider modification times, access times, and modes from original files</h1><p>The <code>-p</code> (lowercase) parameter will help you on this. An estimated time and the connection speed will apear on the screen.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># process</span></span><br><span class="line">scp -p source_file_name username@destination_host:destination_folder</span><br></pre></td></tr></table></figure>
<h1 id="Make-file-transfer-faster-using-C-parameter"><a href="#Make-file-transfer-faster-using-C-parameter" class="headerlink" title="Make file transfer faster using -C parameter"></a>Make file transfer faster using <code>-C</code> parameter</h1><p>One of parameter that can faster your file transfer is <code>-C</code> parameter. The <code>-C</code> parameter will compress your file on the go. The unique thing is the compression is only happen in the network. When the file is arrived to the destination server, it will returning into the original size as before the compression happen.</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># Compression</span></span><br><span class="line">scp -Cpv source_file_name username@destination_host:destination_folder</span><br></pre></td></tr></table></figure>
<h1 id="Specify-specific-port-to-use-with-SCP"><a href="#Specify-specific-port-to-use-with-SCP" class="headerlink" title="Specify specific port to use with SCP"></a>Specify specific port to use with SCP</h1><p>Usually SCP is using port 22 as a default port. But for security reason, you may change the port into another port.</p>
<p>Use <code>-P</code> (uppercase) to specify the port.</p>
<p><code>`bash
scp -P 2212 source_file_name username@destination_host:destination_folder</code></p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/6/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/8/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/6/">6</a></li>
            
            <li><a class="pagination-link is-current" href="/page/7/">7</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/8/">8</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/16/">16</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.jpg" alt="Keith Chen">
                    
                    
                    <p class="is-size-4 is-block">
                        Keith Chen
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        FE Engineer on Blockchain
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>30°17&#39;37N, 120°9&#39;41E</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        304
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        7
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        89
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/keith-CY" target="_blank">
                Follow</a>
        </div>
        
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/keith-CY" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Keith CY</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.linkedin.com/in/宇-陈-644b61ba" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Yu Chen</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.linkedin.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Soup/">
            <span class="level-start">
                <span class="level-item">Soup</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Uncategorized/">
            <span class="level-start">
                <span class="level-item">Uncategorized</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/github/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/note/">
            <span class="level-start">
                <span class="level-item">note</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">141</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/note/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/workNote/">
            <span class="level-start">
                <span class="level-item">workNote</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AJAX/" style="font-size: 10.91px;">AJAX</a> <a href="/tags/BOOTSTRAP/" style="font-size: 10px;">BOOTSTRAP</a> <a href="/tags/Bash/" style="font-size: 11.82px;">Bash</a> <a href="/tags/BlockChain/" style="font-size: 10px;">BlockChain</a> <a href="/tags/Blockchain/" style="font-size: 10px;">Blockchain</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/CSS/" style="font-size: 10.91px;">CSS</a> <a href="/tags/CSS3/" style="font-size: 20px;">CSS3</a> <a href="/tags/Closure/" style="font-size: 10px;">Closure</a> <a href="/tags/CommonJS/" style="font-size: 10px;">CommonJS</a> <a href="/tags/Contract-Ethereum-Web3/" style="font-size: 10px;">Contract, Ethereum, Web3</a> <a href="/tags/Contract-Solidity/" style="font-size: 10px;">Contract, Solidity</a> <a href="/tags/D3-Example/" style="font-size: 10px;">D3, Example</a> <a href="/tags/DAPP-Solidity/" style="font-size: 10px;">DAPP, Solidity</a> <a href="/tags/DApp-Solidity/" style="font-size: 10px;">DApp, Solidity</a> <a href="/tags/DOM/" style="font-size: 12.73px;">DOM</a> <a href="/tags/DevTools/" style="font-size: 10px;">DevTools</a> <a href="/tags/Drizzle-Ethereum-BlockChain/" style="font-size: 10px;">Drizzle, Ethereum, BlockChain</a> <a href="/tags/ES6/" style="font-size: 10.91px;">ES6</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/ETH-Wallet/" style="font-size: 10px;">ETH, Wallet</a> <a href="/tags/Elixir-Phoenix-SCSS/" style="font-size: 10px;">Elixir, Phoenix, SCSS</a> <a href="/tags/Erlang-Elixir-GenServer/" style="font-size: 10px;">Erlang, Elixir, GenServer</a> <a href="/tags/Ethereum/" style="font-size: 10px;">Ethereum</a> <a href="/tags/Ethereum-IPFS/" style="font-size: 10px;">Ethereum, IPFS</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Go-Http-Web/" style="font-size: 10px;">Go, Http, Web</a> <a href="/tags/GraphQL-Apollo-TypeScript/" style="font-size: 10px;">GraphQL, Apollo, TypeScript</a> <a href="/tags/Gulp/" style="font-size: 11.82px;">Gulp</a> <a href="/tags/HTML5/" style="font-size: 15.45px;">HTML5</a> <a href="/tags/HTTP2-Node/" style="font-size: 10px;">HTTP2, Node</a> <a href="/tags/Html-Picture/" style="font-size: 10px;">Html, Picture</a> <a href="/tags/Immutable/" style="font-size: 10px;">Immutable</a> <a href="/tags/Int8Array/" style="font-size: 10px;">Int8Array</a> <a href="/tags/JSON-RPC/" style="font-size: 10px;">JSON-RPC</a> <a href="/tags/Javascript/" style="font-size: 19.09px;">Javascript</a> <a href="/tags/Koa/" style="font-size: 10.91px;">Koa</a> <a href="/tags/Koa-NPM-Package/" style="font-size: 10px;">Koa, NPM, Package</a> <a href="/tags/MDL/" style="font-size: 16.36px;">MDL</a> <a href="/tags/Material-Design/" style="font-size: 17.27px;">Material Design</a> <a href="/tags/Mock-JavaScript/" style="font-size: 10px;">Mock, JavaScript</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/NODE/" style="font-size: 13.64px;">NODE</a> <a href="/tags/NPM/" style="font-size: 10.91px;">NPM</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Nock/" style="font-size: 10px;">Nock</a> <a href="/tags/Node-CLI/" style="font-size: 10.91px;">Node, CLI</a> <a href="/tags/Node-Fastify/" style="font-size: 10.91px;">Node, Fastify</a> <a href="/tags/Node-Graphql-Koa/" style="font-size: 10px;">Node, Graphql, Koa</a> <a href="/tags/Node-js/" style="font-size: 10.91px;">Node.js</a> <a href="/tags/Phoenix-Elixir-Ecto/" style="font-size: 10px;">Phoenix, Elixir, Ecto</a> <a href="/tags/Promise/" style="font-size: 11.82px;">Promise</a> <a href="/tags/Protobuf/" style="font-size: 10px;">Protobuf</a> <a href="/tags/Pug-HTML/" style="font-size: 10px;">Pug, HTML</a> <a href="/tags/React/" style="font-size: 18.18px;">React</a> <a href="/tags/React-Docker/" style="font-size: 10px;">React, Docker</a> <a href="/tags/React-Router-Code-splitting/" style="font-size: 10px;">React, Router, Code-splitting</a> <a href="/tags/React-Native/" style="font-size: 10px;">React-Native</a> <a href="/tags/React-Redux/" style="font-size: 10px;">React-Redux</a> <a href="/tags/React-Router/" style="font-size: 10.91px;">React-Router</a> <a href="/tags/Redux/" style="font-size: 14.55px;">Redux</a> <a href="/tags/RegExp/" style="font-size: 10px;">RegExp</a> <a href="/tags/Ruby-Rails/" style="font-size: 10px;">Ruby, Rails</a> <a href="/tags/Ruby-Rails-RoR-Mina/" style="font-size: 10px;">Ruby, Rails, RoR, Mina</a> <a href="/tags/Rust-Rocket/" style="font-size: 10px;">Rust, Rocket</a> <a href="/tags/RxJS/" style="font-size: 10px;">RxJS</a> <a href="/tags/Smart-Contract-Web3/" style="font-size: 10px;">Smart Contract, Web3</a> <a href="/tags/Solidity/" style="font-size: 12.73px;">Solidity</a> <a href="/tags/Solidity-Error-Handling/" style="font-size: 10px;">Solidity, Error Handling</a> <a href="/tags/Solidity-Public-External/" style="font-size: 10px;">Solidity, Public, External</a> <a href="/tags/Solidity-Smart-Contract/" style="font-size: 10px;">Solidity, Smart Contract</a> <a href="/tags/Thunk/" style="font-size: 10.91px;">Thunk</a> <a href="/tags/Trick/" style="font-size: 11.82px;">Trick</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Webpack-DLL/" style="font-size: 10px;">Webpack, DLL</a> <a href="/tags/automatic/" style="font-size: 10px;">automatic</a> <a href="/tags/babel/" style="font-size: 10px;">babel</a> <a href="/tags/babel-polyfill/" style="font-size: 10px;">babel-polyfill</a> <a href="/tags/blockchain-bitcoin-bip/" style="font-size: 10px;">blockchain, bitcoin, bip</a> <a href="/tags/commandline/" style="font-size: 10px;">commandline</a> <a href="/tags/github/" style="font-size: 10.91px;">github</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/precache/" style="font-size: 10px;">precache</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/webpack/" style="font-size: 17.27px;">webpack</a> <a href="/tags/webpack2/" style="font-size: 11.82px;">webpack2</a> <a href="/tags/测试/" style="font-size: 11.82px;">测试</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/16/keystore/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time></div>
                    <a href="/2019/03/16/keystore/" class="has-link-black-ter is-size-6">Keystore</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="5 Tips in CRA@2.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time></div>
                    <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="has-link-black-ter is-size-6">5 Tips in CRA@2.0</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/08/Assembly-in-Solidity/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Assembly in Solidity">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time></div>
                    <a href="/2018/11/08/Assembly-in-Solidity/" class="has-link-black-ter is-size-6">Assembly in Solidity</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/16/keystore/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/keystore.jpg" alt="Keystore">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-16T07:22:16.000Z">2019-03-16</time></div>
                    <a href="/2019/03/16/keystore/" class="has-link-black-ter is-size-6">Keystore</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/05/note-on-bip32/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/bip32.png" alt="Note on Bip32">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-05T05:54:32.000Z">2019-03-05</time></div>
                    <a href="/2019/03/05/note-on-bip32/" class="has-link-black-ter is-size-6">Note on Bip32</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/20/React-Hooks/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React Hooks">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-20T09:41:39.000Z">2018-11-20</time></div>
                    <a href="/2018/11/20/React-Hooks/" class="has-link-black-ter is-size-6">React Hooks</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="5 Tips in CRA@2.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-11T15:52:25.000Z">2018-11-11</time></div>
                    <a href="/2018/11/11/5-tips-in-CRA-2-0/" class="has-link-black-ter is-size-6">5 Tips in CRA@2.0</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/11/08/Assembly-in-Solidity/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Assembly in Solidity">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-11-08T03:30:30.000Z">2018-11-08</time></div>
                    <a href="/2018/11/08/Assembly-in-Solidity/" class="has-link-black-ter is-size-6">Assembly in Solidity</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">September 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">May 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">April 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">March 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">February 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">January 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">December 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">November 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">October 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">September 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">August 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">31</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">July 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">19</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">June 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">14</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/05/">
                <span class="level-start">
                    <span class="level-item">May 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">15</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">April 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">March 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">February 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">January 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">December 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">November 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/10/">
                <span class="level-start">
                    <span class="level-item">October 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">September 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">16</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">August 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">July 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">43</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">June 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">25</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">May 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">24</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="EzCook" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Chen Yu&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>