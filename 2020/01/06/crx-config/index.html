<!DOCTYPE html>
<html  lang="en">

<head>
    <meta charset="utf-8">
<title>Crx-Config - EzCook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />







<link rel="icon" href="/images/logo.png">

<link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre|DM+Serif+Text&display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">




    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    



    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">







<link rel="stylesheet" href="/css/back-to-top.css">




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136207372-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-136207372-1');
</script>




<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>



    



    
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    




<link rel="stylesheet" href="/css/style.css">
<script data-ad-client="ca-pub-8896169856986797" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</head>

<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Crx-Config" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/projects">Projects</a>
                
                <a class="navbar-item"
                href="https://wiki.digit-map.de/">Digit Map</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/keith-CY">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="Gmail" href="mailto:keithwhisper@gmail.com">
                        
                        <i class="fas fa-envelope"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>

    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-01-05T17:10:11.000Z">2020-01-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    15 minutes read (About 2263 words)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span> visits
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Crx-Config
            
        </h1>
        <div class="content">
            <p>This is a detailed customized chrome extension configuration cheatsheet.</p>
<h2 id="Manifest"><a href="#Manifest" class="headerlink" title="Manifest"></a>Manifest</h2><figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  // required</div><div class="line">  "manifest_version": 2, // integer indicates the version of the manifest file format.</div><div class="line">  "name": "Name of Extension",</div><div class="line">  "version": "Version of Extension", // One to four dot-separated integers indicating the version of the extension, "1.2.3.1234", and there's a field named "version_name" for displaying purpose, "version_name": "1.0 beta"</div><div class="line"></div><div class="line">  // Recommended</div><div class="line">  "default_locale": "en", // this field is required in extensions that have a '_locales' directory and must be absent in extensions that have no '_locales' directory.</div><div class="line">  "description": "Description of Extension",</div><div class="line">  "icons": &#123;</div><div class="line">    // One or more icons that represent the extension, app, or theme.</div><div class="line">    "16": "icon16.png", // is used as the favicon for an extension's pages</div><div class="line">    "48": "icon48.png", // 48 x 48 icon is for extension management page</div><div class="line">    "128": "icon128.png" // You should always provides a 128 x 128 icon, it's used during installation and by the Chrome Extension Store.</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  // Pick one or none</div><div class="line">  "browser_action": &#123;</div><div class="line">    // use browser actions to put icons in the main chrome toolbar, to the right of the address bar. It can have a tooltip, a badge and a popup</div><div class="line">    "default_icon": &#123;</div><div class="line">      // optional, you can use browserAction.setBadgeText, browserAction.setBadgeBackgroundColor to set the badge</div><div class="line">      "16": "images/icon16.png",</div><div class="line">      "24": "images/icon24.png",</div><div class="line">      "32": "images/icon32.png"</div><div class="line">    &#125;,</div><div class="line">    "default_title": "Tooltip of Extension",</div><div class="line">    "default_popup": "popup.html"</div><div class="line">  &#125;,</div><div class="line">  "page_action": &#123;</div><div class="line">    // use the chrome.pageAction API to put icons in the main chrome toolbar, to the right of the address bar. Page actions represent actions that can be taken on the current page, but that aren't applicable to all pages. Page actions appear grayed out when inactive.</div><div class="line">    "default_icons": &#123;</div><div class="line">      // optional</div><div class="line">      "16": "images/icon16.png",</div><div class="line">      "24": "images/icon24.png",</div><div class="line">      "32": "images/icon32.png"</div><div class="line">    &#125;,</div><div class="line">    "default_title": "Tooltip of Extension", // optional</div><div class="line">    "default_popup": "popup.html"</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  // Optional</div><div class="line">  "action": "//TODO",</div><div class="line">  "author": "//TODO",</div><div class="line">  "automation": "//TODO",</div><div class="line">  "background": &#123;</div><div class="line">    "scripts": [],</div><div class="line">    "persistent": false, // Recommended to be false</div><div class="line">    "service_worker": "path to the sw" // Optional</div><div class="line">  &#125;,</div><div class="line">  "chrome_settings_override": &#123;</div><div class="line">    "homepage": "url of homepage",</div><div class="line">    "search_provider": &#123;&#125;,</div><div class="line">    "startup_pages": []</div><div class="line">  &#125;,</div><div class="line">  "chrome_ui_overrides": &#123;</div><div class="line">    "bookmarks_ui": &#123;</div><div class="line">      "remove_bookmark_shortcut": true,</div><div class="line">      "remove_button": true</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "chrome_url_overrides": &#123;&#125;, // used to override pages provided by chrome. In addition to HTML, an override page usually has CSS and JavaScript Code.</div><div class="line">  "commands": &#123;&#125;,</div><div class="line">  "content_capabilities": &#123;&#125;,</div><div class="line">  "content_scripts": [&#123;&#125;],</div><div class="line">  "content_security_poligy": "policyString"a,</div><div class="line">  "converted_from_user-script": "",</div><div class="line">  "devtools_page": "//TODO",</div><div class="line">  "event_rules": [],</div><div class="line">  "externally_connectable": &#123;&#125;,</div><div class="line">  "file_browser_handlers": [],</div><div class="line">  "file_system_provider_capabilities": &#123;</div><div class="line">    "configurable": true,</div><div class="line">    "multiple_mounts": true,</div><div class="line">    "source": "network"</div><div class="line">  &#125;,</div><div class="line">  "homepage_url": "http://path/to/homepage",</div><div class="line">  "import": [], // shared modules</div><div class="line">  "export": [], // shared modules</div><div class="line">  "incognito": "//TODO",</div><div class="line">  "input_components": "",</div><div class="line">  "key": "publicKey",</div><div class="line">  "minimum_chrome_version": "versionString",</div><div class="line">  "nacl_modules": [],</div><div class="line">  "oauth2": "",</div><div class="line">  "offline_enabled": true,</div><div class="line">  "omnibox": &#123;</div><div class="line">    "keyboard": "aString" // The omnibox allows you to register a keyword with chrome's address bar.</div><div class="line">  &#125;,</div><div class="line">  "optional_permissions": ["tabs"],</div><div class="line">  "options_page": "options.html",</div><div class="line">  "options_ui": &#123;</div><div class="line">    "chrome_style": true,</div><div class="line">    "page": "options.html"</div><div class="line">  &#125;,</div><div class="line">  "permissions": ["tabs"],</div><div class="line">  "platforms": "",</div><div class="line">  "replacement_web_app": "",</div><div class="line">  "requirements": &#123;&#125;,</div><div class="line">  "sandbox": [],</div><div class="line">  "short_name": "short name",</div><div class="line">  "signature": "",</div><div class="line">  "spellcheck": "",</div><div class="line">  "storage": &#123;</div><div class="line">    "managed_schema": "schema.json"</div><div class="line">  &#125;,</div><div class="line">  "system_indicator": "",</div><div class="line">  "tts_engine": &#123;&#125;,</div><div class="line">  "update_url": "http://path/to/updateInfo.xml",,</div><div class="line">  "version_name": "0.1 beta",</div><div class="line">  "web_accessible_resource": []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="BrowerAction-Methods"><a href="#BrowerAction-Methods" class="headerlink" title="BrowerAction Methods"></a>BrowerAction Methods</h2><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.browserAction.method(params)</div></pre></td></tr></table></figure>
<ul>
<li>setTitle({ title: string, tabId?: number }, callback)</li>
<li>getTitle({ tabId?: number }, <string>callback)</string></li>
<li>setIcon({ imageData?: ImageDataType | object, path?: string | object, tabId?: number }, callback)</li>
<li>setPopup({ tabId?: number, popup: string }, callback)</li>
<li>getPopup({ tabId?: number }, <string>callback)</string></li>
<li>setBadgeText({ text: string, tabId?: number }, callback)</li>
<li>getBadgeText({ tabId?: number }, <string>callback)</string></li>
<li>setBadgeBackgroundColor({ color: string or ColorArray, tabId?: number }, callback)</li>
<li>getBadgeBackgroundColor({ tabId?: number }, callback)</li>
<li>enable({ tabId?: number }, callback)</li>
<li>disable({ tabId?: number }, callback)</li>
</ul>
<h2 id="BrowserAction-Events"><a href="#BrowserAction-Events" class="headerlink" title="BrowserAction Events"></a>BrowserAction Events</h2><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.browserAction.onClicked.addEventListener(<span class="hljs-function">(<span class="hljs-params">tab: tabs.Tab</span>) =&gt;</span> &#123;&#125;)</div></pre></td></tr></table></figure>
<h2 id="PageAction-Methods"><a href="#PageAction-Methods" class="headerlink" title="PageAction Methods"></a>PageAction Methods</h2><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.pageAction.method(params)</div></pre></td></tr></table></figure>
<ul>
<li>show({ tabId: number }, callback), the page action is shown whenever the tab is selected</li>
<li>hide({ tabId: number }, callback), hide the page action, means set the page action gray</li>
<li>setTitle({ tabId: number, title: string }, callback)</li>
<li>getTitle({ tabId: number }, <string>callback)</string></li>
<li>setIcon({ imageData: object | ImageDataType, path?: string | object, }), the path to the icons could be a dictionary {size =&gt; relative image path}, the actual image to be used is chosen depending on screen’s pixel density. Note that path = ‘foo’ equals to path = { ‘16’: foo }, implicitly converted into a dictionary.</li>
<li>setPopup({ tabId: number, popup: string }, callback)</li>
<li>getPopup({ tabId }, <string>callback)</string></li>
</ul>
<h2 id="PageAction-Events"><a href="#PageAction-Events" class="headerlink" title="PageAction Events"></a>PageAction Events</h2><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.pageAction.onClicked.addEventListener(<span class="hljs-function">(<span class="hljs-params">tab: tabs.Tab</span>) =&gt;</span> &#123;&#125;)</div></pre></td></tr></table></figure>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Extensions are event-driven programs used to modify or enhance the chrome browsing experience. Events are browser triggers and extensions monitor them in background scripts, then react to specified instructions.</p>
<p>A background page is loaded when it is needed, and unloaded when it goes idle.</p>
<pre><code>- The extension is first installed or updated to a new version.
- The background page was listening for an event, and the event is dispatched.
- A content script or other extension sends a message.
- Another view in the extension, such as a popup, calls `runtime.getBackgroundPage`.
</code></pre><h3 id="Register-background-scripts"><a href="#Register-background-scripts" class="headerlink" title="Register background scripts"></a>Register background scripts</h3><p>Background scripts are registered in the manifest under the “background” field. They are listed in an array of “background.scripts”.</p>
<p>Remember to set “persistent” to false unless the extension uses <code>chrome.webRequest</code> API to block or modify network requests.</p>
<h3 id="Initialize-the-extension"><a href="#Initialize-the-extension" class="headerlink" title="Initialize the extension"></a>Initialize the extension</h3><p>Listen to <code>runtime.onInstalled</code> event to initialize an extension on installation. Use this event to set a state or for one-time initialization, such as a context menu.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.onInstalled.addListener(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">  chrome.contextMenu.create(&#123;</div><div class="line">    <span class="hljs-attr">id</span>: <span class="hljs-string">'sampleContextMneu'</span>,</div><div class="line">    <span class="hljs-attr">title</span>: <span class="hljs-string">'Sample Context Menu'</span>,</div><div class="line">    <span class="hljs-attr">contexts</span>: [<span class="hljs-string">'selection'</span>],</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Set-up-listeners"><a href="#Set-up-listeners" class="headerlink" title="Set up listeners"></a>Set up listeners</h3><p>Structure background scripts around events the extension depends on. Defining functionally relevant events allows background scripts to lie dormant until those events are fired and prevents the extension from missing important triggers.</p>
<p>Listeners must be registered synchronously from the start of the page.</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// This will run when a bookmark is created</span></div><div class="line">chrome.bookmark.onCreated.addListener(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-comment">// do something</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Do not register listeners asynchronously, as they will not be properly triggered.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// DO NOT DO THIS</span></div><div class="line">chrome.runtime.onInstalled.addListener(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">  chrome.bookmarks.onCreated.addListener(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="hljs-comment">// do something</span></div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Filter-events"><a href="#Filter-events" class="headerlink" title="Filter events"></a>Filter events</h3><p>Use APIs that supports <code>event filters</code> to restrict listeners to the cases the extension cares about. If an extension is listening for the <code>tabs.onUpdated</code> event, try using the <code>webNavigation.onCompleted</code> event with filters instead, as the tabs API does not support filters.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">chrome.webNavigation.onCompleted.addListener(</div><div class="line">  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">    alert(<span class="hljs-string">'This is my favorite website'</span>)</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="hljs-attr">url</span>: [</div><div class="line">      &#123;</div><div class="line">        <span class="hljs-attr">urlMatches</span>: <span class="hljs-string">'http://www.google.com'</span>,</div><div class="line">      &#125;,</div><div class="line">    ],</div><div class="line">  &#125;,</div><div class="line">)</div></pre></td></tr></table></figure>
<h3 id="React-to-listeners"><a href="#React-to-listeners" class="headerlink" title="React to listeners"></a>React to listeners</h3><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.onMessage.addListener(<span class="hljs-function">(<span class="hljs-params">message, callback</span>) =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (message.data === <span class="hljs-string">'setAlarm'</span>) &#123;</div><div class="line">    chrome.alarms.create(&#123; <span class="hljs-attr">delayInMinutes</span>: <span class="hljs-number">5</span> &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (message.data === <span class="hljs-string">'runLogic'</span>) &#123;</div><div class="line">    chrome.tabs.executeScript(&#123; <span class="hljs-attr">file</span>: <span class="hljs-string">'logic.js'</span> &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (message.data === <span class="hljs-string">'changeColor'</span>) &#123;</div><div class="line">    chrome.tabs.executeScript(&#123;</div><div class="line">      <span class="hljs-attr">code</span>: <span class="hljs-string">'document.body.style.backgroundColor="orange"'</span>,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Unload-background-scripts"><a href="#Unload-background-scripts" class="headerlink" title="Unload background scripts"></a>Unload background scripts</h3><p>Data should be persisted periodically so that important information is not lost if an extension crashes without receiving <code>onSuspend</code>. Use the <code>storage</code> API to assist with this.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.storage.local.set(&#123; <span class="hljs-attr">variable</span>: <span class="hljs-string">'info'</span> &#125;)</div></pre></td></tr></table></figure>
<p>If an extension uses <code>message passing</code>, ensure all ports are closed. The background script will not unload until all message ports have shut.</p>
<p>Listen to <code>runtime.Port.onDisconnect</code> event will give insight to when open ports are closing. Manually close them with <code>runtime.Port.disconnect</code>.</p>
<p>Background scripts unload themself after a few seconds of inactivity. If any last minute cleanup is required, listen to <code>runtime.onSuspend</code> event.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.onSuspend.addListener(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'unloading'</span>)</div><div class="line">  chrome.browserAction.setBadgeText(&#123; <span class="hljs-attr">text</span>: <span class="hljs-string">''</span> &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="Content-scripts"><a href="#Content-scripts" class="headerlink" title="Content scripts"></a>Content scripts</h2><p>Content scripts are files that run in the context of web pages. By using the standard DOM, they are able to read details of the web pages the browser visits, make changes to them and pass information to their parent extension.</p>
<p>Content scripts can access chrome APIs used by their parent extension by exchanging messages with the extension. They can also access the URL of an extension’s file with <code>chrome.runtime.getURL()</code> and use the result the same as other URLs.</p>
<p>Content scripts can access the following chrome APIs directly:</p>
<ul>
<li>i18n</li>
<li>storage</li>
<li>runtime<ul>
<li>connect</li>
<li>getManifest</li>
<li>getURL</li>
<li>id</li>
<li>onConnect</li>
<li>onMessage</li>
<li>sendMessage</li>
</ul>
</li>
</ul>
<p>Content scripts are unable to access other APIs directly.</p>
<h3 id="Work-in-isolated-worlds"><a href="#Work-in-isolated-worlds" class="headerlink" title="Work in isolated worlds"></a>Work in isolated worlds</h3><p>Content scripts live in an isolated world, allowing a content script to makes chagnes to its JavaScript environment without conflicting with the page or additional content scripts.</p>
<h3 id="Inject-scripts"><a href="#Inject-scripts" class="headerlink" title="Inject scripts"></a>Inject scripts</h3><p>Content scripts can be programmatically or declaratively injected.</p>
<h4 id="Inject-Programmatically"><a href="#Inject-Programmatically" class="headerlink" title="Inject Programmatically"></a>Inject Programmatically</h4><p>Use programmatic injection for content scripts that need to run on specific occasions.</p>
<p>To inject a programmatic content script, provide the <code>activeTab</code> permission in the manifest. This grants secure access to the active site’s host and temporary access to the <code>tabs</code> permission, enabling the content script to run on the current active tab without specifying <code>cross-origin premissions</code>.</p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="hljs-attr">"permissions"</span>: [<span class="hljs-string">"activeTab"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Then content scripts can be injected as code</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.onMessage.addListener(<span class="hljs-function">(<span class="hljs-params">message, callback</span>) =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (message === <span class="hljs-string">'changeColor'</span>) &#123;</div><div class="line">    chrome.tabs.executeScript(&#123;</div><div class="line">      <span class="hljs-attr">code</span>: <span class="hljs-string">'document.body.style.backgroundColor="orange"'</span>,</div><div class="line">    &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (message === <span class="hljs-string">'runContentScript'</span>) &#123;</div><div class="line">    chrome.tabs.executeScript(&#123;</div><div class="line">      <span class="hljs-attr">file</span>: <span class="hljs-string">'contentScript.js'</span>,</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="Inject-declaratively"><a href="#Inject-declaratively" class="headerlink" title="Inject declaratively"></a>Inject declaratively</h4><p>Use declarative injection for content scripts that should be automatically run on specified pages.</p>
<p>Declaratively injected scripts are registered in the manifest.content_scripts field.</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  "content_scripts": [</div><div class="line">    &#123;</div><div class="line">      "matches": ["http://*.nytimes.com/*"], // required, specifies which pages this content script will be injected into.</div><div class="line">      "css": ["myStyles.css"], // optional, the list of css files to be injected into the pages. They are injected orderly.</div><div class="line">      "js": ["contentScript.js"], // optional, the list of js files to be injected into orderly.</div><div class="line">      "match_about_blank": false, // optional, whether or not to inject into the blank pages</div><div class="line">      "run_at": "document_idel", // controls when the files are injected, the preferred and default config is document_idle.</div><div class="line">      "all_frames": false,</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Chrome-Permissions"><a href="#Chrome-Permissions" class="headerlink" title="Chrome Permissions"></a>Chrome Permissions</h2><p>Use the <code>chrome.permission</code> API to request declared optional permissions at run time rather than install time, so users understand why the permissions are needed and grant only those that are necessary.</p>
<h3 id="Decide-which-permissions-are-required-and-which-are-optional"><a href="#Decide-which-permissions-are-required-and-which-are-optional" class="headerlink" title="Decide which permissions are required and which are optional"></a>Decide which permissions are required and which are optional</h3><p>An extension can declare both required and optional permissions. In general, you should:</p>
<ul>
<li>Use required permissions when they are needed for your extension’s basic functionality.</li>
<li>Use optional permissions when they are needed for optional features in your extension.</li>
</ul>
<p>Advantages of required permissions:</p>
<ul>
<li>Fewer prompts: An extension can prompt the user once to accept all permissions.</li>
<li>Simpler development: Required permissions are guaranteed to be present.</li>
</ul>
<p>Advantages of optional permissions:</p>
<ul>
<li>Better security</li>
<li>Better information for users: An extension can explain why it needs a particular permission when the user enables the relevant feature.</li>
<li>Easier upgrades: When you upgrades your extension, chrome will not disable it for your users if the upgrade adds optional rather than required permissions.</li>
</ul>
<p>Declare optional permissions in your extension manifest with the <code>optional_permissions</code> key, using the same format as the <code>permission</code> field.</p>
<h3 id="Request-optional-permissions"><a href="#Request-optional-permissions" class="headerlink" title="Request optional permissions"></a>Request optional permissions</h3><p>Request the permission from within a user gesture using <code>permissions.request()</code>.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#my-button'</span>).addEventListener(<span class="hljs-string">'click'</span>, e =&gt; &#123;</div><div class="line">  chrome.permissions.request(</div><div class="line">    &#123;</div><div class="line">      <span class="hljs-attr">permissions</span>: [<span class="hljs-string">'tabs'</span>],</div><div class="line">      <span class="hljs-attr">origins</span>: [<span class="hljs-string">'http://www.google.com'</span>],</div><div class="line">    &#125;,</div><div class="line">    granted =&gt; &#123;</div><div class="line">      <span class="hljs-keyword">if</span> (granted) &#123;</div><div class="line">        <span class="hljs-comment">// do something</span></div><div class="line">      &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">        <span class="hljs-comment">// do something</span></div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  )</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="Check-the-extension’s-current-permissions"><a href="#Check-the-extension’s-current-permissions" class="headerlink" title="Check the extension’s current permissions"></a>Check the extension’s current permissions</h3><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">chrome.permissions.contains(</div><div class="line">  &#123;</div><div class="line">    <span class="hljs-attr">permissions</span>: [<span class="hljs-string">'tabs'</span>],</div><div class="line">    <span class="hljs-attr">origins</span>: [<span class="hljs-string">'http://www.google.com'</span>],</div><div class="line">  &#125;,</div><div class="line">  result =&gt; &#123;</div><div class="line">    <span class="hljs-keyword">if</span> (result) &#123;</div><div class="line">      <span class="hljs-comment">// the extension has the permissions</span></div><div class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</div><div class="line">      <span class="hljs-comment">// the extension doesn't have the permissions</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">)</div></pre></td></tr></table></figure>
<h3 id="Remove-the-permissions"><a href="#Remove-the-permissions" class="headerlink" title="Remove the permissions"></a>Remove the permissions</h3><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">chrome.permissions.remove(</div><div class="line">  &#123;</div><div class="line">    <span class="hljs-attr">permissions</span>: [<span class="hljs-string">'tabs'</span>],</div><div class="line">    <span class="hljs-attr">origins</span>: [<span class="hljs-string">'http://www.google.com'</span>],</div><div class="line">  &#125;,</div><div class="line">  removed =&gt; &#123;</div><div class="line">    <span class="hljs-comment">// do something</span></div><div class="line">  &#125;,</div><div class="line">)</div></pre></td></tr></table></figure>
<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><p>Technologies required by the app or extension. Hosting sites such as chrome web store may use this list to dissuade users from installing apps or extensions that will not work on their computer.</p>
<p>Supported requirements currently include “3D” and “plugins”.</p>
<h2 id="Messages"><a href="#Messages" class="headerlink" title="Messages"></a>Messages</h2><p>Since content scripts run in the context of a web page and not the extension, they often need some way of communicating with the rest of the extension. For example, an RSS reader extension might use content script to detect the presence of an RSS feed on a page, then notify the background page in order to display a page action icon for that page.</p>
<p>Communication between extensions and their content script scripts works by using message passing. Either side can listen for message sent from the other end, and respond on the same channel. A message can contain any valid JSON object.</p>
<h3 id="Simple-one-time-requests"><a href="#Simple-one-time-requests" class="headerlink" title="Simple one-time requests"></a>Simple one-time requests</h3><p>If you only need to send a single message to another part of your extension, you should use the simplified <code>runtime.sendMessage</code> and <code>tabs.sendMessage</code>. This lets you send a one-time JSON-serializable message from a content script to extension, or vice versa, respectively.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// send a request from content script</span></div><div class="line">chrome.runtime.sendMessage(&#123; <span class="hljs-attr">greeting</span>: <span class="hljs-string">'hello'</span> &#125;, res =&gt; &#123;</div><div class="line">  <span class="hljs-built_in">console</span>.log(res)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-comment">// send a request from the extension to a content script works similar, except that you need to specify which tab to send it to.</span></div><div class="line">chrome.tabs.query(&#123; <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">currentWindow</span>: <span class="hljs-literal">true</span> &#125;, tabs =&gt; &#123;</div><div class="line">  chrome.tabs.sendMessage(tabs[<span class="hljs-number">0</span>].id, &#123; <span class="hljs-attr">greeting</span>: <span class="hljs-string">'hello'</span> &#125;, res =&gt; &#123;</div><div class="line">    <span class="hljs-built_in">console</span>.log(res)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>On the receiving end, you need to set up an <code>runtime.onMessage</code> event listener to handle the message.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.onMessage.addListener(<span class="hljs-function">(<span class="hljs-params">req, sender, sendRespond</span>) =&gt;</span> &#123;</div><div class="line">  <span class="hljs-built_in">console</span>.log(sender.tab ? <span class="hljs-string">`from a content script: <span class="hljs-subst">$&#123;sender.tab.url&#125;</span>`</span> : <span class="hljs-string">`from the extension`</span>)</div><div class="line">  <span class="hljs-keyword">if</span> (req.greeting === <span class="hljs-string">'hello'</span>) &#123;</div><div class="line">    sendResponse(&#123; <span class="hljs-attr">farewell</span>: <span class="hljs-string">'goodbye'</span> &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>In the above example, the <code>sendResponse</code> is called synchronously. If you want to call the <code>sendResponse</code> asynchronously, simple <code>return true</code> at the end.</p>
<blockquote>
<p>Note: If multiple pages are listening on the onMessage events, only the first to call <code>sendResponse</code> for a particular event will succeed in sending response. Other response will be ignored.</p>
<p>Note: call sendResponse synchronously or return true. Without return true, sendResponse(undefined) will be called automatically and implicitly.</p>
</blockquote>
<h3 id="Long-lived-connections"><a href="#Long-lived-connections" class="headerlink" title="Long-lived connections"></a>Long-lived connections</h3><p>Sometimes it’s useful to have a conversation lasting longer than one-time request.</p>
<p>You can open a long-lived channel from content script to an extension page, or vice versa, by using <code>runtime.connect</code> or <code>tab.connect</code>.</p>
<p>When establishing a connection, each end is given a <code>runtime.Port</code> object which is used for sending and receiving messages through that connection.</p>
<figure class="highlight js hljs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="hljs-keyword">const</span> port = chrome.runtime.connect(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'knockknock'</span> &#125;)</div><div class="line">port.postMessage(&#123; <span class="hljs-attr">joke</span>: <span class="hljs-string">'Knock knock'</span> &#125;)</div><div class="line">port.onMessage.addListener(<span class="hljs-function"><span class="hljs-params">msg</span> =&gt;</span> &#123;</div><div class="line">  <span class="hljs-keyword">if</span> (msg.question === <span class="hljs-string">"Who's there?"</span>) &#123;</div><div class="line">    port.postMessage(&#123; <span class="hljs-attr">answer</span>: <span class="hljs-string">'Madame'</span> &#125;)</div><div class="line">  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (msg.question === <span class="hljs-string">'Madame who?'</span>) &#123;</div><div class="line">    port.postMessage(&#123; <span class="hljs-attr">answer</span>: <span class="hljs-string">'Madame... Bovary'</span> &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Chrome-Extensions/">Chrome, Extensions</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Like this article? Support the author with</h3>
        <div class="buttons is-centered">
            
                <!-- Visit https://www.paypal.com/donate/buttons/ to get your donate button -->

<a class="button is-warning donate" onclick="document.getElementById(&#39;paypal-donate-form&#39;).submit()">
    <span class="icon is-small">
        <i class="fab fa-paypal"></i>
    </span>
    <span>Paypal</span>
</a>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" id="paypal-donate-form">
    <input type="hidden" name="cmd" value="_donations" />
    <input type="hidden" name="business" value="chen.yu.keith@foxmail.com" />
    <input type="hidden" name="currency_code" value="USD" />
</form>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2020/01/17/Inspect-protobuf-js/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Inspect-protobuf.js</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2019/12/03/Introduction-to-MACD/">
                <span class="level-item">Introduction to MACD</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
	var gitment = new Gitment({
		id: '2020/01/06/crx-config/',
		owner: 'Keith-CY',
		repo: 'Keith-CY.github.io',
		oauth: {
			client_id: '56319e1ce36ed4313555',
			client_secret: 'ca7f10a8357d52290f5509fb54e5173a8bea0a5d',
		},
	})
	gitment.render('comment-container')
</script>

    </div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>

</html>
