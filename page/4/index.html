<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Front-End, JavaScript, Html, Css, React, Vue, Rxjs" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="EzCook">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="EzCook">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="EzCook">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/4/"/>





  <title> EzCook </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">EzCook</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Code Elegantly</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/06/usage-of-redux-action-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/06/usage-of-redux-action-2/" itemprop="url">
                  Usage of Redux-Action
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-06T09:42:50+08:00">
                2016-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><p><code>createAction(type, payloadCreator = Identity, ?metaCreator)</code></p>
<pre><code>import { createAction } from &apos;redux-action&apos;
`&lt;/pre&gt;

Wraps an action creator so that its return value is the payload of a Flux Standard Action. If no payload creator is passed, or if it&apos;s not a function, the identity function is used.

### Example

&lt;pre&gt;`let increment = createAction(&apos;INCREMENT&apos;, amount =&amp;gt; amount);
// same as 
increment = createAction(&apos;INCREMENT&apos;);

expect(increment(42)).to.deep.equal({
  type:&apos;INCREMENT&apos;,
  payload: 42,
});
`&lt;/pre&gt;

If the payload is an instance of an Error Object, redux-actions will automatically set `action.error` to true.

### Example

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;);

const error = new TypeError(&apos;not a number&apos;);
expect(increment(error)).to.deep.equal({
  type: &apos;INCREMENT&apos;,
  payload: error,
  error: true,
})
`&lt;/pre&gt;

`createAction` also return its `type` when used as type in `handleAction` or `handleActions`

### Example

&lt;pre&gt;`const increment = createAction(&apos;INCREMENT&apos;)

// as parameter in handleAction:

handleAction(increment, {
  next(state, action){...},
  throw(state, action) {...},
});

const reducer = handleActions({
  [increment]: (state, action) =&amp;gt; ({
    counter: state.counter + action.payload
  })
})
`&lt;/pre&gt;

### createActions(?actionsMap, ?...identityActions)

&lt;pre&gt;`import { createActions } from from &apos;redux-actions&apos;
`&lt;/pre&gt;

Returns an object mapping action types to action creator. The keys of this object are camel-cased from the keys in `actionsMap` and the string literals of `identityActions` the values are the action creators.

### combineActions(...actionTypes)

Combine any number of action types or action creators, `actionTypes` is a list of positional arguments which can be action type strings, symbols, or action creators.

This allows you to reduce multiple distinct actions with the same reducers.

&lt;pre&gt;`const { increment, decrement } = createActions({
  INCREMENT: amount =&amp;gt; ({amount}),
  DECREMENT: amount =&amp;gt; ({amount: -amount}),
}) 

const reducer = handleAction(combineActions(increment, decrement), {
  next: (state, { payload: { amount }}) =&amp;gt; ({ ...state, counter: state.counter + amount}),
  throw: state =&amp;gt; ({ ...state, counter: 0}),
}, { counter: 10 })

expect(reducer(undefined, increment(1)).to.deep.equal({ counter: 11 }))
expect(reducer(undefined, decrement(1)).to.deep.equal({ counter: 9 }))
expect(reducer(undefined, increment(new Error)).to.deep.equal({ counter: 0 }))
expect(reducer(undefined, decrement(new Error)).to.deep.equal({ counter: 0 }))
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/06/flux-standard-action/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/06/flux-standard-action/" itemprop="url">
                  Flux Standard Action
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-06T08:47:45+08:00">
                2016-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Example"><a href="#Example" class="headerlink" title="Example:"></a>Example:</h3><ol>
<li><p>A basic Flux Standard Action</p>
<p>{<br>  type: ‘ADD_TODO’,<br>  payload: {</p>
<pre><code>text: &apos;Do something&apos;,
</code></pre><p>  }<br>}<br>`</p>
<p>An FSA that represents an error, analogous to a rejected Promise:</p>
<p><pre>`{<br>  type: ‘ADD_TODO’,<br>  payload: new Error(),<br>  error: true,<br>}</pre></p>
</li>
</ol>
<p>Notice:<br>1. An action MUST</p>
<ul>
<li>be a plain JavaScript Object</li>
<li>have a <code>type</code> property</li>
</ul>
<ol>
<li>An action MAY:</li>
</ol>
<ul>
<li>have a <code>error</code> property</li>
<li>have a <code>payload</code> property</li>
<li>have a <code>meta</code> property</li>
</ul>
<ol>
<li>An action MUST NOT include properties other than <code>type</code>, <code>payload</code>, <code>error</code>, <code>meta</code></li>
</ol>
<h3 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h3><p>The <code>type</code> of an action identifies to the consumer the nature of the action that has occurred. Two actions with same <code>type</code> MUST be strictly equivalent (using ===). By convention, <code>type</code> is usually string constant or a Symbol.</p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>The optional <code>payload</code> property MAY be any type of value. It represents the payload of the action. Any information about the action that is not the <code>type</code> or status of the action should be part of the <code>payload</code> filed.</p>
<p>By convention, if <code>error</code> is <code>true</code>, the <code>payload</code> SHOULD be an error object. This is akin to rejecting a promise with an error object.</p>
<h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><p>The optional <code>error</code> property MAY be set to <code>true</code> if the action represents an error.</p>
<p>An action whose <code>error</code> is true is analogous to a rejected Promise. By convention the <code>payload</code> SHOULD be an error object.</p>
<p>If <code>error</code> has any other value besides <code>true</code>, including <code>undefined</code> and <code>null</code>, the action MUST NOT be interpreted as an error.</p>
<h3 id="meta"><a href="#meta" class="headerlink" title="meta"></a>meta</h3><p>The optional <code>meta</code> property MAY be any type of value. It is intended for any extra information that is not part of the payload.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/09/promise-e5-9f-ba-e6-9c-ac-e7-82-b9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/09/promise-e5-9f-ba-e6-9c-ac-e7-82-b9/" itemprop="url">
                  Promise 基本点
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-09T04:57:23+08:00">
                2016-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Promise-基本用法"><a href="#Promise-基本用法" class="headerlink" title="Promise 基本用法"></a>Promise 基本用法</h3><p>创建 Promise</p>
<pre><code>var promise = new Promise(function(resolve, reject){
  // do something async
  if(/* everything ok */){
    resolve(&quot;OK&quot;); // it will return Promise.resolve(&quot;OK&quot;), and the downstream will get &quot;OK&quot; as params
  } else {
    reject(Error(&quot;Error&quot;)); // it will return Error(&quot;Error&quot;) and the downstream will get Error(&quot;Error&quot;) as params
  }
})
`&lt;/pre&gt;

Promise 构造器接受一个函数作为参数, 传入两个回调函数resolve 和 reject, 在这个函数参数中做一些一步操作, 成功后调用 resolve 将 Promise 对象的状态设置为 resolved 并返回一个 Promise 对象用于链式调用, 失败后调用 reject 将 Promise 对象的状态设置为 rejected 并返回一个 Promise 对象用于链式调用

使用时:

&lt;pre&gt;`promise.then(function(result){}).catch(function(err){})
</code></pre><h3 id="Promise-API-Reference"><a href="#Promise-API-Reference" class="headerlink" title="Promise API Reference"></a>Promise API Reference</h3><p>静态方法:</p>
<ul>
<li><p><code>Promise.resolve(promise)</code>, 返回一个 Promise</p>
</li>
<li><p><code>Promise.resolve(thenable)</code>, 从 thenable 对象创建一个新的 Promise, 一个 thenable (类 Promise) 对象是一个带有” then” 方法的对象.</p>
</li>
<li><p><code>Promise.resolve(obj)</code>, 创建一个以 obj 为肯定结果的 Promise</p>
</li>
<li><p><code>Promise.reject(obj)</code>, 创建一个以 obj 为否定结果的 Promise, 为了一致性和调试方便, obj 应该是一个 Error 实例对象.</p>
</li>
<li><p><code>Promise.all(array)</code>, 创建一个 Promise, 当且仅当数组中的所有 Promise 都 resolved 之后才设为 resolved, 若其中存在 rejected, 则设置状态为rejected</p>
</li>
<li><p><code>Promise.race(array)</code>, 创建一个 Promise, 当数组首先出现 resovled 或 rejected 的时候设置为同状态</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/27/javascript-e4-ba-8b-e4-bb-b6-e4-b8-8e-e6-80-a7-e8-83-bd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/27/javascript-e4-ba-8b-e4-bb-b6-e4-b8-8e-e6-80-a7-e8-83-bd/" itemprop="url">
                  JavaScript 事件与性能
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-27T16:23:11+08:00">
                2016-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>事件处理程序本质上是一种函数, 是一种对象, 存放在内存中, 设置大量的事件处理程序会使内存中的对象变多, Web 程序的性能会变得越来越差.</p>
<p>为了更好利用事件处理程序, 出现了<strong>事件委托</strong>, 用来提升性能</p>
<h3 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h3><p>Event Delegate: 把若干个子节点上的相同事件的处理函数绑定到父节点, 从父节点统一处理子节点冒泡上来的事件, 这种技术叫做事件委托.</p>
<p>举例:</p>
<pre><code>&amp;lt;ul id=&apos;parent-list&apos;&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
    &amp;lt;li id=&apos;list-1&apos;&amp;gt;List 1&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
`&lt;/pre&gt;

通过父节点监听冒泡事件可以处理子节点上的对应事件

&lt;pre&gt;`var parentList = document.getElementById(&apos;parent-list&apos;);
parentList.addEventListener(&apos;click&apos;, function(){
  var target = event.target; // li
  if(target.nodeName.toLowerCase() === &apos;li&apos;){
    alert(target.firstChild.nodeValue);
  }
}, false)
</code></pre><p>因为事件委托依赖事件冒泡机制, 所以并不是所有事件都可以委托</p>
<p>最适合的事件: click, mousedown, mouseup, keydown, keyup, keypress</p>
<h3 id="移除事件处理程序"><a href="#移除事件处理程序" class="headerlink" title="移除事件处理程序"></a>移除事件处理程序</h3><p>每当将事件处理程序制定给元素时, 运行中的浏览器代码与支持页面交互的 Js 代码之间就会建立一个连接, 这种连接越多, 页面执行越慢</p>
<p>如果使用完后不再使用的事件处理程序, 应当释放掉<br>```</p>
<p><button id="button">Submit</button><br>var button = document.getElementById(‘button’);<br>button.onclick = function(){<br>  button.onclick = null;<br>  event.target.firstChild.nodeValue = “Submitting”<br>}</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/27/javascript-e5-81-9c-e6-ad-a2-e5-86-92-e6-b3-a1-e5-92-8c-e9-98-bb-e6-ad-a2-e6-b5-8f-e8-a7-88-e5-99-a8-e9-bb-98-e8-ae-a4-e8-a1-8c-e4-b8-ba/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/27/javascript-e5-81-9c-e6-ad-a2-e5-86-92-e6-b3-a1-e5-92-8c-e9-98-bb-e6-ad-a2-e6-b5-8f-e8-a7-88-e5-99-a8-e9-bb-98-e8-ae-a4-e8-a1-8c-e4-b8-ba/" itemprop="url">
                  JavaScript 停止冒泡和阻止浏览器默认行为
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-27T15:25:00+08:00">
                2016-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="事件兼容"><a href="#事件兼容" class="headerlink" title="事件兼容"></a>事件兼容</h3><pre><code>function myFn(e){
  var evt = e ? e:window.event
}
`&lt;/pre&gt;

### JS 停止冒泡

&lt;pre&gt;`function myFn(e){
  window.event ? window.event.cancelBubble = true : e.stopPropagation();
}
`&lt;/pre&gt;

### JS 阻止默认行为

&lt;pre&gt;`function myFn(e){
  window.event ? window.event.returnValue = false : e.preventDefault();
}
</code></pre><h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><p>event 表示事件的状态, 例如, event.target 是触发事件的对象</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/19/koa-router/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/koa-router/" itemprop="url">
                  koa-router
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-19T04:35:48+08:00">
                2016-09-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>Express 式路由使用<code>app.get</code>, <code>app.put</code>, <code>app.post</code> 等</li>
<li>Named URL parameters and regexp captures</li>
<li>String or regular expression route matching</li>
<li>Named Routes with URL generation</li>
<li>Responds to <code>OPTIONS</code> request with allowed methods</li>
<li>Support for <code>405 Method Not Allowed</code> and <code>501 Not Implemented</code></li>
<li>Multiple route middleware</li>
<li>Multiple routers</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>npm install koa-router
`&lt;/pre&gt;

### 使用

&lt;pre&gt;`var koa = require(&quot;koa&quot;),
    router = require(&quot;koa-router&quot;),
    app = koa();

app.use(router(app))
`&lt;/pre&gt;

After the router has been initialized you can register routes:

&lt;pre&gt;`app.get(&quot;/users/:id&quot;, function*(next){
  var user = yield User.findOne(this.params.id);
  this.body = user;
});
`&lt;/pre&gt;

### 多路由

You can use multiple routers and sets of routes by omitting the `app` argument. For example, separate routes for two versions of an API:

&lt;pre&gt;`var koa = require(&quot;koa&quot;),
    mount = require(&quot;mount&quot;),
    Router = require(&quot;koa-router&quot;);

var app = koa();

var APIv1 = new Router();
var APIv2 = new Router();

APIv1.get(&quot;/sign-in&quot;, function*(){
  // ...
})
APIv2.get(&quot;/sign-in&quot;, function*(){
  // ...
})

app.use(mount(&quot;/v1&quot;, APIv1.middleware())).use(mount(&quot;/v2&quot;, APIv2.middleware()));
`&lt;/pre&gt;

### 链

The http methods(get, post, etc) return their `Router` instance, so routes can be chained as you&apos;re used to with express:

&lt;pre&gt;`var api = new Router();

api.get(&quot;/foo&quot;, showFoo).get(&quot;/bar&quot;, showBar).post(&quot;/foo&quot;, createFoo)
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/19/e7-bc-96-e5-86-99-koa-e4-b8-ad-e9-97-b4-e4-bb-b6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/e7-bc-96-e5-86-99-koa-e4-b8-ad-e9-97-b4-e4-bb-b6/" itemprop="url">
                  编写 Koa 中间件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-19T03:23:36+08:00">
                2016-09-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Koa middlewares are simple function which return a <code>GeneratorFunction</code>, and accept another (middleware). When the middleware is run by an “upstream” middleware, it must manually <code>yield</code> to the “downstream” middleware.</p>
<p>For example if you wanted to track how long it takes for a request to propagate through Koa by adding an <code>x-Response-Time</code> header field the middleware would look like the following:</p>
<pre><code>function *responseTime(next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  this.set(&quot;X-Response-Time&quot;, ms+&quot;ms&quot;);
}
app.use(responseTime);
`&lt;/pre&gt;

Here is another way to write the same thing, inline:

&lt;pre&gt;`app.use(function *(next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  this.set(&quot;X-Response-Time&quot;, ms+&quot;ms&quot;);
});
`&lt;/pre&gt;

### 中间件最佳实践

Imcluding Middleware accepting options, named middleware for debugging, among others

#### 中间件选项

When creating public middleware it&apos;s useful to conform to the convention of wrapping the middleware in a function that accepts options, allowing users to extend functionality. Even if your middleware accepts no options, this is still a good idea to keep things uniform.

Here our contrived `logger` middleware accepts a `format` string for customization, and returns the middleware itself:

&lt;pre&gt;`function logger(format){
  format = format || &quot;:method\&quot;:url\&quot;&quot;;
  return function*(next){
    var str = format.replace(&quot;:method&quot;, this.method).replace(&quot;:url&quot;, this.url);
    console.log(str);
    yield next;
  }
}
`&lt;/pre&gt;

app.use(logger());
app.use(logger(&quot;:method:url&quot;))

&lt;pre&gt;`
### 命名中间件
Naming middlewares is optional, however it&apos;s useful for debugging purpose to assign a name
`&lt;/pre&gt;

function logger(format){
  return function *logger(next){
    // ...
  }
}

&lt;pre&gt;`### 结合多个中间件
Sometimes you want to &quot;compose&quot; multiple middleware into a single middleware for easy re-use or exporting. To do so, you may chain them together with `.call(this, next)`, then return another function that yields the chain
</code></pre><p>function _random(next) {<br>  if (‘/random’ == this.path) {<br>    this.body = Math.floor(Math.random()_10);<br>  } else {<br>    yield next;<br>  }<br>};</p>
<p>function *backwards(next) {<br>  if (‘/backwards’ == this.path) {<br>    this.body = ‘sdrawkcab’;<br>  } else {<br>    yield next;<br>  }<br>}</p>
<p>function *pi(next) {<br>  if (‘/pi’ == this.path) {<br>    this.body = String(Math.PI);<br>  } else {<br>    yield next;<br>  }<br>}</p>
<p>function *all(next) {<br>  yield random.call(this, backwards.call(this, pi.call(this, next)));<br>}</p>
<p>app.use(all);<br>```</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/19/koa-e4-bd-bf-e7-94-a8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/koa-e4-bd-bf-e7-94-a8/" itemprop="url">
                  koa 使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-19T03:02:51+08:00">
                2016-09-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Koa 当前需要 node 0.11.x 并开启 –harmony(或– harmony-generators), 因为他依赖于 ES6的 generator 特性<br><code>node --harmony my-koa-app.js</code></p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>Koa 应用是一个包含中间件 generator 方法数组的对象. 当请求到来时, 这些方法会以 stack-slice 的顺序执行.</p>
<p>Koa 的一大设计理念是, 通过其他底层中间件层提供高级”语法糖”, 而不是 Koa, 大大提高了框架的互操作性和健壮性, 并让中间件开发变得有趣.</p>
<p>简单例子</p>
<pre><code>var koa = require(&quot;koa&quot;);
var app = koa();
app.use(function*(){
  this.body = &quot;Hello World&quot;;
});
app.listen(3000);
`&lt;/pre&gt;

**注**: 与普通 function 不同, generator function 以 function* 的形式声明.

### 编写级联代码

koa 中间件以一种更加传统的方式级联.

以往的 Node 开发中, 级联是通过回调实现的, 用户友好度上有欠缺

Koa 借助 generator 实现了中间件架构

Koa 的执行代码的形式不再是简单的将控制权依次移交给一个又一个方法直到结束, 而是像一个回形针, 用户请求中间件, 遇到 yield next 关键字的时候, 会被传递给下游中间件(downstream), 在 yield next 捕获不到 downstream 的时候, 逆序返回执行代码(upstream)(yield next 后面的代码)

&lt;pre&gt;`var koa = require(&quot;koa&quot;);
var app = koa();

// x-response-time

app.use(function* (next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  this.set(&quot;X-Response-Time&quot;, ms+&quot;ms&quot;);
})

// logger
app.use(function* (next){
  var start = new Date;
  yield next;
  var ms = new Date - start;
  console.log(&quot;%s %s - %s&quot;, this.method, this.url, ms)
});

// response
app.use(function* (){
  this.body = &quot;Hello World&quot;;
});

app.listen(3000);
`&lt;/pre&gt;

### 应用配置

应用配置是 app 实例的属性, 目前支持以下配置:
- app.name 应用名
- app.env 执行环境, 默认是`NODE_ENV`或者`development`字符串
- app.proxy, 当该属性为 true 时, `proxy header` 参数会被添加到信任列表中

### app.listen(...)

一个 Koa 应用跟 HTTP Server 不是1-to-1关系, 一个或多个 Koa应用可以被加载到一块, 组成一个更大的包含一个 HTTP server 的应用

该方法创建并返回一个 http server, 并支持传递固定参数

&lt;pre&gt;`var koa = require(&quot;koa&quot;)
var app = koa()
app.listen(3000)
`&lt;/pre&gt;

方法 app.listen(...)是一个语法糖, 等价于

&lt;pre&gt;`var http = require(&quot;http&quot;)
var koa = require(&quot;koa&quot;)
var app = koa()
http.createServer(app.callback()).listen(3000)
`&lt;/pre&gt;

这意味着可以在多个端口使用同一个 app

&lt;pre&gt;`http.createServer(app.callback()).listen(3000)
http.createServer(app.callback()).listen(3001)
`&lt;/pre&gt;

### app.callback()

返回一个回调方法能用于 http.createServer()来处理请求, 也可以将这个回调函数挂载到 Connect/Express 应用上

### app.use(function)

将给定的 function 当做中间件加载到应用中

### app.keys=

设置 Cookie 签名密钥

### 错误处理

除非应用执行环境(NODE_ENV)被配置为&quot;test&quot;, Koa 都会将所有错误信息输出到 stderr, 如果想自定义错误处理逻辑, 可以定义一个&quot;错误事件&quot;来坚挺 Koa App 中的错误:

&lt;pre&gt;`app.on(&quot;error&quot;,function(err){
  log.error(&quot;server error&quot;, err);
})
`&lt;/pre&gt;

当 req/res 周期中出现任何错误且无法响应客户端时, koa 会把 Context(上下文)实例作为第二个参数传递给 error 事件:

&lt;pre&gt;`app.on(&quot;error&quot;, function(err, ctx){
  log.error(&quot;server error&quot;, err, ctx)
})
`&lt;/pre&gt;

### 上下文

Koa 的 Context 把 node 的 request 和 response 对象封装在一个单独对象, 并提供许多开发 web 应用和 APIs 有用的方法. 那些 HTTP Server 开发中使用非常频繁操作, 直接在 Koa 里实现, 而不是放在更高层次的框架, 这样中间件就不需要重复实现这些通用的功能.

每个请求会创建自己的 Context 实例, 在中间件中作为 receiver 引用, 或通过 this 标示引用:

&lt;pre&gt;`app.use(function* (){
  this; // is the Context
  this.request; // is a koa Request
  this.response; // is a koa Response
})
</code></pre><p>Context 的许多访问器和方法直接委托为他们的 ctx.request 或 ctx.response 的等价方法, 用于访问方便, 是完全相同的, 比如 ctx.type 和 ctx.length 委托与 response 对象, ctx.path 和 ctx.method 委托与 request.</p>
<h3 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h3><p>Koa Request 对象是 node 普通 request 对象之上的抽象, 提供了日常 Http Server 中更多有用的功能</p>
<h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><ul>
<li>request.header</li>
<li>request.headers: req.header 的别名</li>
<li>request.method: 请求方法</li>
<li>request.method=: 设置请求方法, 实现中间件的时候非常有用</li>
<li>request.length: 将请求的 Content-length 返回为数字, 或 undefined</li>
<li>request.url: 获取请求 URL</li>
<li>request.url=: 设置请求 URL<br>…</li>
</ul>
<h3 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h3><p>Koa Response 对象是 node 普通 response 对象之上的抽象, 提供了日常 Http Server 中有用的功能</p>
<h4 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h4><p>….</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/18/xtemplate-e6-a8-a1-e6-9d-bf-e8-af-ad-e6-b3-95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/18/xtemplate-e6-a8-a1-e6-9d-bf-e8-af-ad-e6-b3-95/" itemprop="url">
                  XTemplate 模板语法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-18T16:21:47+08:00">
                2016-09-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>变量会从当前模板的上下文查找值, 如果要输出一个变量的值, 可以使用</p>
<pre><code>{{ variable }}
`&lt;/pre&gt;

这样模板引擎会从上下文寻找变量`variable`并打印出来. 变量可以使用`.`访问其属性, 和 js 一样也可以通过`[]`访问属性

&lt;pre&gt;`{{ user.name }}
{{ user['name'] }}
`&lt;/pre&gt;

如果一个变量的值是`undefined`或`null`, 那么什么也不会输出, 也不会报错.

### 支持的数据类型

XTemplate 支持 js 中所有基本数据类型
- Boolean
- Number
- String
- Null
- Undefined
- Object
- Array

### 输出

使用`{{ foo }}`来输出`escape`之后的数据, `{{{ foo }}}`来输出`unescape`的原始数据

&lt;pre&gt;`escaped: {{ foo }}
unescaped: {{{ foo }}}
`&lt;/pre&gt;

如果希望输出最原始数据(包括`{{}}`), 那么需要使用`{{% %}}`语法

&lt;pre&gt;`{{% 
      {{ x }}
    %}}
`&lt;/pre&gt;

渲染这个模板, 会输出

&lt;pre&gt;`{{ x }}
`&lt;/pre&gt;

#### 添加注释

&lt;pre&gt;`{{! comment }}
`&lt;/pre&gt;

#### 添加空格

`{{~`删除空格前缀
    `~}}`删除空格后缀

### 作用域

每一个模板都有一个独立的作用于, 在字幕版中可以访问父模板的上下文, 但是字幕版中定义或者修改变量不会影响到父模板的变量

&lt;pre&gt;`// parent.xtpl
{{ set (a=1,b=2) }}
{{ include ('sub.xtpl') }}
in parent:
a = {{ a }}
b = {{ b }}
`&lt;/pre&gt;

&lt;pre&gt;`// sub.xtpl
in sub:
{{ set b = 3 }}
a = {{ a }}
b = {{ b }}
`&lt;/pre&gt;

渲染 parent.xtpl 得到

&lt;pre&gt;`in sub: 
a: 1
b: 3
in parent:
a: 1
b: 2
`&lt;/pre&gt;

### 根数据

通过`root.foo` 可以访问到渲染的根数据, 即调用`render`方法时传入的数据

用数据`{ name: &apos;foo&apos;, array: [{name:&apos;bar&apos;}] }`渲染下面模板:

&lt;pre&gt;`{{ #each(arr) }}
{{root.name}} {{name}}
{{/each}}
`&lt;/pre&gt;

得到

&lt;pre&gt;`foo bar
`&lt;/pre&gt;

## 方法和逻辑

可以使用变量上 js 提供的方法:

&lt;pre&gt;`var x = [1,2,3]
`&lt;/pre&gt;

&lt;pre&gt;`{{#each(x.slice(1))}}{{this}} {{/each}} // =&amp;gt; 2 3
`&lt;/pre&gt;

### 操作符

XTemplate 支持在数据上使用一些操作符:

&lt;pre&gt;`+, -, *, /, %
`&lt;/pre&gt;

&lt;pre&gt;`===, !==, &amp;gt;, &amp;gt;=, &amp;lt;, &amp;lt;=
`&lt;/pre&gt;

&lt;pre&gt;`||, &amp;amp;&amp;amp;, !
`&lt;/pre&gt;

&lt;pre&gt;`?:
`&lt;/pre&gt;

### 函数调用

如果你传递 js 的方法到模板中, 那么可以使用它

&lt;pre&gt;`{{foo(1,2,3)}}
`&lt;/pre&gt;

### 内置函数

&lt;pre&gt;`range(start, end, [step])
`&lt;/pre&gt;

不包括 end

&lt;pre&gt;`set(key = value, [key = value])
`&lt;/pre&gt;

`set` 用于定义或修改一个变量

&lt;pre&gt;`{{ set(x=1) }}
{{ set(y=3,z=2) }}
{{x}}
{{y+z}}
`&lt;/pre&gt;

渲染得到

&lt;pre&gt;`1
5
`&lt;/pre&gt;

`void`, 允许忽略模板渲染

&lt;pre&gt;`{{ set(x=1) }}
{{ void(x) }}
`&lt;/pre&gt;

将渲染空

## 命令

命令是一些特殊的区块, 对于这些特殊的区块, XTemplate 会做特殊处理. XTemplate 自带了一些内置的命令, 也可以自定义命令

`if`

&lt;pre&gt;`{{# if(variable) }}
  It is true
{{/ if}}
`&lt;/pre&gt;

如果 vairable 为 true, 则渲染命令块

&lt;pre&gt;`{{# if(variable) }}
{{ elseif (vairable)}}
{{ else }}
{{/ if }}

`with`
和 js 中的`with`类似
`&lt;/pre&gt;

var a = {
  b:1
}
```

&lt;pre&gt;`{{{#with(a)}}}
{{b}} // 1
{{/with}}
`&lt;/pre&gt;

`each`
`each`可以对 array 和 dictionary 进行迭代

&lt;pre&gt;`// array
{{ set (array = [{
      name: 'foo'
    }, {
      name: 'bar'
    }])}}

{{#each(array)}}
  {{xindex}} {{this.name}}
{{/each}}
`&lt;/pre&gt;

渲染得到

&lt;pre&gt;`0 foo
1 bar
`&lt;/pre&gt;

&lt;pre&gt;`// dictionary
{{ set (dictionary = {
      foo:'bar',
      hello:'world'
    })}}

{{#each(dictionary,'value','key')}}
  {{key}}{{value}}
{{/each}}
`&lt;/pre&gt;

渲染得到

&lt;pre&gt;`foo bar
hello world
`&lt;/pre&gt;

### 访问上层变量

在`with`和`each`中, 可以通过`../`访问外层的同名变量

&lt;pre&gt;`// {a: 1, b:[{a:2}]}
{{#with(x)}}
  {{#each(b)}}
    {{../a}}{{a}} // 12
  {{/with}}
{{/with}}
`&lt;/pre&gt;

### 宏

宏允许你定义一个可复用的代码片段

&lt;pre&gt;`{{#macro("test","param",default=1)}}
  param is {{param}} {{default}}
{{/macro}}
`&lt;/pre&gt;

现在可以调用该宏

&lt;pre&gt;`{{macro("test", "2")}}
{{macro("test","2",default=2)}}
`&lt;/pre&gt;

渲染结果

&lt;pre&gt;`param is 2 1
param is 2 2
`&lt;/pre&gt;

### include

`include` 引入其他的模板, 在共享组件的时候十分有效

&lt;pre&gt;`{{ include ('item.html') }}
`&lt;/pre&gt;

如果下网引入子模板的时候可以在子模板的上下文设置其他值, 可以通过`include`后面的参数传入

&lt;pre&gt;`// parent.html
{{ set(x='x',y='y') }}
{{ include ('sub.html', xx=x,yy=x) }}
`&lt;/pre&gt;

&lt;pre&gt;`// sub.html
x:{{x}}
y:{{y}}
xx:{{xx}}
yy:{{yy}}
`&lt;/pre&gt;

parent.html渲染结果

&lt;pre&gt;`x: x // from parent.html
y: y // from parent.html
xx: x // from sub.html
yy: x // from sub.html
`&lt;/pre&gt;

### includeOnce

功能和`include`一样, 区别在于对于同一个模板, 只在第一次调用的时候起作用.

### parse

如果希望能够让子模板拥有一个完全独立的上下文, 不需要父级作用于, 则可以使用`parse`

&lt;pre&gt;`// parent.html
{{ set(x = 'x', y = 'y') }}
{{ parse('sub.html', xx = x, yy = x) }}
`&lt;/pre&gt;

&lt;pre&gt;`// sub.html
x: {{x}}
y: {{y}}
xx: {{xx}}
yy: {{yy}}
`&lt;/pre&gt;

parent.html渲染结果

&lt;pre&gt;`x:
y:
xx:x
yy:x
`&lt;/pre&gt;

## 模板继承

当编写一个 template 的时候, 可以定义`blocks`, 这样在字幕版中可以重写这些 block

&lt;pre&gt;`// parent.xtpl
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
  &amp;lt;head&amp;gt;
    &amp;lt;....&amp;gt;
    {{{block ('head')}}}
  &amp;lt;/head&amp;gt;
  &amp;lt;body&amp;gt;
    {{{block ('body')}}}
  &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
`&lt;/pre&gt;

&lt;pre&gt;`// child.xtpl
{{ extend ('./parent.xtpl')}}

{{#block ('head')}} // overwrite head block
  &amp;lt;....&amp;gt;
{{/block}}

{{#block ('body')}} // overwrite body block
  &amp;lt;...&amp;gt;
{{/block}}
</code></pre><p>渲染 child.xtpl 可以获得新的模板下的实例</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/17/flex-e5-b1-9e-e6-80-a7-e8-af-a6-e8-a7-a3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EzCook">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/17/flex-e5-b1-9e-e6-80-a7-e8-af-a6-e8-a7-a3/" itemprop="url">
                  Flex 属性详解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-17T16:05:53+08:00">
                2016-09-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>display: flex|inline-flex; (修饰Flex Container, 也就是 Flex Item的父级元素)<br>该属性修饰的元素, 其子元素将变成 flex 文档流, 称为 Flex Item</li>
</ol>
<p><strong>注意</strong>: CSS 的 columns 在 FlexContainer 上没有作用; float, clear, vertical-align 在 FlexItem 上没有作用</p>
<ol>
<li>flex-direction: row|row-reverse|column|column-reverse(修饰 Flex Container)<br>用于定义main-axis, 从而定义 flex 文档流方向<p></p></li>
<li><p>flex-wrap: nowrap|wrap|wrap-reverse; (修饰 Flex Container)<br>nowrap: 单行显示; wrap: 多行显示; wrap-reverse: 逆向多行显示</p>
</li>
<li><p>flex-flow: &lt;’flex-direction’&gt;||&lt;’flex-wrap’&gt;; (修饰 Flex Container)<br>这个是 flex-direction 和 flex-wrap 的缩写, 同时定义主轴和侧轴的文档流向</p>
</li>
<li><p>justify-content:flex-start|flex-end|center|space-between|space-around; (修饰 Flex Container)<br>定义主轴线上 Flex Item 的对齐方式</p>
</li>
</ol>
<p>flex-start: 向起始位置对齐; flex-end: 向结束位置对齐; center: 向中间靠拢; space-between: 首位 item 位于边界, 所有 items 均匀分布; space-around: 首位 item 距离边界1space, 所有 item 之间距离2space</p>
<p><img src="http://cdn.w3cplus.com/cdn/farfuture/gnLmjiUDLu3L9INIb8KPA5vE6xsQaRuSMU_UfamwmDM/mtime:1421035122/sites/default/files/styles/print_image/public/blogs/2013/flexbox-guide-2.jpg" alt=""></p>
<ol>
<li>align-item: flex-start|flex-end|center|baseline|stretch; (修饰 Flex Container)<br>定义 item 在侧轴方向的对齐方式</li>
</ol>
<p><img src="http://cdn2.w3cplus.com/cdn/farfuture/DTYyNpRoVAWKoI-BNSJ06avE6tVTibwXa3VXqoEhWbs/mtime:1421035123/sites/default/files/styles/print_image/public/blogs/2013/flexbox-guide-3.jpg" alt=""></p>
<ol>
<li>align-content: flex-start|flex-end|center|space-between|space-around|stretch(default); (修饰 Flex Container)<br>校准 item 在 container 中的对齐方式, 类似于 justify-content, 本属性在单行的容器中没有效果</li>
</ol>
<p><img src="http://cdn1.w3cplus.com/cdn/farfuture/P-M8WSERtYlnjKq2QRb-TXGdIOtTs7EIinejAJd0V0I/mtime:1421035123/sites/default/files/styles/print_image/public/blogs/2013/flexbox-guide-4.jpg" alt=""></p>
<ol>
<li><p></p><p>order: <integer>; (修饰 Flex Item)<br>手动指定显示顺序</integer></p>
</li>
<li><p>flex-grow: <number>; (修饰 Flex Item)<br>定义 Item 的扩张能力, 接受一个不带单位的值作为一个比例, 主要用来决 Item 对 Container 剩余空间的利用</number></p>
</li>
<li><p>flex-shrink: <number>; (修饰 Flex Item)<br>定义 Item 的收缩能力</number></p>
</li>
<li><p>flex-basis: <length>|auto(default); (修饰 Flex Item)<br>设置伸缩基准, 剩余的空间按照比例伸缩</length></p>
</li>
<li><p>flex: none|[&lt;’flex-grow’&gt;&lt;’flex-shrink’&gt;? || &lt;’flex-basis’&gt;]; (修饰 Flex Item)<br>flex-grow, flex-shrink, flex-basis 的缩写; 其中, 第二个和第三个参数是可选参数. 默认值是<code>0 1 auto</code></p>
</li>
<li><p>align-self: auto|flex-start|flex-end|center|baseline|stretch; (修饰 Flex Item)<br>用于覆盖单个 Item 的对齐方式.</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Chen Yu" />
          <p class="site-author-name" itemprop="name">Chen Yu</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">171</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Keith-CY" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chen Yu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
