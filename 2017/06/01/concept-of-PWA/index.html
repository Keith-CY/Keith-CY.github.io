<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Concept of PWA | EzCook</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Concept of PWA</h1><a id="logo" href="/.">EzCook</a><p class="description">Code Elegantly</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Concept of PWA</h1><div class="post-meta">Jun 1, 2017</div><div class="post-content"><h1 id="Advantages-of-Progressive-Web-Apps"><a href="#Advantages-of-Progressive-Web-Apps" class="headerlink" title="Advantages of Progressive Web Apps:"></a>Advantages of Progressive Web Apps:</h1><ul>
<li><p>Reliable - Load instantly and never show the dinasaur.</p>
</li>
<li><p>Fast - Respond quickly to user interactions with silky smooth animations.</p>
</li>
<li><p>Enaging - Feel like a natural app on the device, with immersive user experience.</p>
</li>
</ul>
<h1 id="What-is-a-Progressive-Web-App"><a href="#What-is-a-Progressive-Web-App" class="headerlink" title="What is a Progressive Web App"></a>What is a Progressive Web App</h1><ul>
<li><p>Progressive - Works for every user, regardless of browser choice because it’s built with progressive enhancement as a core tenet.</p>
</li>
<li><p>Responsive - Fits any form factor: desktop, mobile, tablet, or whatever is next.</p>
</li>
<li><p>Connectively independent - Enhanced with service workers to work offline or on low-quality networks.</p>
</li>
<li><p>App-like - Feels like an app, because the app shell model seperates the application <em>functionality</em> from application <em>content</em>.</p>
</li>
<li><p>Fresh - Always up-to-date thanks to the service worker update process.</p>
</li>
<li><p>Safe - Served via HTTPS to prevent snooping and to ensure content hasn’t been tampered with.</p>
</li>
<li><p>Discoverable - Is identifiable as an ‘application’ thanks to <em>W3C manifest</em> and <em>service worker registration</em> scope, allowing search engines to find it.</p>
</li>
<li><p>Re-engagable - Makes Re-engagement easy through features like push notification.</p>
</li>
<li><p>Installable - Allows users to add apps they find most useful to their home screen without the hassle of an app store.</p>
</li>
<li><p>Linkable - Easily share the application via URL, doesn’t require complex installation.</p>
</li>
</ul>
<h2 id="What-is-App-Shell"><a href="#What-is-App-Shell" class="headerlink" title="What is App Shell"></a>What is App Shell</h2><p>The app’s shell is the minimal HTML, CSS, JavaScript that is required to power the user interface of a progressive web app and is one of the components that ensures reliably good performance. Its first load should be extremely quick and immediately cached.</p>
<p>‘Chched’ means that the shell files are loaded once over the network and then saved to the local device. Every subsequent time that the user opens the app, the shell files are loaded from the local device’s cache, which results in blazing-fast startup times.</p>
<p>App shell architecture seperates the core application infrastructure and UI from the data. All of the UI and infrastructure is cached locally using a <em>service worker</em> so that on subsequent loads, the PWA only needs to retrieve the necessary data, instead of having to load everything.</p>
<p>A service worker is a script that your browser runs in the background, seperate from a web page, opening the door to features that don’t need a web page or user interaction.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/156b5e3cc8373d55.png" alt=""></p>
<p>The app shell is similar to the bundle of code that you’d publish to an app store when building a native app. It is the core components necessary to get your app off the ground, but likely doesn’t contain the data.</p>
<p>Using the app shell architecture allows you to focus on speed, giving the PWA similar properties to native apps:</p>
<ul>
<li><p>instant loading</p>
</li>
<li><p>regular updates</p>
</li>
</ul>
<h2 id="Implement-App-Shell"><a href="#Implement-App-Shell" class="headerlink" title="Implement App Shell"></a>Implement App Shell</h2><h3 id="Create-the-HTML-for-the-App-Shell"><a href="#Create-the-HTML-for-the-App-Shell" class="headerlink" title="Create the HTML for the App Shell"></a>Create the HTML for the App Shell</h3><p>The Components consist of:</p>
<ul>
<li><p>Header with a title, and app/refresh button</p>
</li>
<li><p>Container for forecast cards</p>
</li>
<li><p>A forecast card template</p>
</li>
<li><p>A dialog for adding new cities</p>
</li>
<li><p>A loading indicator</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Weather PWA<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"styles/inline.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"header__title"</span>&gt;</span>Weather PWA<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"butRefresh"</span> <span class="attr">class</span>=<span class="string">"headerButton"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"butAdd"</span> <span class="attr">class</span>=<span class="string">"headerButton"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">main</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card cardTemplate weather-forecase"</span> <span class="attr">hidden</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"dialog-container"</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"loader"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">viewBox</span>=<span class="string">"0 0 32 32"</span> <span class="attr">with</span>=<span class="string">"32"</span> <span class="attr">height</span>=<span class="string">"32"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">id</span>=<span class="string">"spinner"</span> <span class="attr">cx</span>=<span class="string">"16"</span> <span class="attr">cy</span>=<span class="string">"16"</span> <span class="attr">r</span>=<span class="string">"14"</span> <span class="attr">fill</span>=<span class="string">"none"</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- insert link to app.js here --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Notice the loader is visible by default. This ensures that the user sees the loader immediately as the page loads, giving them a clear indication that the content is loading.</p>
<h3 id="Start-with-a-fast-load"><a href="#Start-with-a-fast-load" class="headerlink" title="Start with a fast load"></a>Start with a fast load</h3><h4 id="Differentiating-the-first-run"><a href="#Differentiating-the-first-run" class="headerlink" title="Differentiating the first run"></a>Differentiating the first run</h4><p>User preferences, like the list of cities a user has subscribed to, should be stored locally using IndexedBD or another fast storage mechanism. To simplify this code, here we use localStorage, which is not ideal for production apps because it is a blocking, synchronous storage mechanism that is potentially very slow on some device.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Save list of cities to lcoalStorage</span></span><br><span class="line">app.saveSelectedCities = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> selectedCities = <span class="built_in">JSON</span>.stringify(app.selectedCities)</span><br><span class="line">  localStorage.selectedCities = selectedCities</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Next, let’s add the startup code to check if the user has any saved cities and render those</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.selectedCities = lcoalStorage.selectedCities</span><br><span class="line"><span class="keyword">if</span> (app.selectedCities) &#123;</span><br><span class="line">  app.selectedCities = <span class="built_in">JSON</span>.parse(app.selectedCities)</span><br><span class="line">  app.selectedCities.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">city</span>) </span>&#123;</span><br><span class="line">    app.getForecast(city.key, city.label)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  app.updateForecastCard(initialWeatherForecast)</span><br><span class="line">  app.selectedCities = [</span><br><span class="line">    &#123;</span><br><span class="line">      key: initialWeatherForecast.key,</span><br><span class="line">      label: initialWeatherForecast.label,</span><br><span class="line">    &#125;,</span><br><span class="line">    app.saveSelectedCities()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Use-service-workers-to-pre-cache-the-App-Shell"><a href="#Use-service-workers-to-pre-cache-the-App-Shell" class="headerlink" title="Use service workers to pre-cache the App Shell"></a>Use service workers to pre-cache the App Shell</h3><p>PWA has to be fast, and installable, which means that they work online, offline, and on intermittent, slow connections.</p>
<p>To achieve this, we need to cache our app shell using service worker, so that it’s always available quickly and reliably.</p>
<p>Features provided via service workers should be considered a progressive enhancement, and added only if supported by the browser.</p>
<h4 id="Register-the-service-worker-if-it’s-available"><a href="#Register-the-service-worker-if-it’s-available" class="headerlink" title="Register the service worker if it’s available"></a>Register the service worker if it’s available</h4><p>The first step to making the app work offline is to register a service worker, a script that allows background functionality without the need of an open web page or user interaction.</p>
<p>This takes two simple steps:</p>
<ul>
<li><p>Tell the browser to register the JavaScript file as the service worker</p>
</li>
<li><p>Create a JavaScript file containing the service worker</p>
</li>
</ul>
<p>First, we need to check if the browser supports service worker, and if it does, register the service worker. Add the following code to <code>app.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">  navigator.serviceWorker</span><br><span class="line">  .register(<span class="string">'./service-worker.js'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Service Worker Registered'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Cache-the-site-assets"><a href="#Cache-the-site-assets" class="headerlink" title="Cache the site assets"></a>Cache the site assets</h4><p>When the service worker is registered, an install event is triggered the first time the user visits the page.</p>
<p>In this event handler, we will cache all the assets that are needed for the application.</p>
<p>When the service worker is fired, it should open the <code>caches</code> object and populate it with the assets necessary to load the App Shell. Create a file called <code>service-worker.js</code> in your application root folder. This file must live in the application root because the scope for service worker is defined by the directory in which the file resides. Add this code to your new <code>service-worker.js</code> file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cacheName = <span class="string">'weatherPWA'</span></span><br><span class="line"><span class="keyword">var</span> filesToCache = []</span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="string">'install'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Install'</span>)</span><br><span class="line">  e.waitUntil(</span><br><span class="line">    caches.open(cacheName).then(<span class="function"><span class="keyword">function</span> (<span class="params">cache</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Caching app shell'</span>)</span><br><span class="line">      <span class="keyword">return</span> cache.addAll(filesToCache)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>First, we need to open the cache with <code>caches.open()</code> and provide a cache name. Providing a cache name allows us to version files, or separate data from the app shell so that we can easily update one but not affect other.</p>
<p>Once the cache is open, we can then call <code>cache.addAll()</code>, which takes a list of URLs, then fetches them from the server and adds the response to the cache. Unfortunately, <code>cache.addAll()</code> is atomic, if any of the files fail, the entire cache step fails.</p>
<p>DevTools can debug service workers. Before reloading your page, open up DevTools, go the <code>Service Worker</code> pane on the <code>Application</code> panel.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/ed4633f91ec1389f.png" alt=""></p>
<p>When you see a blank page like this, it means that the currently open page doesn’t have any registered service workers.</p>
<p>Now reload your page. The Service Worker pane should look like this.</p>
<p><img src="https://codelabs.developers.google.com/codelabs/your-first-pwapp/img/bf15c2f18d7f945c.png" alt=""></p>
<p>When you see information like this, it means the page has a service worker running.</p>
<p>Let’s add some logic on the <code>activate</code> event listener to update the cache.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="string">'activate'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Activate'</span>)</span><br><span class="line">  e.waitUntil(</span><br><span class="line">    caches.keys().then(<span class="function"><span class="keyword">function</span> (<span class="params">keyList</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.all(keyList.map(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (key !== cacheName) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Removing old cache'</span>, key)</span><br><span class="line">          <span class="keyword">return</span> caches.delete(key)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;))</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">  <span class="keyword">return</span> self.clients.claim()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>This code ensures that your service worker updates its cache whenever any of the app shell files change. In order for this to work, you’d need to increment the <code>cacheName</code> variable at the top of your service worker file.</p>
<p>When the app is complete, <code>self.clients.claim()</code> fixes a corner case in which the app wasn’t returning the latest data. You can reproduce the corner case by commenting out the line below and then doing the following steps:</p>
<ul>
<li><p>load app for first time so that the initial City data is shown</p>
</li>
<li><p>press the refresh button on the app</p>
</li>
<li><p>go offline</p>
</li>
<li><p>reload the app</p>
</li>
</ul>
<p>You expect to see the newer data, but you actually see the initial data. This happens because the service worker is not yet activated. <code>self.clients.claim()</code> essentially lets you activate the service worker faster.</p>
<p>Finally, let’s update the list of files required for the app shell. In the array, we need to include all of the files our app needs, including images, js, css, etc.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> filesToCache = [</span><br><span class="line">  <span class="string">'/'</span>,</span><br><span class="line">  <span class="string">'/index.html'</span>,</span><br><span class="line">  <span class="string">'/scripts/app.js'</span>,</span><br><span class="line">  <span class="string">'/styles/inline.css'</span>,</span><br><span class="line">  <span class="string">'/images/clear.png'</span>,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="Serve-the-app-shell-from-the-cache"><a href="#Serve-the-app-shell-from-the-cache" class="headerlink" title="Serve the app shell from the cache"></a>Serve the app shell from the cache</h4><p>Service workers provide the ability to intercept requests made from our PWA and handle them within the service worker. That means we can determine how we want to handle the request and potentially serve our own cached response.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="string">'fetch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'[ServiceWorker] Fetch'</span>, e.request.url)</span><br><span class="line">  e.responseWith(</span><br><span class="line">    caches.match(e.request).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> response || fetch(e.request)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Stepping from inside, out, <code>caches.match()</code> evaluates the web request that triggered the <code>fetch</code> event, and checks to see if it’s available in the cache. It then either responds with the cached version, or uses <code>fetch</code> to get a copy from the network. The <code>response</code> is passed back to the web page with <code>e.responseWith()</code></p>
<h3 id="Beware-of-the-edge-cases"><a href="#Beware-of-the-edge-cases" class="headerlink" title="Beware of the edge cases"></a>Beware of the edge cases</h3><p>This code must not be used in production because of the many unhandled edge cases</p>
<ul>
<li><p>Cache depends on updating the cache key for every change</p>
</li>
<li><p>Requires everything to be redownloaded for every change</p>
</li>
<li><p>Browser cache may prevent the service worker cache from updating</p>
</li>
<li><p>Beware of cache-first strategies in production</p>
</li>
</ul>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2017/06/05/utils-in-axios/">Utils in Axios</a><a class="next" href="/2017/05/31/Simple-Guide-of-Jest/">Simple Guide of Jest</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Soup/">Soup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Uncategorized/">Uncategorized</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/github/note/">note</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/note/">note</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/note/workNote/">workNote</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/workNote/">workNote</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/CSS3/" style="font-size: 15px;">CSS3</a> <a href="/tags/jQuery/" style="font-size: 15px;">jQuery</a> <a href="/tags/Trick/" style="font-size: 15px;">Trick</a> <a href="/tags/Material-Design/" style="font-size: 15px;">Material Design</a> <a href="/tags/GraphQL-Apollo-TypeScript/" style="font-size: 15px;">GraphQL, Apollo, TypeScript</a> <a href="/tags/Node-CLI/" style="font-size: 15px;">Node, CLI</a> <a href="/tags/ETH-Wallet/" style="font-size: 15px;">ETH, Wallet</a> <a href="/tags/Int8Array/" style="font-size: 15px;">Int8Array</a> <a href="/tags/Contract-Solidity/" style="font-size: 15px;">Contract, Solidity</a> <a href="/tags/BlockChain/" style="font-size: 15px;">BlockChain</a> <a href="/tags/Solidity/" style="font-size: 15px;">Solidity</a> <a href="/tags/Ruby-Rails-RoR-Mina/" style="font-size: 15px;">Ruby, Rails, RoR, Mina</a> <a href="/tags/Smart-Contract-Web3/" style="font-size: 15px;">Smart Contract, Web3</a> <a href="/tags/React-Docker/" style="font-size: 15px;">React, Docker</a> <a href="/tags/Solidity-Error-Handling/" style="font-size: 15px;">Solidity, Error Handling</a> <a href="/tags/Ethereum-IPFS/" style="font-size: 15px;">Ethereum, IPFS</a> <a href="/tags/Node-Fastify/" style="font-size: 15px;">Node, Fastify</a> <a href="/tags/Solidity-Public-External/" style="font-size: 15px;">Solidity, Public, External</a> <a href="/tags/Ethereum/" style="font-size: 15px;">Ethereum</a> <a href="/tags/Webpack/" style="font-size: 15px;">Webpack</a> <a href="/tags/Go-Http-Web/" style="font-size: 15px;">Go, Http, Web</a> <a href="/tags/HTTP2-Node/" style="font-size: 15px;">HTTP2, Node</a> <a href="/tags/JSON-RPC/" style="font-size: 15px;">JSON-RPC</a> <a href="/tags/Ruby-Rails/" style="font-size: 15px;">Ruby, Rails</a> <a href="/tags/Rust-Rocket/" style="font-size: 15px;">Rust, Rocket</a> <a href="/tags/DAPP-Solidity/" style="font-size: 15px;">DAPP, Solidity</a> <a href="/tags/D3-Example/" style="font-size: 15px;">D3, Example</a> <a href="/tags/Drizzle-Ethereum-BlockChain/" style="font-size: 15px;">Drizzle, Ethereum, BlockChain</a> <a href="/tags/Protobuf/" style="font-size: 15px;">Protobuf</a> <a href="/tags/Pug-HTML/" style="font-size: 15px;">Pug, HTML</a> <a href="/tags/Mock-JavaScript/" style="font-size: 15px;">Mock, JavaScript</a> <a href="/tags/Blockchain/" style="font-size: 15px;">Blockchain</a> <a href="/tags/DApp-Solidity/" style="font-size: 15px;">DApp, Solidity</a> <a href="/tags/Redux/" style="font-size: 15px;">Redux</a> <a href="/tags/Javascript/" style="font-size: 15px;">Javascript</a> <a href="/tags/babel/" style="font-size: 15px;">babel</a> <a href="/tags/babel-polyfill/" style="font-size: 15px;">babel-polyfill</a> <a href="/tags/BOOTSTRAP/" style="font-size: 15px;">BOOTSTRAP</a> <a href="/tags/HTML5/" style="font-size: 15px;">HTML5</a> <a href="/tags/RxJS/" style="font-size: 15px;">RxJS</a> <a href="/tags/commandline/" style="font-size: 15px;">commandline</a> <a href="/tags/Bash/" style="font-size: 15px;">Bash</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/CommonJS/" style="font-size: 15px;">CommonJS</a> <a href="/tags/Node-js/" style="font-size: 15px;">Node.js</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/ESLint/" style="font-size: 15px;">ESLint</a> <a href="/tags/React-Redux/" style="font-size: 15px;">React-Redux</a> <a href="/tags/DOM/" style="font-size: 15px;">DOM</a> <a href="/tags/NPM/" style="font-size: 15px;">NPM</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/Gulp/" style="font-size: 15px;">Gulp</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/Thunk/" style="font-size: 15px;">Thunk</a> <a href="/tags/测试/" style="font-size: 15px;">测试</a> <a href="/tags/AJAX/" style="font-size: 15px;">AJAX</a> <a href="/tags/Koa/" style="font-size: 15px;">Koa</a> <a href="/tags/NODE/" style="font-size: 15px;">NODE</a> <a href="/tags/webpack2/" style="font-size: 15px;">webpack2</a> <a href="/tags/CORS/" style="font-size: 15px;">CORS</a> <a href="/tags/Elixir-Phoenix-SCSS/" style="font-size: 15px;">Elixir, Phoenix, SCSS</a> <a href="/tags/FP/" style="font-size: 15px;">FP</a> <a href="/tags/Node-Graphql-Koa/" style="font-size: 15px;">Node, Graphql, Koa</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/automatic/" style="font-size: 15px;">automatic</a> <a href="/tags/Immutable/" style="font-size: 15px;">Immutable</a> <a href="/tags/DevTools/" style="font-size: 15px;">DevTools</a> <a href="/tags/Closure/" style="font-size: 15px;">Closure</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/MDL/" style="font-size: 15px;">MDL</a> <a href="/tags/precache/" style="font-size: 15px;">precache</a> <a href="/tags/Webpack-DLL/" style="font-size: 15px;">Webpack, DLL</a> <a href="/tags/Promise/" style="font-size: 15px;">Promise</a> <a href="/tags/React-Router-Code-splitting/" style="font-size: 15px;">React, Router, Code-splitting</a> <a href="/tags/React-Native/" style="font-size: 15px;">React-Native</a> <a href="/tags/React-Router/" style="font-size: 15px;">React-Router</a> <a href="/tags/RegExp/" style="font-size: 15px;">RegExp</a> <a href="/tags/Koa-NPM-Package/" style="font-size: 15px;">Koa, NPM, Package</a> <a href="/tags/Html-Picture/" style="font-size: 15px;">Html, Picture</a> <a href="/tags/Nock/" style="font-size: 15px;">Nock</a> <a href="/tags/Solidity-Smart-Contract/" style="font-size: 15px;">Solidity, Smart Contract</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/04/14/Introduction-to-Object-getOwnPropertyDescriptors/">Introduction to Object.getOwnPropertyDescriptors</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/06/enable-sass-scss-in-phoenix/">Enable Sass/scss in Phoenix</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/14/Model-Generator-of-Rails/">Model Generator of Rails</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/Error-Handling-in-Solidity/">Error Handling in Solidity</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/Start-in-Drizzle/">Start in Drizzle </a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/12/Constant-View-and-Pure-in-Solidity/">Constant, View, and Pure in Solidity</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/05/Writing-Upgradable-Contracts-in-Solidity/">Writing Upgradable Contracts in Solidity</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/28/Dockerizing-a-React-App/">Dockerizing a React App</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/24/Deploy-RoR-with-Mina/">Deploy RoR With Mina</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/14/What-Blockchain-came-with/">What Blockchain Came With</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://github.com/Keith-CY" title="Github" target="_blank">Github</a><ul></ul><a href="https://www.linkedin.com/in/%E5%AE%87-%E9%99%88-644b61ba/" title="LinkedIn" target="_blank">LinkedIn</a><ul></ul><a href="https://www.facebook.com/keithwhisper" title="Facebook" target="_blank">Facebook</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">EzCook.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>